/*! For license information please see 0fda66b8.457b941e.js.LICENSE.txt */
"use strict";(self.webpackChunk_utrecht_docusaurus=self.webpackChunk_utrecht_docusaurus||[]).push([[901],{4733:(e,t,n)=>{n.d(t,{Cd:()=>vn,GS:()=>er,SC:()=>Wi,XJ:()=>tn,Z0:()=>Hr,aC:()=>an,by:()=>pn,iA:()=>gi,k8:()=>cn,nL:()=>Jt,nv:()=>Dr,pj:()=>Ni,xs:()=>Bi});var r=n(520),i=n(1460),o=n(8035),a=n(2983),s=n(7458),l=n(4517),u=(n(2795),n(4749),n(1806),["appearance","busy","disabled","children","className","hint","pressed","type"]);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d=(0,a.forwardRef)((function(e,t){var n=e.appearance,r=e.busy,o=e.disabled,a=e.children,c=e.className,d=e.hint,h=e.pressed,p=e.type,m=(0,i.Z)(e,u);return(0,s.jsx)("button",f(f({ref:t,className:(0,l.Z)("utrecht-button",r&&"utrecht-button--busy",o&&"utrecht-button--disabled","submit"===p&&"utrecht-button--submit","primary-action-button"===n&&"utrecht-button--primary-action","secondary-action-button"===n&&"utrecht-button--secondary-action","subtle-button"===n&&"utrecht-button--subtle","danger"===d&&"utrecht-button--danger","warning"===d&&"utrecht-button--warning","ready"===d&&"utrecht-button--ready",!0===h&&"utrecht-button--pressed",c),"aria-busy":r||void 0,"aria-pressed":"boolean"==typeof h?h:void 0,disabled:o,type:p||"button"},m),{},{children:a}))}));d.displayName="Button";var h=["appearance","className","level"];function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g=(0,a.forwardRef)((function(e,t){var n=e.appearance,r=e.className,o=e.level,a=(0,i.Z)(e,h),u=["utrecht-heading-1","utrecht-heading-2","utrecht-heading-3","utrecht-heading-4","utrecht-heading-5","utrecht-heading-6"],c=2===o?"h2":3===o?"h3":4===o?"h4":5===o?"h5":6===o?"h6":"h1",f=n&&-1!==u.indexOf(n)?n:u[o-1]||"utrecht-heading-1";return(0,s.jsx)(c,m(m({className:(0,l.Z)(f,r)},a),{},{ref:t}))}));g.displayName="Heading";var y=["children","group","headingLevel","heading"];function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var x=(0,a.forwardRef)((function(e,t){var n=e.id,r=e.label,i=e.headingLevel,o=void 0===i?1:i,u=e.expanded,c=void 0!==u&&u,f=e.disabled,h=e.section,p=e.children,m=e.buttonRef,y=e.onActivate,v=e.onButtonBlur,x=e.onButtonFocus,w={className:(0,l.Z)("utrecht-accordion__panel",{"utrecht-accordion__panel--expanded":c}),hidden:!c,"aria-hidden":!c},k="utrecht-accordion",_=n||(0,a.useId)(),O="".concat(k).concat(_,"-button"),E="".concat(k).concat(_,"-panel");return(0,s.jsxs)("div",{className:(0,l.Z)("utrecht-accordion__section"),id:n,ref:t,children:[(0,s.jsx)(g,{level:o,className:(0,l.Z)("utrecht-accordion__header"),children:(0,s.jsx)(d,{className:(0,l.Z)("utrecht-accordion__button"),appearance:"subtle-button","aria-expanded":!0===c,"aria-controls":E,disabled:f,id:O,onClick:function(){return"function"==typeof y&&y(t)},onFocus:function(){return"function"==typeof x&&x(t)},onBlur:function(){return"function"==typeof v&&v(t)},ref:m,children:r})}),h?(0,s.jsx)("section",b(b({id:E,"aria-labelledby":O},w),{},{children:p})):(0,s.jsx)("div",b(b({},w),{},{children:p}))]})}));x.displayName="AccordionSection";var w=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.group,o=e.headingLevel,u=e.heading,c=(0,i.Z)(e,y),f=(0,a.useId)();return(0,s.jsxs)(s.Fragment,{children:[!!u&&"number"==typeof o&&(0,s.jsx)(g,{level:o,children:u}),(0,s.jsx)("div",b(b({className:(0,l.Z)("utrecht-accordion"),role:r?"group":void 0,"aria-labelledby":r?f:void 0},c),{},{ref:t,children:n}))]})}));w.displayName="Accordion";(function(e){var t=e.sections,n=(0,a.useRef)(null),i=function(e,t){console.log("useAccordion");var n=e.map((function(e){return(0,a.useRef)(null)})),r=e.map((function(e){return(0,a.useRef)(null)}));return{ref:t,refs:n,buttonRefs:r,activeElement:null,sections:e,focusNextSection:function(e){var t,i,o,a,s=n.indexOf(e),l=s>=0?r[s]:void 0,u=l?(i=r,(a=(o=l)?i.indexOf(o):-1)>=0&&a+1<=i.length-1?i[a+1]:void 0):void 0;null==u||null===(t=u.current)||void 0===t||t.focus()},focusFirstSection:function(){var e,t,i=(t=r).length>=1?t[0]:void 0;console.log(n),null==i||null===(e=i.current)||void 0===e||e.focus()},focusPreviousSection:function(e){var t,i,o,a,s=n.indexOf(e),l=s>=0?r[s]:void 0,u=l?(i=r,(a=(o=l)?i.indexOf(o):-1)>=0&&a-1<=i.length-1?i[a-1]:void 0):void 0;null==u||null===(t=u.current)||void 0===t||t.focus()},focusLastSection:function(){var e,t,n=(t=r).length>=1?t[t.length-1]:void 0;null==n||null===(e=n.current)||void 0===e||e.focus()}}}(t,n),o=i.refs,l=i.buttonRefs,u=i.focusNextSection,c=i.focusFirstSection,f=i.focusLastSection,d=i.focusPreviousSection,h=(0,a.useState)(null),p=(0,r.Z)(h,2),m=p[0],g=p[1],y=(0,a.useState)(t),v=(0,r.Z)(y,2),k=v[0],_=v[1],O=function(e){g(e)},E=function(e){g(null)};return(0,s.jsx)(w,{onKeyDown:function(e){if("End"===e.code)f();else if("Home"===e.code)c();else if("ArrowDown"===e.code)m&&u(m);else{if("ArrowUp"!==e.code)return;m&&d(m)}e.preventDefault()},ref:n,children:k.map((function(e,t){return(0,a.createElement)(x,b(b({},e),{},{ref:o[t],buttonRef:l[t],key:t,onButtonFocus:O,onButtonBlur:E,onActivate:function(e){var t=o.indexOf(e);_(k.map((function(e,n){return n===t?b(b({},e),{},{expanded:!e.expanded}):e})))}}),e.body)}))})}).displayName="AccordionProvider";var k=["children","className","icon","type"];function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.icon,a=e.type,u=(0,i.Z)(e,k);return(0,s.jsxs)("div",O(O({},u),{},{ref:t,className:(0,l.Z)("utrecht-alert",{"utrecht-alert--error":"error"===a,"utrecht-alert--info":"info"===a,"utrecht-alert--ok":"ok"===a,"utrecht-alert--warning":"warning"===a},r),children:[o&&(0,s.jsx)("div",{className:"utrecht-alert__icon",children:o}),(0,s.jsx)("div",{className:"utrecht-alert__message",children:n})]}))}));E.displayName="Alert";var D=["children","className","icon","type"];function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.icon,a=e.type,u=(0,i.Z)(e,D);return(0,s.jsxs)("dialog",N(N({},u),{},{ref:t,className:(0,l.Z)("utrecht-alert-dialog",{"utrecht-alert-dialog--error":"error"===a,"utrecht-alert-dialog--info":"info"===a,"utrecht-alert-dialog--warning":"warning"===a,className:r}),children:[o&&(0,s.jsx)("div",{className:"utrecht-alert-dialog__icon",children:o}),(0,s.jsx)("div",{className:"utrecht-alert-dialog__message",children:n})]}))}));S.displayName="AlertDialog";var A=["appearance","children","className","external","href","placeholder","role"];function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var M=function(e){var t;" "===e.key&&"function"==typeof(null===(t=e.target)||void 0===t?void 0:t.click)&&(e.preventDefault(),e.target.click())},P=(0,a.forwardRef)((function(e,t){var n=e.appearance,r=e.children,o=e.className,a=e.external,u=e.href,c=e.placeholder,f=e.role,d=(0,i.Z)(e,A),h=d;return"button"===f&&(h=C(C({},d),{},{onKeyDown:M})),(0,s.jsx)("a",C(C({href:c?void 0:u,ref:t,role:f||(c?"link":void 0),className:(0,l.Z)("utrecht-button-link","utrecht-button-link--html-a",{"utrecht-button-link--external":a,"utrecht-button-link--primary-action":"primary-action-button"===n,"utrecht-button-link--secondary-action":"secondary-action-button"===n,"utrecht-button-link--subtle":"subtle-button"===n,"utrecht-button-link--placeholder":c},o),rel:a?"external noopener noreferrer":void 0,"aria-disabled":c?"true":void 0},h),{},{children:r}))}));P.displayName="ButtonLink";var F=["component","currentChar","characters","onLinkClick","Link"];function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var R=(0,a.forwardRef)((function(e,t){var n=e.component,r=e.currentChar,o=e.characters,u=e.onLinkClick,c=e.Link,f=(0,i.Z)(e,F),h=c||P,p=[];return p="button"===n?o.map((function(e){var n=e.char,i=e.disabled,o=r===n;return(0,a.createElement)(d,z(z({},f),{},{className:(0,l.Z)({"utrecht-index-char-nav__link--current":o}),ref:t,key:n,appearance:o?"primary-action-button":"secondary-action-button",disabled:i,onClick:function(){return"function"==typeof u&&u(n)},pressed:o}),n)})):o.map((function(e){var n=e.char,i=e.disabled,o=e.href,a=r===n,d=(0,l.Z)("utrecht-button-link","utrecht-button-link--html-a","utrecht-index-char-nav__link",{"utrecht-index-char-nav__link--current":a,"utrecht-button-link--primary-action":a,"utrecht-button-link--secondary-action":!a,"utrecht-index-char-nav__link--disabled":i,"utrecht-button-link--placeholder":i});return(0,s.jsx)(h,z(z({ref:t,appearance:c?void 0:a?"primary-action-button":"secondary-action-button",href:o,className:(0,l.Z)(c&&d,"utrecht-index-char-nav__link",{"utrecht-index-char-nav__link--disabled":i,"utrecht-index-char-nav__link--current":a}),"aria-current":a?"page":void 0,"aria-disabled":i,placeholder:c?void 0:i,onClick:function(){return"function"==typeof u&&u(n)}},f),{},{children:n}),n)})),(0,s.jsx)("div",{className:"utrecht-index-char-nav",role:"group",children:p})}));R.displayName="IndexCharNav";var L=["children","className"];function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var U=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,L);return(0,s.jsx)("article",I(I({},o),{},{ref:t,className:(0,l.Z)("utrecht-article",r),children:n}))}));U.displayName="Article";var q=["children","className"];function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var H=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,q);return(0,s.jsx)("div",Z(Z({},o),{},{ref:t,className:(0,l.Z)("utrecht-backdrop",r),children:n}))}));H.displayName="Backdrop";var G=["children","className","value"];function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var X=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.value,a=(0,i.Z)(e,G),u=Y({children:n,className:(0,l.Z)("utrecht-badge-counter",r)},a);return void 0!==o?(0,s.jsx)("data",Y(Y({},u),{},{value:o,ref:t})):(0,s.jsx)("span",Y(Y({},u),{},{ref:t}))}));X.displayName="BadgeCounter";var J=["children","className"];function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ee=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,J);return(0,s.jsx)("div",K(K({},o),{},{ref:t,className:(0,l.Z)("utrecht-badge-list",r),children:n}))}));ee.displayName="BadgeList";var te=["boxContent","children","className","external","href","placeholder","role"];function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ie=(0,a.forwardRef)((function(e,t){var n=e.boxContent,r=e.children,o=e.className,a=e.external,u=e.href,c=e.placeholder,f=e.role,d=(0,i.Z)(e,te);return(0,s.jsx)("a",re(re({href:c?void 0:u,ref:t,role:f||(c?"link":void 0),className:(0,l.Z)("utrecht-link","utrecht-link--html-a",{"utrecht-link--box-content":n,"utrecht-link--external":a,"utrecht-link--placeholder":c},o),"aria-disabled":c?"true":void 0,rel:a?"external noopener noreferrer":void 0},d),{},{children:r}))}));ie.displayName="Link";var oe=["appearance","children","className","headingLevel","label"],ae=["className","children"],se=["className","children"],le=["children","disabled","current","href","index","rel","role","Link","className"];function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var fe=function(e){var t=e.prop;return{itemScope:!0,itemType:e.type,itemProp:t}},de=function(e){return{itemProp:e}},he=(0,a.forwardRef)((function(e,t){var n=e.appearance,r=e.children,o=e.className,u=e.headingLevel,c=void 0===u?2:u,f=e.label,d=(0,i.Z)(e,oe),h=f?(0,a.useId)():void 0;return(0,s.jsxs)("nav",ce(ce({},d),{},{ref:t,className:(0,l.Z)("utrecht-breadcrumb","utrecht-breadcrumb--html-ol",{"utrecht-breadcrumb--arrows":"arrows"===n},o),"aria-labelledby":h,children:[f&&(0,s.jsx)(g,{id:h,className:"utrecht-breadcrumb__heading",level:c,"aria-hidden":"true",children:f}),(0,s.jsx)("ol",ce(ce({className:"utrecht-breadcrumb__list utrecht-breadcrumb__list--html-ol"},fe({type:"https://schema.org/BreadcrumbList"})),{},{children:r}))]}))}));he.displayName="BreadcrumbNav";var pe=(0,a.forwardRef)((function(e,t){var n=e.className,r=e.children,o=(0,i.Z)(e,ae);return(0,s.jsx)("li",ce(ce(ce({className:(0,l.Z)("utrecht-breadcrumb__item",n)},fe({type:"https://schema.org/ListItem",prop:"itemListElement"})),{},{ref:t},o),{},{children:r}))}));pe.displayName="BreadcrumbItem";var me=(0,a.forwardRef)((function(e,t){var n=e.className,r=e.children,o=(0,i.Z)(e,se);return(0,s.jsx)("li",ce(ce({"aria-hidden":"true",hidden:!0,style:{display:"var(--_utrecht-breadcrumb-separator-display, block)"},className:(0,l.Z)("utrecht-breadcrumb__separator","utrecht-breadcrumb__separator--html-li",n),ref:t},o),{},{children:r}))}));me.displayName="BreadcrumbSeparator";var ge=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.disabled,o=e.current,a=e.href,u=e.index,c=e.rel,f=e.role,d=e.Link,h=void 0===d?ie:d,p=e.className,m=(0,i.Z)(e,le),g=h||h;return(0,s.jsx)(pe,{children:(0,s.jsxs)(g,ce(ce(ce({className:(0,l.Z)("utrecht-breadcrumb__link",p,{"utrecht-breadcrumb__link--current":o,"utrecht-breadcrumb__link--disabled":r}),href:r?void 0:a,rel:c,role:f||(r?"link":void 0),"aria-current":o&&"page","aria-disabled":r?"true":void 0},de("item")),m),{},{ref:t,children:[(0,s.jsx)("span",ce(ce({className:"utrecht-breadcrumb__text"},de("name")),{},{children:n})),"number"==typeof u?(0,s.jsx)("meta",ce(ce({},de("position")),{},{content:String(u+1)})):null]}))})}));ge.displayName="BreadcrumbLink";var ye=["children","className"];function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var xe=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,ye);return(0,s.jsx)("p",be(be({},o),{},{ref:t,className:(0,l.Z)("utrecht-button-group",r),children:n}))}));xe.displayName="ButtonGroup";var we=["appearance","disabled","invalid","required","className"];function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Oe=(0,a.forwardRef)((function(e,t){var n=e.appearance,r=void 0===n?"custom":n,o=e.disabled,a=e.invalid,u=e.required,c=e.className,f=(0,i.Z)(e,we);return(0,s.jsx)("input",_e(_e({},f),{},{ref:t,type:"checkbox",className:(0,l.Z)("utrecht-checkbox","utrecht-checkbox--html-input",{"utrecht-checkbox--disabled":o,"utrecht-checkbox--custom":"custom"===r,"utrecht-checkbox--invalid":a,"utrecht-checkbox--required":u},c),"aria-invalid":a||void 0,disabled:o,required:u}))}));Oe.displayName="Checkbox";var Ee=["children","className"];function De(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?De(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):De(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ne=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Ee);return(0,s.jsx)("code",je(je({ref:t,className:(0,l.Z)("utrecht-code",r)},o),{},{children:n}))}));Ne.displayName="Code";var Se=["children","className"];function Ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ae(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ce=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Se);return(0,s.jsx)("pre",$e($e({ref:t,className:(0,l.Z)("utrecht-code-block",r)},o),{},{children:(0,s.jsx)("code",{className:"utrecht-code-block__content",children:n})}))}));Ce.displayName="CodeBlock";var Me=["children","className","color","style"];function Pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Te=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.color,a=e.style,u=(0,i.Z)(e,Me);return(0,s.jsx)("data",Fe(Fe({ref:t,className:(0,l.Z)("utrecht-color-sample",r),style:Fe(Fe({},a),{},{color:o}),value:o},u),{},{children:n}))}));Te.displayName="ColorSample";var ze=["children","currency","amount","locale","className"];function Re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Be=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.currency,o=void 0===r?"EUR":r,a=e.amount,u=e.locale,c=void 0===u?"nl-NL":u,f=e.className,d=(0,i.Z)(e,ze),h="string"==typeof a?parseFloat(a):a,p=function(e,t,n){return new Intl.NumberFormat(e,{style:"currency",currency:t,minimumFractionDigits:Number.isInteger(n)?0:void 0,useGrouping:!1}).format(n).replace(/[\s]+/g,"").replace("-","\u2212")}(c,o,h),m=function(e,t,n){var r=new Intl.NumberFormat(e,{style:"currency",currency:t}).format(n);return r=r.replace(/-/,"\u2212"),"nl"!==e&&"nl-NL"!==e||!/\u2212/.test(r)||(r=r.replace(/(.+)\u2212(.+)/,"\u2212 $1$2")),r.replace(/ /g,"\xa0")}(c,o,h);return(0,s.jsx)("data",Le(Le({},d),{},{ref:t,value:"".concat(o," ").concat(a),className:(0,l.Z)("utrecht-currency-data",h<0&&"utrecht-currency-data--negative",h>0&&"utrecht-currency-data--positive",f),"aria-label":p,children:n||m}))}));Be.displayName="CurrencyData";var Ie=["children","className","dateTime","value"];function Ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var We=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.dateTime,a=e.value,u=(0,i.Z)(e,Ie),c=qe({children:n,className:(0,l.Z)("utrecht-badge-data",r)},u);return void 0!==o?(0,s.jsx)("time",qe(qe({},c),{},{dateTime:o,ref:t})):void 0!==a?(0,s.jsx)("data",qe(qe({},c),{},{value:a,ref:t})):(0,s.jsx)("span",qe(qe({},c),{},{ref:t}))}));We.displayName="DataBadge";var Ze=["children","className"];function He(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?He(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):He(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ve=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Ze);return(0,s.jsx)("div",Ge(Ge({},o),{},{ref:t,className:(0,l.Z)("utrecht-document",r),children:n}))}));Ve.displayName="Document";var Ye=["appearance","children","className"],Xe=["children","className"],Je=["children","className"],Qe=["children","className"];function Ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ke(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var tt=(0,a.forwardRef)((function(e,t){var n=e.appearance,r=e.children,o=e.className,a=(0,i.Z)(e,Ye);return(0,s.jsx)("dl",et(et({},a),{},{className:(0,l.Z)("utrecht-data-list","utrecht-data-list--html-dl","rows"===n&&"utrecht-data-list--rows",o),ref:t,children:r}))}));tt.displayName="DataList";var nt=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Xe);return(0,s.jsx)("div",et(et({},o),{},{className:(0,l.Z)("utrecht-data-list__item",r),ref:t,children:n}))}));nt.displayName="DataListItem";var rt=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Je);return(0,s.jsx)("dt",et(et({},o),{},{className:(0,l.Z)("utrecht-data-list__item-key",r),ref:t,children:n}))}));rt.displayName="DataListKey";var it=(0,a.forwardRef)((function(e,t){var n=e.value,r=e.children,i=e.className,o=e.emptyDescription,a=e.multiline,u=e.notranslate,c=""===n||null===n;return(0,s.jsx)("dd",{className:(0,l.Z)("utrecht-data-list__item-value","utrecht-data-list__item-value--html-dd",i,a&&"utrecht-data-list__item-value--multiline"),translate:"boolean"==typeof u?u?"no":"yes":void 0,ref:t,children:c?(0,s.jsx)("span",{"aria-label":o,children:"-"}):r})}));it.displayName="DataListValue";var ot=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Qe);return(0,s.jsx)("dd",et(et({},o),{},{className:(0,l.Z)("utrecht-data-list__actions","utrecht-data-list__actions--html-dd",r),ref:t,children:n}))}));ot.displayName="DataListActions";var at=["children","className"];function st(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function lt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?st(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):st(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ut=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,at);return(0,s.jsx)("em",lt(lt({ref:t,className:(0,l.Z)("utrecht-emphasis","utrecht-emphasis--stressed",r)},o),{},{children:n}))}));ut.displayName="Emphasis";var ct=["aria-describedby","aria-label","aria-labelledby","className","children","disabled","form","invalid","name","role"],ft=["className","children","disabled","invalid"];function dt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ht(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dt(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var pt=(0,a.forwardRef)((function(e,t){var n=e["aria-describedby"],r=e["aria-label"],o=e["aria-labelledby"],a=e.className,u=e.children,c=e.disabled,f=e.form,d=e.invalid,h=e.name,p=e.role,m=(0,i.Z)(e,ct);return(0,s.jsx)("div",ht(ht({},m),{},{ref:t,className:(0,l.Z)("utrecht-form-fieldset",c&&"utrecht-form-fieldset--disabled",d&&"utrecht-form-fieldset--invalid",a),children:(0,s.jsx)("fieldset",{"aria-describedby":n,"aria-label":r,"aria-labelledby":o,"aria-invalid":d||void 0,disabled:c,form:f,name:h,role:p,className:(0,l.Z)("utrecht-form-fieldset__fieldset","utrecht-form-fieldset--html-fieldset"),children:u})}))}));pt.displayName="Fieldset";var mt=(0,a.forwardRef)((function(e,t){var n=e.className,r=e.children,o=e.disabled,a=e.invalid,u=(0,i.Z)(e,ft);return(0,s.jsx)("fieldset",ht(ht({},u),{},{ref:t,"aria-invalid":a||void 0,disabled:o,className:(0,l.Z)("utrecht-form-fieldset","utrecht-form-fieldset--html-fieldset",o&&"utrecht-form-fieldset--disabled",a&&"utrecht-form-fieldset--invalid",n),children:r}))}));mt.displayName="Fieldset";var gt=["className","children"];function yt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yt(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var bt=(0,a.forwardRef)((function(e,t){var n=e.className,r=e.children,o=(0,i.Z)(e,gt);return(0,s.jsx)("legend",vt(vt({},o),{},{ref:t,className:(0,l.Z)("utrecht-form-fieldset__legend","utrecht-form-fieldset__legend--html-legend",n),children:r}))}));bt.displayName="FieldsetLegend";var xt=["className","children"];function wt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wt(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _t=(0,a.forwardRef)((function(e,t){var n=e.className,r=e.children,o=(0,i.Z)(e,xt);return(0,s.jsx)("figure",kt(kt({},o),{},{ref:t,className:(0,l.Z)("utrecht-figure",n),children:r}))}));_t.displayName="Figure";var Ot=["className","children"];function Et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Et(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Et(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var jt=(0,a.forwardRef)((function(e,t){var n=e.className,r=e.children,o=(0,i.Z)(e,Ot);return(0,s.jsx)("figcaption",Dt(Dt({},o),{},{ref:t,className:(0,l.Z)("utrecht-figure__caption",n),children:r}))}));jt.displayName="FigureCaption";var Nt=["className","children","invalid","type"];function St(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function At(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?St(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):St(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $t=(0,a.forwardRef)((function(e,t){var n=e.className,r=e.children,o=e.invalid,a=e.type,u=(0,i.Z)(e,Nt);return(0,s.jsx)("div",At(At({},u),{},{ref:t,className:(0,l.Z)("utrecht-form-field",{"utrecht-form-field--invalid":o,"utrecht-form-field--checkbox":"checkbox"===a,"utrecht-form-field--radio":"radio"===a,"utrecht-form-field--text":!a||"text"===a},n),children:r}))}));$t.displayName="FormField";var Ct=["invalid","valid","warning","className","children"];function Mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mt(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ft=(0,a.forwardRef)((function(e,t){var n=e.invalid,r=e.valid,o=e.warning,a=e.className,u=e.children,c=(0,i.Z)(e,Ct);return(0,s.jsx)("div",Pt(Pt({},c),{},{ref:t,className:(0,l.Z)("utrecht-form-field-description",n&&"utrecht-form-field-description--invalid",r&&"utrecht-form-field-description--valid",o&&"utrecht-form-field-description--warning",a),children:u}))}));Ft.displayName="FormFieldDescription";var Tt=["children","className","type","disabled","checked"];function zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zt(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Lt=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.type,a=e.disabled,u=e.checked,c=(0,i.Z)(e,Tt);return(0,s.jsx)("label",Rt(Rt({},c),{},{ref:t,className:(0,l.Z)("utrecht-form-label",o&&"utrecht-form-label--".concat(o),a&&"utrecht-form-label--disabled",u&&"utrecht-form-label--checked",r),children:n}))}));Lt.displayName="FormLabel";var Bt=["checked","disabled","invalid","id","hidden","required","role","tabIndex","className"];function It(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?It(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):It(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var qt=(0,a.forwardRef)((function(e,t){var n=e.checked,r=e.disabled,o=e.invalid,a=e.id,u=e.hidden,c=e.required,f=e.role,d=e.tabIndex,h=e.className,p=(0,i.Z)(e,Bt);return(0,s.jsxs)("div",{className:(0,l.Z)("utrecht-form-toggle","utrecht-form-toggle--html-checkbox",{"utrecht-form-toggle--disabled":r,"utrecht-form-toggle--invalid":o,"utrecht-form-toggle--required":c},h),hidden:u,children:[(0,s.jsx)("input",Ut({id:a,"aria-invalid":o||void 0,type:"checkbox",className:"utrecht-form-toggle__checkbox",defaultChecked:n||void 0,disabled:r||void 0,required:c,ref:t,role:f,tabIndex:d},p)),(0,s.jsx)("label",{htmlFor:a,className:"utrecht-form-toggle__track",children:(0,s.jsx)("div",{className:"utrecht-form-toggle__thumb"})})]})}));qt.displayName="FormToggle";var Wt=["children","className"];function Zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ht(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zt(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Gt=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Wt);return(0,s.jsx)("div",Ht(Ht({},o),{},{ref:t,className:(0,l.Z)("utrecht-html",r),children:n}))}));Gt.displayName="HTMLContent";var Vt=["children","className"];function Yt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yt(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Jt=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Vt);return(0,s.jsx)("h1",Xt(Xt({},o),{},{ref:t,className:(0,l.Z)("utrecht-heading-1",r),children:n}))}));Jt.displayName="Heading1";var Qt=["children","className"];function Kt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function en(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kt(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var tn=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Qt);return(0,s.jsx)("h2",en(en({},o),{},{ref:t,className:(0,l.Z)("utrecht-heading-2",r),children:n}))}));tn.displayName="Heading2";var nn=["children","className"];function rn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function on(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rn(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var an=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,nn);return(0,s.jsx)("h3",on(on({},o),{},{ref:t,className:(0,l.Z)("utrecht-heading-3",r),children:n}))}));an.displayName="Heading3";var sn=["children","className"];function ln(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function un(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ln(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ln(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var cn=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,sn);return(0,s.jsx)("h4",un(un({},o),{},{ref:t,className:(0,l.Z)("utrecht-heading-4",r),children:n}))}));cn.displayName="Heading4";var fn=["children","className"];function dn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dn(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var pn=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,fn);return(0,s.jsx)("h5",hn(hn({},o),{},{ref:t,className:(0,l.Z)("utrecht-heading-5",r),children:n}))}));pn.displayName="Heading5";var mn=["children","className"];function gn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gn(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var vn=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,mn);return(0,s.jsx)("h6",yn(yn({},o),{},{ref:t,className:(0,l.Z)("utrecht-heading-6",r),children:n}))}));vn.displayName="Heading6";var bn=["children","className"];function xn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xn(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var kn=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,bn);return(0,s.jsx)("hgroup",wn(wn({},o),{},{ref:t,className:(0,l.Z)("utrecht-heading-group",r),children:n}))}));kn.displayName="HeadingGroup";var _n=["children","value","className"];function On(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function En(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?On(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):On(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Dn=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.value,o=e.className,a=(0,i.Z)(e,_n),u=r.replace(/[\s+\W]+/g,"").toUpperCase(),c=u.replace(/(.{4})(?!$)/g,"$1 ");return console.log({value:r,normalized:u,formatted:c}),(0,s.jsx)("data",En(En({},a),{},{ref:t,value:u,className:(0,l.Z)("utrecht-iban-data",o),translate:"no",children:n||c}))}));Dn.displayName="IBANData";var jn=["children","className"];function Nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Sn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nn(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var An=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,jn);return(0,s.jsx)("span",Sn(Sn({"aria-hidden":"true",ref:t,className:(0,l.Z)("utrecht-icon",r)},o),{},{children:n}))}));An.displayName="Icon";var $n=["className","photo"];function Cn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Mn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cn(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Pn=(0,a.forwardRef)((function(e,t){var n=e.className,r=e.photo,o=(0,i.Z)(e,$n);return(0,s.jsx)("img",Mn(Mn({},o),{},{ref:t,className:(0,l.Z)("utrecht-img",{"utrecht-img--photo":r},n)}))}));Pn.displayName="Image";var Fn=["children","disabled","inline","className","pressed","type"];function Tn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tn(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Rn=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.disabled,o=e.inline,a=e.className,u=e.pressed,c=e.type,f=(0,i.Z)(e,Fn);return(0,s.jsx)("button",zn(zn({ref:t,"aria-pressed":"boolean"==typeof u?u:void 0,className:(0,l.Z)("utrecht-link-button","utrecht-link-button--html-button",{"utrecht-link-button--disabled":r,"utrecht-link-button--inline":o,"utrecht-link-button--pressed":u},a),disabled:r,type:c||"button"},f),{},{children:n}))}));Rn.displayName="LinkButton";var Ln=["children","className","external"];function Bn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function In(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bn(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Un=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.external,a=(0,i.Z)(e,Ln);return(0,s.jsx)("a",In(In({},a),{},{ref:t,className:(0,l.Z)("utrecht-link-social",r),rel:!1!==o?"external noopener noreferrer":void 0,children:n}))}));Un.displayName="LinkSocial";var qn=["children","className"];function Wn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wn(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Hn=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,qn);return(0,s.jsx)("mark",Zn(Zn({ref:t,className:(0,l.Z)("utrecht-mark",r)},o),{},{children:n}))}));Hn.displayName="Mark";var Gn=["children","className","value"];function Vn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vn(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Xn=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.value,a=(0,i.Z)(e,Gn);return(0,s.jsx)("data",Yn(Yn({value:"string"==typeof o||"number"==typeof o?String(o):void 0},a),{},{ref:t,className:(0,l.Z)("utrecht-value-number",r),children:n}))}));Xn.displayName="NumberValue";var Jn=["children","className"];function Qn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qn(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var er=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Jn);return(0,s.jsx)("ol",Kn(Kn({},o),{},{ref:t,className:(0,l.Z)("utrecht-ordered-list",r),children:n}))}));er.displayName="OrderedList";var tr=["children","className"];function nr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nr(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ir=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,tr);return(0,s.jsx)("li",rr(rr({},o),{},{ref:t,className:(0,l.Z)("utrecht-ordered-list__item",r),children:n}))}));ir.displayName="OrderedListItem";var or=["children","className"];function ar(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function sr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ar(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ar(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var lr=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,or);return(0,s.jsx)("div",sr(sr({},o),{},{ref:t,className:(0,l.Z)("utrecht-page",r),children:n}))}));lr.displayName="Page";var ur=["children","className"],cr=["children","className"];function fr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fr(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var hr=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,ur);return(0,s.jsx)("div",dr(dr({},o),{},{ref:t,className:(0,l.Z)("utrecht-page-content",r),children:n}))}));hr.displayName="PageContent";var pr=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,cr);return(0,s.jsx)("main",dr(dr({},o),{},{ref:t,className:(0,l.Z)("utrecht-page-content__main",r),children:n}))}));pr.displayName="PageContentMain";var mr=["children","className"];function gr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gr(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var vr=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,mr);return(0,s.jsx)("footer",yr(yr({},o),{},{ref:t,className:(0,l.Z)("utrecht-page-footer",r),children:n}))}));vr.displayName="PageFooter";var br=["children","className"];function xr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xr(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var kr=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,br);return(0,s.jsx)("header",wr(wr({},o),{},{ref:t,className:(0,l.Z)("utrecht-page-header",r),children:n}))}));kr.displayName="PageHeader";var _r=["children","className","lead","small"];function Or(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Er(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Or(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Or(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Dr=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.lead,a=e.small,u=(0,i.Z)(e,_r);return(0,s.jsx)("p",Er(Er({},u),{},{ref:t,className:(0,l.Z)("utrecht-paragraph",o&&"utrecht-paragraph--lead",a&&"utrecht-paragraph--small",r),children:o?(0,s.jsx)("b",{className:"utrecht-paragraph__b",children:n}):a?(0,s.jsx)("small",{className:"utrecht-paragraph__small",children:n}):n}))}));Dr.displayName="Paragraph";var jr=["loading","className"];function Nr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Sr=(0,a.forwardRef)((function(e,t){var n=e.loading,r=e.className,a=(0,i.Z)(e,jr);return(0,s.jsx)("span",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nr(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({ref:t,className:(0,l.Z)("utrecht-data-placeholder",{"utrecht-data-placeholder--loading":n},r)},a))}));Sr.displayName="DataPlaceholder";var Ar=["children","className"];function $r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Cr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$r(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Mr=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Ar);return(0,s.jsx)("p",Cr(Cr({},o),{},{ref:t,className:(0,l.Z)("utrecht-pre-heading",r),children:n}))}));Mr.displayName="PreHeading";var Pr=["disabled","required","className","invalid"];function Fr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Tr=(0,a.forwardRef)((function(e,t){var n=e.disabled,r=e.required,a=e.className,u=e.invalid,c=(0,i.Z)(e,Pr);return(0,s.jsx)("input",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fr(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({type:"radio","aria-invalid":u||void 0,disabled:n,required:r,ref:t,className:(0,l.Z)("utrecht-radio-button","utrecht-radio-button--html-input",n&&"utrecht-radio-button--disabled",u&&"utrecht-radio-button--invalid",a)},c))}));Tr.displayName="RadioButton";var zr=["busy","invalid","required","className","noscript","children"],Rr=["disabled","invalid","value","children","className"];function Lr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Br(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lr(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ir=(0,a.forwardRef)((function(e,t){var n=e.busy,r=e.invalid,o=e.required,a=e.className,u=e.noscript,c=e.children,f=(0,i.Z)(e,zr);return(0,s.jsx)("select",Br(Br({"aria-busy":n||void 0,"aria-invalid":r||void 0,required:!!u&&o,"aria-required":u?void 0:o,className:(0,l.Z)("utrecht-select","utrecht-select--html-select",n&&"utrecht-select--busy",r&&"utrecht-select--invalid",o&&"utrecht-select--required",a),ref:t},f),{},{children:c}))}));Ir.displayName="Select";var Ur=(0,a.forwardRef)((function(e,t){var n=e.disabled,r=e.invalid,o=e.value,a=e.children,u=e.className,c=(0,i.Z)(e,Rr);return(0,s.jsx)("option",Br(Br({},c),{},{ref:t,disabled:n,value:o,className:(0,l.Z)("utrecht-select__option",n&&"utrecht-select__option--disabled",r&&"utrecht-select__option--invalid",u),children:a}))}));Ur.displayName="SelectOption";var qr=["className","children"];function Wr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wr(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Hr=(0,a.forwardRef)((function(e,t){var n=e.className;e.children;var r=(0,i.Z)(e,qr);return(0,s.jsx)("hr",Zr(Zr({},r),{},{ref:t,className:(0,l.Z)("utrecht-separator",n)}))}));Hr.displayName="Separator";var Gr=["children","className"];function Vr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vr(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Xr=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Gr);return(0,s.jsx)("p",{children:(0,s.jsx)("a",Yr(Yr({ref:t},o),{},{className:(0,l.Z)("utrecht-skip-link","utrecht-skip-link--visible-on-focus",r),children:n}))})}));Xr.displayName="SkipLink";var Jr=["aside","children","className","type"];function Qr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qr(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ei=(0,a.forwardRef)((function(e,t){var n=e.aside,r=e.children,o=e.className,a=e.type,u=Kr(Kr({},(0,i.Z)(e,Jr)),{},{ref:t,className:(0,l.Z)("utrecht-spotlight-section",{"utrecht-spotlight-section--info":"info"===a,"utrecht-spotlight-section--warning":"warning"===a},o)});return n?(0,s.jsx)("aside",Kr(Kr({},u),{},{children:r})):(0,s.jsx)("section",Kr(Kr({},u),{},{children:r}))}));ei.displayName="SpotlightSection";var ti=["className","status"];function ni(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ri(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ni(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ni(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ii=(0,a.forwardRef)((function(e,t){var n=e.className,r=e.status,o=(0,i.Z)(e,ti);return(0,s.jsx)("span",ri(ri({className:(0,l.Z)("utrecht-badge-status","utrecht-badge-status--".concat(r||"neutral"),n)},o),{},{ref:t}))}));ii.displayName="StatusBadge";var oi=["children","className"];function ai(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function si(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ai(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ai(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var li=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,oi);return(0,s.jsx)("strong",si(si({ref:t,className:(0,l.Z)("utrecht-emphasis","utrecht-emphasis--strong",r)},o),{},{children:n}))}));li.displayName="Strong";var ui=["children","className"];function ci(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ci(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ci(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var di=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,ui);return(0,s.jsx)("div",fi(fi({},o),{},{ref:t,className:(0,l.Z)("utrecht-surface",r),children:n}))}));di.displayName="Surface";var hi=["busy","children","className"];function pi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pi(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var gi=(0,a.forwardRef)((function(e,t){var n=e.busy,r=e.children,o=e.className,a=(0,i.Z)(e,hi);return(0,s.jsx)("table",mi(mi({"aria-busy":n},a),{},{ref:t,className:(0,l.Z)("utrecht-table",{"utrecht-table--busy":n},o),children:r}))}));gi.displayName="Table";var yi=["children","className"];function vi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vi(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var xi=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,yi);return(0,s.jsx)("tbody",bi(bi({},o),{},{ref:t,className:(0,l.Z)("utrecht-table__body",r),children:n}))}));xi.displayName="TableBody";var wi=["children","className"];function ki(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ki(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ki(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Oi=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,wi);return(0,s.jsx)("caption",_i(_i({},o),{},{ref:t,className:(0,l.Z)("utrecht-table__caption",r),children:n}))}));Oi.displayName="TableCaption";var Ei=["children","className","numericColumn","selected"];function Di(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ji(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Di(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Di(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ni=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.numericColumn,a=e.selected,u=(0,i.Z)(e,Ei);return(0,s.jsx)("td",ji(ji({"aria-selected":!!a||void 0},u),{},{ref:t,className:(0,l.Z)("utrecht-table__cell",{"utrecht-table__cell--selected":a,"utrecht-table__cell--numeric-column":o},r),children:n}))}));Ni.displayName="TableCell";var Si=["children","className","sticky"];function Ai(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ai(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ai(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ci=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.sticky,a=(0,i.Z)(e,Si);return(0,s.jsx)("tfoot",$i($i({},a),{},{ref:t,className:(0,l.Z)("utrecht-table__footer",{"utrecht-table__footer--sticky":o},r),children:n}))}));Ci.displayName="TableFooter";var Mi=["children","className","sticky"];function Pi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pi(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ti=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.sticky,a=(0,i.Z)(e,Mi);return(0,s.jsx)("thead",Fi(Fi({},a),{},{ref:t,className:(0,l.Z)("utrecht-table__header",{"utrecht-table__header--sticky":o},r),children:n}))}));Ti.displayName="TableHeader";var zi=["children","className","numericColumn","selected","sticky","scope"];function Ri(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Li(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ri(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ri(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Bi=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.numericColumn,a=e.selected,u=e.sticky,c=e.scope,f=(0,i.Z)(e,zi);return(0,s.jsx)("th",Li(Li({"aria-selected":!!a||void 0,scope:c},f),{},{ref:t,className:(0,l.Z)("utrecht-table__header-cell",{"utrecht-table__header-cell--numeric-column":o,"utrecht-table__header-cell--selected":a,"utrecht-table__header-cell--sticky-inline":u&&"row"===c,"utrecht-table__header-cell--sticky-block":u&&"col"===c},r),children:n}))}));Bi.displayName="TableHeaderCell";var Ii=["children","className","selected"];function Ui(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ui(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ui(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Wi=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.selected,a=(0,i.Z)(e,Ii);return(0,s.jsx)("tr",qi(qi({"aria-selected":!!o||void 0},a),{},{ref:t,className:(0,l.Z)("utrecht-table__row",{"utrecht-table__row--selected":o},r),children:n}))}));Wi.displayName="TableRow";var Zi=["dir","disabled","invalid","readOnly","required","className"];function Hi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Gi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hi(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Vi=(0,a.forwardRef)((function(e,t){var n=e.dir,r=e.disabled,o=e.invalid,a=e.readOnly,u=e.required,c=e.className,f=(0,i.Z)(e,Zi);return(0,s.jsx)("textarea",Gi(Gi({},f),{},{ref:t,className:(0,l.Z)("utrecht-textarea","utrecht-textarea--html-textarea",r&&"utrecht-textarea--disabled",o&&"utrecht-textarea--invalid",a&&"utrecht-textarea--readonly",u&&"utrecht-textarea--required",c),dir:null!=n?n:"auto",disabled:r,readOnly:a,required:u,"aria-invalid":o||void 0}))}));Vi.displayName="Textarea";var Yi=["dir","disabled","invalid","readOnly","required","className","type","maxLength","inputMode"];function Xi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ji(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xi(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Qi=(0,a.forwardRef)((function(e,t){var n=e.dir,r=e.disabled,o=e.invalid,a=e.readOnly,u=e.required,c=e.className,f=e.type,d=void 0===f?"text":f,h=e.maxLength,p=e.inputMode,m=(0,i.Z)(e,Yi);return(0,s.jsx)("input",Ji(Ji({},m),{},{ref:t,type:d,className:(0,l.Z)("utrecht-textbox","utrecht-textbox--html-input",r&&"utrecht-textbox--disabled",o&&"utrecht-textbox--invalid",a&&"utrecht-textbox--readonly",u&&"utrecht-textbox--required",c),maxLength:h,dir:null!=n?n:"auto",disabled:r,readOnly:a,required:u,"aria-invalid":o||void 0,inputMode:p||("number"===d?"numeric":void 0)}))}));Qi.displayName="Textbox";var Ki=["children","className"];function eo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function to(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eo(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var no=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Ki);return(0,s.jsx)("bdi",to(to({translate:"no"},o),{},{ref:t,className:(0,l.Z)("utrecht-url",r),children:n}))}));no.displayName="URLValue";var ro=["children","className"];function io(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?io(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):io(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ao=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,ro);return(0,s.jsx)("ul",oo(oo({role:"list"},o),{},{ref:t,className:(0,l.Z)("utrecht-unordered-list",r),children:n}))}));ao.displayName="UnorderedList";var so=["children","className"];function lo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function uo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lo(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var co=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,so);return(0,s.jsx)("li",uo(uo({},o),{},{ref:t,className:(0,l.Z)("utrecht-unordered-list__item",r),children:n}))}));function fo(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}co.displayName="UnorderedListItem";var ho={exports:{}};var po,mo,go,yo;function vo(){if(mo)return po;mo=1;return po="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}ho.exports=function(){if(yo)return go;yo=1;var e=vo();function t(){}function n(){}return n.resetWarningCache=t,go=function(){function r(t,n,r,i,o,a){if(a!==e){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function i(){return r}r.isRequired=r;var o={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:i,element:r,elementType:r,instanceOf:i,node:r,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:n,resetWarningCache:t};return o.PropTypes=o,o}}()();var bo=fo(ho.exports);const xo={};function wo(e,t){void 0===e&&(e=xo),void 0===t&&(t=xo);const n=Object.keys(e),r=Object.keys(t);return e===t||n.length===r.length&&n.every((n=>e[n]===t[n]))}var ko,_o=(ko=function(e,t){return ko=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},ko(e,t)},function(e,t){function n(){this.constructor=e}ko(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),Oo=Object.prototype.hasOwnProperty;function Eo(e,t){return Oo.call(e,t)}function Do(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var i in e)Eo(e,i)&&r.push(i);return r}function jo(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function No(e){for(var t,n=0,r=e.length;n<r;){if(!((t=e.charCodeAt(n))>=48&&t<=57))return!1;n++}return!0}function So(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function Ao(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function $o(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if($o(e[t]))return!0}else if("object"==typeof e)for(var r=Do(e),i=r.length,o=0;o<i;o++)if($o(e[r[o]]))return!0;return!1}function Co(e,t){var n=[e];for(var r in t){var i="object"==typeof t[r]?JSON.stringify(t[r],null,2):t[r];void 0!==i&&n.push(r+": "+i)}return n.join("\n")}var Mo=function(e){function t(t,n,r,i,o){var a=this.constructor,s=e.call(this,Co(t,{name:n,index:r,operation:i,tree:o}))||this;return s.name=n,s.index=r,s.operation=i,s.tree=o,Object.setPrototypeOf(s,a.prototype),s.message=Co(t,{name:n,index:r,operation:i,tree:o}),s}return _o(t,e),t}(Error),Po=Mo,Fo=jo,To={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=Ro(n,this.path);r&&(r=jo(r));var i=Lo(n,{op:"remove",path:this.from}).removed;return Lo(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=Ro(n,this.from);return Lo(n,{op:"add",path:this.path,value:jo(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:qo(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},zo={add:function(e,t,n){return No(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){return{newDocument:n,removed:e.splice(t,1)[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:To.move,copy:To.copy,test:To.test,_get:To._get};function Ro(e,t){if(""==t)return e;var n={op:"_get",path:t};return Lo(e,n),n.value}function Lo(e,t,n,r,i,o){if(void 0===n&&(n=!1),void 0===r&&(r=!0),void 0===i&&(i=!0),void 0===o&&(o=0),n&&("function"==typeof n?n(t,0,e,t.path):Io(t,0)),""===t.path){var a={newDocument:e};if("add"===t.op)return a.newDocument=t.value,a;if("replace"===t.op)return a.newDocument=t.value,a.removed=e,a;if("move"===t.op||"copy"===t.op)return a.newDocument=Ro(e,t.from),"move"===t.op&&(a.removed=e),a;if("test"===t.op){if(a.test=qo(e,t.value),!1===a.test)throw new Po("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a.newDocument=e,a}if("remove"===t.op)return a.removed=e,a.newDocument=null,a;if("_get"===t.op)return t.value=e,a;if(n)throw new Po("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,t,e);return a}r||(e=jo(e));var s=(t.path||"").split("/"),l=e,u=1,c=s.length,f=void 0,d=void 0,h=void 0;for(h="function"==typeof n?n:Io;;){if((d=s[u])&&-1!=d.indexOf("~")&&(d=Ao(d)),i&&("__proto__"==d||"prototype"==d&&u>0&&"constructor"==s[u-1]))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===f&&(void 0===l[d]?f=s.slice(0,u).join("/"):u==c-1&&(f=t.path),void 0!==f&&h(t,0,e,f)),u++,Array.isArray(l)){if("-"===d)d=l.length;else{if(n&&!No(d))throw new Po("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,t,e);No(d)&&(d=~~d)}if(u>=c){if(n&&"add"===t.op&&d>l.length)throw new Po("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,t,e);if(!1===(a=zo[t.op].call(t,l,d,e)).test)throw new Po("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a}}else if(u>=c){if(!1===(a=To[t.op].call(t,l,d,e)).test)throw new Po("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a}if(l=l[d],n&&u<c&&(!l||"object"!=typeof l))throw new Po("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,t,e)}}function Bo(e,t,n,r,i){if(void 0===r&&(r=!0),void 0===i&&(i=!0),n&&!Array.isArray(t))throw new Po("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=jo(e));for(var o=new Array(t.length),a=0,s=t.length;a<s;a++)o[a]=Lo(e,t[a],n,!0,i,a),e=o[a].newDocument;return o.newDocument=e,o}function Io(e,t,n,r){if("object"!=typeof e||null===e||Array.isArray(e))throw new Po("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(!To[e.op])throw new Po("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n);if("string"!=typeof e.path)throw new Po("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new Po('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new Po("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new Po("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&$o(e.value))throw new Po("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n)if("add"==e.op){var i=e.path.split("/").length,o=r.split("/").length;if(i!==o+1&&i!==o)throw new Po("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==r)throw new Po("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if("move"===e.op||"copy"===e.op){var a=Uo([{op:"_get",path:e.from,value:void 0}],n);if(a&&"OPERATION_PATH_UNRESOLVABLE"===a.name)throw new Po("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}function Uo(e,t,n){try{if(!Array.isArray(e))throw new Po("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)Bo(jo(t),jo(e),n||!0);else{n=n||Io;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(S9){if(S9 instanceof Po)return S9;throw S9}}function qo(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var n,r,i,o=Array.isArray(e),a=Array.isArray(t);if(o&&a){if((r=e.length)!=t.length)return!1;for(n=r;0!=n--;)if(!qo(e[n],t[n]))return!1;return!0}if(o!=a)return!1;var s=Object.keys(e);if((r=s.length)!==Object.keys(t).length)return!1;for(n=r;0!=n--;)if(!t.hasOwnProperty(s[n]))return!1;for(n=r;0!=n--;)if(!qo(e[i=s[n]],t[i]))return!1;return!0}return e!=e&&t!=t}var Wo=Object.freeze({__proto__:null,JsonPatchError:Po,_areEquals:qo,applyOperation:Lo,applyPatch:Bo,applyReducer:function(e,t,n){var r=Lo(e,t);if(!1===r.test)throw new Po("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument},deepClone:Fo,getValueByPointer:Ro,validate:Uo,validator:Io}),Zo=new WeakMap,Ho=function(e){this.observers=new Map,this.obj=e},Go=function(e,t){this.callback=e,this.observer=t};function Vo(e,t){void 0===t&&(t=!1);var n=Zo.get(e.object);Yo(n.value,e.object,e.patches,"",t),e.patches.length&&Bo(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function Yo(e,t,n,r,i){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var o=Do(t),a=Do(e),s=!1,l=a.length-1;l>=0;l--){var u=e[f=a[l]];if(!Eo(t,f)||void 0===t[f]&&void 0!==u&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(i&&n.push({op:"test",path:r+"/"+So(f),value:jo(u)}),n.push({op:"remove",path:r+"/"+So(f)}),s=!0):(i&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}));else{var c=t[f];"object"==typeof u&&null!=u&&"object"==typeof c&&null!=c&&Array.isArray(u)===Array.isArray(c)?Yo(u,c,n,r+"/"+So(f),i):u!==c&&(i&&n.push({op:"test",path:r+"/"+So(f),value:jo(u)}),n.push({op:"replace",path:r+"/"+So(f),value:jo(c)}))}}if(s||o.length!=a.length)for(l=0;l<o.length;l++){var f;Eo(e,f=o[l])||void 0===t[f]||n.push({op:"add",path:r+"/"+So(f),value:jo(t[f])})}}}var Xo=Object.freeze({__proto__:null,compare:function(e,t,n){void 0===n&&(n=!1);var r=[];return Yo(e,t,r,"",n),r},generate:Vo,observe:function(e,t){var n,r=function(e){return Zo.get(e)}(e);if(r){var i=function(e,t){return e.observers.get(t)}(r,t);n=i&&i.observer}else r=new Ho(e),Zo.set(e,r);if(n)return n;if(n={},r.value=jo(e),t){n.callback=t,n.next=null;var o=function(){Vo(n)},a=function(){clearTimeout(n.next),n.next=setTimeout(o)};"undefined"!=typeof window&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return n.patches=[],n.object=e,n.unobserve=function(){Vo(n),clearTimeout(n.next),function(e,t){e.observers.delete(t.callback)}(r,n),"undefined"!=typeof window&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},r.observers.set(t,new Go(t,n)),n},unobserve:function(e,t){t.unobserve()}});Object.assign({},Wo,Xo,{JsonPatchError:Mo,deepClone:jo,escapePathComponent:So,unescapePathComponent:Ao});var Jo=/("(?:[^\\"]|\\.)*")|[:,]/g,Qo=function(e,t){var n,r,i;return t=t||{},n=JSON.stringify([1],void 0,void 0===t.indent?2:t.indent).slice(2,-3),r=""===n?1/0:void 0===t.maxLength?80:t.maxLength,i=t.replacer,function e(t,o,a){var s,l,u,c,f,d,h,p,m,g,y,v;if(t&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0===(y=JSON.stringify(t,i)))return y;if(h=r-o.length-a,y.length<=h&&(m=y.replace(Jo,(function(e,t){return t||e+" "})),m.length<=h))return m;if(null!=i&&(t=JSON.parse(y),i=void 0),"object"==typeof t&&null!==t){if(p=o+n,u=[],l=0,Array.isArray(t))for(g="[",s="]",h=t.length;l<h;l++)u.push(e(t[l],p,l===h-1?0:1)||"null");else for(g="{",s="}",h=(d=Object.keys(t)).length;l<h;l++)c=d[l],f=JSON.stringify(c)+": ",void 0!==(v=e(t[c],p,f.length+(l===h-1?0:1)))&&u.push(f+v);if(u.length>0)return[g,n+u.join(",\n"+p),s].join("\n"+o)}return y}(e,"",0)},Ko=fo(Qo);function ea(e,t,n){return e.fields=t||[],e.fname=n,e}function ta(e){return null==e?null:e.fname}function na(e){return null==e?null:e.fields}function ra(e){return 1===e.length?ia(e[0]):oa(e)}const ia=e=>function(t){return t[e]},oa=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function aa(e){throw Error(e)}function sa(e){const t=[],n=e.length;let r,i,o,a=null,s=0,l="";function u(){t.push(l+e.substring(r,i)),l="",r=i+1}for(e+="",r=i=0;i<n;++i)if(o=e[i],"\\"===o)l+=e.substring(r,i++),r=i;else if(o===a)u(),a=null,s=-1;else{if(a)continue;r===s&&'"'===o||r===s&&"'"===o?(r=i+1,a=o):"."!==o||s?"["===o?(i>r&&u(),s=r=i+1):"]"===o&&(s||aa("Access path missing open bracket: "+e),s>0&&u(),s=0,r=i+1):i>r?u():r=i+1}return s&&aa("Access path missing closing bracket: "+e),a&&aa("Access path missing closing quote: "+e),i>r&&(i++,u()),t}function la(e,t,n){const r=sa(e);return e=1===r.length?r[0]:e,ea((n&&n.get||ra)(r),[e],t||e)}const ua=la("id"),ca=ea((e=>e),[],"identity"),fa=ea((()=>0),[],"zero"),da=ea((()=>1),[],"one"),ha=ea((()=>!0),[],"true"),pa=ea((()=>!1),[],"false");function ma(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const ga=0,ya=1,va=2,ba=3,xa=4;function wa(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ma,r=e||ga;return{level(e){return arguments.length?(r=+e,this):r},error(){return r>=ya&&n(t||"error","ERROR",arguments),this},warn(){return r>=va&&n(t||"warn","WARN",arguments),this},info(){return r>=ba&&n(t||"log","INFO",arguments),this},debug(){return r>=xa&&n(t||"log","DEBUG",arguments),this}}}var ka=Array.isArray;function _a(e){return e===Object(e)}const Oa=e=>"__proto__"!==e;function Ea(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(((e,t)=>{for(const n in t)if("signals"===n)e.signals=ja(e.signals,t.signals);else{const r="legend"===n?{layout:1}:"style"===n||null;Da(e,n,t[n],r)}return e}),{})}function Da(e,t,n,r){if(!Oa(t))return;let i,o;if(_a(n)&&!ka(n))for(i in o=_a(e[t])?e[t]:e[t]={},n)r&&(!0===r||r[i])?Da(o,i,n[i]):Oa(i)&&(o[i]=n[i]);else e[t]=n}function ja(e,t){if(null==e)return t;const n={},r=[];function i(e){n[e.name]||(n[e.name]=1,r.push(e))}return t.forEach(i),e.forEach(i),r}function Na(e){return e[e.length-1]}function Sa(e){return null==e||""===e?null:+e}const Aa=e=>t=>e*Math.exp(t),$a=e=>t=>Math.log(e*t),Ca=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),Ma=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,Pa=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function Fa(e,t,n,r){const i=n(e[0]),o=n(Na(e)),a=(o-i)*t;return[r(i-a),r(o-a)]}function Ta(e,t){return Fa(e,t,Sa,ca)}function za(e,t){var n=Math.sign(e[0]);return Fa(e,t,$a(n),Aa(n))}function Ra(e,t,n){return Fa(e,t,Pa(n),Pa(1/n))}function La(e,t,n){return Fa(e,t,Ca(n),Ma(n))}function Ba(e,t,n,r,i){const o=r(e[0]),a=r(Na(e)),s=null!=t?r(t):(o+a)/2;return[i(s+(o-s)*n),i(s+(a-s)*n)]}function Ia(e,t,n){return Ba(e,t,n,Sa,ca)}function Ua(e,t,n){const r=Math.sign(e[0]);return Ba(e,t,n,$a(r),Aa(r))}function qa(e,t,n,r){return Ba(e,t,n,Pa(r),Pa(1/r))}function Wa(e,t,n,r){return Ba(e,t,n,Ca(r),Ma(r))}function Za(e){return 1+~~(new Date(e).getMonth()/3)}function Ha(e){return 1+~~(new Date(e).getUTCMonth()/3)}function Ga(e){return null!=e?ka(e)?e:[e]:[]}function Va(e,t,n){let r,i=e[0],o=e[1];return o<i&&(r=o,o=i,i=r),r=o-i,r>=n-t?[t,n]:[i=Math.min(Math.max(i,t),n-r),i+r]}function Ya(e){return"function"==typeof e}const Xa="descending";function Ja(e,t,n){n=n||{},t=Ga(t)||[];const r=[],i=[],o={},a=n.comparator||Ka;return Ga(e).forEach(((e,a)=>{null!=e&&(r.push(t[a]===Xa?-1:1),i.push(e=Ya(e)?e:la(e,null,n)),(na(e)||[]).forEach((e=>o[e]=1)))})),0===i.length?null:ea(a(i,r),Object.keys(o))}const Qa=(e,t)=>(e<t||null==e)&&null!=t?-1:(e>t||null==t)&&null!=e?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t==t?-1:t!=t&&e==e?1:0),Ka=(e,t)=>1===e.length?es(e[0],t[0]):ts(e,t,e.length),es=(e,t)=>function(n,r){return Qa(e(n),e(r))*t},ts=(e,t,n)=>(t.push(0),function(r,i){let o,a=0,s=-1;for(;0===a&&++s<n;)o=e[s],a=Qa(o(r),o(i));return a*t[s]});function ns(e){return Ya(e)?e:()=>e}function rs(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout((()=>(t(r),n=null)),e)}}function is(e){for(let t,n,r=1,i=arguments.length;r<i;++r)for(n in t=arguments[r],t)e[n]=t[n];return e}function os(e,t){let n,r,i,o,a=0;if(e&&(n=e.length))if(null==t){for(r=e[a];a<n&&(null==r||r!=r);r=e[++a]);for(i=o=r;a<n;++a)r=e[a],null!=r&&(r<i&&(i=r),r>o&&(o=r))}else{for(r=t(e[a]);a<n&&(null==r||r!=r);r=t(e[++a]));for(i=o=r;a<n;++a)r=t(e[a]),null!=r&&(r<i&&(i=r),r>o&&(o=r))}return[i,o]}function as(e,t){const n=e.length;let r,i,o,a,s,l=-1;if(null==t){for(;++l<n;)if(i=e[l],null!=i&&i>=i){r=o=i;break}if(l===n)return[-1,-1];for(a=s=l;++l<n;)i=e[l],null!=i&&(r>i&&(r=i,a=l),o<i&&(o=i,s=l))}else{for(;++l<n;)if(i=t(e[l],l,e),null!=i&&i>=i){r=o=i;break}if(l===n)return[-1,-1];for(a=s=l;++l<n;)i=t(e[l],l,e),null!=i&&(r>i&&(r=i,a=l),o<i&&(o=i,s=l))}return[a,s]}const ss=Object.prototype.hasOwnProperty;function ls(e,t){return ss.call(e,t)}const us={};function cs(e){let t,n={};function r(e){return ls(n,e)&&n[e]!==us}const i={size:0,empty:0,object:n,has:r,get:e=>r(e)?n[e]:void 0,set(e,t){return r(e)||(++i.size,n[e]===us&&--i.empty),n[e]=t,this},delete(e){return r(e)&&(--i.size,++i.empty,n[e]=us),this},clear(){i.size=i.empty=0,i.object=n={}},test(e){return arguments.length?(t=e,i):t},clean(){const e={};let r=0;for(const i in n){const o=n[i];o===us||t&&t(o)||(e[i]=o,++r)}i.size=r,i.empty=0,i.object=n=e}};return e&&Object.keys(e).forEach((t=>{i.set(t,e[t])})),i}function fs(e,t,n,r,i,o){if(!n&&0!==n)return o;const a=+n;let s,l=e[0],u=Na(e);u<l&&(s=l,l=u,u=s),s=Math.abs(t-l);const c=Math.abs(u-t);return s<c&&s<=a?r:c<=a?i:o}function ds(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),is(r,n)}function hs(e,t,n,r){let i,o=t[0],a=t[t.length-1];return o>a&&(i=o,o=a,a=i),r=void 0===r||r,((n=void 0===n||n)?o<=e:o<e)&&(r?e<=a:e<a)}function ps(e){return"boolean"==typeof e}function ms(e){return"[object Date]"===Object.prototype.toString.call(e)}function gs(e){return e&&Ya(e[Symbol.iterator])}function ys(e){return"number"==typeof e}function vs(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function bs(e){return"string"==typeof e}function xs(e,t,n){e&&(e=t?Ga(e).map((e=>e.replace(/\\(.)/g,"$1"))):Ga(e));const r=e&&e.length,i=n&&n.get||ra,o=e=>i(t?[e]:sa(e));let a;if(r)if(1===r){const t=o(e[0]);a=function(e){return""+t(e)}}else{const t=e.map(o);a=function(e){let n=""+t[0](e),i=0;for(;++i<r;)n+="|"+t[i](e);return n}}else a=function(){return""};return ea(a,e,"key")}function ws(e,t){const n=e[0],r=Na(e),i=+t;return i?1===i?r:n+i*(r-n):n}function ks(e){let t,n,r;e=+e||1e4;const i=()=>{t={},n={},r=0},o=(i,o)=>(++r>e&&(n=t,t={},r=1),t[i]=o);return i(),{clear:i,has:e=>ls(t,e)||ls(n,e),get:e=>ls(t,e)?t[e]:ls(n,e)?o(e,n[e]):void 0,set:(e,n)=>ls(t,e)?t[e]=n:o(e,n)}}function _s(e,t,n,r){const i=t.length,o=n.length;if(!o)return t;if(!i)return n;const a=r||new t.constructor(i+o);let s=0,l=0,u=0;for(;s<i&&l<o;++u)a[u]=e(t[s],n[l])>0?n[l++]:t[s++];for(;s<i;++s,++u)a[u]=t[s];for(;l<o;++l,++u)a[u]=n[l];return a}function Os(e,t){let n="";for(;--t>=0;)n+=e;return n}function Es(e,t,n,r){const i=n||" ",o=e+"",a=t-o.length;return a<=0?o:"left"===r?Os(i,a)+o:"center"===r?Os(i,~~(a/2))+o+Os(i,Math.ceil(a/2)):o+Os(i,a)}function Ds(e){return e&&Na(e)-e[0]||0}function js(e){return ka(e)?"["+e.map(js)+"]":_a(e)||bs(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Ns(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e)&&!!e}const Ss=e=>ys(e)||ms(e)?e:Date.parse(e);function As(e,t){return t=t||Ss,null==e||""===e?null:t(e)}function $s(e){return null==e||""===e?null:e+""}function Cs(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function Ms(e,t,n,r){const i=null!=r?r:"\u2026",o=e+"",a=o.length,s=Math.max(0,t-i.length);return a<=t?o:"left"===n?i+o.slice(a-s):"center"===n?o.slice(0,Math.ceil(s/2))+i+o.slice(a-~~(s/2)):o.slice(0,s)+i}function Ps(e,t,n){if(e)if(t){const r=e.length;for(let i=0;i<r;++i){const r=t(e[i]);r&&n(r,i,e)}}else e.forEach(n)}var Fs={},Ts={},zs=34,Rs=10,Ls=13;function Bs(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function Is(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var r in e)r in t||n.push(t[r]=r)})),n}function Us(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function qs(e){var t,n=e.getUTCHours(),r=e.getUTCMinutes(),i=e.getUTCSeconds(),o=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":((t=e.getUTCFullYear())<0?"-"+Us(-t,6):t>9999?"+"+Us(t,6):Us(t,4))+"-"+Us(e.getUTCMonth()+1,2)+"-"+Us(e.getUTCDate(),2)+(o?"T"+Us(n,2)+":"+Us(r,2)+":"+Us(i,2)+"."+Us(o,3)+"Z":i?"T"+Us(n,2)+":"+Us(r,2)+":"+Us(i,2)+"Z":r||n?"T"+Us(n,2)+":"+Us(r,2)+"Z":"")}function Ws(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var r,i=[],o=e.length,a=0,s=0,l=o<=0,u=!1;function c(){if(l)return Ts;if(u)return u=!1,Fs;var t,r,i=a;if(e.charCodeAt(i)===zs){for(;a++<o&&e.charCodeAt(a)!==zs||e.charCodeAt(++a)===zs;);return(t=a)>=o?l=!0:(r=e.charCodeAt(a++))===Rs?u=!0:r===Ls&&(u=!0,e.charCodeAt(a)===Rs&&++a),e.slice(i+1,t-1).replace(/""/g,'"')}for(;a<o;){if((r=e.charCodeAt(t=a++))===Rs)u=!0;else if(r===Ls)u=!0,e.charCodeAt(a)===Rs&&++a;else if(r!==n)continue;return e.slice(i,t)}return l=!0,e.slice(i,o)}for(e.charCodeAt(o-1)===Rs&&--o,e.charCodeAt(o-1)===Ls&&--o;(r=c())!==Ts;){for(var f=[];r!==Fs&&r!==Ts;)f.push(r),r=c();t&&null==(f=t(f,s++))||i.push(f)}return i}function i(t,n){return t.map((function(t){return n.map((function(e){return a(t[e])})).join(e)}))}function o(t){return t.map(a).join(e)}function a(e){return null==e?"":e instanceof Date?qs(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,i,o=r(e,(function(e,r){if(n)return n(e,r-1);i=e,n=t?function(e,t){var n=Bs(e);return function(r,i){return t(n(r),i,e)}}(e,t):Bs(e)}));return o.columns=i||[],o},parseRows:r,format:function(t,n){return null==n&&(n=Is(t)),[n.map(a).join(e)].concat(i(t,n)).join("\n")},formatBody:function(e,t){return null==t&&(t=Is(e)),i(e,t).join("\n")},formatRows:function(e){return e.map(o).join("\n")},formatRow:o,formatValue:a}}function Zs(e){return e}function Hs(e,t){return"string"==typeof t&&(t=e.objects[t]),"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map((function(t){return Gs(e,t)}))}:Gs(e,t)}function Gs(e,t){var n=t.id,r=t.bbox,i=null==t.properties?{}:t.properties,o=Vs(e,t);return null==n&&null==r?{type:"Feature",properties:i,geometry:o}:null==r?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function Vs(e,t){var n=function(e){if(null==e)return Zs;var t,n,r=e.scale[0],i=e.scale[1],o=e.translate[0],a=e.translate[1];return function(e,s){s||(t=n=0);var l=2,u=e.length,c=new Array(u);for(c[0]=(t+=e[0])*r+o,c[1]=(n+=e[1])*i+a;l<u;)c[l]=e[l],++l;return c}}(e.transform),r=e.arcs;function i(e,t){t.length&&t.pop();for(var i=r[e<0?~e:e],o=0,a=i.length;o<a;++o)t.push(n(i[o],o));e<0&&function(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}(t,a)}function o(e){return n(e)}function a(e){for(var t=[],n=0,r=e.length;n<r;++n)i(e[n],t);return t.length<2&&t.push(t[0]),t}function s(e){for(var t=a(e);t.length<4;)t.push(t[0]);return t}function l(e){return e.map(s)}return function e(t){var n,r=t.type;switch(r){case"GeometryCollection":return{type:r,geometries:t.geometries.map(e)};case"Point":n=o(t.coordinates);break;case"MultiPoint":n=t.coordinates.map(o);break;case"LineString":n=a(t.arcs);break;case"MultiLineString":n=t.arcs.map(a);break;case"Polygon":n=l(t.arcs);break;case"MultiPolygon":n=t.arcs.map(l);break;default:return null}return{type:r,coordinates:n}}(t)}function Ys(e,t){var n={},r={},i={},o=[],a=-1;function s(e,t){for(var r in e){var i=e[r];delete t[i.start],delete i.start,delete i.end,i.forEach((function(e){n[e<0?~e:e]=1})),o.push(i)}}return t.forEach((function(n,r){var i,o=e.arcs[n<0?~n:n];o.length<3&&!o[1][0]&&!o[1][1]&&(i=t[++a],t[a]=n,t[r]=i)})),t.forEach((function(t){var n,o,a=function(t){var n,r=e.arcs[t<0?~t:t],i=r[0];e.transform?(n=[0,0],r.forEach((function(e){n[0]+=e[0],n[1]+=e[1]}))):n=r[r.length-1];return t<0?[n,i]:[i,n]}(t),s=a[0],l=a[1];if(n=i[s])if(delete i[n.end],n.push(t),n.end=l,o=r[l]){delete r[o.start];var u=o===n?n:n.concat(o);r[u.start=n.start]=i[u.end=o.end]=u}else r[n.start]=i[n.end]=n;else if(n=r[l])if(delete r[n.start],n.unshift(t),n.start=s,o=i[s]){delete i[o.end];var c=o===n?n:o.concat(n);r[c.start=o.start]=i[c.end=n.end]=c}else r[n.start]=i[n.end]=n;else r[(n=[t]).start=s]=i[n.end=l]=n})),s(i,r),s(r,i),t.forEach((function(e){n[e<0?~e:e]||o.push([e])})),o}function Xs(e){return Vs(e,Js.apply(this,arguments))}function Js(e,t,n){var r,i,o;if(arguments.length>1)r=function(e,t,n){var r,i=[],o=[];function a(e){var t=e<0?~e:e;(o[t]||(o[t]=[])).push({i:e,g:r})}function s(e){e.forEach(a)}function l(e){e.forEach(s)}function u(e){e.forEach(l)}function c(e){switch(r=e,e.type){case"GeometryCollection":e.geometries.forEach(c);break;case"LineString":s(e.arcs);break;case"MultiLineString":case"Polygon":l(e.arcs);break;case"MultiPolygon":u(e.arcs)}}return c(t),o.forEach(null==n?function(e){i.push(e[0].i)}:function(e){n(e[0].g,e[e.length-1].g)&&i.push(e[0].i)}),i}(0,t,n);else for(i=0,r=new Array(o=e.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:Ys(e,r)}}function Qs(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Ks(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function el(e){let t,n,r;function i(e,r,i,o){if(void 0===i&&(i=0),void 0===o&&(o=e.length),i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<0?i=t+1:o=t}while(i<o)}return i}return 2!==e.length?(t=Qs,n=(t,n)=>Qs(e(t),n),r=(t,n)=>e(t)-n):(t=e===Qs||e===Ks?e:tl,n=e,r=e),{left:i,center:function(e,t,n,o){void 0===n&&(n=0),void 0===o&&(o=e.length);const a=i(e,t,n,o-1);return a>n&&r(e[a-1],t)>-r(e[a],t)?a-1:a},right:function(e,r,i,o){if(void 0===i&&(i=0),void 0===o&&(o=e.length),i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<=0?i=t+1:o=t}while(i<o)}return i}}}function tl(){return 0}function nl(e){return null===e?NaN:+e}const rl=el(Qs),il=rl.right,ol=rl.left;el(nl).center;var al=il;class sl{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=t[r],o=e+i,a=Math.abs(e)<Math.abs(i)?e-(o-i):i-(o-e);a&&(t[n++]=a),e=o}return t[n]=e,this._n=n+1,this}valueOf(){const e=this._partials;let t,n,r,i=this._n,o=0;if(i>0){for(o=e[--i];i>0&&(t=o,n=e[--i],o=t+n,r=n-(o-t),!r););i>0&&(r<0&&e[i-1]<0||r>0&&e[i-1]>0)&&(n=2*r,t=o+n,n==t-o&&(o=t))}return o}}class ll extends Map{constructor(e,t){if(void 0===t&&(t=hl),super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[n,r]of e)this.set(n,r)}get(e){return super.get(cl(this,e))}has(e){return super.has(cl(this,e))}set(e,t){return super.set(fl(this,e),t)}delete(e){return super.delete(dl(this,e))}}class ul extends Set{constructor(e,t){if(void 0===t&&(t=hl),super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const n of e)this.add(n)}has(e){return super.has(cl(this,e))}add(e){return super.add(fl(this,e))}delete(e){return super.delete(dl(this,e))}}function cl(e,t){let{_intern:n,_key:r}=e;const i=r(t);return n.has(i)?n.get(i):t}function fl(e,t){let{_intern:n,_key:r}=e;const i=r(t);return n.has(i)?n.get(i):(n.set(i,t),t)}function dl(e,t){let{_intern:n,_key:r}=e;const i=r(t);return n.has(i)&&(t=n.get(i),n.delete(i)),t}function hl(e){return null!==e&&"object"==typeof e?e.valueOf():e}function pl(e,t){return(null==e||!(e>=e))-(null==t||!(t>=t))||(e<t?-1:e>t?1:0)}const ml=Math.sqrt(50),gl=Math.sqrt(10),yl=Math.sqrt(2);function vl(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=ml?10:o>=gl?5:o>=yl?2:1;let s,l,u;return i<0?(u=Math.pow(10,-i)/a,s=Math.round(e*u),l=Math.round(t*u),s/u<e&&++s,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*a,s=Math.round(e/u),l=Math.round(t/u),s*u<e&&++s,l*u>t&&--l),l<s&&.5<=n&&n<2?vl(e,t,2*n):[s,l,u]}function bl(e,t,n){if(!((n=+n)>0))return[];if((e=+e)===(t=+t))return[e];const r=t<e,[i,o,a]=r?vl(t,e,n):vl(e,t,n);if(!(o>=i))return[];const s=o-i+1,l=new Array(s);if(r)if(a<0)for(let u=0;u<s;++u)l[u]=(o-u)/-a;else for(let u=0;u<s;++u)l[u]=(o-u)*a;else if(a<0)for(let u=0;u<s;++u)l[u]=(i+u)/-a;else for(let u=0;u<s;++u)l[u]=(i+u)*a;return l}function xl(e,t,n){return vl(e=+e,t=+t,n=+n)[2]}function wl(e,t,n){n=+n;const r=(t=+t)<(e=+e),i=r?xl(t,e,n):xl(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function kl(e,t){let n;if(void 0===t)for(const r of e)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function _l(e,t){let n;if(void 0===t)for(const r of e)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function Ol(e,t,n,r,i){if(void 0===n&&(n=0),void 0===r&&(r=1/0),t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(i=void 0===i?pl:function(e){if(void 0===e&&(e=Qs),e===Qs)return pl;if("function"!=typeof e)throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||0===r?r:(0===e(n,n))-(0===e(t,t))}}(i);r>n;){if(r-n>600){const o=r-n+1,a=t-n+1,s=Math.log(o),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(o-l)/o)*(a-o/2<0?-1:1);Ol(e,t,Math.max(n,Math.floor(t-a*l/o+u)),Math.min(r,Math.floor(t+(o-a)*l/o+u)),i)}const o=e[t];let a=n,s=r;for(El(e,n,t),i(e[r],o)>0&&El(e,n,r);a<s;){for(El(e,a,s),++a,--s;i(e[a],o)<0;)++a;for(;i(e[s],o)>0;)--s}0===i(e[n],o)?El(e,n,s):(++s,El(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function El(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Dl(e,t,n){if(e=Float64Array.from(function*(e,t){if(void 0===t)for(let n of e)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)null!=(r=t(r,++n,e))&&(r=+r)>=r&&(yield r)}}(e,n)),(r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return _l(e);if(t>=1)return kl(e);var r,i=(r-1)*t,o=Math.floor(i),a=kl(Ol(e,o).subarray(0,o+1));return a+(_l(e.subarray(o+1))-a)*(i-o)}}function jl(e,t,n){if(void 0===n&&(n=nl),(r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),a=+n(e[o],o,e);return a+(+n(e[o+1],o+1,e)-a)*(i-o)}}function Nl(e,t){return Dl(e,.5,t)}function Sl(e){return Array.from(function*(e){for(const t of e)yield*t}(e))}function Al(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),o=new Array(i);++r<i;)o[r]=e+r*n;return o}function $l(e,t){let n=0;if(void 0===t)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function Cl(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Ml(e){return(e=Cl(Math.abs(e)))?e[1]:NaN}var Pl,Fl=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Tl(e){if(!(t=Fl.exec(e)))throw new Error("invalid format: "+e);var t;return new zl({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function zl(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Rl(e,t){var n=Cl(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}Tl.prototype=zl.prototype,zl.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Ll={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Rl(100*e,t),r:Rl,s:function(e,t){var n=Cl(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(Pl=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Cl(e,Math.max(0,t+o-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Bl(e){return e}var Il,Ul,ql,Wl=Array.prototype.map,Zl=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function Hl(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?Bl:(t=Wl.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,o=[],a=0,s=t[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),o.push(e.substring(i-=s,i+s)),!((l+=s+1)>r));)s=t[a=(a+1)%t.length];return o.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",o=void 0===e.currency?"":e.currency[1]+"",a=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?Bl:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(Wl.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",u=void 0===e.minus?"\u2212":e.minus+"",c=void 0===e.nan?"NaN":e.nan+"";function f(e){var t=(e=Tl(e)).fill,n=e.align,f=e.sign,d=e.symbol,h=e.zero,p=e.width,m=e.comma,g=e.precision,y=e.trim,v=e.type;"n"===v?(m=!0,v="g"):Ll[v]||(void 0===g&&(g=12),y=!0,v="g"),(h||"0"===t&&"="===n)&&(h=!0,t="0",n="=");var b="$"===d?i:"#"===d&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",x="$"===d?o:/[%p]/.test(v)?l:"",w=Ll[v],k=/[defgprs%]/.test(v);function _(e){var i,o,l,d=b,_=x;if("c"===v)_=w(e)+_,e="";else{var O=(e=+e)<0||1/e<0;if(e=isNaN(e)?c:w(Math.abs(e),g),y&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),O&&0==+e&&"+"!==f&&(O=!1),d=(O?"("===f?f:u:"-"===f||"("===f?"":f)+d,_=("s"===v?Zl[8+Pl/3]:"")+_+(O&&"("===f?")":""),k)for(i=-1,o=e.length;++i<o;)if(48>(l=e.charCodeAt(i))||l>57){_=(46===l?a+e.slice(i+1):e.slice(i))+_,e=e.slice(0,i);break}}m&&!h&&(e=r(e,1/0));var E=d.length+e.length+_.length,D=E<p?new Array(p-E+1).join(t):"";switch(m&&h&&(e=r(D+e,D.length?p-_.length:1/0),D=""),n){case"<":e=d+e+_+D;break;case"=":e=d+D+e+_;break;case"^":e=D.slice(0,E=D.length>>1)+d+e+_+D.slice(E);break;default:e=D+d+e+_}return s(e)}return g=void 0===g?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),_.toString=function(){return e+""},_}return{format:f,formatPrefix:function(e,t){var n=f(((e=Tl(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(Ml(t)/3))),i=Math.pow(10,-r),o=Zl[8+r/3];return function(e){return n(i*e)+o}}}}function Gl(e){return Math.max(0,-Ml(Math.abs(e)))}function Vl(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Ml(t)/3)))-Ml(Math.abs(e)))}function Yl(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Ml(t)-Ml(e))+1}!function(e){Il=Hl(e),Ul=Il.format,ql=Il.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]});const Xl=new Date,Jl=new Date;function Ql(e,t,n,r){function i(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return i.floor=t=>(e(t=new Date(+t)),t),i.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),i.round=e=>{const t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),i.range=(n,r,o)=>{const a=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return a;let s;do{a.push(s=new Date(+n)),t(n,o),e(n)}while(s<n&&n<r);return a},i.filter=n=>Ql((t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),((e,r)=>{if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););})),n&&(i.count=(t,r)=>(Xl.setTime(+t),Jl.setTime(+r),e(Xl),e(Jl),Math.floor(n(Xl,Jl))),i.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(r?t=>r(t)%e==0:t=>i.count(0,t)%e==0):i:null)),i}const Kl=Ql((()=>{}),((e,t)=>{e.setTime(+e+t)}),((e,t)=>t-e));Kl.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?Ql((t=>{t.setTime(Math.floor(t/e)*e)}),((t,n)=>{t.setTime(+t+n*e)}),((t,n)=>(n-t)/e)):Kl:null),Kl.range;const eu=1e3,tu=6e4,nu=60*tu,ru=24*nu,iu=7*ru,ou=30*ru,au=365*ru,su=Ql((e=>{e.setTime(e-e.getMilliseconds())}),((e,t)=>{e.setTime(+e+t*eu)}),((e,t)=>(t-e)/eu),(e=>e.getUTCSeconds()));su.range;const lu=Ql((e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*eu)}),((e,t)=>{e.setTime(+e+t*tu)}),((e,t)=>(t-e)/tu),(e=>e.getMinutes()));lu.range;const uu=Ql((e=>{e.setUTCSeconds(0,0)}),((e,t)=>{e.setTime(+e+t*tu)}),((e,t)=>(t-e)/tu),(e=>e.getUTCMinutes()));uu.range;const cu=Ql((e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*eu-e.getMinutes()*tu)}),((e,t)=>{e.setTime(+e+t*nu)}),((e,t)=>(t-e)/nu),(e=>e.getHours()));cu.range;const fu=Ql((e=>{e.setUTCMinutes(0,0,0)}),((e,t)=>{e.setTime(+e+t*nu)}),((e,t)=>(t-e)/nu),(e=>e.getUTCHours()));fu.range;const du=Ql((e=>e.setHours(0,0,0,0)),((e,t)=>e.setDate(e.getDate()+t)),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*tu)/ru),(e=>e.getDate()-1));du.range;const hu=Ql((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/ru),(e=>e.getUTCDate()-1));hu.range;const pu=Ql((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/ru),(e=>Math.floor(e/ru)));function mu(e){return Ql((t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),((e,t)=>{e.setDate(e.getDate()+7*t)}),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*tu)/iu))}pu.range;const gu=mu(0),yu=mu(1),vu=mu(2),bu=mu(3),xu=mu(4),wu=mu(5),ku=mu(6);function _u(e){return Ql((t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)}),((e,t)=>(t-e)/iu))}gu.range,yu.range,vu.range,bu.range,xu.range,wu.range,ku.range;const Ou=_u(0),Eu=_u(1),Du=_u(2),ju=_u(3),Nu=_u(4),Su=_u(5),Au=_u(6);Ou.range,Eu.range,Du.range,ju.range,Nu.range,Su.range,Au.range;const $u=Ql((e=>{e.setDate(1),e.setHours(0,0,0,0)}),((e,t)=>{e.setMonth(e.getMonth()+t)}),((e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())),(e=>e.getMonth()));$u.range;const Cu=Ql((e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)}),((e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())),(e=>e.getUTCMonth()));Cu.range;const Mu=Ql((e=>{e.setMonth(0,1),e.setHours(0,0,0,0)}),((e,t)=>{e.setFullYear(e.getFullYear()+t)}),((e,t)=>t.getFullYear()-e.getFullYear()),(e=>e.getFullYear()));Mu.every=e=>isFinite(e=Math.floor(e))&&e>0?Ql((t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),((t,n)=>{t.setFullYear(t.getFullYear()+n*e)})):null,Mu.range;const Pu=Ql((e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)}),((e,t)=>t.getUTCFullYear()-e.getUTCFullYear()),(e=>e.getUTCFullYear()));function Fu(e,t,n,r,i,o){const a=[[su,1,eu],[su,5,5e3],[su,15,15e3],[su,30,3e4],[o,1,tu],[o,5,5*tu],[o,15,15*tu],[o,30,30*tu],[i,1,nu],[i,3,3*nu],[i,6,6*nu],[i,12,12*nu],[r,1,ru],[r,2,2*ru],[n,1,iu],[t,1,ou],[t,3,3*ou],[e,1,au]];function s(t,n,r){const i=Math.abs(n-t)/r,o=el((e=>{let[,,t]=e;return t})).right(a,i);if(o===a.length)return e.every(wl(t/au,n/au,r));if(0===o)return Kl.every(Math.max(wl(t,n,r),1));const[s,l]=a[i/a[o-1][2]<a[o][2]/i?o-1:o];return s.every(l)}return[function(e,t,n){const r=t<e;r&&([e,t]=[t,e]);const i=n&&"function"==typeof n.range?n:s(e,t,n),o=i?i.range(e,+t+1):[];return r?o.reverse():o},s]}Pu.every=e=>isFinite(e=Math.floor(e))&&e>0?Ql((t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),((t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null,Pu.range;const[Tu,zu]=Fu(Pu,Cu,Ou,pu,fu,uu),[Ru,Lu]=Fu(Mu,$u,gu,du,cu,lu),Bu="year",Iu="quarter",Uu="month",qu="week",Wu="date",Zu="day",Hu="dayofyear",Gu="hours",Vu="minutes",Yu="seconds",Xu="milliseconds",Ju=[Bu,Iu,Uu,qu,Wu,Zu,Hu,Gu,Vu,Yu,Xu],Qu=Ju.reduce(((e,t,n)=>(e[t]=1+n,e)),{});function Ku(e){const t=Ga(e).slice(),n={};t.length||aa("Missing time unit."),t.forEach((e=>{ls(Qu,e)?n[e]=1:aa(`Invalid time unit: ${e}.`)}));return(n[qu]||n[Zu]?1:0)+(n[Iu]||n[Uu]||n[Wu]?1:0)+(n[Hu]?1:0)>1&&aa(`Incompatible time units: ${e}`),t.sort(((e,t)=>Qu[e]-Qu[t])),t}const ec={[Bu]:"%Y ",[Iu]:"Q%q ",[Uu]:"%b ",[Wu]:"%d ",[qu]:"W%U ",[Zu]:"%a ",[Hu]:"%j ",[Gu]:"%H:00",[Vu]:"00:%M",[Yu]:":%S",[Xu]:".%L",[`${Bu}-${Uu}`]:"%Y-%m ",[`${Bu}-${Uu}-${Wu}`]:"%Y-%m-%d ",[`${Gu}-${Vu}`]:"%H:%M"};function tc(e,t){const n=is({},ec,t),r=Ku(e),i=r.length;let o,a,s="",l=0;for(l=0;l<i;)for(o=r.length;o>l;--o)if(a=r.slice(l,o).join("-"),null!=n[a]){s+=n[a],l=o;break}return s.trim()}const nc=new Date;function rc(e){return nc.setFullYear(e),nc.setMonth(0),nc.setDate(1),nc.setHours(0,0,0,0),nc}function ic(e){return ac(new Date(e))}function oc(e){return sc(new Date(e))}function ac(e){return du.count(rc(e.getFullYear())-1,e)}function sc(e){return gu.count(rc(e.getFullYear())-1,e)}function lc(e){return rc(e).getDay()}function uc(e,t,n,r,i,o,a){if(0<=e&&e<100){const s=new Date(-1,t,n,r,i,o,a);return s.setFullYear(e),s}return new Date(e,t,n,r,i,o,a)}function cc(e){return dc(new Date(e))}function fc(e){return hc(new Date(e))}function dc(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return hu.count(t-1,e)}function hc(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Ou.count(t-1,e)}function pc(e){return nc.setTime(Date.UTC(e,0,1)),nc.getUTCDay()}function mc(e,t,n,r,i,o,a){if(0<=e&&e<100){const e=new Date(Date.UTC(-1,t,n,r,i,o,a));return e.setUTCFullYear(n.y),e}return new Date(Date.UTC(e,t,n,r,i,o,a))}function gc(e,t,n,r,i){const o=t||1,a=Na(e),s=(e,t,i)=>function(e,t,n,r){const i=n<=1?e:r?(t,i)=>r+n*Math.floor((e(t,i)-r)/n):(t,r)=>n*Math.floor(e(t,r)/n);return t?(e,n)=>t(i(e,n),n):i}(n[i=i||e],r[i],e===a&&o,t),l=new Date,u=Cs(e),c=u[Bu]?s(Bu):ns(2012),f=u[Uu]?s(Uu):u[Iu]?s(Iu):fa,d=u[qu]&&u[Zu]?s(Zu,1,qu+Zu):u[qu]?s(qu,1):u[Zu]?s(Zu,1):u[Wu]?s(Wu,1):u[Hu]?s(Hu,1):da,h=u[Gu]?s(Gu):fa,p=u[Vu]?s(Vu):fa,m=u[Yu]?s(Yu):fa,g=u[Xu]?s(Xu):fa;return function(e){l.setTime(+e);const t=c(l);return i(t,f(l),d(l,t),h(l),p(l),m(l),g(l))}}function yc(e,t,n){return t+7*e-(n+6)%7}const vc={[Bu]:e=>e.getFullYear(),[Iu]:e=>Math.floor(e.getMonth()/3),[Uu]:e=>e.getMonth(),[Wu]:e=>e.getDate(),[Gu]:e=>e.getHours(),[Vu]:e=>e.getMinutes(),[Yu]:e=>e.getSeconds(),[Xu]:e=>e.getMilliseconds(),[Hu]:e=>ac(e),[qu]:e=>sc(e),[qu+Zu]:(e,t)=>yc(sc(e),e.getDay(),lc(t)),[Zu]:(e,t)=>yc(1,e.getDay(),lc(t))},bc={[Iu]:e=>3*e,[qu]:(e,t)=>yc(e,0,lc(t))};function xc(e,t){return gc(e,t||1,vc,bc,uc)}const wc={[Bu]:e=>e.getUTCFullYear(),[Iu]:e=>Math.floor(e.getUTCMonth()/3),[Uu]:e=>e.getUTCMonth(),[Wu]:e=>e.getUTCDate(),[Gu]:e=>e.getUTCHours(),[Vu]:e=>e.getUTCMinutes(),[Yu]:e=>e.getUTCSeconds(),[Xu]:e=>e.getUTCMilliseconds(),[Hu]:e=>dc(e),[qu]:e=>hc(e),[Zu]:(e,t)=>yc(1,e.getUTCDay(),pc(t)),[qu+Zu]:(e,t)=>yc(hc(e),e.getUTCDay(),pc(t))},kc={[Iu]:e=>3*e,[qu]:(e,t)=>yc(e,0,pc(t))};function _c(e,t){return gc(e,t||1,wc,kc,mc)}const Oc={[Bu]:Mu,[Iu]:$u.every(3),[Uu]:$u,[qu]:gu,[Wu]:du,[Zu]:du,[Hu]:du,[Gu]:cu,[Vu]:lu,[Yu]:su,[Xu]:Kl},Ec={[Bu]:Pu,[Iu]:Cu.every(3),[Uu]:Cu,[qu]:Ou,[Wu]:hu,[Zu]:hu,[Hu]:hu,[Gu]:fu,[Vu]:uu,[Yu]:su,[Xu]:Kl};function Dc(e){return Oc[e]}function jc(e){return Ec[e]}function Nc(e,t,n){return e?e.offset(t,n):void 0}function Sc(e,t,n){return Nc(Dc(e),t,n)}function Ac(e,t,n){return Nc(jc(e),t,n)}function $c(e,t,n,r){return e?e.range(t,n,r):void 0}function Cc(e,t,n,r){return $c(Dc(e),t,n,r)}function Mc(e,t,n,r){return $c(jc(e),t,n,r)}const Pc=1e3,Fc=6e4,Tc=36e5,zc=864e5,Rc=2592e6,Lc=31536e6,Bc=[Bu,Uu,Wu,Gu,Vu,Yu,Xu],Ic=Bc.slice(0,-1),Uc=Ic.slice(0,-1),qc=Uc.slice(0,-1),Wc=qc.slice(0,-1),Zc=[Bu,Uu],Hc=[Bu],Gc=[[Ic,1,Pc],[Ic,5,5e3],[Ic,15,15e3],[Ic,30,3e4],[Uc,1,Fc],[Uc,5,3e5],[Uc,15,9e5],[Uc,30,18e5],[qc,1,Tc],[qc,3,108e5],[qc,6,216e5],[qc,12,432e5],[Wc,1,zc],[[Bu,qu],1,6048e5],[Zc,1,Rc],[Zc,3,7776e6],[Hc,1,Lc]];function Vc(e){const t=e.extent,n=e.maxbins||40,r=Math.abs(Ds(t))/n;let i,o,a=el((e=>e[2])).right(Gc,r);return a===Gc.length?(i=Hc,o=wl(t[0]/Lc,t[1]/Lc,n)):a?(a=Gc[r/Gc[a-1][2]<Gc[a][2]/r?a-1:a],i=a[0],o=a[1]):(i=Bc,o=Math.max(wl(t[0],t[1],n),1)),{units:i,step:o}}function Yc(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Xc(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Jc(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function Qc(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,a=e.shortDays,s=e.months,l=e.shortMonths,u=ff(i),c=df(i),f=ff(o),d=df(o),h=ff(a),p=df(a),m=ff(s),g=df(s),y=ff(l),v=df(l),b={a:function(e){return a[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return l[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:Mf,e:Mf,f:Rf,g:Yf,G:Jf,H:Pf,I:Ff,j:Tf,L:zf,m:Lf,M:Bf,p:function(e){return i[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:xd,s:wd,S:If,u:Uf,U:qf,V:Zf,w:Hf,W:Gf,x:null,X:null,y:Vf,Y:Xf,Z:Qf,"%":bd},x={a:function(e){return a[e.getUTCDay()]},A:function(e){return o[e.getUTCDay()]},b:function(e){return l[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:Kf,e:Kf,f:id,g:md,G:yd,H:ed,I:td,j:nd,L:rd,m:od,M:ad,p:function(e){return i[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:xd,s:wd,S:sd,u:ld,U:ud,V:fd,w:dd,W:hd,x:null,X:null,y:pd,Y:gd,Z:vd,"%":bd},w={a:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=f.exec(t.slice(n));return r?(e.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=y.exec(t.slice(n));return r?(e.m=v.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=g.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return O(e,t,n,r)},d:_f,e:_f,f:Sf,g:bf,G:vf,H:Ef,I:Ef,j:Of,L:Nf,m:kf,M:Df,p:function(e,t,n){var r=u.exec(t.slice(n));return r?(e.p=c.get(r[0].toLowerCase()),n+r[0].length):-1},q:wf,Q:$f,s:Cf,S:jf,u:pf,U:mf,V:gf,w:hf,W:yf,x:function(e,t,r){return O(e,n,t,r)},X:function(e,t,n){return O(e,r,t,n)},y:bf,Y:vf,Z:xf,"%":Af};function k(e,t){return function(n){var r,i,o,a=[],s=-1,l=0,u=e.length;for(n instanceof Date||(n=new Date(+n));++s<u;)37===e.charCodeAt(s)&&(a.push(e.slice(l,s)),null!=(i=of[r=e.charAt(++s)])?r=e.charAt(++s):i="e"===r?" ":"0",(o=t[r])&&(r=o(n,i)),a.push(r),l=s+1);return a.push(e.slice(l,s)),a.join("")}}function _(e,t){return function(n){var r,i,o=Jc(1900,void 0,1);if(O(o,e,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(t&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=Xc(Jc(o.y,0,1))).getUTCDay(),r=i>4||0===i?Eu.ceil(r):Eu(r),r=hu.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=Yc(Jc(o.y,0,1))).getDay(),r=i>4||0===i?yu.ceil(r):yu(r),r=du.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?Xc(Jc(o.y,0,1)).getUTCDay():Yc(Jc(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,Xc(o)):Yc(o)}}function O(e,t,n,r){for(var i,o,a=0,s=t.length,l=n.length;a<s;){if(r>=l)return-1;if(37===(i=t.charCodeAt(a++))){if(i=t.charAt(a++),!(o=w[i in of?t.charAt(a++):i])||(r=o(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return b.x=k(n,b),b.X=k(r,b),b.c=k(t,b),x.x=k(n,x),x.X=k(r,x),x.c=k(t,x),{format:function(e){var t=k(e+="",b);return t.toString=function(){return e},t},parse:function(e){var t=_(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=k(e+="",x);return t.toString=function(){return e},t},utcParse:function(e){var t=_(e+="",!0);return t.toString=function(){return e},t}}}var Kc,ef,tf,nf,rf,of={"-":"",_:" ",0:"0"},af=/^\s*\d+/,sf=/^%/,lf=/[\\^$*+?|[\]().{}]/g;function uf(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function cf(e){return e.replace(lf,"\\$&")}function ff(e){return new RegExp("^(?:"+e.map(cf).join("|")+")","i")}function df(e){return new Map(e.map(((e,t)=>[e.toLowerCase(),t])))}function hf(e,t,n){var r=af.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function pf(e,t,n){var r=af.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function mf(e,t,n){var r=af.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function gf(e,t,n){var r=af.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function yf(e,t,n){var r=af.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function vf(e,t,n){var r=af.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function bf(e,t,n){var r=af.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function xf(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function wf(e,t,n){var r=af.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function kf(e,t,n){var r=af.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function _f(e,t,n){var r=af.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function Of(e,t,n){var r=af.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Ef(e,t,n){var r=af.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Df(e,t,n){var r=af.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function jf(e,t,n){var r=af.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Nf(e,t,n){var r=af.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function Sf(e,t,n){var r=af.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Af(e,t,n){var r=sf.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function $f(e,t,n){var r=af.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function Cf(e,t,n){var r=af.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Mf(e,t){return uf(e.getDate(),t,2)}function Pf(e,t){return uf(e.getHours(),t,2)}function Ff(e,t){return uf(e.getHours()%12||12,t,2)}function Tf(e,t){return uf(1+du.count(Mu(e),e),t,3)}function zf(e,t){return uf(e.getMilliseconds(),t,3)}function Rf(e,t){return zf(e,t)+"000"}function Lf(e,t){return uf(e.getMonth()+1,t,2)}function Bf(e,t){return uf(e.getMinutes(),t,2)}function If(e,t){return uf(e.getSeconds(),t,2)}function Uf(e){var t=e.getDay();return 0===t?7:t}function qf(e,t){return uf(gu.count(Mu(e)-1,e),t,2)}function Wf(e){var t=e.getDay();return t>=4||0===t?xu(e):xu.ceil(e)}function Zf(e,t){return e=Wf(e),uf(xu.count(Mu(e),e)+(4===Mu(e).getDay()),t,2)}function Hf(e){return e.getDay()}function Gf(e,t){return uf(yu.count(Mu(e)-1,e),t,2)}function Vf(e,t){return uf(e.getFullYear()%100,t,2)}function Yf(e,t){return uf((e=Wf(e)).getFullYear()%100,t,2)}function Xf(e,t){return uf(e.getFullYear()%1e4,t,4)}function Jf(e,t){var n=e.getDay();return uf((e=n>=4||0===n?xu(e):xu.ceil(e)).getFullYear()%1e4,t,4)}function Qf(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+uf(t/60|0,"0",2)+uf(t%60,"0",2)}function Kf(e,t){return uf(e.getUTCDate(),t,2)}function ed(e,t){return uf(e.getUTCHours(),t,2)}function td(e,t){return uf(e.getUTCHours()%12||12,t,2)}function nd(e,t){return uf(1+hu.count(Pu(e),e),t,3)}function rd(e,t){return uf(e.getUTCMilliseconds(),t,3)}function id(e,t){return rd(e,t)+"000"}function od(e,t){return uf(e.getUTCMonth()+1,t,2)}function ad(e,t){return uf(e.getUTCMinutes(),t,2)}function sd(e,t){return uf(e.getUTCSeconds(),t,2)}function ld(e){var t=e.getUTCDay();return 0===t?7:t}function ud(e,t){return uf(Ou.count(Pu(e)-1,e),t,2)}function cd(e){var t=e.getUTCDay();return t>=4||0===t?Nu(e):Nu.ceil(e)}function fd(e,t){return e=cd(e),uf(Nu.count(Pu(e),e)+(4===Pu(e).getUTCDay()),t,2)}function dd(e){return e.getUTCDay()}function hd(e,t){return uf(Eu.count(Pu(e)-1,e),t,2)}function pd(e,t){return uf(e.getUTCFullYear()%100,t,2)}function md(e,t){return uf((e=cd(e)).getUTCFullYear()%100,t,2)}function gd(e,t){return uf(e.getUTCFullYear()%1e4,t,4)}function yd(e,t){var n=e.getUTCDay();return uf((e=n>=4||0===n?Nu(e):Nu.ceil(e)).getUTCFullYear()%1e4,t,4)}function vd(){return"+0000"}function bd(){return"%"}function xd(e){return+e}function wd(e){return Math.floor(+e/1e3)}function kd(e){const t={};return n=>t[n]||(t[n]=e(n))}function _d(e){const t=kd(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(e){const n=Tl(e||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let o=function(e,t){let n,r=e.lastIndexOf("e");if(r>0)return r;for(r=e.length;--r>t;)if(n=e.charCodeAt(r),n>=48&&n<=57)return r+1}(r,i);const a=o<r.length?r.slice(o):"";for(;--o>i;)if("0"!==r[o]){++o;break}return r.slice(0,o)+a}}(t(n),t(".1f")(1)[1])}return t(n)},formatSpan(e,r,i,o){o=Tl(null==o?",f":o);const a=wl(e,r,i),s=Math.max(Math.abs(e),Math.abs(r));let l;if(null==o.precision)switch(o.type){case"s":return isNaN(l=Vl(a,s))||(o.precision=l),n(o,s);case"":case"e":case"g":case"p":case"r":isNaN(l=Yl(a,s))||(o.precision=l-("e"===o.type));break;case"f":case"%":isNaN(l=Gl(a))||(o.precision=l-2*("%"===o.type))}return t(o)}}}let Od,Ed;function Dd(){return Od=_d({format:Ul,formatPrefix:ql})}function jd(e){return _d(Hl(e))}function Nd(e){return arguments.length?Od=jd(e):Od}function Sd(e,t,n){_a(n=n||{})||aa(`Invalid time multi-format specifier: ${n}`);const r=t(Yu),i=t(Vu),o=t(Gu),a=t(Wu),s=t(qu),l=t(Uu),u=t(Iu),c=t(Bu),f=e(n[Xu]||".%L"),d=e(n[Yu]||":%S"),h=e(n[Vu]||"%I:%M"),p=e(n[Gu]||"%I %p"),m=e(n[Wu]||n[Zu]||"%a %d"),g=e(n[qu]||"%b %d"),y=e(n[Uu]||"%B"),v=e(n[Iu]||"%B"),b=e(n[Bu]||"%Y");return e=>(r(e)<e?f:i(e)<e?d:o(e)<e?h:a(e)<e?p:l(e)<e?s(e)<e?m:g:c(e)<e?u(e)<e?y:v:b)(e)}function Ad(e){const t=kd(e.format),n=kd(e.utcFormat);return{timeFormat:e=>bs(e)?t(e):Sd(t,Dc,e),utcFormat:e=>bs(e)?n(e):Sd(n,jc,e),timeParse:kd(e.parse),utcParse:kd(e.utcParse)}}function $d(){return Ed=Ad({format:ef,parse:tf,utcFormat:nf,utcParse:rf})}function Cd(e){return Ad(Qc(e))}function Md(e){return arguments.length?Ed=Cd(e):Ed}!function(e){Kc=Qc(e),ef=Kc.format,tf=Kc.parse,nf=Kc.utcFormat,rf=Kc.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),Dd(),$d();const Pd=(e,t)=>is({},e,t);function Fd(e,t){const n=e?jd(e):Nd(),r=t?Cd(t):Md();return Pd(n,r)}function Td(e,t){const n=arguments.length;return n&&2!==n&&aa("defaultLocale expects either zero or two arguments."),n?Pd(Nd(e),Md(t)):Pd(Nd(),Md())}const zd=/^(data:|([A-Za-z]+:)?\/\/)/,Rd=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Ld=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Bd="file://";async function Id(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function Ud(e,t){t=is({},this.options,t);const n=this.fileAccess,r={href:null};let i,o,a;const s=Rd.test(e.replace(Ld,""));null!=e&&"string"==typeof e&&s||aa("Sanitize failure, invalid URI: "+js(e));const l=zd.test(e);return(a=t.baseURL)&&!l&&(e.startsWith("/")||a.endsWith("/")||(e="/"+e),e=a+e),o=(i=e.startsWith(Bd))||"file"===t.mode||"http"!==t.mode&&!l&&n,i?e=e.slice(Bd.length):e.startsWith("//")&&("file"===t.defaultProtocol?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!o}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),"image"===t.context&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function qd(e){return e?t=>new Promise(((n,r)=>{e.readFile(t,((e,t)=>{e?r(e):n(t)}))})):Wd}async function Wd(){aa("No file system access.")}function Zd(e){return e?async function(t,n){const r=is({},this.options.http,n),i=n&&n.response,o=await e(t,r);return o.ok?Ya(o[i])?o[i]():o.text():aa(o.status+""+o.statusText)}:Hd}async function Hd(){aa("No HTTP fetch method available.")}const Gd=e=>null!=e&&e==e,Vd=e=>!(Number.isNaN(+e)||e instanceof Date),Yd={boolean:Ns,integer:Sa,number:Sa,date:As,string:$s,unknown:ca},Xd=[e=>"true"===e||"false"===e||!0===e||!1===e,e=>Vd(e)&&Number.isInteger(+e),Vd,e=>!Number.isNaN(Date.parse(e))],Jd=["boolean","integer","number","date"];function Qd(e,t){if(!e||!e.length)return"unknown";const n=e.length,r=Xd.length,i=Xd.map(((e,t)=>t+1));for(let o,a,s=0,l=0;s<n;++s)for(a=t?e[s][t]:e[s],o=0;o<r;++o)if(i[o]&&Gd(a)&&!Xd[o](a)&&(i[o]=0,++l,l===Xd.length))return"string";return Jd[i.reduce(((e,t)=>0===e?t:e),0)-1]}function Kd(e,t){return t.reduce(((t,n)=>(t[n]=Qd(e,n),t)),{})}function eh(e){const t=function(t,n){const r={delimiter:e};return th(t,n?is(n,r):r)};return t.responseType="text",t}function th(e,t){return t.header&&(e=t.header.map(js).join(t.delimiter)+"\n"+e),Ws(t.delimiter).parse(e+"")}function nh(e,t){const n=t&&t.property?la(t.property):ca;return!_a(e)||(r=e,"function"==typeof Buffer&&Ya(Buffer.isBuffer)&&Buffer.isBuffer(r))?n(JSON.parse(e)):function(e,t){!ka(e)&&gs(e)&&(e=[...e]);return t&&t.copy?JSON.parse(JSON.stringify(e)):e}(n(e),t);var r}th.responseType="text",nh.responseType="json";const rh={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function ih(e,t){let n,r,i,o;return e=nh(e,t),t&&t.feature?(n=Hs,i=t.feature):t&&t.mesh?(n=Xs,i=t.mesh,o=rh[t.filter]):aa("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,o):aa("Invalid TopoJSON object: "+i),r&&r.features||[r]}ih.responseType="json";const oh={dsv:th,csv:eh(","),tsv:eh("\t"),json:nh,topojson:ih};function ah(e,t){return arguments.length>1?(oh[e]=t,this):ls(oh,e)?oh[e]:null}function sh(e){const t=ah(e);return t&&t.responseType||"text"}function lh(e,t,n,r){const i=ah((t=t||{}).type||"json");return i||aa("Unknown data format type: "+t.type),e=i(e,t),t.parse&&function(e,t,n,r){if(!e.length)return;const i=Md();n=n||i.timeParse,r=r||i.utcParse;let o,a,s,l,u,c,f=e.columns||Object.keys(e[0]);"auto"===t&&(t=Kd(e,f));f=Object.keys(t);const d=f.map((e=>{const i=t[e];let o,a;if(i&&(i.startsWith("date:")||i.startsWith("utc:"))){o=i.split(/:(.+)?/,2),a=o[1],("'"===a[0]&&"'"===a[a.length-1]||'"'===a[0]&&'"'===a[a.length-1])&&(a=a.slice(1,-1));return("utc"===o[0]?r:n)(a)}if(!Yd[i])throw Error("Illegal format pattern: "+e+":"+i);return Yd[i]}));for(s=0,u=e.length,c=f.length;s<u;++s)for(o=e[s],l=0;l<c;++l)a=f[l],o[a]=d[l](o[a])}(e,t.parse,n,r),ls(e,"columns")&&delete e.columns,e}const uh=function(e,t){return n=>({options:n||{},sanitize:Ud,load:Id,fileAccess:!!t,file:qd(t),http:Zd(e)})}("undefined"!=typeof fetch&&fetch,null);function ch(e){const t=e||ca,n=[],r={};return n.add=e=>{const i=t(e);return r[i]||(r[i]=1,n.push(e)),n},n.remove=e=>{const i=t(e);if(r[i]){r[i]=0;const t=n.indexOf(e);t>=0&&n.splice(t,1)}return n},n}async function fh(e,t){try{await t(e)}catch(n){e.error(n)}}const dh=Symbol("vega_id");let hh=1;function ph(e){return!(!e||!mh(e))}function mh(e){return e[dh]}function gh(e,t){return e[dh]=t,e}function yh(e){const t=e===Object(e)?e:{data:e};return mh(t)?t:gh(t,hh++)}function vh(e){return bh(e,yh({}))}function bh(e,t){for(const n in e)t[n]=e[n];return t}function xh(e,t){return gh(t,mh(e))}function wh(e,t){return e?t?(n,r)=>e(n,r)||mh(t(n))-mh(t(r)):(t,n)=>e(t,n)||mh(t)-mh(n):null}function kh(e){return e&&e.constructor===_h}function _h(){const e=[],t=[],n=[],r=[],i=[];let o=null,a=!1;return{constructor:_h,insert(t){const n=Ga(t),r=n.length;for(let i=0;i<r;++i)e.push(n[i]);return this},remove(e){const n=Ya(e)?r:t,i=Ga(e),o=i.length;for(let t=0;t<o;++t)n.push(i[t]);return this},modify(e,t,r){const o={field:t,value:ns(r)};return Ya(e)?(o.filter=e,i.push(o)):(o.tuple=e,n.push(o)),this},encode(e,t){return Ya(e)?i.push({filter:e,field:t}):n.push({tuple:e,field:t}),this},clean(e){return o=e,this},reflow(){return a=!0,this},pulse(s,l){const u={},c={};let f,d,h,p,m,g;for(f=0,d=l.length;f<d;++f)u[mh(l[f])]=1;for(f=0,d=t.length;f<d;++f)m=t[f],u[mh(m)]=-1;for(f=0,d=r.length;f<d;++f)p=r[f],l.forEach((e=>{p(e)&&(u[mh(e)]=-1)}));for(f=0,d=e.length;f<d;++f)m=e[f],g=mh(m),u[g]?u[g]=1:s.add.push(yh(e[f]));for(f=0,d=l.length;f<d;++f)m=l[f],u[mh(m)]<0&&s.rem.push(m);function y(e,t,n){n?e[t]=n(e):s.encode=t,a||(c[mh(e)]=e)}for(f=0,d=n.length;f<d;++f)h=n[f],m=h.tuple,p=h.field,g=u[mh(m)],g>0&&(y(m,p,h.value),s.modifies(p));for(f=0,d=i.length;f<d;++f)h=i[f],p=h.filter,l.forEach((e=>{p(e)&&u[mh(e)]>0&&y(e,h.field,h.value)})),s.modifies(h.field);if(a)s.mod=t.length||r.length?l.filter((e=>u[mh(e)]>0)):l.slice();else for(g in c)s.mod.push(c[g]);return(o||null==o&&(t.length||r.length))&&s.clean(!0),s}}}const Oh="_:mod:_";function Eh(){Object.defineProperty(this,Oh,{writable:!0,value:{}})}Eh.prototype={set(e,t,n,r){const i=this,o=i[e],a=i[Oh];return null!=t&&t>=0?(o[t]!==n||r)&&(o[t]=n,a[t+":"+e]=-1,a[e]=-1):(o!==n||r)&&(i[e]=n,a[e]=ka(n)?1+n.length:-1),i},modified(e,t){const n=this[Oh];if(!arguments.length){for(const e in n)if(n[e])return!0;return!1}if(ka(e)){for(let t=0;t<e.length;++t)if(n[e[t]])return!0;return!1}return null!=t&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[Oh]={},this}};let Dh=0;const jh=new Eh;function Nh(e,t,n,r){this.id=++Dh,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function Sh(e){return function(t){const n=this.flags;return 0===arguments.length?!!(n&e):(this.flags=t?n|e:n&~e,this)}}Nh.prototype={targets(){return this._targets||(this._targets=ch(ua))},set(e){return this.value!==e?(this.value=e,1):0},skip:Sh(1),modified:Sh(2),parameters(e,t,n){t=!1!==t;const r=this._argval=this._argval||new Eh,i=this._argops=this._argops||[],o=[];let a,s,l,u;const c=(e,n,a)=>{a instanceof Nh?(a!==this&&(t&&a.targets().add(this),o.push(a)),i.push({op:a,name:e,index:n})):r.set(e,n,a)};for(a in e)if(s=e[a],"pulse"===a)Ga(s).forEach((e=>{e instanceof Nh?e!==this&&(e.targets().add(this),o.push(e)):aa("Pulse parameters must be operator instances.")})),this.source=s;else if(ka(s))for(r.set(a,-1,Array(l=s.length)),u=0;u<l;++u)c(a,u,s[u]);else c(a,-1,s);return this.marshall().clear(),n&&(i.initonly=!0),o},marshall(e){const t=this._argval||jh,n=this._argops;let r,i,o,a;if(n){const s=n.length;for(i=0;i<s;++i)r=n[i],o=r.op,a=o.modified()&&o.stamp===e,t.set(r.name,r.index,o.value,a);if(n.initonly){for(i=0;i<s;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,r,i;if(e)for(t=0,n=e.length;t<n;++t)r=e[t],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};let Ah=0;function $h(e,t,n){this.id=++Ah,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function Ch(e,t,n){return new $h(e,t,n)}$h.prototype={_filter:ha,_apply:ca,targets(){return this._targets||(this._targets=ch(ua))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,r=n?n.length:0;for(let e=0;e<r;++e)n[e].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=Ch(e);return this.targets().add(t),t},apply(e){const t=Ch(null,e);return this.targets().add(t),t},merge(){const e=Ch();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter((()=>{const n=Date.now();return n-t>e?(t=n,1):0}))},debounce(e){const t=Ch();return this.targets().add(Ch(null,null,rs(e,(e=>{const n=e.dataflow;t.receive(e),n&&n.run&&n.run()})))),t},between(e,t){let n=!1;return e.targets().add(Ch(null,null,(()=>n=!0))),t.targets().add(Ch(null,null,(()=>n=!1))),this.filter((()=>n))},detach(){this._filter=ha,this._targets=null}};const Mh={skip:!0};function Ph(e,t,n,r,i,o){const a=is({},o,Mh);let s,l;Ya(n)||(n=ns(n)),void 0===r?s=t=>e.touch(n(t)):Ya(r)?(l=new Nh(null,r,i,!1),s=t=>{l.evaluate(t);const r=n(t),i=l.value;kh(i)?e.pulse(r,i,o):e.update(r,i,a)}):s=t=>e.update(n(t),r,a),t.apply(s)}function Fh(e,t,n,r,i,o){if(void 0===r)t.targets().add(n);else{const a=o||{},s=new Nh(null,function(e,t){return t=Ya(t)?t:ns(t),e?function(n,r){const i=t(n,r);return e.skip()||(e.skip(i!==this.value).value=i),i}:t}(n,r),i,!1);s.modified(a.force),s.rank=t.rank,t.targets().add(s),n&&(s.skip(!0),s.value=n.value,s.targets().add(n),e.connect(n,[s]))}}const Th={};function zh(e,t,n){this.dataflow=e,this.stamp=null==t?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function Rh(e,t){const n=[];return Ps(e,t,(e=>n.push(e))),n}function Lh(e,t){const n={};return e.visit(t,(e=>{n[mh(e)]=1})),e=>n[mh(e)]?null:e}function Bh(e,t){return e?(n,r)=>e(n,r)&&t(n,r):t}function Ih(e,t,n,r){const i=this;let o=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;for(const a of n)if(a.stamp===t){if(a.fields){const e=i.fields||(i.fields={});for(const t in a.fields)e[t]=1}a.changed(i.ADD)&&(o|=i.ADD),a.changed(i.REM)&&(o|=i.REM),a.changed(i.MOD)&&(o|=i.MOD)}this.changes=o}function Uh(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}zh.prototype={StopPropagation:Th,ADD:1,REM:2,MOD:4,ADD_REM:3,ADD_MOD:5,ALL:7,REFLOW:8,SOURCE:16,NO_SOURCE:32,NO_FIELDS:64,fork(e){return new zh(this.dataflow).init(this,e)},clone(){const e=this.fork(7);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(23)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new zh(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,!e.fields||64&t||(n.fields=e.fields),1&t?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),2&t?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),4&t?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),32&t?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||7;return 1&t&&this.add.length||2&t&&this.rem.length||4&t&&this.mod.length},reflow(e){if(e)return this.fork(7).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(4,Lh(this,1))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return ka(e)?e.forEach((e=>t[e]=!0)):t[e]=!0,this},modified(e,t){const n=this.fields;return!(!t&&!this.mod.length||!n)&&(arguments.length?ka(e)?e.some((e=>n[e])):n[e]:!!n)},filter(e,t){const n=this;return 1&e&&(n.addF=Bh(n.addF,t)),2&e&&(n.remF=Bh(n.remF,t)),4&e&&(n.modF=Bh(n.modF,t)),16&e&&(n.srcF=Bh(n.srcF,t)),n},materialize(e){const t=this;return 1&(e=e||7)&&t.addF&&(t.add=Rh(t.add,t.addF),t.addF=null),2&e&&t.remF&&(t.rem=Rh(t.rem,t.remF),t.remF=null),4&e&&t.modF&&(t.mod=Rh(t.mod,t.modF),t.modF=null),16&e&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,r=t;if(16&e)return Ps(n.source,n.srcF,r),n;1&e&&Ps(n.add,n.addF,r),2&e&&Ps(n.rem,n.remF,r),4&e&&Ps(n.mod,n.modF,r);const i=n.source;if(8&e&&i){const e=n.add.length+n.mod.length;e===i.length||Ps(i,e?Lh(n,5):n.srcF,r)}return n}},ds(Ih,zh,{fork(e){const t=new zh(this.dataflow).init(this,e&this.NO_FIELDS);return void 0!==e&&(e&t.ADD&&this.visit(t.ADD,(e=>t.add.push(e))),e&t.REM&&this.visit(t.REM,(e=>t.rem.push(e))),e&t.MOD&&this.visit(t.MOD,(e=>t.mod.push(e)))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?ka(e)?e.some((e=>n[e])):n[e]:0},filter(){aa("MultiPulse does not support filtering.")},materialize(){aa("MultiPulse does not support materialization.")},visit(e,t){const n=this,r=n.pulses,i=r.length;let o=0;if(e&n.SOURCE)for(;o<i;++o)r[o].visit(e,t);else for(;o<i;++o)r[o].stamp===n.stamp&&r[o].visit(e,t);return n}});const qh={skip:!1,force:!1};function Wh(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),Zh(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let r;return t.length?(r=t[0],t[0]=n,function(e,t,n){const r=t,i=e.length,o=e[t];let a,s=1+(t<<1);for(;s<i;)a=s+1,a<i&&n(e[s],e[a])>=0&&(s=a),e[t]=e[s],s=1+((t=s)<<1);e[t]=o,Zh(e,r,t,n)}(t,0,e)):r=n,r}}}function Zh(e,t,n,r){let i,o;const a=e[n];for(;n>t&&(o=n-1>>1,i=e[o],r(a,i)<0);)e[n]=i,n=o;return e[n]=a}function Hh(){this.logger(wa()),this.logLevel(ya),this._clock=0,this._rank=0,this._locale=Td();try{this._loader=uh()}catch(S9){}this._touched=ch(ua),this._input={},this._pulse=null,this._heap=Wh(((e,t)=>e.qrank-t.qrank)),this._postrun=[]}function Gh(e){return function(){return this._log[e].apply(this,arguments)}}function Vh(e,t){Nh.call(this,e,null,t)}Hh.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:Gh("error"),warn:Gh("warn"),info:Gh("info"),debug:Gh("debug"),logLevel:Gh("level"),cleanThreshold:1e4,add:function(e,t,n,r){let i,o=1;return e instanceof Nh?i=e:e&&e.prototype instanceof Nh?i=new e:Ya(e)?i=new Nh(null,e):(o=0,i=new Nh(e,t)),this.rank(i),o&&(r=n,n=t),n&&this.connect(i,i.parameters(n,r)),this.touch(i),i},connect:function(e,t){const n=e.rank,r=t.length;for(let i=0;i<r;++i)if(n<t[i].rank)return void this.rerank(e)},rank:function(e){e.rank=++this._rank},rerank:function(e){const t=[e];let n,r,i;for(;t.length;)if(this.rank(n=t.pop()),r=n._targets)for(i=r.length;--i>=0;)t.push(n=r[i]),n===e&&aa("Cycle detected in dataflow graph.")},pulse:function(e,t,n){this.touch(e,n||qh);const r=new zh(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,i),this},touch:function(e,t){const n=t||qh;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this},update:function(e,t,n){const r=n||qh;return(e.set(t)||r.force)&&this.touch(e,r),this},changeset:_h,ingest:function(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))},parse:function(e,t){const n=this.locale();return lh(e,t,n.timeParse,n.utcParse)},preload:async function(e,t,n){const r=this,i=r._pending||function(e){let t;const n=new Promise((e=>t=e));return n.requests=0,n.done=()=>{0==--n.requests&&(e._pending=null,t(e))},e._pending=n}(r);i.requests+=1;const o=await r.request(t,n);return r.pulse(e,r.changeset().remove(ha).insert(o.data||[])),i.done(),o},request:async function(e,t){const n=this;let r,i=0;try{r=await n.loader().load(e,{context:"dataflow",response:sh(t&&t.type)});try{r=n.parse(r,t)}catch(o){i=-2,n.warn("Data ingestion failed",e,o)}}catch(o){i=-1,n.warn("Loading failed",e,o)}return{data:r,status:i}},events:function(e,t,n,r){const i=this,o=Ch(n,r),a=function(e){e.dataflow=i;try{o.receive(e)}catch(aa){i.error(aa)}finally{i.run()}};let s;s="string"==typeof e&&"undefined"!=typeof document?document.querySelectorAll(e):Ga(e);const l=s.length;for(let u=0;u<l;++u)s[u].addEventListener(t,a);return o},on:function(e,t,n,r,i){return(e instanceof Nh?Fh:Ph)(this,e,t,n,r,i),this},evaluate:async function(e,t,n){const r=this,i=[];if(r._pulse)return Uh(r);if(r._pending&&await r._pending,t&&await fh(r,t),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const o=++r._clock;r._pulse=new zh(r,o,e),r._touched.forEach((e=>r._enqueue(e,!0))),r._touched=ch(ua);let a,s,l,u=0;try{for(;r._heap.size()>0;)a=r._heap.pop(),a.rank===a.qrank?(s=a.run(r._getPulse(a,e)),s.then?s=await s:s.async&&(i.push(s.async),s=Th),s!==Th&&a._targets&&a._targets.forEach((e=>r._enqueue(e))),++u):r._enqueue(a,!0)}catch(c){r._heap.clear(),l=c}if(r._input={},r._pulse=null,r.debug(`Pulse ${o}: ${u} operators`),l&&(r._postrun=[],r.error(l)),r._postrun.length){const e=r._postrun.sort(((e,t)=>t.priority-e.priority));r._postrun=[];for(let t=0;t<e.length;++t)await fh(r,e[t].callback)}return n&&await fh(r,n),i.length&&Promise.all(i).then((e=>r.runAsync(null,(()=>{e.forEach((e=>{try{e(r)}catch(c){r.error(c)}}))})))),r},run:function(e,t,n){return this._pulse?Uh(this):(this.evaluate(e,t,n),this)},runAsync:async function(e,t,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(r,r),this._running},runAfter:function(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(r){this.error(r)}},_enqueue:function(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))},_getPulse:function(e,t){const n=e.source,r=this._clock;return n&&ka(n)?new Ih(this,r,n.map((e=>e.pulse)),t):this._input[e.id]||function(e,t){if(t&&t.stamp===e.stamp)return t;e=e.fork(),t&&t!==Th&&(e.source=t.source);return e}(this._pulse,n&&n.pulse)}},ds(Vh,Nh,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then((e=>this.pulse=e)):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const Yh={};function Xh(e){const t=Jh(e);return t&&t.Definition||null}function Jh(e){return e=e&&e.toLowerCase(),ls(Yh,e)?Yh[e]:null}function*Qh(e,t){if(null==t)for(let n of e)null!=n&&""!==n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)r=t(r,++n,e),null!=r&&""!==r&&(r=+r)>=r&&(yield r)}}function Kh(e,t,n){const r=Float64Array.from(Qh(e,n));return r.sort(Qs),t.map((e=>jl(r,e)))}function ep(e,t){return Kh(e,[.25,.5,.75],t)}function tp(e,t){const n=e.length,r=function(e,t){const n=function(e,t){let n,r=0,i=0,o=0;if(void 0===t)for(let a of e)null!=a&&(a=+a)>=a&&(n=a-i,i+=n/++r,o+=n*(a-i));else{let a=-1;for(let s of e)null!=(s=t(s,++a,e))&&(s=+s)>=s&&(n=s-i,i+=n/++r,o+=n*(s-i))}if(r>1)return o/(r-1)}(e,t);return n?Math.sqrt(n):n}(e,t),i=ep(e,t),o=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,o)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function np(e){const t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2];let o,a,s,l,u,c,f=e.extent[0],d=e.extent[1];const h=e.span||d-f||Math.abs(f)||1;if(e.step)o=e.step;else if(e.steps){for(l=h/t,u=0,c=e.steps.length;u<c&&e.steps[u]<l;++u);o=e.steps[Math.max(0,u-1)]}else{for(a=Math.ceil(Math.log(t)/r),s=e.minstep||0,o=Math.max(s,Math.pow(n,Math.round(Math.log(h)/r)-a));Math.ceil(h/o)>t;)o*=n;for(u=0,c=i.length;u<c;++u)l=o/i[u],l>=s&&h/l<=t&&(o=l)}l=Math.log(o);const p=l>=0?0:1+~~(-l/r),m=Math.pow(n,-p-1);return(e.nice||void 0===e.nice)&&(l=Math.floor(f/o+m)*o,f=f<l?l-o:l,d=Math.ceil(d/o)*o),{start:f,stop:d===f?f+o:d,step:o}}var rp=Math.random;function ip(e,t,n,r){if(!e.length)return[void 0,void 0];const i=Float64Array.from(Qh(e,r)),o=i.length,a=t;let s,l,u,c;for(u=0,c=Array(a);u<a;++u){for(s=0,l=0;l<o;++l)s+=i[~~(rp()*o)];c[u]=s/o}return c.sort(Qs),[Dl(c,n/2),Dl(c,1-n/2)]}function op(e,t,n,r){r=r||(e=>e);const i=e.length,o=new Float64Array(i);let a,s=0,l=1,u=r(e[0]),c=u,f=u+t;for(;l<i;++l){if(a=r(e[l]),a>=f){for(c=(u+c)/2;s<l;++s)o[s]=c;f=a+t,u=a}c=a}for(c=(u+c)/2;s<l;++s)o[s]=c;return n?function(e,t){const n=e.length;let r,i,o=0,a=1;for(;e[o]===e[a];)++a;for(;a<n;){for(r=a+1;e[a]===e[r];)++r;if(e[a]-e[a-1]<t){for(i=a+(o+r-a-a>>1);i<a;)e[i++]=e[a];for(;i>a;)e[i--]=e[o]}o=a,a=r}return e}(o,t+t/4):o}const ap=Math.sqrt(2*Math.PI),sp=Math.SQRT2;let lp=NaN;function up(e,t){e=e||0,t=null==t?1:t;let n,r,i=0,o=0;if(lp==lp)i=lp,lp=NaN;else{do{i=2*rp()-1,o=2*rp()-1,n=i*i+o*o}while(0===n||n>1);r=Math.sqrt(-2*Math.log(n)/n),i*=r,lp=o*r}return e+i*t}function cp(e,t,n){const r=(e-(t||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*ap)}function fp(e,t,n){const r=(e-(t=t||0))/(n=null==n?1:n),i=Math.abs(r);let o;if(i>37)o=0;else{const e=Math.exp(-i*i/2);let t;i<7.07106781186547?(t=.0352624965998911*i+.700383064443688,t=t*i+6.37396220353165,t=t*i+33.912866078383,t=t*i+112.079291497871,t=t*i+221.213596169931,t=t*i+220.206867912376,o=e*t,t=.0883883476483184*i+1.75566716318264,t=t*i+16.064177579207,t=t*i+86.7807322029461,t=t*i+296.564248779674,t=t*i+637.333633378831,t=t*i+793.826512519948,t=t*i+440.413735824752,o/=t):(t=i+.65,t=i+4/t,t=i+3/t,t=i+2/t,t=i+1/t,o=e/t/2.506628274631)}return r>0?1-o:o}function dp(e,t,n){return e<0||e>1?NaN:(t||0)+(null==n?1:n)*sp*function(e){let t,n=-Math.log((1-e)*(1+e));n<6.25?(n-=3.125,t=-364441206401782e-35,t=t*n-16850591381820166e-35,t=128584807152564e-32+t*n,t=11157877678025181e-33+t*n,t=t*n-1333171662854621e-31,t=20972767875968562e-33+t*n,t=6637638134358324e-30+t*n,t=t*n-4054566272975207e-29,t=t*n-8151934197605472e-29,t=26335093153082323e-28+t*n,t=t*n-12975133253453532e-27,t=t*n-5415412054294628e-26,t=1.0512122733215323e-9+t*n,t=t*n-4.112633980346984e-9,t=t*n-2.9070369957882005e-8,t=4.2347877827932404e-7+t*n,t=t*n-13654692000834679e-22,t=t*n-13882523362786469e-21,t=.00018673420803405714+t*n,t=t*n-.000740702534166267,t=t*n-.006033670871430149,t=.24015818242558962+t*n,t=1.6536545626831027+t*n):n<16?(n=Math.sqrt(n)-3.25,t=2.2137376921775787e-9,t=9.075656193888539e-8+t*n,t=t*n-2.7517406297064545e-7,t=1.8239629214389228e-8+t*n,t=15027403968909828e-22+t*n,t=t*n-4013867526981546e-21,t=29234449089955446e-22+t*n,t=12475304481671779e-21+t*n,t=t*n-47318229009055734e-21,t=6828485145957318e-20+t*n,t=24031110387097894e-21+t*n,t=t*n-.0003550375203628475,t=.0009532893797373805+t*n,t=t*n-.0016882755560235047,t=.002491442096107851+t*n,t=t*n-.003751208507569241,t=.005370914553590064+t*n,t=1.0052589676941592+t*n,t=3.0838856104922208+t*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,t=-27109920616438573e-27,t=t*n-2.555641816996525e-10,t=1.5076572693500548e-9+t*n,t=t*n-3.789465440126737e-9,t=7.61570120807834e-9+t*n,t=t*n-1.496002662714924e-8,t=2.914795345090108e-8+t*n,t=t*n-6.771199775845234e-8,t=2.2900482228026655e-7+t*n,t=t*n-9.9298272942317e-7,t=4526062597223154e-21+t*n,t=t*n-1968177810553167e-20,t=7599527703001776e-20+t*n,t=t*n-.00021503011930044477,t=t*n-.00013871931833623122,t=1.0103004648645344+t*n,t=4.849906401408584+t*n):t=1/0;return t*e}(2*e-1)}function hp(e,t){let n,r;const i={mean(e){return arguments.length?(n=e||0,i):n},stdev(e){return arguments.length?(r=null==e?1:e,i):r},sample:()=>up(n,r),pdf:e=>cp(e,n,r),cdf:e=>fp(e,n,r),icdf:e=>dp(e,n,r)};return i.mean(e).stdev(t)}function pp(e,t){const n=hp();let r=0;const i={data(n){return arguments.length?(e=n,r=n?n.length:0,i.bandwidth(t)):e},bandwidth(n){return arguments.length?(!(t=n)&&e&&(t=tp(e)),i):t},sample:()=>e[~~(rp()*r)]+t*n.sample(),pdf(i){let o=0,a=0;for(;a<r;++a)o+=n.pdf((i-e[a])/t);return o/t/r},cdf(i){let o=0,a=0;for(;a<r;++a)o+=n.cdf((i-e[a])/t);return o/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(e)}function mp(e,t){return e=e||0,t=null==t?1:t,Math.exp(e+up()*t)}function gp(e,t,n){if(e<=0)return 0;t=t||0,n=null==n?1:n;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*ap*e)}function yp(e,t,n){return fp(Math.log(e),t,n)}function vp(e,t,n){return Math.exp(dp(e,t,n))}function bp(e,t){let n,r;const i={mean(e){return arguments.length?(n=e||0,i):n},stdev(e){return arguments.length?(r=null==e?1:e,i):r},sample:()=>mp(n,r),pdf:e=>gp(e,n,r),cdf:e=>yp(e,n,r),icdf:e=>vp(e,n,r)};return i.mean(e).stdev(t)}function xp(e,t){let n,r=0;const i={weights(e){return arguments.length?(n=function(e){const t=[];let n,i=0;for(n=0;n<r;++n)i+=t[n]=null==e[n]?1:+e[n];for(n=0;n<r;++n)t[n]/=i;return t}(t=e||[]),i):t},distributions(n){return arguments.length?(n?(r=n.length,e=n):(r=0,e=[]),i.weights(t)):e},sample(){const t=rp();let i=e[r-1],o=n[0],a=0;for(;a<r-1;o+=n[++a])if(t<o){i=e[a];break}return i.sample()},pdf(t){let i=0,o=0;for(;o<r;++o)i+=n[o]*e[o].pdf(t);return i},cdf(t){let i=0,o=0;for(;o<r;++o)i+=n[o]*e[o].cdf(t);return i},icdf(){throw Error("Mixture icdf not supported.")}};return i.distributions(e).weights(t)}function wp(e,t){return null==t&&(t=null==e?1:e,e=0),e+(t-e)*rp()}function kp(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function _p(e,t,n){return null==n&&(n=null==t?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function Op(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function Ep(e,t){let n,r;const i={min(e){return arguments.length?(n=e||0,i):n},max(e){return arguments.length?(r=null==e?1:e,i):r},sample:()=>wp(n,r),pdf:e=>kp(e,n,r),cdf:e=>_p(e,n,r),icdf:e=>Op(e,n,r)};return null==t&&(t=null==e?1:e,e=0),i.min(e).max(t)}function Dp(e,t,n){let r=0,i=0;for(const o of e){const e=n(o);null==t(o)||null==e||isNaN(e)||(r+=(e-r)/++i)}return{coef:[r],predict:()=>r,rSquared:0}}function jp(e,t,n,r){const i=r-e*e,o=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-o*e,o]}function Np(e,t,n,r){e=e.filter((e=>{let r=t(e),i=n(e);return null!=r&&(r=+r)>=r&&null!=i&&(i=+i)>=i})),r&&e.sort(((e,n)=>t(e)-t(n)));const i=e.length,o=new Float64Array(i),a=new Float64Array(i);let s,l,u,c=0,f=0,d=0;for(u of e)o[c]=s=+t(u),a[c]=l=+n(u),++c,f+=(s-f)/c,d+=(l-d)/c;for(c=0;c<i;++c)o[c]-=f,a[c]-=d;return[o,a,f,d]}function Sp(e,t,n,r){let i,o,a=-1;for(const s of e)i=t(s),o=n(s),null!=i&&(i=+i)>=i&&null!=o&&(o=+o)>=o&&r(i,o,++a)}function Ap(e,t,n,r,i){let o=0,a=0;return Sp(e,t,n,((e,t)=>{const n=t-i(e),s=t-r;o+=n*n,a+=s*s})),1-o/a}function $p(e,t,n){let r=0,i=0,o=0,a=0,s=0;Sp(e,t,n,((e,t)=>{++s,r+=(e-r)/s,i+=(t-i)/s,o+=(e*t-o)/s,a+=(e*e-a)/s}));const l=jp(r,i,o,a),u=e=>l[0]+l[1]*e;return{coef:l,predict:u,rSquared:Ap(e,t,n,i,u)}}function Cp(e,t,n){let r=0,i=0,o=0,a=0,s=0;Sp(e,t,n,((e,t)=>{++s,e=Math.log(e),r+=(e-r)/s,i+=(t-i)/s,o+=(e*t-o)/s,a+=(e*e-a)/s}));const l=jp(r,i,o,a),u=e=>l[0]+l[1]*Math.log(e);return{coef:l,predict:u,rSquared:Ap(e,t,n,i,u)}}function Mp(e,t,n){const[r,i,o,a]=Np(e,t,n);let s,l,u,c=0,f=0,d=0,h=0,p=0;Sp(e,t,n,((e,t)=>{s=r[p++],l=Math.log(t),u=s*t,c+=(t*l-c)/p,f+=(u-f)/p,d+=(u*l-d)/p,h+=(s*u-h)/p}));const[m,g]=jp(f/a,c/a,d/a,h/a),y=e=>Math.exp(m+g*(e-o));return{coef:[Math.exp(m-g*o),g],predict:y,rSquared:Ap(e,t,n,a,y)}}function Pp(e,t,n){let r=0,i=0,o=0,a=0,s=0,l=0;Sp(e,t,n,((e,t)=>{const n=Math.log(e),u=Math.log(t);++l,r+=(n-r)/l,i+=(u-i)/l,o+=(n*u-o)/l,a+=(n*n-a)/l,s+=(t-s)/l}));const u=jp(r,i,o,a),c=e=>u[0]*Math.pow(e,u[1]);return u[0]=Math.exp(u[0]),{coef:u,predict:c,rSquared:Ap(e,t,n,s,c)}}function Fp(e,t,n){const[r,i,o,a]=Np(e,t,n),s=r.length;let l,u,c,f,d=0,h=0,p=0,m=0,g=0;for(l=0;l<s;)u=r[l],c=i[l++],f=u*u,d+=(f-d)/l,h+=(f*u-h)/l,p+=(f*f-p)/l,m+=(u*c-m)/l,g+=(f*c-g)/l;const y=p-d*d,v=d*y-h*h,b=(g*d-m*h)/v,x=(m*y-g*h)/v,w=-b*d,k=e=>b*(e-=o)*e+x*e+w+a;return{coef:[w-x*o+b*o*o+a,x-2*b*o,b],predict:k,rSquared:Ap(e,t,n,a,k)}}function Tp(e,t,n,r){if(0===r)return Dp(e,t,n);if(1===r)return $p(e,t,n);if(2===r)return Fp(e,t,n);const[i,o,a,s]=Np(e,t,n),l=i.length,u=[],c=[],f=r+1;let d,h,p,m,g;for(d=0;d<f;++d){for(p=0,m=0;p<l;++p)m+=Math.pow(i[p],d)*o[p];for(u.push(m),g=new Float64Array(f),h=0;h<f;++h){for(p=0,m=0;p<l;++p)m+=Math.pow(i[p],d+h);g[h]=m}c.push(g)}c.push(u);const y=function(e){const t=e.length-1,n=[];let r,i,o,a,s;for(r=0;r<t;++r){for(a=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][a])&&(a=i);for(o=r;o<t+1;++o)s=e[o][r],e[o][r]=e[o][a],e[o][a]=s;for(i=r+1;i<t;++i)for(o=t;o>=r;o--)e[o][i]-=e[o][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(s=0,o=i+1;o<t;++o)s+=e[o][i]*n[o];n[i]=(e[t][i]-s)/e[i][i]}return n}(c),v=e=>{e-=a;let t=s+y[0]+y[1]*e+y[2]*e*e;for(d=3;d<f;++d)t+=y[d]*Math.pow(e,d);return t};return{coef:zp(f,y,-a,s),predict:v,rSquared:Ap(e,t,n,s,v)}}function zp(e,t,n,r){const i=Array(e);let o,a,s,l;for(o=0;o<e;++o)i[o]=0;for(o=e-1;o>=0;--o)for(s=t[o],l=1,i[o]+=s,a=1;a<=o;++a)l*=(o+1-a)/a,i[o-a]+=s*Math.pow(n,a)*l;return i[0]+=r,i}function Rp(e,t,n,r){const[i,o,a,s]=Np(e,t,n,!0),l=i.length,u=Math.max(2,~~(r*l)),c=new Float64Array(l),f=new Float64Array(l),d=new Float64Array(l).fill(1);for(let h=-1;++h<=2;){const e=[0,u-1];for(let n=0;n<l;++n){const t=i[n],r=e[0],a=e[1],s=t-i[r]>i[a]-t?r:a;let l=0,u=0,h=0,p=0,m=0;const g=1/Math.abs(i[s]-t||1);for(let e=r;e<=a;++e){const n=i[e],r=o[e],a=Lp(Math.abs(t-n)*g)*d[e],s=n*a;l+=a,u+=s,h+=r*a,p+=r*s,m+=n*s}const[y,v]=jp(u/l,h/l,p/l,m/l);c[n]=y+v*t,f[n]=Math.abs(o[n]-c[n]),Bp(i,n+1,e)}if(2===h)break;const t=Nl(f);if(Math.abs(t)<1e-12)break;for(let n,r,i=0;i<l;++i)n=f[i]/(6*t),d[i]=n>=1?1e-12:(r=1-n*n)*r}return function(e,t,n,r){const i=e.length,o=[];let a,s=0,l=0,u=[];for(;s<i;++s)a=e[s]+n,u[0]===a?u[1]+=(t[s]-u[1])/++l:(l=0,u[1]+=r,u=[a,t[s]],o.push(u));return u[1]+=r,o}(i,c,a,s)}function Lp(e){return(e=1-e*e*e)*e*e}function Bp(e,t,n){const r=e[t];let i=n[0],o=n[1]+1;if(!(o>=e.length))for(;t>i&&e[o]-r<=r-e[i];)n[0]=++i,n[1]=o,++o}const Ip=.5*Math.PI/180;function Up(e,t,n,r){n=n||25,r=Math.max(n,r||200);const i=t=>[t,e(t)],o=t[0],a=t[1],s=a-o,l=s/r,u=[i(o)],c=[];if(n===r){for(let e=1;e<r;++e)u.push(i(o+e/n*s));return u.push(i(a)),u}c.push(i(a));for(let m=n;--m>0;)c.push(i(o+m/n*s));let f=u[0],d=c[c.length-1];const h=1/s,p=function(e,t){let n=e,r=e;const i=t.length;for(let o=0;o<i;++o){const e=t[o][1];e<n&&(n=e),e>r&&(r=e)}return 1/(r-n)}(f[1],c);for(;d;){const e=i((f[0]+d[0])/2);e[0]-f[0]>=l&&qp(f,e,d,h,p)>Ip?c.push(e):(f=d,u.push(d),c.pop()),d=c[c.length-1]}return u}function qp(e,t,n,r,i){const o=Math.atan2(i*(n[1]-e[1]),r*(n[0]-e[0])),a=Math.atan2(i*(t[1]-e[1]),r*(t[0]-e[0]));return Math.abs(o-a)}function Wp(e){return e&&e.length?1===e.length?e[0]:(t=e,e=>{const n=t.length;let r=1,i=String(t[0](e));for(;r<n;++r)i+="|"+t[r](e);return i}):function(){return""};var t}function Zp(e,t,n){return n||e+(t?"_"+t:"")}const Hp=()=>{},Gp={init:Hp,add:Hp,rem:Hp,idx:0},Vp={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||void 0===e.min)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||void 0===e.max)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},Yp=Object.keys(Vp).filter((e=>"__count__"!==e));function Xp(e,t){return Vp[e](t)}function Jp(e,t){return e.idx-t.idx}function Qp(){this.valid=0,this.missing=0,this._ops.forEach((e=>e.init(this)))}function Kp(e,t){null!=e&&""!==e?e==e&&(++this.valid,this._ops.forEach((n=>n.add(this,e,t)))):++this.missing}function em(e,t){null!=e&&""!==e?e==e&&(--this.valid,this._ops.forEach((n=>n.rem(this,e,t)))):--this.missing}function tm(e){return this._out.forEach((t=>e[t.out]=t.value(this))),e}function nm(e,t){const n=t||ca,r=function(e){const t={};e.forEach((e=>t[e.name]=e));const n=e=>{e.req&&e.req.forEach((e=>{t[e]||n(t[e]=Vp[e]())}))};return e.forEach(n),Object.values(t).sort(Jp)}(e),i=e.slice().sort(Jp);function o(e){this._ops=r,this._out=i,this.cell=e,this.init()}return o.prototype.init=Qp,o.prototype.add=Kp,o.prototype.rem=em,o.prototype.set=tm,o.prototype.get=n,o.fields=e.map((e=>e.out)),o}function rm(e){this._key=e?la(e):mh,this.reset()}[...Yp,"__count__"].forEach((e=>{Vp[e]=function(e,t){return n=>is({name:e,out:n||e},Gp,t)}(e,Vp[e])}));const im=rm.prototype;function om(e){Vh.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}im.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},im.add=function(e){this._add.push(e)},im.rem=function(e){this._rem.push(e)},im.values=function(){if(this._get=null,0===this._rem.length)return this._add;const e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,o=Array(r-i),a={};let s,l,u;for(s=0;s<i;++s)a[n(t[s])]=1;for(s=0,l=0;s<r;++s)a[n(u=e[s])]?a[n(u)]=0:o[l++]=u;return this._rem=[],this._add=o},im.distinct=function(e){const t=this.values(),n={};let r,i=t.length,o=0;for(;--i>=0;)r=e(t[i])+"",ls(n,r)||(n[r]=1,++o);return o},im.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=as(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext},im.argmin=function(e){return this.extent(e)[0]||{}},im.argmax=function(e){return this.extent(e)[1]||{}},im.min=function(e){const t=this.extent(e)[0];return null!=t?e(t):void 0},im.max=function(e){const t=this.extent(e)[1];return null!=t?e(t):void 0},im.quartile=function(e){return this._get===e&&this._q||(this._q=ep(this.values(),e),this._get=e),this._q},im.q1=function(e){return this.quartile(e)[0]},im.q2=function(e){return this.quartile(e)[1]},im.q3=function(e){return this.quartile(e)[2]},im.ci=function(e){return this._get===e&&this._ci||(this._ci=ip(this.values(),1e3,.05,e),this._get=e),this._ci},im.ci0=function(e){return this.ci(e)[0]},im.ci1=function(e){return this.ci(e)[1]},om.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Yp},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},ds(om,Vh,{transform(e,t){const n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return n.stamp=r.stamp,n.value&&(i||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(e):Object.create(null),t.visit(t.SOURCE,(e=>n.add(e)))):(n.value=n.value||n.init(e),t.visit(t.REM,(e=>n.rem(e))),t.visit(t.ADD,(e=>n.add(e)))),r.modifies(n._outputs),n._drop=!1!==e.drop,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&r.clean(!0).runAfter((()=>this.clean())),n.changes(r)},cross(){const e=this,t=e.value,n=e._dnames,r=n.map((()=>({}))),i=n.length;function o(e){let t,o,a,s;for(t in e)for(a=e[t].tuple,o=0;o<i;++o)r[o][s=a[n[o]]]=s}o(e._prev),o(t),function o(a,s,l){const u=n[l],c=r[l++];for(const n in c){const r=a?a+"|"+n:n;s[u]=c[n],l<i?o(r,s,l):t[r]||e.cell(r,s)}}("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],r={};function i(e){const n=Ga(na(e)),i=n.length;let o,a=0;for(;a<i;++a)r[o=n[a]]||(r[o]=1,t.push(o))}this._dims=Ga(e.groupby),this._dnames=this._dims.map((e=>{const t=ta(e);return i(e),n.push(t),t})),this.cellkey=e.key?e.key:Wp(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const o=e.fields||[null],a=e.ops||["count"],s=e.as||[],l=o.length,u={};let c,f,d,h,p,m;for(l!==a.length&&aa("Unmatched number of fields and aggregate ops."),m=0;m<l;++m)c=o[m],f=a[m],null==c&&"count"!==f&&aa("Null aggregate field specified."),h=ta(c),p=Zp(f,h,s[m]),n.push(p),"count"!==f?(d=u[h],d||(i(c),d=u[h]=[],d.field=c,this._measures.push(d)),"count"!==f&&(this._countOnly=!1),d.push(Xp(f,p))):this._counts.push(p);return this._measures=this._measures.map((e=>nm(e,e.field))),Object.create(null)},cellkey:Wp(),cell(e,t){let n=this.value[e];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const e=this._measures,t=e.length;n.agg=Array(t);for(let r=0;r<t;++r)n.agg[r]=new e[r](n)}return n.store&&(n.data=new rm),n},newtuple(e,t){const n=this._dnames,r=this._dims,i=r.length,o={};for(let a=0;a<i;++a)o[n[a]]=r[a](e);return t?xh(t.tuple,o):yh(o)},clean(){const e=this.value;for(const t in e)0===e[t].num&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].add(r[i].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].rem(r[i].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let r=0,i=n.length;r<i;++r)t[n[r]]=e.num;if(!this._countOnly){const n=e.agg;for(let e=0,r=n.length;e<r;++e)n[e].set(t)}return t},changes(e){const t=this._adds,n=this._mods,r=this._prev,i=this._drop,o=e.add,a=e.rem,s=e.mod;let l,u,c,f;if(r)for(u in r)l=r[u],i&&!l.num||a.push(l.tuple);for(c=0,f=this._alen;c<f;++c)o.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)l=n[c],(0===l.num&&i?a:s).push(this.celltuple(l)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});function am(e){Vh.call(this,null,e)}function sm(e,t,n){const r=e;let i=t||[],o=n||[],a={},s=0;return{add:e=>o.push(e),remove:e=>a[r(e)]=++s,size:()=>i.length,data:(e,t)=>(s&&(i=i.filter((e=>!a[r(e)])),a={},s=0),t&&e&&i.sort(e),o.length&&(i=e?_s(e,i,o.sort(e)):i.concat(o),o=[]),i)}}function lm(e){Vh.call(this,[],e)}function um(e){Nh.call(this,null,cm,e)}function cm(e){return this.value&&!e.modified()?this.value:Ja(e.fields,e.orders)}function fm(e){Vh.call(this,null,e)}function dm(e){Vh.call(this,null,e)}am.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},ds(am,Vh,{transform(e,t){const n=!1!==e.interval,r=this._bins(e),i=r.start,o=r.step,a=e.as||["bin0","bin1"],s=a[0],l=a[1];let u;return u=e.modified()?(t=t.reflow(!0)).SOURCE:t.modified(na(e.field))?t.ADD_MOD:t.ADD,t.visit(u,n?e=>{const t=r(e);e[s]=t,e[l]=null==t?null:i+o*(1+(t-i)/o)}:e=>e[s]=r(e)),t.modifies(n?a:s)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=np(e),r=n.step;let i,o,a=n.start,s=a+Math.ceil((n.stop-a)/r)*r;null!=(i=e.anchor)&&(o=i-(a+r*Math.floor((i-a)/r)),a+=o,s+=o);const l=function(e){let n=Sa(t(e));return null==n?null:n<a?-1/0:n>s?1/0:(n=Math.max(a,Math.min(n,s-r)),a+r*Math.floor(1e-14+(n-a)/r))};return l.start=a,l.stop=n.stop,l.step=r,this.value=ea(l,na(t),e.name||"bin_"+ta(t))}}),lm.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},ds(lm,Vh,{transform(e,t){const n=t.fork(t.ALL),r=sm(mh,this.value,n.materialize(n.ADD).add),i=e.sort,o=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(o),this.value=n.source=r.data(wh(i),o),t.source&&t.source.root&&(this.value.root=t.source.root),n}}),ds(um,Nh),fm.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},ds(fm,Vh,{transform(e,t){const n=t=>n=>{for(var r,i=function(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase()}return e.match(n)}(s(n),e.case,o)||[],l=0,u=i.length;l<u;++l)a.test(r=i[l])||t(r)},r=this._parameterCheck(e,t),i=this._counts,o=this._match,a=this._stop,s=e.field,l=e.as||["text","count"],u=n((e=>i[e]=1+(i[e]||0))),c=n((e=>i[e]-=1));return r?t.visit(t.SOURCE,u):(t.visit(t.ADD,u),t.visit(t.REM,c)),this._finish(t,l)},_parameterCheck(e,t){let n=!1;return!e.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),!e.modified("pattern")&&this._match||(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],o=t[1],a=e.fork(e.NO_SOURCE|e.NO_FIELDS);let s,l,u;for(s in n)l=r[s],u=n[s]||0,!l&&u?(r[s]=l=yh({}),l[i]=s,l[o]=u,a.add.push(l)):0===u?(l&&a.rem.push(l),n[s]=null,r[s]=null):l[o]!==u&&(l[o]=u,a.mod.push(l));return a.modifies(t)}}),dm.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},ds(dm,Vh,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],i=r[0],o=r[1],a=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let s=this.value;return a?(s&&(n.rem=s),s=t.materialize(t.SOURCE).source,n.add=this.value=function(e,t,n,r){for(var i,o,a=[],s={},l=e.length,u=0;u<l;++u)for(s[t]=o=e[u],i=0;i<l;++i)s[n]=e[i],r(s)&&(a.push(yh(s)),(s={})[t]=o);return a}(s,i,o,e.filter||ha)):n.mod=s,n.source=this.value,n.modifies(r)}});const hm={kde:pp,mixture:xp,normal:hp,lognormal:bp,uniform:Ep},pm="function";function mm(e,t){const n=e[pm];ls(hm,n)||aa("Unknown distribution function: "+n);const r=hm[n]();for(const i in e)"field"===i?r.data((e.from||t()).map(e[i])):"distributions"===i?r[i](e[i].map((e=>mm(e,t)))):typeof r[i]===pm&&r[i](e[i]);return r}function gm(e){Vh.call(this,null,e)}const ym=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],vm={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:ym},{name:"weights",type:"number",array:!0}]};function bm(e,t){return e?e.map(((e,n)=>t[n]||ta(e))):null}function xm(e,t,n){const r=[],i=e=>e(l);let o,a,s,l,u,c;if(null==t)r.push(e.map(n));else for(o={},a=0,s=e.length;a<s;++a)l=e[a],u=t.map(i),c=o[u],c||(o[u]=c=[],c.dims=u,r.push(c)),c.push(n(l));return r}gm.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:ym.concat(vm)},{name:"as",type:"string",array:!0,default:["value","density"]}]},ds(gm,Vh,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=mm(e.distribution,function(e){return()=>e.materialize(e.SOURCE).source}(t)),i=e.steps||e.minsteps||25,o=e.steps||e.maxsteps||200;let a=e.method||"pdf";"pdf"!==a&&"cdf"!==a&&aa("Invalid density method: "+a),e.extent||r.data||aa("Missing density extent parameter."),a=r[a];const s=e.as||["value","density"],l=Up(a,e.extent||os(r.data()),i,o).map((e=>{const t={};return t[s[0]]=e[0],t[s[1]]=e[1],yh(t)}));this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function wm(e){Vh.call(this,null,e)}wm.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]};function km(e){Nh.call(this,null,_m,e),this.modified(!0)}function _m(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:ea((n=>t(n,e)),na(t),ta(t))}function Om(e){Vh.call(this,[void 0,void 0],e)}function Em(e,t){Nh.call(this,e),this.parent=t,this.count=0}function Dm(e){Vh.call(this,{},e),this._keys=cs();const t=this._targets=[];t.active=0,t.forEach=e=>{for(let n=0,r=t.active;n<r;++n)e(t[n],n,t)}}function jm(e){Nh.call(this,null,Nm,e)}function Nm(e){return this.value&&!e.modified()?this.value:ka(e.name)?Ga(e.name).map((e=>la(e))):la(e.name,e.as)}function Sm(e){Vh.call(this,cs(),e)}function Am(e){Vh.call(this,[],e)}function $m(e){Vh.call(this,[],e)}function Cm(e){Vh.call(this,null,e)}function Mm(e){Vh.call(this,[],e)}ds(wm,Vh,{transform(e,t){if(this.value&&!e.modified()&&!t.changed())return t;const n=t.materialize(t.SOURCE).source,r=xm(t.source,e.groupby,ca),i=e.smooth||!1,o=e.field,a=e.step||((e,t)=>Ds(os(e,t))/30)(n,o),s=wh(((e,t)=>o(e)-o(t))),l=e.as||"bin",u=r.length;let c,f=1/0,d=-1/0,h=0;for(;h<u;++h){const e=r[h].sort(s);c=-1;for(const t of op(e,a,i,o))t<f&&(f=t),t>d&&(d=t),e[++c][l]=t}return this.value={start:f,stop:d,step:a},t.reflow(!0).modifies(l)}}),ds(km,Nh),Om.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},ds(Om,Vh,{transform(e,t){const n=this.value,r=e.field,i=t.changed()||t.modified(r.fields)||e.modified("field");let o=n[0],a=n[1];if((i||null==o)&&(o=1/0,a=-1/0),t.visit(i?t.SOURCE:t.ADD,(e=>{const t=Sa(r(e));null!=t&&(t<o&&(o=t),t>a&&(a=t))})),!Number.isFinite(o)||!Number.isFinite(a)){let e=ta(r);e&&(e=` for field "${e}"`),t.dataflow.warn(`Infinite extent${e}: [${o}, ${a}]`),o=a=void 0}this.value=[o,a]}}),ds(Em,Nh,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}}),ds(Dm,Vh,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,r){const i=this.value;let o,a,s=ls(i,e)&&i[e];return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(a=r||(a=this._group[e])&&a.tuple,o=n.dataflow,s=new Em(n.fork(n.NO_SOURCE),this),o.add(s).connect(t(o,e,a)),i[e]=s,this.activate(s)),s},clean(){const e=this.value;let t=0;for(const n in e)if(0===e[n].count){const r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){const e=this._targets.filter((e=>e&&e.count>0));this.initTargets(e)}},initTargets(e){const t=this._targets,n=t.length,r=e?e.length:0;let i=0;for(;i<r;++i)t[i]=e[i];for(;i<n&&null!=t[i];++i)t[i]=null;t.active=r},transform(e,t){const n=t.dataflow,r=e.key,i=e.subflow,o=this._keys,a=e.modified("key"),s=e=>this.subflow(e,i,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,(e=>{const t=mh(e),n=o.get(t);void 0!==n&&(o.delete(t),s(n).rem(e))})),t.visit(t.ADD,(e=>{const t=r(e);o.set(mh(e),t),s(t).add(e)})),a||t.modified(r.fields)?t.visit(t.MOD,(e=>{const t=mh(e),n=o.get(t),i=r(e);n===i?s(i).mod(e):(o.set(t,i),s(n).rem(e),s(i).add(e))})):t.changed(t.MOD)&&t.visit(t.MOD,(e=>{s(o.get(mh(e))).mod(e)})),a&&t.visit(t.REFLOW,(e=>{const t=mh(e),n=o.get(t),i=r(e);n!==i&&(o.set(t,i),s(n).rem(e),s(i).add(e))})),t.clean()?n.runAfter((()=>{this.clean(),o.clean()})):o.empty>n.cleanThreshold&&n.runAfter(o.clean),t}}),ds(jm,Nh),Sm.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},ds(Sm,Vh,{transform(e,t){const n=t.dataflow,r=this.value,i=t.fork(),o=i.add,a=i.rem,s=i.mod,l=e.expr;let u=!0;function c(t){const n=mh(t),i=l(t,e),c=r.get(n);i&&c?(r.delete(n),o.push(t)):i||c?u&&i&&!c&&s.push(t):(r.set(n,1),a.push(t))}return t.visit(t.REM,(e=>{const t=mh(e);r.has(t)?r.delete(t):a.push(e)})),t.visit(t.ADD,(t=>{l(t,e)?o.push(t):r.set(mh(t),1)})),t.visit(t.MOD,c),e.modified()&&(u=!1,t.visit(t.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}}),Am.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},ds(Am,Vh,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=bm(r,e.as||[]),o=e.index||null,a=i.length;return n.rem=this.value,t.visit(t.SOURCE,(e=>{const t=r.map((t=>t(e))),s=t.reduce(((e,t)=>Math.max(e,t.length)),0);let l,u,c,f=0;for(;f<s;++f){for(u=vh(e),l=0;l<a;++l)u[i[l]]=null==(c=t[l][f])?null:c;o&&(u[o]=f),n.add.push(u)}})),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(i)}}),$m.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},ds($m,Vh,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(ta),o=e.as||["key","value"],a=o[0],s=o[1],l=r.length;return n.rem=this.value,t.visit(t.SOURCE,(e=>{for(let t,o=0;o<l;++o)t=vh(e),t[a]=i[o],t[s]=r[o](e),n.add.push(t)})),this.value=n.source=n.add,n.modifies(o)}}),Cm.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},ds(Cm,Vh,{transform(e,t){const n=e.expr,r=e.as,i=e.modified(),o=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(o,(t=>t[r]=n(t,e)))}}),ds(Mm,Vh,{transform(e,t){const n=t.fork(t.ALL),r=e.generator;let i,o,a,s=this.value,l=e.size-s.length;if(l>0){for(i=[];--l>=0;)i.push(a=yh(r(e))),s.push(a);n.add=n.add.length?n.materialize(n.ADD).add.concat(i):i}else o=s.slice(0,-l),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(o):o,s=s.slice(-l);return n.source=this.value=s,n}});const Pm={value:"value",median:Nl,mean:function(e,t){let n=0,r=0;if(void 0===t)for(let i of e)null!=i&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let o of e)null!=(o=t(o,++i,e))&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n},min:_l,max:kl},Fm=[];function Tm(e){Vh.call(this,[],e)}function zm(e){om.call(this,e)}function Rm(e){Vh.call(this,null,e)}function Lm(e){Nh.call(this,null,Bm,e)}function Bm(e){return this.value&&!e.modified()?this.value:xs(e.fields,e.flat)}function Im(e){Vh.call(this,[],e),this._pending=null}function Um(e,t,n){n.forEach(yh);const r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function qm(e){Vh.call(this,{},e)}function Wm(e){Nh.call(this,null,Zm,e)}function Zm(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let r,i,o=1/0,a=-1/0;for(r=0;r<n;++r)i=t[r],i[0]<o&&(o=i[0]),i[1]>a&&(a=i[1]);return[o,a]}function Hm(e){Nh.call(this,null,Gm,e)}function Gm(e){return this.value&&!e.modified()?this.value:e.values.reduce(((e,t)=>e.concat(t)),[])}function Vm(e){Vh.call(this,null,e)}function Ym(e){om.call(this,e)}function Xm(e){Dm.call(this,e)}function Jm(e){Vh.call(this,null,e)}function Qm(e){Vh.call(this,null,e)}function Km(e){Vh.call(this,null,e)}Tm.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},ds(Tm,Vh,{transform(e,t){var n,r,i,o,a,s,l,u,c,f,d=t.fork(t.ALL),h=function(e){var t,n=e.method||Pm.value;if(null!=Pm[n])return n===Pm.value?(t=void 0!==e.value?e.value:0,()=>t):Pm[n];aa("Unrecognized imputation method: "+n)}(e),p=function(e){const t=e.field;return e=>e?t(e):NaN}(e),m=ta(e.field),g=ta(e.key),y=(e.groupby||[]).map(ta),v=function(e,t,n,r){var i,o,a,s,l,u,c,f,d=e=>e(f),h=[],p=r?r.slice():[],m={},g={};for(p.forEach(((e,t)=>m[e]=t+1)),s=0,c=e.length;s<c;++s)u=n(f=e[s]),l=m[u]||(m[u]=p.push(u)),(a=g[o=(i=t?t.map(d):Fm)+""])||(a=g[o]=[],h.push(a),a.values=i),a[l-1]=f;return h.domain=p,h}(t.source,e.groupby,e.key,e.keyvals),b=[],x=this.value,w=v.domain.length;for(a=0,u=v.length;a<u;++a)for(i=(n=v[a]).values,r=NaN,l=0;l<w;++l)if(null==n[l]){for(o=v.domain[l],f={_impute:!0},s=0,c=i.length;s<c;++s)f[y[s]]=i[s];f[g]=o,f[m]=Number.isNaN(r)?r=h(n,p):r,b.push(yh(f))}return b.length&&(d.add=d.materialize(d.ADD).add.concat(b)),x.length&&(d.rem=d.materialize(d.REM).rem.concat(x)),this.value=b,d}}),zm.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:Yp},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},ds(zm,om,{transform(e,t){const n=this,r=e.modified();let i;return n.value&&(r||t.modified(n._inputs,!0))?(i=n.value=r?n.init(e):{},t.visit(t.SOURCE,(e=>n.add(e)))):(i=n.value=n.value||this.init(e),t.visit(t.REM,(e=>n.rem(e))),t.visit(t.ADD,(e=>n.add(e)))),n.changes(),t.visit(t.SOURCE,(e=>{is(e,i[n.cellkey(e)].tuple)})),t.reflow(r).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(e[n]),e[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}}),Rm.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},ds(Rm,Vh,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=xm(r,e.groupby,e.field),o=(e.groupby||[]).map(ta),a=e.bandwidth,s=e.cumulative?"cdf":"pdf",l=e.as||["value","density"],u=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;"pdf"!==s&&"cdf"!==s&&aa("Invalid density method: "+s),"shared"===e.resolve&&(c||(c=os(r,e.field)),f=d=e.steps||d),i.forEach((t=>{const n=pp(t,a)[s],r=e.counts?t.length:1;Up(n,c||os(t),f,d).forEach((e=>{const n={};for(let r=0;r<o.length;++r)n[o[r]]=t.dims[r];n[l[0]]=e[0],n[l[1]]=e[1]*r,u.push(yh(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}}),ds(Lm,Nh),ds(Im,Vh,{transform(e,t){const n=t.dataflow;if(this._pending)return Um(this,t,this._pending);if(function(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}(e))return t.StopPropagation;if(e.values)return Um(this,t,n.parse(e.values,e.format));if(e.async){const t=n.request(e.url,e.format).then((e=>(this._pending=Ga(e.data),e=>e.touch(this))));return{async:t}}return n.request(e.url,e.format).then((e=>Um(this,t,Ga(e.data))))}}),qm.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},ds(qm,Vh,{transform(e,t){const n=e.fields,r=e.index,i=e.values,o=null==e.default?null:e.default,a=e.modified(),s=n.length;let l,u,c,f=a?t.SOURCE:t.ADD,d=t,h=e.as;return i?(u=i.length,s>1&&!h&&aa('Multi-field lookup requires explicit "as" parameter.'),h&&h.length!==s*u&&aa('The "as" parameter has too few output field names.'),h=h||i.map(ta),l=function(e){for(var t,a,l=0,c=0;l<s;++l)if(null==(a=r.get(n[l](e))))for(t=0;t<u;++t,++c)e[h[c]]=o;else for(t=0;t<u;++t,++c)e[h[c]]=i[t](a)}):(h||aa("Missing output field names."),l=function(e){for(var t,i=0;i<s;++i)t=r.get(n[i](e)),e[h[i]]=null==t?o:t}),a?d=t.reflow(!0):(c=n.some((e=>t.modified(e.fields))),f|=c?t.MOD:0),t.visit(f,l),d.modifies(h)}}),ds(Wm,Nh),ds(Hm,Nh),ds(Vm,Vh,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),Ym.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:Yp,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},ds(Ym,om,{_transform:om.prototype.transform,transform(e,t){return this._transform(function(e,t){const n=e.field,r=e.value,i=("count"===e.op?"__count__":e.op)||"sum",o=na(n).concat(na(r)),a=function(e,t,n){const r={},i=[];return n.visit(n.SOURCE,(t=>{const n=e(t);r[n]||(r[n]=1,i.push(n))})),i.sort(Qa),t?i.slice(0,t):i}(n,e.limit||0,t);t.changed()&&e.set("__pivot__",null,null,!0);return{key:e.key,groupby:e.groupby,ops:a.map((()=>i)),fields:a.map((e=>function(e,t,n,r){return ea((r=>t(r)===e?n(r):NaN),r,e+"")}(e,n,r,o))),as:a.map((e=>e+"")),modified:e.modified.bind(e)}}(e,t),t)}}),ds(Xm,Dm,{transform(e,t){const n=e.subflow,r=e.field,i=e=>this.subflow(mh(e),n,t,e);return(e.modified("field")||r&&t.modified(na(r)))&&aa("PreFacet does not support field modification."),this.initTargets(),r?(t.visit(t.MOD,(e=>{const t=i(e);r(e).forEach((e=>t.mod(e)))})),t.visit(t.ADD,(e=>{const t=i(e);r(e).forEach((e=>t.add(yh(e))))})),t.visit(t.REM,(e=>{const t=i(e);r(e).forEach((e=>t.rem(e)))}))):(t.visit(t.MOD,(e=>i(e).mod(e))),t.visit(t.ADD,(e=>i(e).add(e))),t.visit(t.REM,(e=>i(e).rem(e)))),t.clean()&&t.runAfter((()=>this.clean())),t}}),Jm.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},ds(Jm,Vh,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=bm(e.fields,e.as||[]),o=r?(e,t)=>function(e,t,n,r){for(let i=0,o=n.length;i<o;++i)t[r[i]]=n[i](e);return t}(e,t,r,i):bh;let a;return this.value?a=this.value:(t=t.addAll(),a=this.value={}),t.visit(t.REM,(e=>{const t=mh(e);n.rem.push(a[t]),a[t]=null})),t.visit(t.ADD,(e=>{const t=o(e,yh({}));a[mh(e)]=t,n.add.push(t)})),t.visit(t.MOD,(e=>{n.mod.push(o(e,a[mh(e)]))})),n}}),ds(Qm,Vh,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}}),Km.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};function eg(e){Vh.call(this,null,e)}function tg(e){Vh.call(this,[],e),this.count=0}function ng(e){Vh.call(this,null,e)}function rg(e){Vh.call(this,null,e),this.modified(!0)}function ig(e){Vh.call(this,null,e)}ds(Km,Vh,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const i=xm(t.materialize(t.SOURCE).source,e.groupby,e.field),o=(e.groupby||[]).map(ta),a=[],s=e.step||.01,l=e.probs||Al(s/2,1-1e-14,s),u=l.length;return i.forEach((e=>{const t=Kh(e,l);for(let n=0;n<u;++n){const i={};for(let t=0;t<o.length;++t)i[o[t]]=e.dims[t];i[r[0]]=l[n],i[r[1]]=t[n],a.push(yh(i))}})),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}}),ds(eg,Vh,{transform(e,t){let n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,(e=>{const t=mh(e);n.rem.push(r[t]),r[t]=null})),t.visit(t.ADD,(e=>{const t=vh(e);r[mh(e)]=t,n.add.push(t)})),t.visit(t.MOD,(e=>{const t=r[mh(e)];for(const r in e)t[r]=e[r],n.modifies(r);n.mod.push(t)}))),n}}),tg.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},ds(tg,Vh,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,o=this.value.reduce(((e,t)=>(e[mh(t)]=1,e)),{});let a=this.value,s=this.count,l=0;function u(e){let t,r;a.length<i?a.push(e):(r=~~((s+1)*rp()),r<a.length&&r>=l&&(t=a[r],o[mh(t)]&&n.rem.push(t),a[r]=e)),++s}if(t.rem.length&&(t.visit(t.REM,(e=>{const t=mh(e);o[t]&&(o[t]=-1,n.rem.push(e)),--s})),a=a.filter((e=>-1!==o[mh(e)]))),(t.rem.length||r)&&a.length<i&&t.source&&(l=s=a.length,t.visit(t.SOURCE,(e=>{o[mh(e)]||u(e)})),l=-1),r&&a.length>i){const e=a.length-i;for(let t=0;t<e;++t)o[mh(a[t])]=-1,n.rem.push(a[t]);a=a.slice(e)}return t.mod.length&&t.visit(t.MOD,(e=>{o[mh(e)]&&n.mod.push(e)})),t.add.length&&t.visit(t.ADD,u),(t.add.length||l<0)&&(n.add=a.filter((e=>!o[mh(e)]))),this.count=s,this.value=n.source=a,n}}),ng.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},ds(ng,Vh,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Al(e.start,e.stop,e.step||1).map((e=>{const t={};return t[r]=e,yh(t)})),n.add=t.add.concat(this.value),n}}),ds(rg,Vh,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});const og=["unit0","unit1"];function ag(e){Vh.call(this,cs(),e)}function sg(e){Vh.call(this,null,e)}ig.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:Ju,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:og}]},ds(ig,Vh,{transform(e,t){const n=e.field,r=!1!==e.interval,i="utc"===e.timezone,o=this._floor(e,t),a=(i?jc:Dc)(o.unit).offset,s=e.as||og,l=s[0],u=s[1],c=o.step;let f=o.start||1/0,d=o.stop||-1/0,h=t.ADD;return(e.modified()||t.changed(t.REM)||t.modified(na(n)))&&(h=(t=t.reflow(!0)).SOURCE,f=1/0,d=-1/0),t.visit(h,(e=>{const t=n(e);let i,s;null==t?(e[l]=null,r&&(e[u]=null)):(e[l]=i=s=o(t),r&&(e[u]=s=a(i,c)),i<f&&(f=i),s>d&&(d=s))})),o.start=f,o.stop=d,t.modifies(r?s:l)},_floor(e,t){const n="utc"===e.timezone,{units:r,step:i}=e.units?{units:e.units,step:e.step||1}:Vc({extent:e.extent||os(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),o=Ku(r),a=this.value||{},s=(n?_c:xc)(o,i);return s.unit=Na(o),s.units=o,s.step=i,s.start=a.start,s.stop=a.stop,this.value=s}}),ds(ag,Vh,{transform(e,t){const n=t.dataflow,r=e.field,i=this.value,o=e=>i.set(r(e),e);let a=!0;return e.modified("field")||t.modified(r.fields)?(i.clear(),t.visit(t.SOURCE,o)):t.changed()?(t.visit(t.REM,(e=>i.delete(r(e)))),t.visit(t.ADD,o)):a=!1,this.modified(a),i.empty>n.cleanThreshold&&n.runAfter(i.clean),t.fork()}}),ds(sg,Vh,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(wh(e.sort)):t.source).map(e.field))}});const lg={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){const e=lg.rank(),t=e.next;return{init:e.init,next:e=>(t(e)-1)/(e.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,r=t.compare;let i=t.index;if(e<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;e=i}return(1+e)/n.length}}},ntile:function(e,t){(t=+t)>0||aa("ntile num must be greater than zero.");const n=lg.cume_dist(),r=n.next;return{init:n.init,next:e=>Math.ceil(t*r(e))}},lag:function(e,t){return t=+t||1,{next:n=>{const r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return(t=+t)>0||aa("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const r=e(n.data[n.index]);return null!=r?t=r:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:r=>{const i=r.data;return r.index<=n?t:(n=function(e,t,n){for(let r=t.length;n<r;++n){if(null!=e(t[n]))return n}return-1}(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}};const ug=Object.keys(lg);function cg(e){const t=Ga(e.ops),n=Ga(e.fields),r=Ga(e.params),i=Ga(e.as),o=this.outputs=[],a=this.windows=[],s={},l={},u=[],c=[];let f=!0;function d(e){Ga(na(e)).forEach((e=>s[e]=1))}d(e.sort),t.forEach(((e,t)=>{const s=n[t],h=ta(s),p=Zp(e,h,i[t]);if(d(s),o.push(p),ls(lg,e))a.push(function(e,t,n,r){const i=lg[e](t,n);return{init:i.init||fa,update:function(e,t){t[r]=i.next(e)}}}(e,n[t],r[t],p));else{if(null==s&&"count"!==e&&aa("Null aggregate field specified."),"count"===e)return void u.push(p);f=!1;let t=l[h];t||(t=l[h]=[],t.field=s,c.push(t)),t.push(Xp(e,p))}})),(u.length||c.length)&&(this.cell=function(e,t,n){e=e.map((e=>nm(e,e.field)));const r={num:0,agg:null,store:!1,count:t};if(!n)for(var i=e.length,o=r.agg=Array(i),a=0;a<i;++a)o[a]=new e[a](r);if(r.store)var s=r.data=new rm;return r.add=function(e){if(r.num+=1,!n){s&&s.add(e);for(let t=0;t<i;++t)o[t].add(o[t].get(e),e)}},r.rem=function(e){if(r.num-=1,!n){s&&s.rem(e);for(let t=0;t<i;++t)o[t].rem(o[t].get(e),e)}},r.set=function(e){let i,a;for(s&&s.values(),i=0,a=t.length;i<a;++i)e[t[i]]=r.num;if(!n)for(i=0,a=o.length;i<a;++i)o[i].set(e)},r.init=function(){r.num=0,s&&s.reset();for(let e=0;e<i;++e)o[e].init()},r}(c,u,f)),this.inputs=Object.keys(s)}const fg=cg.prototype;function dg(e){Vh.call(this,{},e),this._mlen=0,this._mods=[]}function hg(e,t,n,r){const i=r.sort,o=i&&!r.ignorePeers,a=r.frame||[null,0],s=e.data(n),l=s.length,u=o?el(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:s,compare:i||ns(-1)};t.init();for(let f=0;f<l;++f)pg(c,a,f,l),o&&mg(c,u),t.update(c,s[f])}function pg(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=null==t[0]?0:Math.max(0,n-Math.abs(t[0])),e.i1=null==t[1]?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function mg(e,t){const n=e.i0,r=e.i1-1,i=e.compare,o=e.data,a=o.length-1;n>0&&!i(o[n],o[n-1])&&(e.i0=t.left(o,o[n])),r<a&&!i(o[r],o[r+1])&&(e.i1=t.right(o,o[r]))}fg.init=function(){this.windows.forEach((e=>e.init())),this.cell&&this.cell.init()},fg.update=function(e,t){const n=this.cell,r=this.windows,i=e.data,o=r&&r.length;let a;if(n){for(a=e.p0;a<e.i0;++a)n.rem(i[a]);for(a=e.p1;a<e.i1;++a)n.add(i[a]);n.set(t)}for(a=0;a<o;++a)r[a].update(e,t)},dg.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:ug.concat(Yp)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},ds(dg,Vh,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),r=wh(e.sort),i=Wp(e.groupby),o=e=>this.group(i(e));let a=this.state;a&&!n||(a=this.state=new cg(e)),n||t.modified(a.inputs)?(this.value={},t.visit(t.SOURCE,(e=>o(e).add(e)))):(t.visit(t.REM,(e=>o(e).remove(e))),t.visit(t.ADD,(e=>o(e).add(e))));for(let s=0,l=this._mlen;s<l;++s)hg(this._mods[s],a,r,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(a.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=sm(mh),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});var gg=Object.freeze({__proto__:null,aggregate:om,bin:am,collect:lm,compare:um,countpattern:fm,cross:dm,density:gm,dotbin:wm,expression:km,extent:Om,facet:Dm,field:jm,filter:Sm,flatten:Am,fold:$m,formula:Cm,generate:Mm,impute:Tm,joinaggregate:zm,kde:Rm,key:Lm,load:Im,lookup:qm,multiextent:Wm,multivalues:Hm,params:Vm,pivot:Ym,prefacet:Xm,project:Jm,proxy:Qm,quantile:Km,relay:eg,sample:tg,sequence:ng,sieve:rg,subflow:Em,timeunit:ig,tupleindex:ag,values:sg,window:dg});function yg(e){return function(){return e}}const vg=Math.abs,bg=Math.atan2,xg=Math.cos,wg=Math.max,kg=Math.min,_g=Math.sin,Og=Math.sqrt,Eg=1e-12,Dg=Math.PI,jg=Dg/2,Ng=2*Dg;function Sg(e){return e>=1?jg:e<=-1?-jg:Math.asin(e)}const Ag=Math.PI,$g=2*Ag,Cg=1e-6,Mg=$g-Cg;function Pg(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}let Fg=class{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?Pg:function(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Pg;const n=10**t;return function(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(e)}moveTo(e,t){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,t){this._append`L${this._x1=+e},${this._y1=+t}`}quadraticCurveTo(e,t,n,r){this._append`Q${+e},${+t},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(e,t,n,r,i,o){this._append`C${+e},${+t},${+n},${+r},${this._x1=+i},${this._y1=+o}`}arcTo(e,t,n,r,i){if(e=+e,t=+t,n=+n,r=+r,(i=+i)<0)throw new Error(`negative radius: ${i}`);let o=this._x1,a=this._y1,s=n-e,l=r-t,u=o-e,c=a-t,f=u*u+c*c;if(null===this._x1)this._append`M${this._x1=e},${this._y1=t}`;else if(f>Cg)if(Math.abs(c*s-l*u)>Cg&&i){let d=n-o,h=r-a,p=s*s+l*l,m=d*d+h*h,g=Math.sqrt(p),y=Math.sqrt(f),v=i*Math.tan((Ag-Math.acos((p+f-m)/(2*g*y)))/2),b=v/y,x=v/g;Math.abs(b-1)>Cg&&this._append`L${e+b*u},${t+b*c}`,this._append`A${i},${i},0,0,${+(c*d>u*h)},${this._x1=e+x*s},${this._y1=t+x*l}`}else this._append`L${this._x1=e},${this._y1=t}`;else;}arc(e,t,n,r,i,o){if(e=+e,t=+t,o=!!o,(n=+n)<0)throw new Error(`negative radius: ${n}`);let a=n*Math.cos(r),s=n*Math.sin(r),l=e+a,u=t+s,c=1^o,f=o?r-i:i-r;null===this._x1?this._append`M${l},${u}`:(Math.abs(this._x1-l)>Cg||Math.abs(this._y1-u)>Cg)&&this._append`L${l},${u}`,n&&(f<0&&(f=f%$g+$g),f>Mg?this._append`A${n},${n},0,1,${c},${e-a},${t-s}A${n},${n},0,1,${c},${this._x1=l},${this._y1=u}`:f>Cg&&this._append`A${n},${n},0,${+(f>=Ag)},${c},${this._x1=e+n*Math.cos(i)},${this._y1=t+n*Math.sin(i)}`)}rect(e,t,n,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}};function Tg(){return new Fg}function zg(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(null==n)t=null;else{const e=Math.floor(n);if(!(e>=0))throw new RangeError(`invalid digits: ${n}`);t=e}return e},()=>new Fg(t)}function Rg(e){return e.innerRadius}function Lg(e){return e.outerRadius}function Bg(e){return e.startAngle}function Ig(e){return e.endAngle}function Ug(e){return e&&e.padAngle}function qg(e,t,n,r,i,o,a){var s=e-n,l=t-r,u=(a?o:-o)/Og(s*s+l*l),c=u*l,f=-u*s,d=e+c,h=t+f,p=n+c,m=r+f,g=(d+p)/2,y=(h+m)/2,v=p-d,b=m-h,x=v*v+b*b,w=i-o,k=d*m-p*h,_=(b<0?-1:1)*Og(wg(0,w*w*x-k*k)),O=(k*b-v*_)/x,E=(-k*v-b*_)/x,D=(k*b+v*_)/x,j=(-k*v+b*_)/x,N=O-g,S=E-y,A=D-g,$=j-y;return N*N+S*S>A*A+$*$&&(O=D,E=j),{cx:O,cy:E,x01:-c,y01:-f,x11:O*(i/w-1),y11:E*(i/w-1)}}function Wg(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function Zg(e){this._context=e}function Hg(e){return new Zg(e)}function Gg(e){return e[0]}function Vg(e){return e[1]}function Yg(e,t){var n=yg(!0),r=null,i=Hg,o=null,a=zg(s);function s(s){var l,u,c,f=(s=Wg(s)).length,d=!1;for(null==r&&(o=i(c=a())),l=0;l<=f;++l)!(l<f&&n(u=s[l],l,s))===d&&((d=!d)?o.lineStart():o.lineEnd()),d&&o.point(+e(u,l,s),+t(u,l,s));if(c)return o=null,c+""||null}return e="function"==typeof e?e:void 0===e?Gg:yg(e),t="function"==typeof t?t:void 0===t?Vg:yg(t),s.x=function(t){return arguments.length?(e="function"==typeof t?t:yg(+t),s):e},s.y=function(e){return arguments.length?(t="function"==typeof e?e:yg(+e),s):t},s.defined=function(e){return arguments.length?(n="function"==typeof e?e:yg(!!e),s):n},s.curve=function(e){return arguments.length?(i=e,null!=r&&(o=i(r)),s):i},s.context=function(e){return arguments.length?(null==e?r=o=null:o=i(r=e),s):r},s}function Xg(e,t,n){var r=null,i=yg(!0),o=null,a=Hg,s=null,l=zg(u);function u(u){var c,f,d,h,p,m=(u=Wg(u)).length,g=!1,y=new Array(m),v=new Array(m);for(null==o&&(s=a(p=l())),c=0;c<=m;++c){if(!(c<m&&i(h=u[c],c,u))===g)if(g=!g)f=c,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),d=c-1;d>=f;--d)s.point(y[d],v[d]);s.lineEnd(),s.areaEnd()}g&&(y[c]=+e(h,c,u),v[c]=+t(h,c,u),s.point(r?+r(h,c,u):y[c],n?+n(h,c,u):v[c]))}if(p)return s=null,p+""||null}function c(){return Yg().defined(i).curve(a).context(o)}return e="function"==typeof e?e:void 0===e?Gg:yg(+e),t="function"==typeof t?t:yg(void 0===t?0:+t),n="function"==typeof n?n:void 0===n?Vg:yg(+n),u.x=function(t){return arguments.length?(e="function"==typeof t?t:yg(+t),r=null,u):e},u.x0=function(t){return arguments.length?(e="function"==typeof t?t:yg(+t),u):e},u.x1=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:yg(+e),u):r},u.y=function(e){return arguments.length?(t="function"==typeof e?e:yg(+e),n=null,u):t},u.y0=function(e){return arguments.length?(t="function"==typeof e?e:yg(+e),u):t},u.y1=function(e){return arguments.length?(n=null==e?null:"function"==typeof e?e:yg(+e),u):n},u.lineX0=u.lineY0=function(){return c().x(e).y(t)},u.lineY1=function(){return c().x(e).y(n)},u.lineX1=function(){return c().x(r).y(t)},u.defined=function(e){return arguments.length?(i="function"==typeof e?e:yg(!!e),u):i},u.curve=function(e){return arguments.length?(a=e,null!=o&&(s=a(o)),u):a},u.context=function(e){return arguments.length?(null==e?o=s=null:s=a(o=e),u):o},u}Tg.prototype=Fg.prototype,Zg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};var Jg={draw(e,t){const n=Og(t/Dg);e.moveTo(n,0),e.arc(0,0,n,0,Ng)}};function Qg(){}function Kg(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function ey(e){this._context=e}function ty(e){this._context=e}function ny(e){this._context=e}function ry(e,t){this._basis=new ey(e),this._beta=t}ey.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Kg(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Kg(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},ty.prototype={areaStart:Qg,areaEnd:Qg,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Kg(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},ny.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Kg(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},ry.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r,i=e[0],o=t[0],a=e[n]-i,s=t[n]-o,l=-1;++l<=n;)r=l/n,this._basis.point(this._beta*e[l]+(1-this._beta)*(i+r*a),this._beta*t[l]+(1-this._beta)*(o+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var iy=function e(t){function n(e){return 1===t?new ey(e):new ry(e,t)}return n.beta=function(t){return e(+t)},n}(.85);function oy(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function ay(e,t){this._context=e,this._k=(1-t)/6}ay.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:oy(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:oy(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var sy=function e(t){function n(e){return new ay(e,t)}return n.tension=function(t){return e(+t)},n}(0);function ly(e,t){this._context=e,this._k=(1-t)/6}ly.prototype={areaStart:Qg,areaEnd:Qg,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:oy(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var uy=function e(t){function n(e){return new ly(e,t)}return n.tension=function(t){return e(+t)},n}(0);function cy(e,t){this._context=e,this._k=(1-t)/6}cy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:oy(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var fy=function e(t){function n(e){return new cy(e,t)}return n.tension=function(t){return e(+t)},n}(0);function dy(e,t,n){var r=e._x1,i=e._y1,o=e._x2,a=e._y2;if(e._l01_a>Eg){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>Eg){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*u+e._x1*e._l23_2a-t*e._l12_2a)/c,a=(a*u+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,o,a,e._x2,e._y2)}function hy(e,t){this._context=e,this._alpha=t}hy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:dy(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var py=function e(t){function n(e){return t?new hy(e,t):new ay(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function my(e,t){this._context=e,this._alpha=t}my.prototype={areaStart:Qg,areaEnd:Qg,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:dy(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var gy=function e(t){function n(e){return t?new my(e,t):new ly(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function yy(e,t){this._context=e,this._alpha=t}yy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:dy(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var vy=function e(t){function n(e){return t?new yy(e,t):new cy(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function by(e){this._context=e}function xy(e){return e<0?-1:1}function wy(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),a=(n-e._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(xy(o)+xy(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function ky(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function _y(e,t,n){var r=e._x0,i=e._y0,o=e._x1,a=e._y1,s=(o-r)/3;e._context.bezierCurveTo(r+s,i+s*t,o-s,a-s*n,o,a)}function Oy(e){this._context=e}function Ey(e){this._context=new Dy(e)}function Dy(e){this._context=e}function jy(e){this._context=e}function Ny(e){var t,n,r=e.length-1,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,o[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/o[t-1],o[t]-=n,a[t]-=n*a[t-1];for(i[r-1]=a[r-1]/o[r-1],t=r-2;t>=0;--t)i[t]=(a[t]-i[t+1])/o[t];for(o[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function Sy(e,t){this._context=e,this._t=t}function Ay(e,t){if("undefined"!=typeof document&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}by.prototype={areaStart:Qg,areaEnd:Qg,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},Oy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:_y(this,this._t0,ky(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,_y(this,ky(this,n=wy(this,e,t)),n);break;default:_y(this,this._t0,n=wy(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(Ey.prototype=Object.create(Oy.prototype)).point=function(e,t){Oy.prototype.point.call(this,t,e)},Dy.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}},jy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=Ny(e),i=Ny(t),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[a],t[a]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},Sy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};const $y=()=>"undefined"!=typeof Image?Image:null;function Cy(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function My(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}const Py=Symbol("implicit");function Fy(){var e=new ll,t=[],n=[],r=Py;function i(i){let o=e.get(i);if(void 0===o){if(r!==Py)return r;e.set(i,o=t.push(i)-1)}return n[o%n.length]}return i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new ll;for(const r of n)e.has(r)||e.set(r,t.push(r)-1);return i},i.range=function(e){return arguments.length?(n=Array.from(e),i):n.slice()},i.unknown=function(e){return arguments.length?(r=e,i):r},i.copy=function(){return Fy(t,n).unknown(r)},Cy.apply(i,arguments),i}function Ty(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function zy(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Ry(){}var Ly=.7,By=1/Ly,Iy="\\s*([+-]?\\d+)\\s*",Uy="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",qy="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Wy=/^#([0-9a-f]{3,8})$/,Zy=new RegExp(`^rgb\\(${Iy},${Iy},${Iy}\\)$`),Hy=new RegExp(`^rgb\\(${qy},${qy},${qy}\\)$`),Gy=new RegExp(`^rgba\\(${Iy},${Iy},${Iy},${Uy}\\)$`),Vy=new RegExp(`^rgba\\(${qy},${qy},${qy},${Uy}\\)$`),Yy=new RegExp(`^hsl\\(${Uy},${qy},${qy}\\)$`),Xy=new RegExp(`^hsla\\(${Uy},${qy},${qy},${Uy}\\)$`),Jy={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Qy(){return this.rgb().formatHex()}function Ky(){return this.rgb().formatRgb()}function ev(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Wy.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?tv(t):3===n?new ov(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?nv(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?nv(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Zy.exec(e))?new ov(t[1],t[2],t[3],1):(t=Hy.exec(e))?new ov(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Gy.exec(e))?nv(t[1],t[2],t[3],t[4]):(t=Vy.exec(e))?nv(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Yy.exec(e))?fv(t[1],t[2]/100,t[3]/100,1):(t=Xy.exec(e))?fv(t[1],t[2]/100,t[3]/100,t[4]):Jy.hasOwnProperty(e)?tv(Jy[e]):"transparent"===e?new ov(NaN,NaN,NaN,0):null}function tv(e){return new ov(e>>16&255,e>>8&255,255&e,1)}function nv(e,t,n,r){return r<=0&&(e=t=n=NaN),new ov(e,t,n,r)}function rv(e){return e instanceof Ry||(e=ev(e)),e?new ov((e=e.rgb()).r,e.g,e.b,e.opacity):new ov}function iv(e,t,n,r){return 1===arguments.length?rv(e):new ov(e,t,n,null==r?1:r)}function ov(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function av(){return`#${cv(this.r)}${cv(this.g)}${cv(this.b)}`}function sv(){const e=lv(this.opacity);return`${1===e?"rgb(":"rgba("}${uv(this.r)}, ${uv(this.g)}, ${uv(this.b)}${1===e?")":`, ${e})`}`}function lv(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function uv(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function cv(e){return((e=uv(e))<16?"0":"")+e.toString(16)}function fv(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new pv(e,t,n,r)}function dv(e){if(e instanceof pv)return new pv(e.h,e.s,e.l,e.opacity);if(e instanceof Ry||(e=ev(e)),!e)return new pv;if(e instanceof pv)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,l=(o+i)/2;return s?(a=t===o?(n-r)/s+6*(n<r):n===o?(r-t)/s+2:(t-n)/s+4,s/=l<.5?o+i:2-o-i,a*=60):s=l>0&&l<1?0:a,new pv(a,s,l,e.opacity)}function hv(e,t,n,r){return 1===arguments.length?dv(e):new pv(e,t,n,null==r?1:r)}function pv(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function mv(e){return(e=(e||0)%360)<0?e+360:e}function gv(e){return Math.max(0,Math.min(1,e||0))}function yv(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}Ty(Ry,ev,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Qy,formatHex:Qy,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return dv(this).formatHsl()},formatRgb:Ky,toString:Ky}),Ty(ov,iv,zy(Ry,{brighter(e){return e=null==e?By:Math.pow(By,e),new ov(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?Ly:Math.pow(Ly,e),new ov(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ov(uv(this.r),uv(this.g),uv(this.b),lv(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:av,formatHex:av,formatHex8:function(){return`#${cv(this.r)}${cv(this.g)}${cv(this.b)}${cv(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:sv,toString:sv})),Ty(pv,hv,zy(Ry,{brighter(e){return e=null==e?By:Math.pow(By,e),new pv(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?Ly:Math.pow(Ly,e),new pv(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new ov(yv(e>=240?e-240:e+120,i,r),yv(e,i,r),yv(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new pv(mv(this.h),gv(this.s),gv(this.l),lv(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=lv(this.opacity);return`${1===e?"hsl(":"hsla("}${mv(this.h)}, ${100*gv(this.s)}%, ${100*gv(this.l)}%${1===e?")":`, ${e})`}`}}));const vv=Math.PI/180,bv=180/Math.PI,xv=.96422,wv=1,kv=.82521,_v=4/29,Ov=6/29,Ev=3*Ov*Ov,Dv=Ov*Ov*Ov;function jv(e){if(e instanceof Sv)return new Sv(e.l,e.a,e.b,e.opacity);if(e instanceof Fv)return Tv(e);e instanceof ov||(e=rv(e));var t,n,r=Mv(e.r),i=Mv(e.g),o=Mv(e.b),a=Av((.2225045*r+.7168786*i+.0606169*o)/wv);return r===i&&i===o?t=n=a:(t=Av((.4360747*r+.3850649*i+.1430804*o)/xv),n=Av((.0139322*r+.0971045*i+.7141733*o)/kv)),new Sv(116*a-16,500*(t-a),200*(a-n),e.opacity)}function Nv(e,t,n,r){return 1===arguments.length?jv(e):new Sv(e,t,n,null==r?1:r)}function Sv(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function Av(e){return e>Dv?Math.pow(e,1/3):e/Ev+_v}function $v(e){return e>Ov?e*e*e:Ev*(e-_v)}function Cv(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Mv(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Pv(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof Fv)return new Fv(e.h,e.c,e.l,e.opacity);if(e instanceof Sv||(e=jv(e)),0===e.a&&0===e.b)return new Fv(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*bv;return new Fv(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}(e):new Fv(e,t,n,null==r?1:r)}function Fv(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function Tv(e){if(isNaN(e.h))return new Sv(e.l,0,0,e.opacity);var t=e.h*vv;return new Sv(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Ty(Sv,Nv,zy(Ry,{brighter(e){return new Sv(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker(e){return new Sv(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new ov(Cv(3.1338561*(t=xv*$v(t))-1.6168667*(e=wv*$v(e))-.4906146*(n=kv*$v(n))),Cv(-.9787684*t+1.9161415*e+.033454*n),Cv(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),Ty(Fv,Pv,zy(Ry,{brighter(e){return new Fv(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker(e){return new Fv(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb(){return Tv(this).rgb()}}));var zv=-.14861,Rv=1.78277,Lv=-.29227,Bv=-.90649,Iv=1.97294,Uv=Iv*Bv,qv=Iv*Rv,Wv=Rv*Lv-Bv*zv;function Zv(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof Hv)return new Hv(e.h,e.s,e.l,e.opacity);e instanceof ov||(e=rv(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(Wv*r+Uv*t-qv*n)/(Wv+Uv-qv),o=r-i,a=(Iv*(n-i)-Lv*o)/Bv,s=Math.sqrt(a*a+o*o)/(Iv*i*(1-i)),l=s?Math.atan2(a,o)*bv-120:NaN;return new Hv(l<0?l+360:l,s,i,e.opacity)}(e):new Hv(e,t,n,null==r?1:r)}function Hv(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function Gv(e,t,n,r,i){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*r+a*i)/6}function Vv(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],a=r>0?e[r-1]:2*i-o,s=r<t-1?e[r+2]:2*o-i;return Gv((n-r/t)*t,a,i,o,s)}}function Yv(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],a=e[(r+1)%t],s=e[(r+2)%t];return Gv((n-r/t)*t,i,o,a,s)}}Ty(Hv,Zv,zy(Ry,{brighter(e){return e=null==e?By:Math.pow(By,e),new Hv(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?Ly:Math.pow(Ly,e),new Hv(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*vv,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new ov(255*(t+n*(zv*r+Rv*i)),255*(t+n*(Lv*r+Bv*i)),255*(t+n*(Iv*r)),this.opacity)}}));var Xv=e=>()=>e;function Jv(e,t){return function(n){return e+n*t}}function Qv(e,t){var n=t-e;return n?Jv(e,n>180||n<-180?n-360*Math.round(n/360):n):Xv(isNaN(e)?t:e)}function Kv(e){return 1==(e=+e)?eb:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):Xv(isNaN(t)?n:t)}}function eb(e,t){var n=t-e;return n?Jv(e,n):Xv(isNaN(e)?t:e)}var tb=function e(t){var n=Kv(t);function r(e,t){var r=n((e=iv(e)).r,(t=iv(t)).r),i=n(e.g,t.g),o=n(e.b,t.b),a=eb(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=o(t),e.opacity=a(t),e+""}}return r.gamma=e,r}(1);function nb(e){return function(t){var n,r,i=t.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=iv(t[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=e(o),a=e(a),s=e(s),r.opacity=1,function(e){return r.r=o(e),r.g=a(e),r.b=s(e),r+""}}}var rb=nb(Vv),ib=nb(Yv);function ob(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(o){for(n=0;n<r;++n)i[n]=e[n]*(1-o)+t[n]*o;return i}}function ab(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function sb(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=pb(e[n],t[n]);for(;n<r;++n)a[n]=t[n];return function(e){for(n=0;n<i;++n)a[n]=o[n](e);return a}}function lb(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function ub(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function cb(e,t){var n,r={},i={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?r[n]=pb(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}var fb=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,db=new RegExp(fb.source,"g");function hb(e,t){var n,r,i,o=fb.lastIndex=db.lastIndex=0,a=-1,s=[],l=[];for(e+="",t+="";(n=fb.exec(e))&&(r=db.exec(t));)(i=r.index)>o&&(i=t.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,l.push({i:a,x:ub(n,r)})),o=db.lastIndex;return o<t.length&&(i=t.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,r=0;r<t;++r)s[(n=l[r]).i]=n.x(e);return s.join("")})}function pb(e,t){var n,r=typeof t;return null==t||"boolean"===r?Xv(t):("number"===r?ub:"string"===r?(n=ev(t))?(t=n,tb):hb:t instanceof ev?tb:t instanceof Date?lb:ab(t)?ob:Array.isArray(t)?sb:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?cb:ub)(e,t)}function mb(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var gb,yb=180/Math.PI,vb={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function bb(e,t,n,r,i,o){var a,s,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*yb,skewX:Math.atan(l)*yb,scaleX:a,scaleY:s}}function xb(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}return function(o,a){var s=[],l=[];return o=e(o),a=e(a),function(e,r,i,o,a,s){if(e!==i||r!==o){var l=a.push("translate(",null,t,null,n);s.push({i:l-4,x:ub(e,i)},{i:l-2,x:ub(r,o)})}else(i||o)&&a.push("translate("+i+t+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,l),function(e,t,n,o){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:ub(e,t)})):t&&n.push(i(n)+"rotate("+t+r)}(o.rotate,a.rotate,s,l),function(e,t,n,o){e!==t?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:ub(e,t)}):t&&n.push(i(n)+"skewX("+t+r)}(o.skewX,a.skewX,s,l),function(e,t,n,r,o,a){if(e!==n||t!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:ub(e,n)},{i:s-2,x:ub(t,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,l),o=a=null,function(e){for(var t,n=-1,r=l.length;++n<r;)s[(t=l[n]).i]=t.x(e);return s.join("")}}}var wb=xb((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?vb:bb(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),kb=xb((function(e){return null==e?vb:(gb||(gb=document.createElementNS("http://www.w3.org/2000/svg","g")),gb.setAttribute("transform",e),(e=gb.transform.baseVal.consolidate())?bb((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):vb)}),", ",")",")");function _b(e){return((e=Math.exp(e))+1/e)/2}var Ob=function e(t,n,r){function i(e,i){var o,a,s=e[0],l=e[1],u=e[2],c=i[0],f=i[1],d=i[2],h=c-s,p=f-l,m=h*h+p*p;if(m<1e-12)a=Math.log(d/u)/t,o=function(e){return[s+e*h,l+e*p,u*Math.exp(t*e*a)]};else{var g=Math.sqrt(m),y=(d*d-u*u+r*m)/(2*u*n*g),v=(d*d-u*u-r*m)/(2*d*n*g),b=Math.log(Math.sqrt(y*y+1)-y),x=Math.log(Math.sqrt(v*v+1)-v);a=(x-b)/t,o=function(e){var r=e*a,i=_b(b),o=u/(n*g)*(i*function(e){return((e=Math.exp(2*e))-1)/(e+1)}(t*r+b)-function(e){return((e=Math.exp(e))-1/e)/2}(b));return[s+o*h,l+o*p,u*i/_b(t*r+b)]}}return o.duration=1e3*a*t/Math.SQRT2,o}return i.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},i}(Math.SQRT2,2,4);function Eb(e){return function(t,n){var r=e((t=hv(t)).h,(n=hv(n)).h),i=eb(t.s,n.s),o=eb(t.l,n.l),a=eb(t.opacity,n.opacity);return function(e){return t.h=r(e),t.s=i(e),t.l=o(e),t.opacity=a(e),t+""}}}var Db=Eb(Qv),jb=Eb(eb);function Nb(e){return function(t,n){var r=e((t=Pv(t)).h,(n=Pv(n)).h),i=eb(t.c,n.c),o=eb(t.l,n.l),a=eb(t.opacity,n.opacity);return function(e){return t.h=r(e),t.c=i(e),t.l=o(e),t.opacity=a(e),t+""}}}var Sb=Nb(Qv),Ab=Nb(eb);function $b(e){return function t(n){function r(t,r){var i=e((t=Zv(t)).h,(r=Zv(r)).h),o=eb(t.s,r.s),a=eb(t.l,r.l),s=eb(t.opacity,r.opacity);return function(e){return t.h=i(e),t.s=o(e),t.l=a(Math.pow(e,n)),t.opacity=s(e),t+""}}return n=+n,r.gamma=t,r}(1)}var Cb=$b(Qv),Mb=$b(eb);function Pb(e,t){void 0===t&&(t=e,e=pb);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return o[t](e-t)}}var Fb=Object.freeze({__proto__:null,interpolate:pb,interpolateArray:function(e,t){return(ab(t)?ob:sb)(e,t)},interpolateBasis:Vv,interpolateBasisClosed:Yv,interpolateCubehelix:Cb,interpolateCubehelixLong:Mb,interpolateDate:lb,interpolateDiscrete:function(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}},interpolateHcl:Sb,interpolateHclLong:Ab,interpolateHsl:Db,interpolateHslLong:jb,interpolateHue:function(e,t){var n=Qv(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}},interpolateLab:function(e,t){var n=eb((e=Nv(e)).l,(t=Nv(t)).l),r=eb(e.a,t.a),i=eb(e.b,t.b),o=eb(e.opacity,t.opacity);return function(t){return e.l=n(t),e.a=r(t),e.b=i(t),e.opacity=o(t),e+""}},interpolateNumber:ub,interpolateNumberArray:ob,interpolateObject:cb,interpolateRgb:tb,interpolateRgbBasis:rb,interpolateRgbBasisClosed:ib,interpolateRound:mb,interpolateString:hb,interpolateTransformCss:wb,interpolateTransformSvg:kb,interpolateZoom:Ob,piecewise:Pb,quantize:function(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}});function Tb(e){return+e}var zb=[0,1];function Rb(e){return e}function Lb(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function Bb(e,t,n){var r=e[0],i=e[1],o=t[0],a=t[1];return i<r?(r=Lb(i,r),o=n(a,o)):(r=Lb(r,i),o=n(o,a)),function(e){return o(r(e))}}function Ib(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=Lb(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(t){var n=al(e,t,1,r)-1;return o[n](i[n](t))}}function Ub(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function qb(){var e,t,n,r,i,o,a=zb,s=zb,l=pb,u=Rb;function c(){var e=Math.min(a.length,s.length);return u!==Rb&&(u=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(a[0],a[e-1])),r=e>2?Ib:Bb,i=o=null,f}function f(t){return null==t||isNaN(t=+t)?n:(i||(i=r(a.map(e),s,l)))(e(u(t)))}return f.invert=function(n){return u(t((o||(o=r(s,a.map(e),ub)))(n)))},f.domain=function(e){return arguments.length?(a=Array.from(e,Tb),c()):a.slice()},f.range=function(e){return arguments.length?(s=Array.from(e),c()):s.slice()},f.rangeRound=function(e){return s=Array.from(e),l=mb,c()},f.clamp=function(e){return arguments.length?(u=!!e||Rb,c()):u!==Rb},f.interpolate=function(e){return arguments.length?(l=e,c()):l},f.unknown=function(e){return arguments.length?(n=e,f):n},function(n,r){return e=n,t=r,c()}}function Wb(){return qb()(Rb,Rb)}function Zb(e,t,n,r){var i,o=wl(e,t,n);switch((r=Tl(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(i=Vl(o,a))||(r.precision=i),ql(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=Yl(o,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=Gl(o))||(r.precision=i-2*("%"===r.type))}return Ul(r)}function Hb(e){var t=e.domain;return e.ticks=function(e){var n=t();return bl(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return Zb(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,i,o=t(),a=0,s=o.length-1,l=o[a],u=o[s],c=10;for(u<l&&(i=l,l=u,u=i,i=a,a=s,s=i);c-- >0;){if((i=xl(l,u,n))===r)return o[a]=l,o[s]=u,t(o);if(i>0)l=Math.floor(l/i)*i,u=Math.ceil(u/i)*i;else{if(!(i<0))break;l=Math.ceil(l*i)/i,u=Math.floor(u*i)/i}r=i}return e},e}function Gb(e,t){var n,r=0,i=(e=e.slice()).length-1,o=e[r],a=e[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),e[r]=t.floor(o),e[i]=t.ceil(a),e}function Vb(e){return Math.log(e)}function Yb(e){return Math.exp(e)}function Xb(e){return-Math.log(-e)}function Jb(e){return-Math.exp(-e)}function Qb(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Kb(e){return(t,n)=>-e(-t,n)}function ex(e){const t=e(Vb,Yb),n=t.domain;let r,i,o=10;function a(){return r=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}(o),i=function(e){return 10===e?Qb:e===Math.E?Math.exp:t=>Math.pow(e,t)}(o),n()[0]<0?(r=Kb(r),i=Kb(i),e(Xb,Jb)):e(Vb,Yb),t}return t.base=function(e){return arguments.length?(o=+e,a()):o},t.domain=function(e){return arguments.length?(n(e),a()):n()},t.ticks=e=>{const t=n();let a=t[0],s=t[t.length-1];const l=s<a;l&&([a,s]=[s,a]);let u,c,f=r(a),d=r(s);const h=null==e?10:+e;let p=[];if(!(o%1)&&d-f<h){if(f=Math.floor(f),d=Math.ceil(d),a>0){for(;f<=d;++f)for(u=1;u<o;++u)if(c=f<0?u/i(-f):u*i(f),!(c<a)){if(c>s)break;p.push(c)}}else for(;f<=d;++f)for(u=o-1;u>=1;--u)if(c=f>0?u/i(-f):u*i(f),!(c<a)){if(c>s)break;p.push(c)}2*p.length<h&&(p=bl(a,s,h))}else p=bl(f,d,Math.min(d-f,h)).map(i);return l?p.reverse():p},t.tickFormat=(e,n)=>{if(null==e&&(e=10),null==n&&(n=10===o?"s":","),"function"!=typeof n&&(o%1||null!=(n=Tl(n)).precision||(n.trim=!0),n=Ul(n)),e===1/0)return n;const a=Math.max(1,o*e/t.ticks().length);return e=>{let t=e/i(Math.round(r(e)));return t*o<o-.5&&(t*=o),t<=a?n(e):""}},t.nice=()=>n(Gb(n(),{floor:e=>i(Math.floor(r(e))),ceil:e=>i(Math.ceil(r(e)))})),t}function tx(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function nx(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function rx(e){var t=1,n=e(tx(t),nx(t));return n.constant=function(n){return arguments.length?e(tx(t=+n),nx(t)):t},Hb(n)}function ix(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function ox(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function ax(e){return e<0?-e*e:e*e}function sx(e){var t=e(Rb,Rb),n=1;return t.exponent=function(t){return arguments.length?1===(n=+t)?e(Rb,Rb):.5===n?e(ox,ax):e(ix(n),ix(1/n)):n},Hb(t)}function lx(){var e=sx(qb());return e.copy=function(){return Ub(e,lx()).exponent(e.exponent())},Cy.apply(e,arguments),e}function ux(e){return new Date(e)}function cx(e){return e instanceof Date?+e:+new Date(+e)}function fx(e,t,n,r,i,o,a,s,l,u){var c=Wb(),f=c.invert,d=c.domain,h=u(".%L"),p=u(":%S"),m=u("%I:%M"),g=u("%I %p"),y=u("%a %d"),v=u("%b %d"),b=u("%B"),x=u("%Y");function w(e){return(l(e)<e?h:s(e)<e?p:a(e)<e?m:o(e)<e?g:r(e)<e?i(e)<e?y:v:n(e)<e?b:x)(e)}return c.invert=function(e){return new Date(f(e))},c.domain=function(e){return arguments.length?d(Array.from(e,cx)):d().map(ux)},c.ticks=function(t){var n=d();return e(n[0],n[n.length-1],null==t?10:t)},c.tickFormat=function(e,t){return null==t?w:u(t)},c.nice=function(e){var n=d();return e&&"function"==typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?d(Gb(n,e)):c},c.copy=function(){return Ub(c,fx(e,t,n,r,i,o,a,s,l,u))},c}function dx(){var e,t,n,r,i,o=0,a=1,s=Rb,l=!1;function u(t){return null==t||isNaN(t=+t)?i:s(0===n?.5:(t=(r(t)-e)*n,l?Math.max(0,Math.min(1,t)):t))}function c(e){return function(t){var n,r;return arguments.length?([n,r]=t,s=e(n,r),u):[s(0),s(1)]}}return u.domain=function(i){return arguments.length?([o,a]=i,e=r(o=+o),t=r(a=+a),n=e===t?0:1/(t-e),u):[o,a]},u.clamp=function(e){return arguments.length?(l=!!e,u):l},u.interpolator=function(e){return arguments.length?(s=e,u):s},u.range=c(pb),u.rangeRound=c(mb),u.unknown=function(e){return arguments.length?(i=e,u):i},function(i){return r=i,e=i(o),t=i(a),n=e===t?0:1/(t-e),u}}function hx(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function px(){var e=Hb(dx()(Rb));return e.copy=function(){return hx(e,px())},My.apply(e,arguments)}function mx(){var e=sx(dx());return e.copy=function(){return hx(e,mx()).exponent(e.exponent())},My.apply(e,arguments)}function gx(){var e,t,n,r,i,o,a,s=0,l=.5,u=1,c=1,f=Rb,d=!1;function h(e){return isNaN(e=+e)?a:(e=.5+((e=+o(e))-t)*(c*e<c*t?r:i),f(d?Math.max(0,Math.min(1,e)):e))}function p(e){return function(t){var n,r,i;return arguments.length?([n,r,i]=t,f=Pb(e,[n,r,i]),h):[f(0),f(.5),f(1)]}}return h.domain=function(a){return arguments.length?([s,l,u]=a,e=o(s=+s),t=o(l=+l),n=o(u=+u),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),c=t<e?-1:1,h):[s,l,u]},h.clamp=function(e){return arguments.length?(d=!!e,h):d},h.interpolator=function(e){return arguments.length?(f=e,h):f},h.range=p(pb),h.rangeRound=p(mb),h.unknown=function(e){return arguments.length?(a=e,h):a},function(a){return o=a,e=a(s),t=a(l),n=a(u),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),c=t<e?-1:1,h}}function yx(){var e=sx(gx());return e.copy=function(){return hx(e,yx()).exponent(e.exponent())},My.apply(e,arguments)}function vx(e,t,n){const r=e-t+2*n;return e?r>0?r:1:0}const bx="linear",xx="log",wx="pow",kx="sqrt",_x="symlog",Ox="time",Ex="utc",Dx="sequential",jx="diverging",Nx="quantile",Sx="quantize",Ax="threshold",$x="ordinal",Cx="point",Mx="band",Px="bin-ordinal",Fx="continuous",Tx="discrete",zx="discretizing",Rx="interpolating",Lx="temporal";function Bx(){const e=Fy().unknown(void 0),t=e.domain,n=e.range;let r,i,o=[0,1],a=!1,s=0,l=0,u=.5;function c(){const e=t().length,c=o[1]<o[0],f=o[1-c],d=vx(e,s,l);let h=o[c-0];r=(f-h)/(d||1),a&&(r=Math.floor(r)),h+=(f-h-r*(e-s))*u,i=r*(1-s),a&&(h=Math.round(h),i=Math.round(i));const p=Al(e).map((e=>h+r*e));return n(c?p.reverse():p)}return delete e.unknown,e.domain=function(e){return arguments.length?(t(e),c()):t()},e.range=function(e){return arguments.length?(o=[+e[0],+e[1]],c()):o.slice()},e.rangeRound=function(e){return o=[+e[0],+e[1]],a=!0,c()},e.bandwidth=function(){return i},e.step=function(){return r},e.round=function(e){return arguments.length?(a=!!e,c()):a},e.padding=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),s=l,c()):s},e.paddingInner=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),c()):s},e.paddingOuter=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),c()):l},e.align=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),c()):u},e.invertRange=function(e){if(null==e[0]||null==e[1])return;const r=o[1]<o[0],a=r?n().reverse():n(),s=a.length-1;let l,u,c,f=+e[0],d=+e[1];return f!=f||d!=d||(d<f&&(c=f,f=d,d=c),d<a[0]||f>o[1-r])?void 0:(l=Math.max(0,il(a,f)-1),u=f===d?l:il(a,d)-1,f-a[l]>i+1e-10&&++l,r&&(c=l,l=s-u,u=s-c),l>u?void 0:t().slice(l,u+1))},e.invert=function(t){const n=e.invertRange([t,t]);return n?n[0]:n},e.copy=function(){return Bx().domain(t()).range(o).round(a).paddingInner(s).paddingOuter(l).align(u)},c()}function Ix(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return Ix(t())},e}var Ux=Array.prototype.map;const qx=Array.prototype.slice;const Wx=new Map,Zx=Symbol("vega_scale");function Hx(e){return e[Zx]=!0,e}function Gx(e,t,n){return arguments.length>1?(Wx.set(e,function(e,t,n){const r=function(){const n=t();return n.invertRange||(n.invertRange=n.invert?function(e){return function(t){let n,r=t[0],i=t[1];return i<r&&(n=r,r=i,i=n),[e.invert(r),e.invert(i)]}}(n):n.invertExtent?function(e){return function(t){const n=e.range();let r,i,o,a,s=t[0],l=t[1],u=-1;for(l<s&&(i=s,s=l,l=i),o=0,a=n.length;o<a;++o)n[o]>=s&&n[o]<=l&&(u<0&&(u=o),r=o);if(!(u<0))return s=e.invertExtent(n[u]),l=e.invertExtent(n[r]),[void 0===s[0]?s[1]:s[0],void 0===l[1]?l[0]:l[1]]}}(n):void 0),n.type=e,Hx(n)};return r.metadata=Cs(Ga(n)),r}(e,t,n)),this):Vx(e)?Wx.get(e):void 0}function Vx(e){return Wx.has(e)}function Yx(e,t){const n=Wx.get(e);return n&&n.metadata[t]}function Xx(e){return Yx(e,Fx)}function Jx(e){return Yx(e,Tx)}function Qx(e){return Yx(e,zx)}function Kx(e){return Yx(e,xx)}function ew(e){return Yx(e,Rx)}function tw(e){return Yx(e,Nx)}Gx("identity",(function e(t){var n;function r(e){return null==e||isNaN(e=+e)?n:e}return r.invert=r,r.domain=r.range=function(e){return arguments.length?(t=Array.from(e,Tb),r):t.slice()},r.unknown=function(e){return arguments.length?(n=e,r):n},r.copy=function(){return e(t).unknown(n)},t=arguments.length?Array.from(t,Tb):[0,1],Hb(r)})),Gx(bx,(function e(){var t=Wb();return t.copy=function(){return Ub(t,e())},Cy.apply(t,arguments),Hb(t)}),Fx),Gx(xx,(function e(){const t=ex(qb()).domain([1,10]);return t.copy=()=>Ub(t,e()).base(t.base()),Cy.apply(t,arguments),t}),[Fx,xx]),Gx(wx,lx,Fx),Gx(kx,(function(){return lx.apply(null,arguments).exponent(.5)}),Fx),Gx(_x,(function e(){var t=rx(qb());return t.copy=function(){return Ub(t,e()).constant(t.constant())},Cy.apply(t,arguments)}),Fx),Gx(Ox,(function(){return Cy.apply(fx(Ru,Lu,Mu,$u,gu,du,cu,lu,su,ef).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}),[Fx,Lx]),Gx(Ex,(function(){return Cy.apply(fx(Tu,zu,Pu,Cu,Ou,hu,fu,uu,su,nf).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}),[Fx,Lx]),Gx(Dx,px,[Fx,Rx]),Gx(`${Dx}-${bx}`,px,[Fx,Rx]),Gx(`${Dx}-${xx}`,(function e(){var t=ex(dx()).domain([1,10]);return t.copy=function(){return hx(t,e()).base(t.base())},My.apply(t,arguments)}),[Fx,Rx,xx]),Gx(`${Dx}-${wx}`,mx,[Fx,Rx]),Gx(`${Dx}-${kx}`,(function(){return mx.apply(null,arguments).exponent(.5)}),[Fx,Rx]),Gx(`${Dx}-${_x}`,(function e(){var t=rx(dx());return t.copy=function(){return hx(t,e()).constant(t.constant())},My.apply(t,arguments)}),[Fx,Rx]),Gx(`${jx}-${bx}`,(function e(){var t=Hb(gx()(Rb));return t.copy=function(){return hx(t,e())},My.apply(t,arguments)}),[Fx,Rx]),Gx(`${jx}-${xx}`,(function e(){var t=ex(gx()).domain([.1,1,10]);return t.copy=function(){return hx(t,e()).base(t.base())},My.apply(t,arguments)}),[Fx,Rx,xx]),Gx(`${jx}-${wx}`,yx,[Fx,Rx]),Gx(`${jx}-${kx}`,(function(){return yx.apply(null,arguments).exponent(.5)}),[Fx,Rx]),Gx(`${jx}-${_x}`,(function e(){var t=rx(gx());return t.copy=function(){return hx(t,e()).constant(t.constant())},My.apply(t,arguments)}),[Fx,Rx]),Gx(Nx,(function e(){var t,n=[],r=[],i=[];function o(){var e=0,t=Math.max(1,r.length);for(i=new Array(t-1);++e<t;)i[e-1]=jl(n,e/t);return a}function a(e){return null==e||isNaN(e=+e)?t:r[al(i,e)]}return a.invertExtent=function(e){var t=r.indexOf(e);return t<0?[NaN,NaN]:[t>0?i[t-1]:n[0],t<i.length?i[t]:n[n.length-1]]},a.domain=function(e){if(!arguments.length)return n.slice();n=[];for(let t of e)null==t||isNaN(t=+t)||n.push(t);return n.sort(Qs),o()},a.range=function(e){return arguments.length?(r=Array.from(e),o()):r.slice()},a.unknown=function(e){return arguments.length?(t=e,a):t},a.quantiles=function(){return i.slice()},a.copy=function(){return e().domain(n).range(r).unknown(t)},Cy.apply(a,arguments)}),[zx,Nx]),Gx(Sx,(function e(){var t,n=0,r=1,i=1,o=[.5],a=[0,1];function s(e){return null!=e&&e<=e?a[al(o,e,0,i)]:t}function l(){var e=-1;for(o=new Array(i);++e<i;)o[e]=((e+1)*r-(e-i)*n)/(i+1);return s}return s.domain=function(e){return arguments.length?([n,r]=e,n=+n,r=+r,l()):[n,r]},s.range=function(e){return arguments.length?(i=(a=Array.from(e)).length-1,l()):a.slice()},s.invertExtent=function(e){var t=a.indexOf(e);return t<0?[NaN,NaN]:t<1?[n,o[0]]:t>=i?[o[i-1],r]:[o[t-1],o[t]]},s.unknown=function(e){return arguments.length?(t=e,s):s},s.thresholds=function(){return o.slice()},s.copy=function(){return e().domain([n,r]).range(a).unknown(t)},Cy.apply(Hb(s),arguments)}),zx),Gx(Ax,(function e(){var t,n=[.5],r=[0,1],i=1;function o(e){return null!=e&&e<=e?r[al(n,e,0,i)]:t}return o.domain=function(e){return arguments.length?(n=Array.from(e),i=Math.min(n.length,r.length-1),o):n.slice()},o.range=function(e){return arguments.length?(r=Array.from(e),i=Math.min(n.length,r.length-1),o):r.slice()},o.invertExtent=function(e){var t=r.indexOf(e);return[n[t-1],n[t]]},o.unknown=function(e){return arguments.length?(t=e,o):t},o.copy=function(){return e().domain(n).range(r).unknown(t)},Cy.apply(o,arguments)}),zx),Gx(Px,(function e(){let t=[],n=[];function r(e){return null==e||e!=e?void 0:n[(al(t,e)-1)%n.length]}return r.domain=function(e){return arguments.length?(t=function(e){return Ux.call(e,Sa)}(e),r):t.slice()},r.range=function(e){return arguments.length?(n=qx.call(e),r):n.slice()},r.tickFormat=function(e,n){return Zb(t[0],Na(t),null==e?10:e,n)},r.copy=function(){return e().domain(r.domain()).range(r.range())},r}),[Tx,zx]),Gx($x,Fy,Tx),Gx(Mx,Bx,Tx),Gx(Cx,(function(){return Ix(Bx().paddingInner(1))}),Tx);const nw=["clamp","base","constant","exponent"];function rw(e,t){const n=t[0],r=Na(t)-n;return function(t){return e(n+t*r)}}function iw(e,t,n){return Pb(sw(t||"rgb",n),e)}function ow(e,t){const n=new Array(t),r=t+1;for(let i=0;i<t;)n[i]=e(++i/r);return n}function aw(e,t,n){const r=n-t;let i,o,a;return r&&Number.isFinite(r)?(i=(o=e.type).indexOf("-"),o=i<0?o:o.slice(i+1),a=Gx(o)().domain([t,n]).range([0,1]),nw.forEach((t=>e[t]?a[t](e[t]()):0)),a):ns(.5)}function sw(e,t){const n=Fb[function(e){return"interpolate"+e.toLowerCase().split("-").map((e=>e[0].toUpperCase()+e.slice(1))).join("")}(e)];return null!=t&&n&&n.gamma?n.gamma(t):n}function lw(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n}function uw(e,t){for(const n in e)fw(n,t(e[n]))}const cw={};function fw(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(cw[e]=t,this):cw[e]}uw({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},lw),uw({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(e=>iw(lw(e))));const dw="symbol",hw="discrete",pw=e=>ka(e)?e.map((e=>String(e))):String(e),mw=(e,t)=>e[1]-t[1],gw=(e,t)=>t[1]-e[1];function yw(e,t,n){let r;return ys(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),null!=n&&(t=Math.min(t,Math.floor(Ds(e.domain())/n||1)))),_a(t)&&(r=t.step,t=t.interval),bs(t)&&(t=e.type===Ox?Dc(t):e.type==Ex?jc(t):aa("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function vw(e,t,n){let r=e.range(),i=r[0],o=Na(r),a=mw;if(i>o&&(r=o,o=i,i=r,a=gw),i=Math.floor(i),o=Math.ceil(o),t=t.map((t=>[t,e(t)])).filter((e=>i<=e[1]&&e[1]<=o)).sort(a).map((e=>e[0])),n>0&&t.length>1){const e=[t[0],Na(t)];for(;t.length>n&&t.length>=3;)t=t.filter(((e,t)=>!(t%2)));t.length<3&&(t=e)}return t}function bw(e,t){return e.bins?vw(e,e.bins):e.ticks?e.ticks(t):e.domain()}function xw(e,t,n,r,i,o){const a=t.type;let s=pw;if(a===Ox||i===Ox)s=e.timeFormat(r);else if(a===Ex||i===Ex)s=e.utcFormat(r);else if(Kx(a)){const i=e.formatFloat(r);if(o||t.bins)s=i;else{const e=ww(t,n,!1);s=t=>e(t)?i(t):""}}else if(t.tickFormat){const i=t.domain();s=e.formatSpan(i[0],i[i.length-1],n,r)}else r&&(s=e.format(r));return s}function ww(e,t,n){const r=bw(e,t),i=e.base(),o=Math.log(i),a=Math.max(1,i*t/r.length),s=e=>{let t=e/Math.pow(i,Math.round(Math.log(e)/o));return t*i<i-.5&&(t*=i),t<=a};return n?r.filter(s):s}const kw={[Nx]:"quantiles",[Sx]:"thresholds",[Ax]:"domain"},_w={[Nx]:"quantiles",[Sx]:"domain"};function Ow(e,t){return e.bins?function(e){const t=e.slice(0,-1);return t.max=Na(e),t}(e.bins):e.type===xx?ww(e,t,!0):kw[e.type]?function(e){const t=[-1/0].concat(e);return t.max=1/0,t}(e[kw[e.type]]()):bw(e,t)}const Ew=e=>kw[e.type]||e.bins;function Dw(e,t,n,r,i,o,a){const s=_w[t.type]&&o!==Ox&&o!==Ex?function(e,t,n){const r=t[_w[t.type]](),i=r.length;let o,a=i>1?r[1]-r[0]:r[0];for(o=1;o<i;++o)a=Math.min(a,r[o]-r[o-1]);return e.formatSpan(0,a,30,n)}(e,t,i):xw(e,t,n,i,o,a);return r===dw&&Ew(t)?jw(s):r===hw?Sw(s):Aw(s)}const jw=e=>(t,n,r)=>{const i=Nw(r[n+1],Nw(r.max,1/0)),o=$w(t,e),a=$w(i,e);return o&&a?o+" \u2013 "+a:a?"< "+a:"\u2265 "+o},Nw=(e,t)=>null!=e?e:t,Sw=e=>(t,n)=>n?e(t):null,Aw=e=>t=>e(t),$w=(e,t)=>Number.isFinite(e)?t(e):null;function Cw(e,t,n,r){const i=r||t.type;return bs(n)&&function(e){return Yx(e,Lx)}(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||i!==Ox?n||i!==Ex?Dw(e,t,5,null,n,r,!0):e.utcFormat("%A, %d %B %Y, %X UTC"):e.timeFormat("%A, %d %B %Y, %X")}function Mw(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=Cw(e,t,n.format,n.formatType);if(Qx(t.type)){const e=Ow(t).slice(1).map(i),n=e.length;return`${n} boundar${1===n?"y":"ies"}: ${e.join(", ")}`}if(Jx(t.type)){const e=t.domain(),n=e.length;return`${n} value${1===n?"":"s"}: ${n>r?e.slice(0,r-2).map(i).join(", ")+", ending with "+e.slice(-1).map(i):e.map(i).join(", ")}`}{const e=t.domain();return`values from ${i(e[0])} to ${i(Na(e))}`}}let Pw=0;const Fw="p_";function Tw(e){return e&&e.gradient}function zw(e,t,n){const r=e.gradient;let i=e.id,o="radial"===r?Fw:"";return i||(i=e.id="gradient_"+Pw++,"radial"===r?(e.x1=Rw(e.x1,.5),e.y1=Rw(e.y1,.5),e.r1=Rw(e.r1,0),e.x2=Rw(e.x2,.5),e.y2=Rw(e.y2,.5),e.r2=Rw(e.r2,.5),o=Fw):(e.x1=Rw(e.x1,0),e.y1=Rw(e.y1,0),e.x2=Rw(e.x2,1),e.y2=Rw(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+o+i+")"}function Rw(e,t){return null!=e?e:t}function Lw(e,t){var n,r=[];return n={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:r,stop:function(e,t){return r.push({offset:e,color:t}),n}}}const Bw={basis:{curve:function(e){return new ey(e)}},"basis-closed":{curve:function(e){return new ty(e)}},"basis-open":{curve:function(e){return new ny(e)}},bundle:{curve:iy,tension:"beta",value:.85},cardinal:{curve:sy,tension:"tension",value:0},"cardinal-open":{curve:fy,tension:"tension",value:0},"cardinal-closed":{curve:uy,tension:"tension",value:0},"catmull-rom":{curve:py,tension:"alpha",value:.5},"catmull-rom-closed":{curve:gy,tension:"alpha",value:.5},"catmull-rom-open":{curve:vy,tension:"alpha",value:.5},linear:{curve:Hg},"linear-closed":{curve:function(e){return new by(e)}},monotone:{horizontal:function(e){return new Ey(e)},vertical:function(e){return new Oy(e)}},natural:{curve:function(e){return new jy(e)}},step:{curve:function(e){return new Sy(e,.5)}},"step-after":{curve:function(e){return new Sy(e,1)}},"step-before":{curve:function(e){return new Sy(e,0)}}};function Iw(e,t,n){var r=ls(Bw,e)&&Bw[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}const Uw={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},qw=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,Ww=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,Zw=/^((\s+,?\s*)|(,\s*))/,Hw=/^[01]/;function Gw(e){const t=[];return(e.match(qw)||[]).forEach((e=>{let n=e[0];const r=n.toLowerCase(),i=Uw[r],o=function(e,t,n){const r=[];for(let i=0;t&&i<n.length;)for(let o=0;o<t;++o){const t="a"!==e||3!==o&&4!==o?Ww:Hw,a=n.slice(i).match(t);if(null===a)throw Error("Invalid SVG path, incorrect parameter type");i+=a[0].length,r.push(+a[0]);const s=n.slice(i).match(Zw);null!==s&&(i+=s[0].length)}return r}(r,i,e.slice(1).trim()),a=o.length;if(a<i||a&&a%i!=0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([n,...o.slice(0,i)]),a!==i){"m"===r&&(n="M"===n?"L":"l");for(let e=i;e<a;e+=i)t.push([n,...o.slice(e,e+i)])}})),t}const Vw=Math.PI/180,Yw=Math.PI/2,Xw=2*Math.PI,Jw=Math.sqrt(3)/2;var Qw={},Kw={},ek=[].join;function tk(e){const t=ek.call(e);if(Kw[t])return Kw[t];var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7];const c=u*a,f=-l*s,d=l*a,h=u*s,p=Math.cos(i),m=Math.sin(i),g=Math.cos(o),y=Math.sin(o),v=.5*(o-i),b=Math.sin(.5*v),x=8/3*b*b/Math.sin(v),w=n+p-x*m,k=r+m+x*p,_=n+g,O=r+y,E=_+x*y,D=O-x*g;return Kw[t]=[c*w+f*k,d*w+h*k,c*E+f*D,d*E+h*D,c*_+f*O,d*_+h*O]}const nk=["l",0,0,0,0,0,0,0];function rk(e,t,n){const r=nk[0]=e[0];if("a"===r||"A"===r)nk[1]=t*e[1],nk[2]=n*e[2],nk[3]=e[3],nk[4]=e[4],nk[5]=e[5],nk[6]=t*e[6],nk[7]=n*e[7];else if("h"===r||"H"===r)nk[1]=t*e[1];else if("v"===r||"V"===r)nk[1]=n*e[1];else for(var i=1,o=e.length;i<o;++i)nk[i]=(i%2==1?t:n)*e[i];return nk}function ik(e,t,n,r,i,o){var a,s,l,u,c,f=null,d=0,h=0,p=0,m=0,g=0,y=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==o&&(o=i),e.beginPath&&e.beginPath();for(var v=0,b=t.length;v<b;++v){switch(a=t[v],1===i&&1===o||(a=rk(a,i,o)),a[0]){case"l":d+=a[1],h+=a[2],e.lineTo(d+n,h+r);break;case"L":d=a[1],h=a[2],e.lineTo(d+n,h+r);break;case"h":d+=a[1],e.lineTo(d+n,h+r);break;case"H":d=a[1],e.lineTo(d+n,h+r);break;case"v":h+=a[1],e.lineTo(d+n,h+r);break;case"V":h=a[1],e.lineTo(d+n,h+r);break;case"m":g=d+=a[1],y=h+=a[2],e.moveTo(d+n,h+r);break;case"M":g=d=a[1],y=h=a[2],e.moveTo(d+n,h+r);break;case"c":s=d+a[5],l=h+a[6],p=d+a[3],m=h+a[4],e.bezierCurveTo(d+a[1]+n,h+a[2]+r,p+n,m+r,s+n,l+r),d=s,h=l;break;case"C":d=a[5],h=a[6],p=a[3],m=a[4],e.bezierCurveTo(a[1]+n,a[2]+r,p+n,m+r,d+n,h+r);break;case"s":s=d+a[3],l=h+a[4],p=2*d-p,m=2*h-m,e.bezierCurveTo(p+n,m+r,d+a[1]+n,h+a[2]+r,s+n,l+r),p=d+a[1],m=h+a[2],d=s,h=l;break;case"S":s=a[3],l=a[4],p=2*d-p,m=2*h-m,e.bezierCurveTo(p+n,m+r,a[1]+n,a[2]+r,s+n,l+r),d=s,h=l,p=a[1],m=a[2];break;case"q":s=d+a[3],l=h+a[4],p=d+a[1],m=h+a[2],e.quadraticCurveTo(p+n,m+r,s+n,l+r),d=s,h=l;break;case"Q":s=a[3],l=a[4],e.quadraticCurveTo(a[1]+n,a[2]+r,s+n,l+r),d=s,h=l,p=a[1],m=a[2];break;case"t":s=d+a[1],l=h+a[2],null===f[0].match(/[QqTt]/)?(p=d,m=h):"t"===f[0]?(p=2*d-u,m=2*h-c):"q"===f[0]&&(p=2*d-p,m=2*h-m),u=p,c=m,e.quadraticCurveTo(p+n,m+r,s+n,l+r),h=l,p=(d=s)+a[1],m=h+a[2];break;case"T":s=a[1],l=a[2],p=2*d-p,m=2*h-m,e.quadraticCurveTo(p+n,m+r,s+n,l+r),d=s,h=l;break;case"a":ok(e,d+n,h+r,[a[1],a[2],a[3],a[4],a[5],a[6]+d+n,a[7]+h+r]),d+=a[6],h+=a[7];break;case"A":ok(e,d+n,h+r,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+r]),d=a[6],h=a[7];break;case"z":case"Z":d=g,h=y,e.closePath()}f=a}}function ok(e,t,n,r){const i=function(e,t,n,r,i,o,a,s,l){const u=ek.call(arguments);if(Qw[u])return Qw[u];const c=a*Vw,f=Math.sin(c),d=Math.cos(c),h=d*(s-e)*.5+f*(l-t)*.5,p=d*(l-t)*.5-f*(s-e)*.5;let m=h*h/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);m>1&&(m=Math.sqrt(m),n*=m,r*=m);const g=d/n,y=f/n,v=-f/r,b=d/r,x=g*s+y*l,w=v*s+b*l,k=g*e+y*t,_=v*e+b*t;let O=1/((k-x)*(k-x)+(_-w)*(_-w))-.25;O<0&&(O=0);let E=Math.sqrt(O);o==i&&(E=-E);const D=.5*(x+k)-E*(_-w),j=.5*(w+_)+E*(k-x),N=Math.atan2(w-j,x-D);let S=Math.atan2(_-j,k-D)-N;S<0&&1===o?S+=Xw:S>0&&0===o&&(S-=Xw);const A=Math.ceil(Math.abs(S/(Yw+.001))),$=[];for(let C=0;C<A;++C){const e=N+C*S/A,t=N+(C+1)*S/A;$[C]=[D,j,e,t,n,r,f,d]}return Qw[u]=$}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let o=0;o<i.length;++o){const t=tk(i[o]);e.bezierCurveTo(t[0],t[1],t[2],t[3],t[4],t[5])}}const ak=.5773502691896257,sk={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Xw)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,o=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-o),e.lineTo(i,-o),e.lineTo(0,-n),e.lineTo(-i,-o),e.lineTo(-r,-o),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Jw*n,i=r-n*ak,o=n/4;e.moveTo(0,-r-i),e.lineTo(-o,r-i),e.lineTo(o,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Jw*n,i=r-n*ak;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Jw*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Jw*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Jw*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Jw*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function lk(e){return ls(sk,e)?sk[e]:function(e){if(!ls(uk,e)){const t=Gw(e);uk[e]={draw:function(e,n){ik(e,t,0,0,Math.sqrt(n)/2)}}}return uk[e]}(e)}var uk={};const ck=.448084975506;function fk(e){return e.x}function dk(e){return e.y}function hk(e){return e.width}function pk(e){return e.height}function mk(e){return"function"==typeof e?e:()=>+e}function gk(e,t,n){return Math.max(t,Math.min(e,n))}function yk(){var e=fk,t=dk,n=hk,r=pk,i=mk(0),o=i,a=i,s=i,l=null;function u(u,c,f){var d,h=null!=c?c:+e.call(this,u),p=null!=f?f:+t.call(this,u),m=+n.call(this,u),g=+r.call(this,u),y=Math.min(m,g)/2,v=gk(+i.call(this,u),0,y),b=gk(+o.call(this,u),0,y),x=gk(+a.call(this,u),0,y),w=gk(+s.call(this,u),0,y);if(l||(l=d=Tg()),v<=0&&b<=0&&x<=0&&w<=0)l.rect(h,p,m,g);else{var k=h+m,_=p+g;l.moveTo(h+v,p),l.lineTo(k-b,p),l.bezierCurveTo(k-ck*b,p,k,p+ck*b,k,p+b),l.lineTo(k,_-w),l.bezierCurveTo(k,_-ck*w,k-ck*w,_,k-w,_),l.lineTo(h+x,_),l.bezierCurveTo(h+ck*x,_,h,_-ck*x,h,_-x),l.lineTo(h,p+v),l.bezierCurveTo(h,p+ck*v,h+ck*v,p,h+v,p),l.closePath()}if(d)return l=null,d+""||null}return u.x=function(t){return arguments.length?(e=mk(t),u):e},u.y=function(e){return arguments.length?(t=mk(e),u):t},u.width=function(e){return arguments.length?(n=mk(e),u):n},u.height=function(e){return arguments.length?(r=mk(e),u):r},u.cornerRadius=function(e,t,n,r){return arguments.length?(i=mk(e),o=null!=t?mk(t):i,s=null!=n?mk(n):i,a=null!=r?mk(r):o,u):i},u.context=function(e){return arguments.length?(l=null==e?null:e,u):l},u}function vk(){var e,t,n,r,i,o,a,s,l=null;function u(e,t,n){const r=n/2;if(i){var u=a-t,c=e-o;if(u||c){var f=Math.sqrt(u*u+c*c),d=(u/=f)*s,h=(c/=f)*s,p=Math.atan2(c,u);l.moveTo(o-d,a-h),l.lineTo(e-u*r,t-c*r),l.arc(e,t,r,p-Math.PI,p),l.lineTo(o+d,a+h),l.arc(o,a,s,p,p+Math.PI)}else l.arc(e,t,r,0,Xw);l.closePath()}else i=1;o=e,a=t,s=r}function c(o){var a,s,c,f=o.length,d=!1;for(null==l&&(l=c=Tg()),a=0;a<=f;++a)!(a<f&&r(s=o[a],a,o))===d&&(d=!d)&&(i=0),d&&u(+e(s,a,o),+t(s,a,o),+n(s,a,o));if(c)return l=null,c+""||null}return c.x=function(t){return arguments.length?(e=t,c):e},c.y=function(e){return arguments.length?(t=e,c):t},c.size=function(e){return arguments.length?(n=e,c):n},c.defined=function(e){return arguments.length?(r=e,c):r},c.context=function(e){return arguments.length?(l=null==e?null:e,c):l},c}function bk(e,t){return null!=e?e:t}const xk=e=>e.x||0,wk=e=>e.y||0,kk=e=>!(!1===e.defined),_k=function(){var e=Rg,t=Lg,n=yg(0),r=null,i=Bg,o=Ig,a=Ug,s=null,l=zg(u);function u(){var u,c,f=+e.apply(this,arguments),d=+t.apply(this,arguments),h=i.apply(this,arguments)-jg,p=o.apply(this,arguments)-jg,m=vg(p-h),g=p>h;if(s||(s=u=l()),d<f&&(c=d,d=f,f=c),d>Eg)if(m>Ng-Eg)s.moveTo(d*xg(h),d*_g(h)),s.arc(0,0,d,h,p,!g),f>Eg&&(s.moveTo(f*xg(p),f*_g(p)),s.arc(0,0,f,p,h,g));else{var y,v,b=h,x=p,w=h,k=p,_=m,O=m,E=a.apply(this,arguments)/2,D=E>Eg&&(r?+r.apply(this,arguments):Og(f*f+d*d)),j=kg(vg(d-f)/2,+n.apply(this,arguments)),N=j,S=j;if(D>Eg){var A=Sg(D/f*_g(E)),$=Sg(D/d*_g(E));(_-=2*A)>Eg?(w+=A*=g?1:-1,k-=A):(_=0,w=k=(h+p)/2),(O-=2*$)>Eg?(b+=$*=g?1:-1,x-=$):(O=0,b=x=(h+p)/2)}var C=d*xg(b),M=d*_g(b),P=f*xg(k),F=f*_g(k);if(j>Eg){var T,z=d*xg(x),R=d*_g(x),L=f*xg(w),B=f*_g(w);if(m<Dg)if(T=function(e,t,n,r,i,o,a,s){var l=n-e,u=r-t,c=a-i,f=s-o,d=f*l-c*u;if(!(d*d<Eg))return[e+(d=(c*(t-o)-f*(e-i))/d)*l,t+d*u]}(C,M,L,B,z,R,P,F)){var I=C-T[0],U=M-T[1],q=z-T[0],W=R-T[1],Z=1/_g(function(e){return e>1?0:e<-1?Dg:Math.acos(e)}((I*q+U*W)/(Og(I*I+U*U)*Og(q*q+W*W)))/2),H=Og(T[0]*T[0]+T[1]*T[1]);N=kg(j,(f-H)/(Z-1)),S=kg(j,(d-H)/(Z+1))}else N=S=0}O>Eg?S>Eg?(y=qg(L,B,C,M,d,S,g),v=qg(z,R,P,F,d,S,g),s.moveTo(y.cx+y.x01,y.cy+y.y01),S<j?s.arc(y.cx,y.cy,S,bg(y.y01,y.x01),bg(v.y01,v.x01),!g):(s.arc(y.cx,y.cy,S,bg(y.y01,y.x01),bg(y.y11,y.x11),!g),s.arc(0,0,d,bg(y.cy+y.y11,y.cx+y.x11),bg(v.cy+v.y11,v.cx+v.x11),!g),s.arc(v.cx,v.cy,S,bg(v.y11,v.x11),bg(v.y01,v.x01),!g))):(s.moveTo(C,M),s.arc(0,0,d,b,x,!g)):s.moveTo(C,M),f>Eg&&_>Eg?N>Eg?(y=qg(P,F,z,R,f,-N,g),v=qg(C,M,L,B,f,-N,g),s.lineTo(y.cx+y.x01,y.cy+y.y01),N<j?s.arc(y.cx,y.cy,N,bg(y.y01,y.x01),bg(v.y01,v.x01),!g):(s.arc(y.cx,y.cy,N,bg(y.y01,y.x01),bg(y.y11,y.x11),!g),s.arc(0,0,f,bg(y.cy+y.y11,y.cx+y.x11),bg(v.cy+v.y11,v.cx+v.x11),g),s.arc(v.cx,v.cy,N,bg(v.y11,v.x11),bg(v.y01,v.x01),!g))):s.arc(0,0,f,k,w,g):s.lineTo(P,F)}else s.moveTo(0,0);if(s.closePath(),u)return s=null,u+""||null}return u.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-Dg/2;return[xg(r)*n,_g(r)*n]},u.innerRadius=function(t){return arguments.length?(e="function"==typeof t?t:yg(+t),u):e},u.outerRadius=function(e){return arguments.length?(t="function"==typeof e?e:yg(+e),u):t},u.cornerRadius=function(e){return arguments.length?(n="function"==typeof e?e:yg(+e),u):n},u.padRadius=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:yg(+e),u):r},u.startAngle=function(e){return arguments.length?(i="function"==typeof e?e:yg(+e),u):i},u.endAngle=function(e){return arguments.length?(o="function"==typeof e?e:yg(+e),u):o},u.padAngle=function(e){return arguments.length?(a="function"==typeof e?e:yg(+e),u):a},u.context=function(e){return arguments.length?(s=null==e?null:e,u):s},u}().startAngle((e=>e.startAngle||0)).endAngle((e=>e.endAngle||0)).padAngle((e=>e.padAngle||0)).innerRadius((e=>e.innerRadius||0)).outerRadius((e=>e.outerRadius||0)).cornerRadius((e=>e.cornerRadius||0)),Ok=Xg().x(xk).y1(wk).y0((e=>(e.y||0)+(e.height||0))).defined(kk),Ek=Xg().y(wk).x1(xk).x0((e=>(e.x||0)+(e.width||0))).defined(kk),Dk=Yg().x(xk).y(wk).defined(kk),jk=yk().x(xk).y(wk).width((e=>e.width||0)).height((e=>e.height||0)).cornerRadius((e=>bk(e.cornerRadiusTopLeft,e.cornerRadius)||0),(e=>bk(e.cornerRadiusTopRight,e.cornerRadius)||0),(e=>bk(e.cornerRadiusBottomRight,e.cornerRadius)||0),(e=>bk(e.cornerRadiusBottomLeft,e.cornerRadius)||0)),Nk=function(e,t){let n=null,r=zg(i);function i(){let i;if(n||(n=i=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),i)return n=null,i+""||null}return e="function"==typeof e?e:yg(e||Jg),t="function"==typeof t?t:yg(void 0===t?64:+t),i.type=function(t){return arguments.length?(e="function"==typeof t?t:yg(t),i):e},i.size=function(e){return arguments.length?(t="function"==typeof e?e:yg(+e),i):t},i.context=function(e){return arguments.length?(n=null==e?null:e,i):n},i}().type((e=>lk(e.shape||"circle"))).size((e=>bk(e.size,64))),Sk=vk().x(xk).y(wk).defined(kk).size((e=>e.size||1));function Ak(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function $k(e,t,n,r){return jk.context(e)(t,n,r)}var Ck=1;function Mk(){Ck=1}function Pk(e,t,n){var r=t.clip,i=e._defs,o=t.clip_id||(t.clip_id="clip"+Ck++),a=i.clipping[o]||(i.clipping[o]={id:o});return Ya(r)?a.path=r(null):Ak(n)?a.path=$k(null,n,0,0):(a.width=n.width||0,a.height=n.height||0),"url(#"+o+")"}function Fk(e){this.clear(),e&&this.union(e)}function Tk(e){this.mark=e,this.bounds=this.bounds||new Fk}function zk(e){Tk.call(this,e),this.items=this.items||[]}function Rk(e){this._pending=0,this._loader=e||uh()}function Lk(e){e._pending+=1}function Bk(e){e._pending-=1}function Ik(e,t,n){if(t.stroke&&0!==t.opacity&&0!==t.strokeOpacity){const r=null!=t.strokeWidth?+t.strokeWidth:1;e.expand(r+(n?function(e,t){return e.strokeJoin&&"miter"!==e.strokeJoin?0:t}(t,r):0))}return e}Fk.prototype={clone(){return new Fk(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:o,y2:a}=this,s=Math.cos(e),l=Math.sin(e),u=t-t*s+n*l,c=n-t*l-n*s;return[s*r-l*i+u,l*r+s*i+c,s*r-l*a+u,l*r+s*a+c,s*o-l*i+u,l*o+s*i+c,s*o-l*a+u,l*o+s*a+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},ds(zk,Tk),Rk.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return Lk(t),t._loader.sanitize(e,{context:"href"}).then((e=>(Bk(t),e))).catch((()=>(Bk(t),null)))},loadImage(e){const t=this,n=$y();return Lk(t),t._loader.sanitize(e,{context:"image"}).then((e=>{const r=e.href;if(!r||!n)throw{url:r};const i=new n,o=ls(e,"crossOrigin")?e.crossOrigin:"anonymous";return null!=o&&(i.crossOrigin=o),i.onload=()=>Bk(t),i.onerror=()=>Bk(t),i.src=r,i})).catch((e=>(Bk(t),{complete:!1,width:0,height:0,src:e&&e.url||""})))},ready(){const e=this;return new Promise((t=>{!function n(r){e.pending()?setTimeout((()=>{n(!0)}),10):t(r)}(!1)}))}};const Uk=Xw-1e-8;let qk,Wk,Zk,Hk,Gk,Vk,Yk,Xk;const Jk=(e,t)=>qk.add(e,t),Qk=(e,t)=>Jk(Wk=e,Zk=t),Kk=e=>Jk(e,qk.y1),e_=e=>Jk(qk.x1,e),t_=(e,t)=>Gk*e+Yk*t,n_=(e,t)=>Vk*e+Xk*t,r_=(e,t)=>Jk(t_(e,t),n_(e,t)),i_=(e,t)=>Qk(t_(e,t),n_(e,t));function o_(e,t){return qk=e,t?(Hk=t*Vw,Gk=Xk=Math.cos(Hk),Vk=Math.sin(Hk),Yk=-Vk):(Gk=Xk=1,Hk=Vk=Yk=0),a_}const a_={beginPath(){},closePath(){},moveTo:i_,lineTo:i_,rect(e,t,n,r){Hk?(r_(e+n,t),r_(e+n,t+r),r_(e,t+r),i_(e,t)):(Jk(e+n,t+r),Qk(e,t))},quadraticCurveTo(e,t,n,r){const i=t_(e,t),o=n_(e,t),a=t_(n,r),s=n_(n,r);s_(Wk,i,a,Kk),s_(Zk,o,s,e_),Qk(a,s)},bezierCurveTo(e,t,n,r,i,o){const a=t_(e,t),s=n_(e,t),l=t_(n,r),u=n_(n,r),c=t_(i,o),f=n_(i,o);l_(Wk,a,l,c,Kk),l_(Zk,s,u,f,e_),Qk(c,f)},arc(e,t,n,r,i,o){if(r+=Hk,i+=Hk,Wk=n*Math.cos(i)+e,Zk=n*Math.sin(i)+t,Math.abs(i-r)>Uk)Jk(e-n,t-n),Jk(e+n,t+n);else{const a=r=>Jk(n*Math.cos(r)+e,n*Math.sin(r)+t);let s,l;if(a(r),a(i),i!==r)if((r%=Xw)<0&&(r+=Xw),(i%=Xw)<0&&(i+=Xw),i<r&&(o=!o,s=r,r=i,i=s),o)for(i-=Xw,s=r-r%Yw,l=0;l<4&&s>i;++l,s-=Yw)a(s);else for(s=r-r%Yw+Yw,l=0;l<4&&s<i;++l,s+=Yw)a(s)}}};function s_(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function l_(e,t,n,r,i){const o=r-e+3*t-3*n,a=e+n-2*t,s=e-t;let l,u=0,c=0;Math.abs(o)>1e-14?(l=a*a+s*o,l>=0&&(l=Math.sqrt(l),u=(-a+l)/o,c=(-a-l)/o)):u=.5*s/a,0<u&&u<1&&i(u_(u,e,t,n,r)),0<c&&c<1&&i(u_(c,e,t,n,r))}function u_(e,t,n,r,i){const o=1-e,a=o*o,s=e*e;return a*o*t+3*a*e*n+3*o*s*r+s*e*i}var c_=(c_=Ay(1,1))?c_.getContext("2d"):null;const f_=new Fk;function d_(e){return function(t,n){if(!c_)return!0;e(c_,t),f_.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:o,y2:a}=f_;for(let e=i;e<=a;++e)for(let t=r;t<=o;++t)if(c_.isPointInPath(t,e))return!0;return!1}}function h_(e,t){return t.contains(e.x||0,e.y||0)}function p_(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,o=e.height||0;return t.intersects(f_.set(n,r,n+i,r+o))}function m_(e,t){const n=e.x||0,r=e.y||0;return g_(t,n,r,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r)}function g_(e,t,n,r,i){const{x1:o,y1:a,x2:s,y2:l}=e,u=r-t,c=i-n;let f,d,h,p,m=0,g=1;for(p=0;p<4;++p){if(0===p&&(f=-u,d=-(o-t)),1===p&&(f=u,d=s-t),2===p&&(f=-c,d=-(a-n)),3===p&&(f=c,d=l-n),Math.abs(f)<1e-10&&d<0)return!1;if(h=d/f,f<0){if(h>g)return!1;h>m&&(m=h)}else if(f>0){if(h<m)return!1;h<g&&(g=h)}}return!0}function y_(e,t){e.globalCompositeOperation=t.blend||"source-over"}function v_(e,t){return null==e?t:e}function b_(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function x_(e,t,n){return Tw(n)?function(e,t,n){const r=n.width(),i=n.height();let o;if("radial"===t.gradient)o=e.createRadialGradient(n.x1+v_(t.x1,.5)*r,n.y1+v_(t.y1,.5)*i,Math.max(r,i)*v_(t.r1,0),n.x1+v_(t.x2,.5)*r,n.y1+v_(t.y2,.5)*i,Math.max(r,i)*v_(t.r2,.5));else{const a=v_(t.x1,0),s=v_(t.y1,0),l=v_(t.x2,1),u=v_(t.y2,0);if(a!==l&&s!==u&&r!==i){const n=Ay(Math.ceil(r),Math.ceil(i)),o=n.getContext("2d");return o.scale(r,i),o.fillStyle=b_(o.createLinearGradient(a,s,l,u),t.stops),o.fillRect(0,0,r,i),e.createPattern(n,"no-repeat")}o=e.createLinearGradient(n.x1+a*r,n.y1+s*i,n.x1+l*r,n.y1+u*i)}return b_(o,t.stops)}(e,n,t.bounds):n}function w_(e,t,n){return(n*=null==t.fillOpacity?1:t.fillOpacity)>0&&(e.globalAlpha=n,e.fillStyle=x_(e,t,t.fill),!0)}var k_=[];function __(e,t,n){var r=null!=(r=t.strokeWidth)?r:1;return!(r<=0)&&((n*=null==t.strokeOpacity?1:t.strokeOpacity)>0&&(e.globalAlpha=n,e.strokeStyle=x_(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||k_),e.lineDashOffset=t.strokeDashOffset||0),!0))}function O_(e,t){return e.zindex-t.zindex||e.index-t.index}function E_(e){if(!e.zdirty)return e.zitems;var t,n,r,i=e.items,o=[];for(n=0,r=i.length;n<r;++n)(t=i[n]).index=n,t.zindex&&o.push(t);return e.zdirty=!1,e.zitems=o.sort(O_)}function D_(e,t){var n,r,i=e.items;if(!i||!i.length)return;const o=E_(e);if(o&&o.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||t(i[n]);i=o}for(n=0,r=i.length;n<r;++n)t(i[n])}function j_(e,t){var n,r,i=e.items;if(!i||!i.length)return null;const o=E_(e);for(o&&o.length&&(i=o),r=i.length;--r>=0;)if(n=t(i[r]))return n;if(i===o)for(r=(i=e.items).length;--r>=0;)if(!i[r].zindex&&(n=t(i[r])))return n;return null}function N_(e){return function(t,n,r){D_(n,(n=>{r&&!r.intersects(n.bounds)||A_(e,t,n,n)}))}}function S_(e){return function(t,n,r){!n.items.length||r&&!r.intersects(n.bounds)||A_(e,t,n.items[0],n.items)}}function A_(e,t,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(e(t,r)||(y_(t,n),n.fill&&w_(t,n,i)&&t.fill(),n.stroke&&__(t,n,i)&&t.stroke()))}function $_(e){return e=e||ha,function(t,n,r,i,o,a){return r*=t.pixelRatio,i*=t.pixelRatio,j_(n,(n=>{const s=n.bounds;if((!s||s.contains(o,a))&&s)return e(t,n,r,i,o,a)?n:void 0}))}}function C_(e,t){return function(n,r,i,o){var a,s,l=Array.isArray(r)?r[0]:r,u=null==t?l.fill:t,c=l.stroke&&n.isPointInStroke;return c&&(a=l.strokeWidth,s=l.strokeCap,n.lineWidth=null!=a?a:1,n.lineCap=null!=s?s:"butt"),!e(n,r)&&(u&&n.isPointInPath(i,o)||c&&n.isPointInStroke(i,o))}}function M_(e){return $_(C_(e))}function P_(e,t){return"translate("+e+","+t+")"}function F_(e){return"rotate("+e+")"}function T_(e){return P_(e.x||0,e.y||0)}function z_(e,t,n){function r(e,n){var r=n.x||0,i=n.y||0,o=n.angle||0;e.translate(r,i),o&&e.rotate(o*=Vw),e.beginPath(),t(e,n),o&&e.rotate(-o),e.translate(-r,-i)}return{type:e,tag:"path",nested:!1,attr:function(e,n){e("transform",function(e){return P_(e.x||0,e.y||0)+(e.angle?" "+F_(e.angle):"")}(n)),e("d",t(null,n))},bound:function(e,n){return t(o_(e,n.angle),n),Ik(e,n).translate(n.x||0,n.y||0)},draw:N_(r),pick:M_(r),isect:n||d_(r)}}var R_=z_("arc",(function(e,t){return _k.context(e)(t)}));function L_(e,t,n){function r(e,n){e.beginPath(),t(e,n)}const i=C_(r);return{type:e,tag:"path",nested:!0,attr:function(e,n){var r=n.mark.items;r.length&&e("d",t(null,r))},bound:function(e,n){var r=n.items;return 0===r.length?e:(t(o_(e),r),Ik(e,r[0]))},draw:S_(r),pick:function(e,t,n,r,o,a){var s=t.items,l=t.bounds;return!s||!s.length||l&&!l.contains(o,a)?null:(n*=e.pixelRatio,r*=e.pixelRatio,i(e,s,n,r)?s[0]:null)},isect:h_,tip:n}}var B_=L_("area",(function(e,t){const n=t[0],r=n.interpolate||"linear";return("horizontal"===n.orient?Ek:Ok).curve(Iw(r,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,r,i="horizontal"===e[0].orient?t[1]:t[0],o="horizontal"===e[0].orient?"y":"x",a=e.length,s=1/0;--a>=0;)!1!==e[a].defined&&(r=Math.abs(e[a][o]-i))<s&&(s=r,n=e[a]);return n}));function I_(e,t){e.beginPath(),Ak(t)?$k(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function U_(e){const t=v_(e.strokeWidth,1);return null!=e.strokeOffset?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function q_(e,t){const n=U_(t);e("d",$k(null,t,n,n))}function W_(e,t,n,r){const i=U_(t);e.beginPath(),$k(e,t,(n||0)+i,(r||0)+i)}const Z_=C_(W_),H_=C_(W_,!1),G_=C_(W_,!0);var V_={type:"group",tag:"g",nested:!1,attr:function(e,t){e("transform",T_(t))},bound:function(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let t=0;t<r;++t)e.union(n[t].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),Ik(e,t),e.translate(t.x||0,t.y||0)},draw:function(e,t,n){D_(t,(t=>{const r=t.x||0,i=t.y||0,o=t.strokeForeground,a=null==t.opacity?1:t.opacity;(t.stroke||t.fill)&&a&&(W_(e,t,r,i),y_(e,t),t.fill&&w_(e,t,a)&&e.fill(),t.stroke&&!o&&__(e,t,a)&&e.stroke()),e.save(),e.translate(r,i),t.clip&&I_(e,t),n&&n.translate(-r,-i),D_(t,(t=>{this.draw(e,t,n)})),n&&n.translate(r,i),e.restore(),o&&t.stroke&&a&&(W_(e,t,r,i),y_(e,t),__(e,t,a)&&e.stroke())}))},pick:function(e,t,n,r,i,o){if(t.bounds&&!t.bounds.contains(i,o)||!t.items)return null;const a=n*e.pixelRatio,s=r*e.pixelRatio;return j_(t,(l=>{let u,c,f;const d=l.bounds;if(d&&!d.contains(i,o))return;c=l.x||0,f=l.y||0;const h=c+(l.width||0),p=f+(l.height||0),m=l.clip;if(m&&(i<c||i>h||o<f||o>p))return;if(e.save(),e.translate(c,f),c=i-c,f=o-f,m&&Ak(l)&&!G_(e,l,a,s))return e.restore(),null;const g=l.strokeForeground,y=!1!==t.interactive;return y&&g&&l.stroke&&H_(e,l,a,s)?(e.restore(),l):(u=j_(l,(e=>function(e,t,n){return(!1!==e.interactive||"group"===e.marktype)&&e.bounds&&e.bounds.contains(t,n)}(e,c,f)?this.pick(e,n,r,c,f):null)),!u&&y&&(l.fill||!g&&l.stroke)&&Z_(e,l,a,s)&&(u=l),e.restore(),u||null)}))},isect:p_,content:function(e,t,n){e("clip-path",t.clip?Pk(n,t,t):null)},background:function(e,t){e("class","background"),e("aria-hidden",!0),q_(e,t)},foreground:function(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?q_(e,t):e("d","")}},Y_={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function X_(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then((t=>{e.image=t,e.image.url=e.url}))),n}function J_(e,t){return null!=e.width?e.width:t&&t.width?!1!==e.aspect&&e.height?e.height*t.width/t.height:t.width:0}function Q_(e,t){return null!=e.height?e.height:t&&t.height?!1!==e.aspect&&e.width?e.width*t.height/t.width:t.height:0}function K_(e,t){return"center"===e?t/2:"right"===e?t:0}function eO(e,t){return"middle"===e?t/2:"bottom"===e?t:0}var tO={type:"image",tag:"image",nested:!1,attr:function(e,t,n){const r=X_(t,n),i=J_(t,r),o=Q_(t,r),a=(t.x||0)-K_(t.align,i),s=(t.y||0)-eO(t.baseline,o);e("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",Y_["xmlns:xlink"],"xlink:href"),e("transform",P_(a,s)),e("width",i),e("height",o),e("preserveAspectRatio",!1===t.aspect?"none":"xMidYMid")},bound:function(e,t){const n=t.image,r=J_(t,n),i=Q_(t,n),o=(t.x||0)-K_(t.align,r),a=(t.y||0)-eO(t.baseline,i);return e.set(o,a,o+r,a+i)},draw:function(e,t,n){D_(t,(t=>{if(n&&!n.intersects(t.bounds))return;const r=X_(t,this);let i=J_(t,r),o=Q_(t,r);if(0===i||0===o)return;let a,s,l,u,c=(t.x||0)-K_(t.align,i),f=(t.y||0)-eO(t.baseline,o);!1!==t.aspect&&(s=r.width/r.height,l=t.width/t.height,s==s&&l==l&&s!==l&&(l<s?(u=i/s,f+=(o-u)/2,o=u):(u=o*s,c+=(i-u)/2,i=u))),(r.complete||r.toDataURL)&&(y_(e,t),e.globalAlpha=null!=(a=t.opacity)?a:1,e.imageSmoothingEnabled=!1!==t.smooth,e.drawImage(r,c,f,i,o))}))},pick:$_(),isect:ha,get:X_,xOffset:K_,yOffset:eO},nO=L_("line",(function(e,t){const n=t[0],r=n.interpolate||"linear";return Dk.curve(Iw(r,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,r,i=Math.pow(e[0].strokeWidth||1,2),o=e.length;--o>=0;)if(!1!==e[o].defined&&(n=e[o].x-t[0])*n+(r=e[o].y-t[1])*r<i)return e[o];return null}));function rO(e,t){var n=t.path;if(null==n)return!0;var r=t.x||0,i=t.y||0,o=t.scaleX||1,a=t.scaleY||1,s=(t.angle||0)*Vw,l=t.pathCache;l&&l.path===n||((t.pathCache=l=Gw(n)).path=n),s&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(s),ik(e,l,0,0,o,a),e.rotate(-s),e.translate(-r,-i)):ik(e,l,r,i,o,a)}var iO={type:"path",tag:"path",nested:!1,attr:function(e,t){var n=t.scaleX||1,r=t.scaleY||1;1===n&&1===r||e("vector-effect","non-scaling-stroke"),e("transform",function(e){return P_(e.x||0,e.y||0)+(e.angle?" "+F_(e.angle):"")+(e.scaleX||e.scaleY?" "+function(e,t){return"scale("+e+","+t+")"}(e.scaleX||1,e.scaleY||1):"")}(t)),e("d",t.path)},bound:function(e,t){return rO(o_(e,t.angle),t)?e.set(0,0,0,0):Ik(e,t,!0)},draw:N_(rO),pick:M_(rO),isect:d_(rO)};function oO(e,t){e.beginPath(),$k(e,t)}var aO={type:"rect",tag:"path",nested:!1,attr:function(e,t){e("d",$k(null,t))},bound:function(e,t){var n,r;return Ik(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)},draw:N_(oO),pick:M_(oO),isect:p_};function sO(e,t,n){var r,i,o,a;return!(!t.stroke||!__(e,t,n))&&(r=t.x||0,i=t.y||0,o=null!=t.x2?t.x2:r,a=null!=t.y2?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(o,a),!0)}var lO={type:"rule",tag:"line",nested:!1,attr:function(e,t){e("transform",T_(t)),e("x2",null!=t.x2?t.x2-(t.x||0):0),e("y2",null!=t.y2?t.y2-(t.y||0):0)},bound:function(e,t){var n,r;return Ik(e.set(n=t.x||0,r=t.y||0,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r),t)},draw:function(e,t,n){D_(t,(t=>{if(!n||n.intersects(t.bounds)){var r=null==t.opacity?1:t.opacity;r&&sO(e,t,r)&&(y_(e,t),e.stroke())}}))},pick:$_((function(e,t,n,r){return!!e.isPointInStroke&&(sO(e,t,1)&&e.isPointInStroke(n,r))})),isect:m_},uO=z_("shape",(function(e,t){return(t.mark.shape||t.shape).context(e)(t)})),cO=z_("symbol",(function(e,t){return Nk.context(e)(t)}),h_);const fO=ks();var dO={height:vO,measureWidth:gO,estimateWidth:pO,width:pO,canvas:hO};function hO(e){dO.width=e&&c_?gO:pO}function pO(e,t){return mO(kO(e,t),vO(e))}function mO(e,t){return~~(.8*e.length*t)}function gO(e,t){return vO(e)<=0||!(t=kO(e,t))?0:yO(t,OO(e))}function yO(e,t){const n=`(${t}) ${e}`;let r=fO.get(n);return void 0===r&&(c_.font=t,r=c_.measureText(e).width,fO.set(n,r)),r}function vO(e){return null!=e.fontSize?+e.fontSize||0:11}function bO(e){return null!=e.lineHeight?e.lineHeight:vO(e)+2}function xO(e){return t=e.lineBreak&&e.text&&!ka(e.text)?e.text.split(e.lineBreak):e.text,ka(t)?t.length>1?t:t[0]:t;var t}function wO(e){const t=xO(e);return(ka(t)?t.length-1:0)*bO(e)}function kO(e,t){const n=null==t?"":(t+"").trim();return e.limit>0&&n.length?function(e,t){var n=+e.limit,r=function(e){if(dO.width===gO){const t=OO(e);return e=>yO(e,t)}{const t=vO(e);return e=>mO(e,t)}}(e);if(r(t)<n)return t;var i,o=e.ellipsis||"\u2026",a="rtl"===e.dir,s=0,l=t.length;if(n-=r(o),a){for(;s<l;)i=s+l>>>1,r(t.slice(i))>n?s=i+1:l=i;return o+t.slice(s)}for(;s<l;)i=1+(s+l>>>1),r(t.slice(0,i))<n?s=i:l=i-1;return t.slice(0,s)+o}(e,n):n}function _O(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function OO(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+vO(e)+"px "+_O(e,t)}function EO(e){var t=e.baseline,n=vO(e);return Math.round("top"===t?.79*n:"middle"===t?.3*n:"bottom"===t?-.21*n:"line-top"===t?.29*n+.5*bO(e):"line-bottom"===t?.29*n-.5*bO(e):0)}hO(!0);const DO={left:"start",center:"middle",right:"end"},jO=new Fk;function NO(e){var t,n=e.x||0,r=e.y||0,i=e.radius||0;return i&&(t=(e.theta||0)-Yw,n+=i*Math.cos(t),r+=i*Math.sin(t)),jO.x1=n,jO.y1=r,jO}function SO(e,t,n){var r,i=dO.height(t),o=t.align,a=NO(t),s=a.x1,l=a.y1,u=t.dx||0,c=(t.dy||0)+EO(t)-Math.round(.8*i),f=xO(t);if(ka(f)?(i+=bO(t)*(f.length-1),r=f.reduce(((e,n)=>Math.max(e,dO.width(t,n))),0)):r=dO.width(t,f),"center"===o?u-=r/2:"right"===o&&(u-=r),e.set(u+=s,c+=l,u+r,c+i),t.angle&&!n)e.rotate(t.angle*Vw,s,l);else if(2===n)return e.rotatedPoints(t.angle*Vw,s,l);return e}var AO={type:"text",tag:"text",nested:!1,attr:function(e,t){var n,r=t.dx||0,i=(t.dy||0)+EO(t),o=NO(t),a=o.x1,s=o.y1,l=t.angle||0;e("text-anchor",DO[t.align]||"start"),l?(n=P_(a,s)+" "+F_(l),(r||i)&&(n+=" "+P_(r,i))):n=P_(a+r,s+i),e("transform",n)},bound:SO,draw:function(e,t,n){D_(t,(t=>{var r,i,o,a,s,l,u,c=null==t.opacity?1:t.opacity;if(!(n&&!n.intersects(t.bounds)||0===c||t.fontSize<=0||null==t.text||0===t.text.length)){if(e.font=OO(t),e.textAlign=t.align||"left",i=(r=NO(t)).x1,o=r.y1,t.angle&&(e.save(),e.translate(i,o),e.rotate(t.angle*Vw),i=o=0),i+=t.dx||0,o+=(t.dy||0)+EO(t),l=xO(t),y_(e,t),ka(l))for(s=bO(t),a=0;a<l.length;++a)u=kO(t,l[a]),t.fill&&w_(e,t,c)&&e.fillText(u,i,o),t.stroke&&__(e,t,c)&&e.strokeText(u,i,o),o+=s;else u=kO(t,l),t.fill&&w_(e,t,c)&&e.fillText(u,i,o),t.stroke&&__(e,t,c)&&e.strokeText(u,i,o);t.angle&&e.restore()}}))},pick:$_((function(e,t,n,r,i,o){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var a=NO(t),s=a.x1,l=a.y1,u=SO(jO,t,1),c=-t.angle*Vw,f=Math.cos(c),d=Math.sin(c),h=f*i-d*o+(s-f*s+d*l),p=d*i+f*o+(l-d*s-f*l);return u.contains(h,p)})),isect:function(e,t){const n=SO(jO,e,2);return g_(t,n[0],n[1],n[2],n[3])||g_(t,n[0],n[1],n[4],n[5])||g_(t,n[4],n[5],n[6],n[7])||g_(t,n[2],n[3],n[6],n[7])}},$O=L_("trail",(function(e,t){return Sk.context(e)(t)}),(function(e,t){for(var n,r,i=e.length;--i>=0;)if(!1!==e[i].defined&&(n=e[i].x-t[0])*n+(r=e[i].y-t[1])*r<(n=e[i].size||1)*n)return e[i];return null})),CO={arc:R_,area:B_,group:V_,image:tO,line:nO,path:iO,rect:aO,rule:lO,shape:uO,symbol:cO,text:AO,trail:$O};function MO(e,t,n){var r=CO[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new Fk),e,n)}var PO={mark:null};function FO(e,t,n){var r,i,o,a,s=CO[e.marktype],l=s.bound,u=e.items,c=u&&u.length;if(s.nested)return c?o=u[0]:(PO.mark=e,o=PO),a=MO(o,l,n),t=t&&t.union(a)||a;if(t=t||e.bounds&&e.bounds.clear()||new Fk,c)for(r=0,i=u.length;r<i;++r)t.union(MO(u[r],l,n));return e.bounds=t}const TO=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function zO(e,t){return JSON.stringify(e,TO,t)}function RO(e){return LO("string"==typeof e?JSON.parse(e):e)}function LO(e){var t,n,r,i=e.marktype,o=e.items;if(o)for(n=0,r=o.length;n<r;++n)t=i?"mark":"group",o[n][t]=e,o[n].zindex&&(o[n][t].zdirty=!0),"group"===(i||t)&&LO(o[n]);return i&&FO(e),e}function BO(e){arguments.length?this.root=RO(e):(this.root=IO({marktype:"group",name:"root",role:"frame"}),this.root.items=[new zk(this.root)])}function IO(e,t){const n={bounds:new Fk,clip:!!e.clip,group:t,interactive:!1!==e.interactive,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return null!=e.aria&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function UO(e,t,n){return!e&&"undefined"!=typeof document&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function qO(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function WO(e,t,n,r){var i,o=e.childNodes[t];return o&&o.tagName.toLowerCase()===n.toLowerCase()||(i=o||null,o=UO(e.ownerDocument,n,r),e.insertBefore(o,i)),o}function ZO(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function HO(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function GO(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function VO(e,t){this._active=null,this._handlers={},this._loader=e||uh(),this._tooltip=t||YO}function YO(e,t,n,r){e.element().setAttribute("title",r||"")}function XO(e){this._el=null,this._bgcolor=null,this._loader=new Rk(e)}BO.prototype={toJSON(e){return zO(this.root,e||0)},mark(e,t,n){const r=IO(e,t=t||this.root.items[0]);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}},VO.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const r in t)n.push(...t[r]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then((t=>{const n=new MouseEvent(e.type,e),r=UO(null,"a");for(const e in t)r.setAttribute(e,t[e]);r.dispatchEvent(n)})).catch((()=>{}))},handleTooltip(e,t,n){if(t&&null!=t.tooltip){t=function(e,t,n,r){var i,o,a=e&&e.mark;if(a&&(i=CO[a.marktype]).tip){for((o=GO(t,n))[0]-=r[0],o[1]-=r[1];e=e.mark.group;)o[0]-=e.x||0,o[1]-=e.y||0;e=i.tip(a.items,o)}return e}(t,e,this.canvas(),this._origin);const r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,o=i.width(),a=i.height();let s=i.x1+r[0]+n.left,l=i.y1+r[1]+n.top;for(;e.mark&&(e=e.mark.group);)s+=e.x||0,l+=e.y||0;return{x:s,y:l,width:o,height:a,left:s,top:l,right:s+o,bottom:l+a}}},XO.prototype={initialize(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then((()=>t)):Promise.resolve(t)},_load(e,t){var n=this,r=n._loader[e](t);if(!n._ready){const e=n._call;n._ready=n._loader.ready().then((t=>{t&&e(),n._ready=null}))}return r},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const JO="dragenter",QO="dragleave",KO="dragover",eE="mousedown",tE="mousemove",nE="mouseout",rE="mouseover",iE="click",oE="mousewheel",aE="touchstart",sE="touchmove",lE="touchend",uE=tE,cE=nE,fE=iE;function dE(e,t){VO.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}function hE(e,t){(e=>e===aE||e===sE||e===lE?[aE,sE,lE]:[e])(t).forEach((t=>function(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?n=>e[t](n):n=>e.fire(t,n)))}(e,t)))}function pE(e,t,n){return function(r){const i=this._active,o=this.pickEvent(r);o===i||(i&&i.exit||this.fire(n,r),this._active=o,this.fire(t,r)),this.fire(e,r)}}function mE(e){return function(t){this.fire(e,t),this._active=null}}ds(dE,VO,{initialize(e,t,n){return this._canvas=e&&qO(e,"canvas"),[iE,eE,tE,nE,QO].forEach((e=>hE(this,e))),VO.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup",JO,QO,KO,eE,"mouseup",tE,nE,rE,iE,"dblclick","wheel",oE,aE,sE,lE],DOMMouseScroll(e){this.fire(oE,e)},mousemove:pE(tE,rE,nE),dragover:pE(KO,JO,QO),mouseout:mE(nE),dragleave:mE(QO),mousedown(e){this._down=this._active,this.fire(eE,e)},click(e){this._down===this._active&&(this.fire(iE,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(aE,e,!0)},touchmove(e){this.fire(sE,e,!0)},touchend(e){this.fire(lE,e,!0),this._touch=null},fire(e,t,n){const r=n?this._touch:this._active,i=this._handlers[e];if(t.vegaType=e,e===fE&&r&&r.href?this.handleHref(t,r,r.href):e!==uE&&e!==cE||this.handleTooltip(t,r,e!==cE),i)for(let o=0,a=i.length;o<a;++o)i[o].handler.call(this._obj,t,r)},on(e,t){const n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(hE(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},pickEvent(e){const t=GO(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,r,i){const o=this.context();return CO[e.marktype].pick.call(this,o,e,t,n,r,i)}});var gE="undefined"!=typeof window&&window.devicePixelRatio||1;function yE(e){XO.call(this,e),this._options={},this._redraw=!1,this._dirty=new Fk,this._tempb=new Fk}const vE=XO.prototype;function bE(e,t){VO.call(this,e,t);const n=this;n._hrefHandler=xE(n,((e,t)=>{t&&t.href&&n.handleHref(e,t,t.href)})),n._tooltipHandler=xE(n,((e,t)=>{n.handleTooltip(e,t,e.type!==cE)}))}ds(yE,XO,{initialize(e,t,n,r,i,o){return this._options=o||{},this._canvas=this._options.externalContext?null:Ay(1,1,this._options.type),e&&this._canvas&&(ZO(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),vE.initialize.call(this,e,t,n,r,i)},resize(e,t,n,r){if(vE.resize.call(this,e,t,n,r),this._canvas)!function(e,t,n,r,i,o){const a="undefined"!=typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,s=e.getContext("2d"),l=a?gE:i;e.width=t*l,e.height=n*l;for(const u in o)s[u]=o[u];a&&1!==l&&(e.style.width=t+"px",e.style.height=n+"px"),s.pixelRatio=l,s.setTransform(l,0,0,l,l*r[0],l*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const e=this._options.externalContext;e||aa("CanvasRenderer is missing a valid canvas or context"),e.scale(this._scale,this._scale),e.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,r=this._width,i=this._height,o=this._dirty,a=((e,t,n)=>(new Fk).set(0,0,t,n).translate(-e[0],-e[1]))(n,r,i);t.save();const s=this._redraw||o.empty()?(this._redraw=!1,a.expand(1)):function(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-n[0]%1,-n[1]%1),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}(t,a.intersect(o),n);return this.clear(-n[0],-n[1],r,i),this.draw(t,e,s),t.restore(),o.clear(),this},draw(e,t,n){const r=CO[t.marktype];t.clip&&function(e,t){var n=t.clip;e.save(),Ya(n)?(e.beginPath(),n(e),e.clip()):I_(e,t.group)}(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,r){const i=this._options,o=this.context();"pdf"===i.type||i.externalContext||o.clearRect(e,t,n,r),null!=this._bgcolor&&(o.fillStyle=this._bgcolor,o.fillRect(e,t,n,r))}});const xE=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)};ds(bE,VO,{initialize(e,t,n){let r=this._svg;return r&&(r.removeEventListener(fE,this._hrefHandler),r.removeEventListener(uE,this._tooltipHandler),r.removeEventListener(cE,this._tooltipHandler)),this._svg=r=e&&qO(e,"svg"),r&&(r.addEventListener(fE,this._hrefHandler),r.addEventListener(uE,this._tooltipHandler),r.addEventListener(cE,this._tooltipHandler)),VO.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){const i={type:e,handler:t,listener:xE(this,t)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const wE="aria-hidden",kE="aria-label",_E="role",OE="aria-roledescription",EE="graphics-object",DE="graphics-symbol",jE=(e,t,n)=>({[_E]:e,[OE]:t,[kE]:n||void 0}),NE=Cs(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),SE={axis:{desc:"axis",caption:function(e){const t=e.datum,n=e.orient,r=t.title?PE(e):null,i=e.context,o=i.scales[t.scale].value,a=i.dataflow.locale(),s=o.type,l="left"===n||"right"===n?"Y":"X";return`${l}-axis`+(r?` titled '${r}'`:"")+` for a ${Jx(s)?"discrete":s} scale`+` with ${Mw(a,o,e)}`}},legend:{desc:"legend",caption:function(e){const t=e.datum,n=t.title?PE(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,o=Object.keys(i),a=e.context,s=a.scales[i[o[0]]].value,l=a.dataflow.locale();return u=r,(u.length?u[0].toUpperCase()+u.slice(1):u)+(n?` titled '${n}'`:"")+` for ${function(e){return e=e.map((e=>e+("fill"===e||"stroke"===e?" color":""))),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+Na(e)}(o)}`+` with ${Mw(l,s,e)}`;var u}},"title-text":{desc:"title",caption:e=>`Title text '${ME(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${ME(e)}'`}},AE={ariaRole:_E,ariaRoleDescription:OE,description:kE};function $E(e,t){const n=!1===t.aria;if(e(wE,n||void 0),n||null==t.description)for(const r in AE)e(AE[r],void 0);else{const n=t.mark.marktype;e(kE,t.description),e(_E,t.ariaRole||("group"===n?EE:DE)),e(OE,t.ariaRoleDescription||`${n} mark`)}}function CE(e){return!1===e.aria?{[wE]:!0}:NE[e.role]?null:SE[e.role]?function(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return jE(t.role||DE,t.desc,n.description||r(n))}catch(n){return null}}(e,SE[e.role]):function(e){const t=e.marktype,n="group"===t||"text"===t||e.items.some((e=>null!=e.description&&!1!==e.aria));return jE(n?EE:DE,`${t} mark container`,e.description)}(e)}function ME(e){return Ga(e.text).join(" ")}function PE(e){try{return Ga(Na(e.items).items[0].text).join(" ")}catch(t){return null}}const FE=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function TE(){let e="",t="",n="";const r=[],i=()=>t=n="",o=(e,n)=>{var r;return null!=n&&(t+=` ${e}="${r=n,FE(r).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")}"`),a},a={open(s){(o=>{t&&(e+=`${t}>${n}`,i()),r.push(o)})(s),t="<"+s;for(var l=arguments.length,u=new Array(l>1?l-1:0),c=1;c<l;c++)u[c-1]=arguments[c];for(const e of u)for(const t in e)o(t,e[t]);return a},close(){const o=r.pop();return e+=t?t+(n?`>${n}</${o}>`:"/>"):`</${o}>`,i(),a},attr:o,text:e=>(n+=FE(e),a),toString:()=>e};return a}const zE=e=>RE(TE(),e)+"";function RE(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let t=0;t<r;++t)e.attr(n[t].name,n[t].value)}if(t.hasChildNodes()){const n=t.childNodes;for(const t of n)3===t.nodeType?e.text(t.nodeValue):RE(e,t)}return e.close()}const LE={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},BE={blend:"mix-blend-mode"},IE={fill:"none","stroke-miterlimit":10},UE="http://www.w3.org/2000/xmlns/",qE=Y_.xmlns;function WE(e){XO.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const ZE=XO.prototype;function HE(e,t){for(;e&&e.dirty!==t;e=e.mark.group){if(e.dirty=t,!e.mark||e.mark.dirty===t)return;e.mark.dirty=t}}function GE(e,t,n){let r,i,o;if("radial"===t.gradient){let r=WO(e,n++,"pattern",qE);tD(r,{id:Fw+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),r=WO(r,0,"rect",qE),tD(r,{width:1,height:1,fill:`url(${rD()}#${t.id})`}),tD(e=WO(e,n++,"radialGradient",qE),{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else tD(e=WO(e,n++,"linearGradient",qE),{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)o=WO(e,r,"stop",qE),o.setAttribute("offset",t.stops[r].offset),o.setAttribute("stop-color",t.stops[r].color);return ZO(e,r),n}function VE(e,t,n){let r;return(e=WO(e,n,"clipPath",qE)).setAttribute("id",t.id),t.path?(r=WO(e,0,"path",qE),r.setAttribute("d",t.path)):(r=WO(e,0,"rect",qE),tD(r,{x:0,y:0,width:t.width,height:t.height})),ZO(e,1),n+1}function YE(e,t,n,r,i){let o,a=e._svg;if(!a&&(o=t.ownerDocument,a=UO(o,r,qE),e._svg=a,e.mark&&(a.__data__=e,a.__values__={fill:"default"},"g"===r))){const t=UO(o,"path",qE);a.appendChild(t),t.__data__=e;const n=UO(o,"g",qE);a.appendChild(n),n.__data__=e;const r=UO(o,"path",qE);a.appendChild(r),r.__data__=e,r.__values__={fill:"default"}}return(a.ownerSVGElement!==i||function(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}(a,n))&&t.insertBefore(a,n?n.nextSibling:t.firstChild),a}ds(WE,XO,{initialize(e,t,n,r,i){return this._defs={},this._clearDefs(),e&&(this._svg=WO(e,0,"svg",qE),this._svg.setAttributeNS(UE,"xmlns",qE),this._svg.setAttributeNS(UE,"xmlns:xlink",Y_["xmlns:xlink"]),this._svg.setAttribute("version",Y_.version),this._svg.setAttribute("class","marks"),ZO(e,1),this._root=WO(this._svg,0,"g",qE),tD(this._root,IE),ZO(this._svg,1)),this.background(this._bgcolor),ZE.initialize.call(this,e,t,n,r,i)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),ZE.background.apply(this,arguments)},resize(e,t,n,r){return ZE.resize.call(this,e,t,n,r),this._svg&&(tD(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=WO(e,0,"rect",qE),tD(n,{width:this._width,height:this._height,fill:t}));const r=zE(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),r},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),ZO(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||!e._svg.ownerSVGElement||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,r,i,o,a,s,l;for(a=0,s=e.length;a<s;++a)n=e[a],r=n.mark,r.marktype!==i&&(i=r.marktype,o=CO[i]),r.zdirty&&r.dirty!==t&&(this._dirtyAll=!1,HE(n,t),r.items.forEach((e=>{e.dirty=t}))),r.zdirty||(n.exit?(o.nested&&r.items.length?(l=r.items[0],l._svg&&this._update(o,l._svg,l)):n._svg&&(l=n._svg.parentNode,l&&l.removeChild(n._svg)),n._svg=null):(n=o.nested?r.items[0]:n,n._update!==t&&(n._svg&&n._svg.ownerSVGElement?this._update(o,n._svg,n):(this._dirtyAll=!1,HE(n,t)),n._update=t)));return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const r=this._svg,i=CO[t.marktype],o=!1===t.interactive?"none":null,a="g"===i.tag,s=YE(t,e,n,"g",r);s.setAttribute("class",HO(t));const l=CE(t);for(const d in l)nD(s,d,l[d]);a||nD(s,"pointer-events",o),nD(s,"clip-path",t.clip?Pk(this,t,t.group):null);let u=null,c=0;const f=e=>{const t=this.isDirty(e),n=YE(e,s,u,i.tag,r);t&&(this._update(i,n,e),a&&function(e,t,n){t=t.lastChild.previousSibling;let r,i=0;D_(n,(n=>{r=e.mark(t,n,r),++i})),ZO(t,1+i)}(this,n,e)),u=n,++c};return i.nested?t.items.length&&f(t.items[0]):D_(t,f),ZO(s,c),s},_update(e,t,n){XE=t,JE=t.__values__,$E(KE,n),e.attr(KE,n,this);const r=QE[e.type];r&&r.call(this,e,t,n),XE&&this.style(XE,n)},style(e,t){if(null!=t){for(const n in LE){let r="font"===n?_O(t):t[n];if(r===JE[n])continue;const i=LE[n];null==r?e.removeAttribute(i):(Tw(r)&&(r=zw(r,this._defs.gradient,rD())),e.setAttribute(i,r+"")),JE[n]=r}for(const n in BE)eD(e,BE[n],t[n])}},defs(){const e=this._svg,t=this._defs;let n=t.el,r=0;for(const i in t.gradient)n||(t.el=n=WO(e,1,"defs",qE)),r=GE(n,t.gradient[i],r);for(const i in t.clipping)n||(t.el=n=WO(e,1,"defs",qE)),r=VE(n,t.clipping[i],r);n&&(0===r?(e.removeChild(n),t.el=null):ZO(n,r))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});let XE=null,JE=null;const QE={group(e,t,n){const r=XE=t.childNodes[2];JE=r.__values__,e.foreground(KE,n,this),JE=t.__values__,XE=t.childNodes[1],e.content(KE,n,this);const i=XE=t.childNodes[0];e.background(KE,n,this);const o=!1===n.mark.interactive?"none":null;if(o!==JE.events&&(nD(r,"pointer-events",o),nD(i,"pointer-events",o),JE.events=o),n.strokeForeground&&n.stroke){const e=n.fill;nD(r,"display",null),this.style(i,n),nD(i,"stroke",null),e&&(n.fill=null),JE=r.__values__,this.style(r,n),e&&(n.fill=e),XE=null}else nD(r,"display","none")},image(e,t,n){!1===n.smooth?(eD(t,"image-rendering","optimizeSpeed"),eD(t,"image-rendering","pixelated")):eD(t,"image-rendering",null)},text(e,t,n){const r=xO(n);let i,o,a,s;ka(r)?(o=r.map((e=>kO(n,e))),i=o.join("\n"),i!==JE.text&&(ZO(t,0),a=t.ownerDocument,s=bO(n),o.forEach(((e,r)=>{const i=UO(a,"tspan",qE);i.__data__=n,i.textContent=e,r&&(i.setAttribute("x",0),i.setAttribute("dy",s)),t.appendChild(i)})),JE.text=i)):(o=kO(n,r),o!==JE.text&&(t.textContent=o,JE.text=o)),nD(t,"font-family",_O(n)),nD(t,"font-size",vO(n)+"px"),nD(t,"font-style",n.fontStyle),nD(t,"font-variant",n.fontVariant),nD(t,"font-weight",n.fontWeight)}};function KE(e,t,n){t!==JE[e]&&(n?function(e,t,n,r){null!=n?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}(XE,e,t,n):nD(XE,e,t),JE[e]=t)}function eD(e,t,n){n!==JE[t]&&(null==n?e.style.removeProperty(t):e.style.setProperty(t,n+""),JE[t]=n)}function tD(e,t){for(const n in t)nD(e,n,t[n])}function nD(e,t,n){null!=n?e.setAttribute(t,n):e.removeAttribute(t)}function rD(){let e;return"undefined"==typeof window?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function iD(e){XO.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}ds(iD,XO,{svg(){return this._text},_render(e){const t=TE();t.open("svg",is({},Y_,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",IE,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=CO[t.marktype],r=n.tag,i=[$E,n.attr];e.open("g",{class:HO(t),"clip-path":t.clip?Pk(this,t,t.group):null},CE(t),{"pointer-events":"g"!==r&&!1===t.interactive?"none":null});const o=o=>{const a=this.href(o);if(a&&e.open("a",a),e.open(r,this.attr(t,o,i,"g"!==r?r:null)),"text"===r){const t=xO(o);if(ka(t)){const n={x:0,dy:bO(o)};for(let r=0;r<t.length;++r)e.open("tspan",r?n:null).text(kO(o,t[r])).close()}else e.text(kO(o,t))}else if("g"===r){const r=o.strokeForeground,i=o.fill,a=o.stroke;r&&a&&(o.stroke=null),e.open("path",this.attr(t,o,n.background,"bgrect")).close(),e.open("g",this.attr(t,o,n.content)),D_(o,(t=>this.mark(e,t))),e.close(),r&&a?(i&&(o.fill=null),o.stroke=a,e.open("path",this.attr(t,o,n.foreground,"bgrect")).close(),i&&(o.fill=i)):e.open("path",this.attr(t,o,n.foreground,"bgfore")).close()}e.close(),a&&e.close()};return n.nested?t.items&&t.items.length&&o(t.items[0]):D_(t,o),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then((e=>{e["xlink:href"]=e.href,e.href=null,(this._hrefs||(this._hrefs={}))[t]=e}))}return null},attr(e,t,n,r){const i={},o=(e,t,n,r)=>{i[r||e]=t};return Array.isArray(n)?n.forEach((e=>e(o,t,this))):n(o,t,this),r&&function(e,t,n,r,i){let o;if(null==t)return e;"bgrect"===r&&!1===n.interactive&&(e["pointer-events"]="none");if("bgfore"===r&&(!1===n.interactive&&(e["pointer-events"]="none"),e.display="none",null!==t.fill))return e;"image"===r&&!1===t.smooth&&(o=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]);"text"===r&&(e["font-family"]=_O(t),e["font-size"]=vO(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const a in LE){let n=t[a];const r=LE[a];("transparent"!==n||"fill"!==r&&"stroke"!==r)&&null!=n&&(Tw(n)&&(n=zw(n,i.gradient,"")),e[r]=n)}for(const a in BE){const e=t[a];null!=e&&(o=o||[],o.push(`${BE[a]}: ${e};`))}o&&(e.style=o.join(" "))}(i,t,e,r,this._defs),i},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(t).length+Object.keys(n).length){e.open("defs");for(const n in t){const r=t[n],i=r.stops;"radial"===r.gradient?(e.open("pattern",{id:Fw+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),e.close(),e.open("radialGradient",{id:n,fx:r.x1,fy:r.y1,fr:r.r1,cx:r.x2,cy:r.y2,r:r.r2})):e.open("linearGradient",{id:n,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2});for(let t=0;t<i.length;++t)e.open("stop",{offset:i[t].offset,"stop-color":i[t].color}).close();e.close()}for(const t in n){const r=n[t];e.open("clipPath",{id:t}),r.path?e.open("path",{d:r.path}).close():e.open("rect",{x:0,y:0,width:r.width,height:r.height}).close(),e.close()}e.close()}}});const oD="canvas",aD="none",sD={Canvas:oD,PNG:"png",SVG:"svg",None:aD},lD={};function uD(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(lD[e]=t,this):lD[e]}function cD(e,t,n){const r=[],i=(new Fk).union(t),o=e.marktype;return o?fD(e,i,n,r):"group"===o?dD(e,i,n,r):aa("Intersect scene must be mark node or group item.")}function fD(e,t,n,r){if(function(e,t,n){return e.bounds&&t.intersects(e.bounds)&&("group"===e.marktype||!1!==e.interactive&&(!n||n(e)))}(e,t,n)){const i=e.items,o=e.marktype,a=i.length;let s=0;if("group"===o)for(;s<a;++s)dD(i[s],t,n,r);else for(const e=CO[o].isect;s<a;++s){const n=i[s];hD(n,t,e)&&r.push(n)}}return r}function dD(e,t,n,r){n&&n(e.mark)&&hD(e,t,CO.group.isect)&&r.push(e);const i=e.items,o=i&&i.length;if(o){const a=e.x||0,s=e.y||0;t.translate(-a,-s);for(let e=0;e<o;++e)fD(i[e],t,n,r);t.translate(a,s)}return r}function hD(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}lD[oD]=lD.png={renderer:yE,headless:yE,handler:dE},lD.svg={renderer:WE,headless:iD,handler:bE},lD[aD]={};const pD=new Fk;function mD(e){const t=e.clip;if(Ya(t))t(o_(pD.clear()));else{if(!t)return;pD.set(0,0,e.group.width,e.group.height)}e.bounds.intersect(pD)}const gD=1e-9;function yD(e,t,n){return e===t||("path"===n?vD(e,t):e instanceof Date&&t instanceof Date?+e==+t:ys(e)&&ys(t)?Math.abs(e-t)<=gD:e&&t&&(_a(e)||_a(t))?function(e,t){var n,r,i=Object.keys(e),o=Object.keys(t);if(i.length!==o.length)return!1;for(i.sort(),o.sort(),r=i.length-1;r>=0;r--)if(i[r]!=o[r])return!1;for(r=i.length-1;r>=0;r--)if(!yD(e[n=i[r]],t[n],n))return!1;return typeof e==typeof t}(e,t):e==t)}function vD(e,t){return yD(Gw(e),Gw(t))}const bD="top",xD="left",wD="right",kD="bottom",_D="top-left",OD="top-right",ED="bottom-left",DD="bottom-right",jD="start",ND="middle",SD="end",AD="x",$D="y",CD="group",MD="axis",PD="title",FD="frame",TD="scope",zD="legend",RD="row-header",LD="row-footer",BD="row-title",ID="column-header",UD="column-footer",qD="column-title",WD="padding",ZD="symbol",HD="fit",GD="fit-x",VD="fit-y",YD="pad",XD="none",JD="all",QD="each",KD="flush",ej="column",tj="row";function nj(e){Vh.call(this,null,e)}function rj(e,t,n){return t(e.bounds.clear(),e,n)}ds(nj,Vh,{transform(e,t){const n=t.dataflow,r=e.mark,i=r.marktype,o=CO[i],a=o.bound;let s,l=r.bounds;if(o.nested)r.items.length&&n.dirty(r.items[0]),l=rj(r,a),r.items.forEach((e=>{e.bounds.clear().union(l)}));else if(i===CD||e.modified())switch(t.visit(t.MOD,(e=>n.dirty(e))),l.clear(),r.items.forEach((e=>l.union(rj(e,a)))),r.role){case MD:case zD:case PD:t.reflow()}else s=t.changed(t.REM),t.visit(t.ADD,(e=>{l.union(rj(e,a))})),t.visit(t.MOD,(e=>{s=s||l.alignsWith(e.bounds),n.dirty(e),l.union(rj(e,a))})),s&&(l.clear(),r.items.forEach((e=>l.union(e.bounds))));return mD(r),t.modifies("bounds")}});const ij=":vega_identifier:";function oj(e){Vh.call(this,0,e)}function aj(e){Vh.call(this,null,e)}function sj(e){Vh.call(this,null,e)}oj.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},ds(oj,Vh,{transform(e,t){const n=(i=t.dataflow)._signals[ij]||(i._signals[ij]=i.add(0)),r=e.as;var i;let o=n.value;return t.visit(t.ADD,(e=>e[r]=e[r]||++o)),n.set(this.value=o),t}}),ds(aj,Vh,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,function(e){const t=e.groups,n=e.parent;return t&&1===t.size?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const r=n.marktype===CD?zk:Tk;return t.visit(t.ADD,(e=>r.call(e,n))),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});const lj={parity:e=>e.filter(((e,t)=>t%2?e.opacity=0:1)),greedy:(e,t)=>{let n;return e.filter(((e,r)=>r&&uj(n.bounds,e.bounds,t)?e.opacity=0:(n=e,1)))}},uj=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),cj=(e,t)=>{for(var n,r=1,i=e.length,o=e[0].bounds;r<i;o=n,++r)if(uj(o,n=e[r].bounds,t))return!0},fj=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},dj=e=>(e.forEach((e=>e.opacity=1)),e),hj=(e,t)=>e.reflow(t.modified()).modifies("opacity");function pj(e){Vh.call(this,null,e)}ds(sj,Vh,{transform(e,t){const n=lj[e.method]||lj.parity,r=e.separation||0;let i,o,a=t.materialize(t.SOURCE).source;if(!a||!a.length)return;if(!e.method)return e.modified("method")&&(dj(a),t=hj(t,e)),t;if(a=a.filter(fj),!a.length)return;if(e.sort&&(a=a.slice().sort(e.sort)),i=dj(a),t=hj(t,e),i.length>=3&&cj(i,r)){do{i=n(i,r)}while(i.length>=3&&cj(i,r));i.length<3&&!Na(a).opacity&&(i.length>1&&(Na(i).opacity=0),Na(a).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(o=((e,t,n)=>{var r=e.range(),i=new Fk;return t===bD||t===kD?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),e=>i.encloses(e.bounds)})(e.boundScale,e.boundOrient,+e.boundTolerance),a.forEach((e=>{o(e)||(e.opacity=0)})));const s=i[0].mark.bounds.clear();return a.forEach((e=>{e.opacity&&s.union(e.bounds)})),t}}),ds(pj,Vh,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,(e=>n.dirty(e))),t.fields&&t.fields.zindex){const e=t.source&&t.source[0];e&&(e.mark.zdirty=!0)}}});const mj=new Fk;function gj(e,t,n){return e[t]===n?0:(e[t]=n,1)}function yj(e){var t=e.items[0].orient;return t===xD||t===wD}function vj(e,t,n,r){var i,o,a=t.items[0],s=a.datum,l=null!=a.translate?a.translate:.5,u=a.orient,c=function(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}(s),f=a.range,d=a.offset,h=a.position,p=a.minExtent,m=a.maxExtent,g=s.title&&a.items[c[2]].items[0],y=a.titlePadding,v=a.bounds,b=g&&wO(g),x=0,w=0;switch(mj.clear().union(v),v.clear(),(i=c[0])>-1&&v.union(a.items[i].bounds),(i=c[1])>-1&&v.union(a.items[i].bounds),u){case bD:x=h||0,w=-d,o=Math.max(p,Math.min(m,-v.y1)),v.add(0,-o).add(f,0),g&&bj(e,g,o,y,b,0,-1,v);break;case xD:x=-d,w=h||0,o=Math.max(p,Math.min(m,-v.x1)),v.add(-o,0).add(0,f),g&&bj(e,g,o,y,b,1,-1,v);break;case wD:x=n+d,w=h||0,o=Math.max(p,Math.min(m,v.x2)),v.add(0,0).add(o,f),g&&bj(e,g,o,y,b,1,1,v);break;case kD:x=h||0,w=r+d,o=Math.max(p,Math.min(m,v.y2)),v.add(0,0).add(f,o),g&&bj(e,g,o,y,0,0,1,v);break;default:x=a.x,w=a.y}return Ik(v.translate(x,w),a),gj(a,"x",x+l)|gj(a,"y",w+l)&&(a.bounds=mj,e.dirty(a),a.bounds=v,e.dirty(a)),a.mark.bounds.clear().union(v)}function bj(e,t,n,r,i,o,a,s){const l=t.bounds;if(t.auto){const s=a*(n+i+r);let u=0,c=0;e.dirty(t),o?u=(t.x||0)-(t.x=s):c=(t.y||0)-(t.y=s),t.mark.bounds.clear().union(l.translate(-u,-c)),e.dirty(t)}s.union(l)}const xj=(e,t)=>Math.floor(Math.min(e,t)),wj=(e,t)=>Math.ceil(Math.max(e,t));function kj(e){return(new Fk).set(0,0,e.width||0,e.height||0)}function _j(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function Oj(e,t,n){const r=_a(e)?e[t]:e;return null!=r?r:void 0!==n?n:0}function Ej(e){return e<0?Math.ceil(-e):0}function Dj(e,t,n){var r,i,o,a,s,l,u,c,f,d,h,p=!n.nodirty,m=n.bounds===KD?kj:_j,g=mj.set(0,0,0,0),y=Oj(n.align,ej),v=Oj(n.align,tj),b=Oj(n.padding,ej),x=Oj(n.padding,tj),w=n.columns||t.length,k=w<=0?1:Math.ceil(t.length/w),_=t.length,O=Array(_),E=Array(w),D=0,j=Array(_),N=Array(k),S=0,A=Array(_),$=Array(_),C=Array(_);for(i=0;i<w;++i)E[i]=0;for(i=0;i<k;++i)N[i]=0;for(i=0;i<_;++i)l=t[i],s=C[i]=m(l),l.x=l.x||0,A[i]=0,l.y=l.y||0,$[i]=0,o=i%w,a=~~(i/w),D=Math.max(D,u=Math.ceil(s.x2)),S=Math.max(S,c=Math.ceil(s.y2)),E[o]=Math.max(E[o],u),N[a]=Math.max(N[a],c),O[i]=b+Ej(s.x1),j[i]=x+Ej(s.y1),p&&e.dirty(t[i]);for(i=0;i<_;++i)i%w==0&&(O[i]=0),i<w&&(j[i]=0);if(y===QD)for(o=1;o<w;++o){for(h=0,i=o;i<_;i+=w)h<O[i]&&(h=O[i]);for(i=o;i<_;i+=w)O[i]=h+E[o-1]}else if(y===JD){for(h=0,i=0;i<_;++i)i%w&&h<O[i]&&(h=O[i]);for(i=0;i<_;++i)i%w&&(O[i]=h+D)}else for(y=!1,o=1;o<w;++o)for(i=o;i<_;i+=w)O[i]+=E[o-1];if(v===QD)for(a=1;a<k;++a){for(h=0,r=(i=a*w)+w;i<r;++i)h<j[i]&&(h=j[i]);for(i=a*w;i<r;++i)j[i]=h+N[a-1]}else if(v===JD){for(h=0,i=w;i<_;++i)h<j[i]&&(h=j[i]);for(i=w;i<_;++i)j[i]=h+S}else for(v=!1,a=1;a<k;++a)for(r=(i=a*w)+w;i<r;++i)j[i]+=N[a-1];for(f=0,i=0;i<_;++i)f=O[i]+(i%w?f:0),A[i]+=f-t[i].x;for(o=0;o<w;++o)for(d=0,i=o;i<_;i+=w)d+=j[i],$[i]+=d-t[i].y;if(y&&Oj(n.center,ej)&&k>1)for(i=0;i<_;++i)(f=(s=y===JD?D:E[i%w])-C[i].x2-t[i].x-A[i])>0&&(A[i]+=f/2);if(v&&Oj(n.center,tj)&&1!==w)for(i=0;i<_;++i)(d=(s=v===JD?S:N[~~(i/w)])-C[i].y2-t[i].y-$[i])>0&&($[i]+=d/2);for(i=0;i<_;++i)g.union(C[i].translate(A[i],$[i]));switch(f=Oj(n.anchor,AD),d=Oj(n.anchor,$D),Oj(n.anchor,ej)){case SD:f-=g.width();break;case ND:f-=g.width()/2}switch(Oj(n.anchor,tj)){case SD:d-=g.height();break;case ND:d-=g.height()/2}for(f=Math.round(f),d=Math.round(d),g.clear(),i=0;i<_;++i)t[i].mark.bounds.clear();for(i=0;i<_;++i)(l=t[i]).x+=A[i]+=f,l.y+=$[i]+=d,g.union(l.mark.bounds.union(l.bounds.translate(A[i],$[i]))),p&&e.dirty(l);return g}function jj(e,t,n){var r,i,o,a,s,l,u,c=function(e){var t,n,r=e.items,i=r.length,o=0;const a={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;o<i;++o)if(n=(t=r[o]).items,t.marktype===CD)switch(t.role){case MD:case zD:case PD:break;case RD:a.rowheaders.push(...n);break;case LD:a.rowfooters.push(...n);break;case ID:a.colheaders.push(...n);break;case UD:a.colfooters.push(...n);break;case BD:a.rowtitle=n[0];break;case qD:a.coltitle=n[0];break;default:a.marks.push(...n)}return a}(t),f=c.marks,d=n.bounds===KD?Nj:Sj,h=n.offset,p=n.columns||f.length,m=p<=0?1:Math.ceil(f.length/p),g=m*p;const y=Dj(e,f,n);y.empty()&&y.set(0,0,0,0),c.rowheaders&&(l=Oj(n.headerBand,tj,null),r=Aj(e,c.rowheaders,f,p,m,-Oj(h,"rowHeader"),xj,0,d,"x1",0,p,1,l)),c.colheaders&&(l=Oj(n.headerBand,ej,null),i=Aj(e,c.colheaders,f,p,p,-Oj(h,"columnHeader"),xj,1,d,"y1",0,1,p,l)),c.rowfooters&&(l=Oj(n.footerBand,tj,null),o=Aj(e,c.rowfooters,f,p,m,Oj(h,"rowFooter"),wj,0,d,"x2",p-1,p,1,l)),c.colfooters&&(l=Oj(n.footerBand,ej,null),a=Aj(e,c.colfooters,f,p,p,Oj(h,"columnFooter"),wj,1,d,"y2",g-p,1,p,l)),c.rowtitle&&(s=Oj(n.titleAnchor,tj),u=Oj(h,"rowTitle"),u=s===SD?o+u:r-u,l=Oj(n.titleBand,tj,.5),$j(e,c.rowtitle,u,0,y,l)),c.coltitle&&(s=Oj(n.titleAnchor,ej),u=Oj(h,"columnTitle"),u=s===SD?a+u:i-u,l=Oj(n.titleBand,ej,.5),$j(e,c.coltitle,u,1,y,l))}function Nj(e,t){return"x1"===t?e.x||0:"y1"===t?e.y||0:"x2"===t?(e.x||0)+(e.width||0):"y2"===t?(e.y||0)+(e.height||0):void 0}function Sj(e,t){return e.bounds[t]}function Aj(e,t,n,r,i,o,a,s,l,u,c,f,d,h){var p,m,g,y,v,b,x,w,k,_=n.length,O=0,E=0;if(!_)return O;for(p=c;p<_;p+=f)n[p]&&(O=a(O,l(n[p],u)));if(!t.length)return O;for(t.length>i&&(e.warn("Grid headers exceed limit: "+i),t=t.slice(0,i)),O+=o,m=0,y=t.length;m<y;++m)e.dirty(t[m]),t[m].mark.bounds.clear();for(p=c,m=0,y=t.length;m<y;++m,p+=f){for(v=(b=t[m]).mark.bounds,g=p;g>=0&&null==(x=n[g]);g-=d);s?(w=null==h?x.x:Math.round(x.bounds.x1+h*x.bounds.width()),k=O):(w=O,k=null==h?x.y:Math.round(x.bounds.y1+h*x.bounds.height())),v.union(b.bounds.translate(w-(b.x||0),k-(b.y||0))),b.x=w,b.y=k,e.dirty(b),E=a(E,v[u])}return E}function $j(e,t,n,r,i,o){if(t){e.dirty(t);var a=n,s=n;r?a=Math.round(i.x1+o*i.width()):s=Math.round(i.y1+o*i.height()),t.bounds.translate(a-(t.x||0),s-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=a,t.y=s,e.dirty(t)}}function Cj(e,t,n,r,i,o,a){const s=function(e,t){const n=e[t]||{};return(t,r)=>null!=n[t]?n[t]:null!=e[t]?e[t]:r}(n,t),l=function(e,t){let n=-1/0;return e.forEach((e=>{null!=e.offset&&(n=Math.max(n,e.offset))})),n>-1/0?n:t}(e,s("offset",0)),u=s("anchor",jD),c=u===SD?1:u===ND?.5:0,f={align:QD,bounds:s("bounds",KD),columns:"vertical"===s("direction")?1:e.length,padding:s("margin",8),center:s("center"),nodirty:!0};switch(t){case xD:f.anchor={x:Math.floor(r.x1)-l,column:SD,y:c*(a||r.height()+2*r.y1),row:u};break;case wD:f.anchor={x:Math.ceil(r.x2)+l,y:c*(a||r.height()+2*r.y1),row:u};break;case bD:f.anchor={y:Math.floor(i.y1)-l,row:SD,x:c*(o||i.width()+2*i.x1),column:u};break;case kD:f.anchor={y:Math.ceil(i.y2)+l,x:c*(o||i.width()+2*i.x1),column:u};break;case _D:f.anchor={x:l,y:l};break;case OD:f.anchor={x:o-l,y:l,column:SD};break;case ED:f.anchor={x:l,y:a-l,row:SD};break;case DD:f.anchor={x:o-l,y:a-l,column:SD,row:SD}}return f}function Mj(e,t){var n,r,i=t.items[0],o=i.datum,a=i.orient,s=i.bounds,l=i.x,u=i.y;return i._bounds?i._bounds.clear().union(s):i._bounds=s.clone(),s.clear(),function(e,t,n){var r=t.padding,i=r-n.x,o=r-n.y;if(t.datum.title){var a=t.items[1].items[0],s=a.anchor,l=t.titlePadding||0,u=r-a.x,c=r-a.y;switch(a.orient){case xD:i+=Math.ceil(a.bounds.width())+l;break;case wD:case kD:break;default:o+=a.bounds.height()+l}switch((i||o)&&Fj(e,n,i,o),a.orient){case xD:c+=Pj(t,n,a,s,1,1);break;case wD:u+=Pj(t,n,a,SD,0,0)+l,c+=Pj(t,n,a,s,1,1);break;case kD:u+=Pj(t,n,a,s,0,0),c+=Pj(t,n,a,SD,-1,0,1)+l;break;default:u+=Pj(t,n,a,s,0,0)}(u||c)&&Fj(e,a,u,c),(u=Math.round(a.bounds.x1-r))<0&&(Fj(e,n,-u,0),Fj(e,a,-u,0))}else(i||o)&&Fj(e,n,i,o)}(e,i,i.items[0].items[0]),s=function(e,t){return e.items.forEach((e=>t.union(e.bounds))),t.x1=e.padding,t.y1=e.padding,t}(i,s),n=2*i.padding,r=2*i.padding,s.empty()||(n=Math.ceil(s.width()+n),r=Math.ceil(s.height()+r)),o.type===ZD&&function(e){const t=e.reduce(((e,t)=>(e[t.column]=Math.max(t.bounds.x2-t.x,e[t.column]||0),e)),{});e.forEach((e=>{e.width=t[e.column],e.height=e.bounds.y2-e.y}))}(i.items[0].items[0].items[0].items),a!==XD&&(i.x=l=0,i.y=u=0),i.width=n,i.height=r,Ik(s.set(l,u,l+n,u+r),i),i.mark.bounds.clear().union(s),i}function Pj(e,t,n,r,i,o,a){const s="symbol"!==e.datum.type,l=n.datum.vgrad,u=(!s||!o&&l||a?t:t.items[0]).bounds[i?"y2":"x2"]-e.padding,c=l&&o?u:0,f=l&&o?0:u,d=i<=0?0:wO(n);return Math.round(r===jD?c:r===SD?f-d:.5*(u-d))}function Fj(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function Tj(e){Vh.call(this,null,e)}ds(Tj,Vh,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach((t=>{e.layout&&jj(n,t,e.layout),function(e,t,n){var r,i,o,a,s,l=t.items,u=Math.max(0,t.width||0),c=Math.max(0,t.height||0),f=(new Fk).set(0,0,u,c),d=f.clone(),h=f.clone(),p=[];for(a=0,s=l.length;a<s;++a)switch((i=l[a]).role){case MD:(yj(i)?d:h).union(vj(e,i,u,c));break;case PD:r=i;break;case zD:p.push(Mj(e,i));break;case FD:case TD:case RD:case LD:case BD:case ID:case UD:case qD:d.union(i.bounds),h.union(i.bounds);break;default:f.union(i.bounds)}if(p.length){const t={};p.forEach((e=>{(o=e.orient||wD)!==XD&&(t[o]||(t[o]=[])).push(e)}));for(const r in t){const i=t[r];Dj(e,i,Cj(i,r,n.legends,d,h,u,c))}p.forEach((t=>{const r=t.bounds;if(r.equals(t._bounds)||(t.bounds=t._bounds,e.dirty(t),t.bounds=r,e.dirty(t)),!n.autosize||n.autosize.type!==HD&&n.autosize.type!==GD&&n.autosize.type!==VD)f.union(r);else switch(t.orient){case xD:case wD:f.add(r.x1,0).add(r.x2,0);break;case bD:case kD:f.add(0,r.y1).add(0,r.y2)}}))}f.union(d).union(h),r&&f.union(function(e,t,n,r,i){var o,a=t.items[0],s=a.frame,l=a.orient,u=a.anchor,c=a.offset,f=a.padding,d=a.items[0].items[0],h=a.items[1]&&a.items[1].items[0],p=l===xD||l===wD?r:n,m=0,g=0,y=0,v=0,b=0;if(s!==CD?l===xD?(m=i.y2,p=i.y1):l===wD?(m=i.y1,p=i.y2):(m=i.x1,p=i.x2):l===xD&&(m=r,p=0),o=u===jD?m:u===SD?p:(m+p)/2,h&&h.text){switch(l){case bD:case kD:b=d.bounds.height()+f;break;case xD:v=d.bounds.width()+f;break;case wD:v=-d.bounds.width()-f}mj.clear().union(h.bounds),mj.translate(v-(h.x||0),b-(h.y||0)),gj(h,"x",v)|gj(h,"y",b)&&(e.dirty(h),h.bounds.clear().union(mj),h.mark.bounds.clear().union(mj),e.dirty(h)),mj.clear().union(h.bounds)}else mj.clear();switch(mj.union(d.bounds),l){case bD:g=o,y=i.y1-mj.height()-c;break;case xD:g=i.x1-mj.width()-c,y=o;break;case wD:g=i.x2+mj.width()+c,y=o;break;case kD:g=o,y=i.y2+c;break;default:g=a.x,y=a.y}return gj(a,"x",g)|gj(a,"y",y)&&(mj.translate(g,y),e.dirty(a),a.bounds.clear().union(mj),t.bounds.clear().union(mj),e.dirty(a)),a.bounds}(e,r,u,c,f));t.clip&&f.set(0,0,t.width||0,t.height||0);!function(e,t,n,r){const i=r.autosize||{},o=i.type;if(e._autosize<1||!o)return;let a=e._width,s=e._height,l=Math.max(0,t.width||0),u=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-l)),h=Math.max(0,Math.ceil(n.y2-c));if(i.contains===WD){const t=e.padding();a-=t.left+t.right,s-=t.top+t.bottom}o===XD?(u=0,f=0,l=a,c=s):o===HD?(l=Math.max(0,a-u-d),c=Math.max(0,s-f-h)):o===GD?(l=Math.max(0,a-u-d),s=c+f+h):o===VD?(a=l+u+d,c=Math.max(0,s-f-h)):o===YD&&(a=l+u+d,s=c+f+h);e._resizeView(a,s,l,c,[u,f],i.resize)}(e,t,f,n)}(n,t,e)})),function(e){return e&&"legend-entry"!==e.mark.role}(e.mark.group)?t.reflow():t}});var zj=Object.freeze({__proto__:null,bound:nj,identifier:oj,mark:aj,overlap:sj,render:pj,viewlayout:Tj});function Rj(e){Vh.call(this,null,e)}function Lj(e){Vh.call(this,null,e)}function Bj(){return yh({})}function Ij(e){Vh.call(this,null,e)}function Uj(e){Vh.call(this,[],e)}ds(Rj,Vh,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,o=e.scale,a=yw(o,null==e.count?e.values?e.values.length:10:e.count,e.minstep),s=e.format||xw(n,o,a,e.formatSpecifier,e.formatType,!!e.values),l=e.values?vw(o,e.values,a):bw(o,a);return i&&(r.rem=i),i=l.map(((e,t)=>yh({index:t/(l.length-1||1),value:e,label:s(e)}))),e.extra&&i.length&&i.push(yh({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}}),ds(Lj,Vh,{transform(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||Bj,o=e.key||mh,a=this.value;return ka(r.encode)&&(r.encode=null),a&&(e.modified("key")||t.modified(o))&&aa("DataJoin does not support modified key function or fields."),a||(t=t.addAll(),this.value=a=function(e){const t=cs().test((e=>e.exit));return t.lookup=n=>t.get(e(n)),t}(o)),t.visit(t.ADD,(e=>{const t=o(e);let n=a.get(t);n?n.exit?(a.empty--,r.add.push(n)):r.mod.push(n):(n=i(e),a.set(t,n),r.add.push(n)),n.datum=e,n.exit=!1})),t.visit(t.MOD,(e=>{const t=o(e),n=a.get(t);n&&(n.datum=e,r.mod.push(n))})),t.visit(t.REM,(e=>{const t=o(e),n=a.get(t);e!==n.datum||n.exit||(r.rem.push(n),n.exit=!0,++a.empty)})),t.changed(t.ADD_MOD)&&r.modifies("datum"),(t.clean()||e.clean&&a.empty>n.cleanThreshold)&&n.runAfter(a.clean),r}}),ds(Ij,Vh,{transform(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,i=e.encoders,o=t.encode;if(ka(o)){if(!n.changed()&&!o.every((e=>i[e])))return t.StopPropagation;o=o[0],n.encode=null}var a="enter"===o,s=i.update||pa,l=i.enter||pa,u=i.exit||pa,c=(o&&!a?i[o]:s)||pa;if(t.changed(t.ADD)&&(t.visit(t.ADD,(t=>{l(t,e),s(t,e)})),n.modifies(l.output),n.modifies(s.output),c!==pa&&c!==s&&(t.visit(t.ADD,(t=>{c(t,e)})),n.modifies(c.output))),t.changed(t.REM)&&u!==pa&&(t.visit(t.REM,(t=>{u(t,e)})),n.modifies(u.output)),a||c!==pa){const i=t.MOD|(e.modified()?t.REFLOW:0);a?(t.visit(i,(t=>{const i=l(t,e)||r;(c(t,e)||i)&&n.mod.push(t)})),n.mod.length&&n.modifies(l.output)):t.visit(i,(t=>{(c(t,e)||r)&&n.mod.push(t)})),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}}),ds(Uj,Vh,{transform(e,t){if(null!=this.value&&!e.modified())return t.StopPropagation;var n,r,i,o,a,s=t.dataflow.locale(),l=t.fork(t.NO_SOURCE|t.NO_FIELDS),u=this.value,c=e.type||dw,f=e.scale,d=+e.limit,h=yw(f,null==e.count?5:e.count,e.minstep),p=!!e.values||c===dw,m=e.format||Dw(s,f,h,c,e.formatSpecifier,e.formatType,p),g=e.values||Ow(f,h);return u&&(l.rem=u),c===dw?(d&&g.length>d?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),u=g.slice(0,d-1),a=!0):u=g,Ya(i=e.size)?(e.values||0!==f(u[0])||(u=u.slice(1)),o=u.reduce(((t,n)=>Math.max(t,i(n,e))),0)):i=ns(o=i||8),u=u.map(((t,n)=>yh({index:n,label:m(t,n,u),value:t,offset:o,size:i(t,e)}))),a&&(a=g[u.length],u.push(yh({index:u.length,label:`\u2026${g.length-u.length} entries`,value:a,offset:o,size:i(a,e)})))):"gradient"===c?(n=f.domain(),r=aw(f,n[0],Na(n)),g.length<3&&!e.values&&n[0]!==Na(n)&&(g=[n[0],Na(n)]),u=g.map(((e,t)=>yh({index:t,label:m(e,t,g),value:e,perc:r(e)})))):(i=g.length-1,r=function(e){const t=e.domain(),n=t.length-1;let r=+t[0],i=+Na(t),o=i-r;if(e.type===Ax){const e=n?o/n:.1;r-=e,i+=e,o=i-r}return e=>(e-r)/o}(f),u=g.map(((e,t)=>yh({index:t,label:m(e,t,g),value:e,perc:t?r(e):0,perc2:t===i?1:r(g[t+1])})))),l.source=u,l.add=u,this.value=u,l}});const qj=e=>e.source.x,Wj=e=>e.source.y,Zj=e=>e.target.x,Hj=e=>e.target.y;function Gj(e){Vh.call(this,{},e)}Gj.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},ds(Gj,Vh,{transform(e,t){var n=e.sourceX||qj,r=e.sourceY||Wj,i=e.targetX||Zj,o=e.targetY||Hj,a=e.as||"path",s=e.orient||"vertical",l=e.shape||"line",u=Jj.get(l+"-"+s)||Jj.get(l);return u||aa("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,(e=>{e[a]=u(n(e),r(e),i(e),o(e))})),t.reflow(e.modified()).modifies(a)}});const Vj=(e,t,n,r)=>"M"+e+","+t+"L"+n+","+r,Yj=(e,t,n,r)=>{var i=n-e,o=r-t,a=Math.hypot(i,o)/2;return"M"+e+","+t+"A"+a+","+a+" "+180*Math.atan2(o,i)/Math.PI+" 0 1 "+n+","+r},Xj=(e,t,n,r)=>{const i=n-e,o=r-t,a=.2*(i+o),s=.2*(o-i);return"M"+e+","+t+"C"+(e+a)+","+(t+s)+" "+(n+s)+","+(r-a)+" "+n+","+r},Jj=cs({line:Vj,"line-radial":(e,t,n,r)=>Vj(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),arc:Yj,"arc-radial":(e,t,n,r)=>Yj(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),curve:Xj,"curve-radial":(e,t,n,r)=>Xj(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),"orthogonal-horizontal":(e,t,n,r)=>"M"+e+","+t+"V"+r+"H"+n,"orthogonal-vertical":(e,t,n,r)=>"M"+e+","+t+"H"+n+"V"+r,"orthogonal-radial":(e,t,n,r)=>{const i=Math.cos(e),o=Math.sin(e),a=Math.cos(n),s=Math.sin(n);return"M"+t*i+","+t*o+"A"+t+","+t+" 0 0,"+((Math.abs(n-e)>Math.PI?n<=e:n>e)?1:0)+" "+t*a+","+t*s+"L"+r*a+","+r*s},"diagonal-horizontal":(e,t,n,r)=>{const i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r},"diagonal-vertical":(e,t,n,r)=>{const i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r},"diagonal-radial":(e,t,n,r)=>{const i=Math.cos(e),o=Math.sin(e),a=Math.cos(n),s=Math.sin(n),l=(t+r)/2;return"M"+t*i+","+t*o+"C"+l*i+","+l*o+" "+l*a+","+l*s+" "+r*a+","+r*s}});function Qj(e){Vh.call(this,null,e)}Qj.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},ds(Qj,Vh,{transform(e,t){var n,r,i,o=e.as||["startAngle","endAngle"],a=o[0],s=o[1],l=e.field||da,u=e.startAngle||0,c=null!=e.endAngle?e.endAngle:2*Math.PI,f=t.source,d=f.map(l),h=d.length,p=u,m=(c-u)/$l(d),g=Al(h);for(e.sort&&g.sort(((e,t)=>d[e]-d[t])),n=0;n<h;++n)i=d[g[n]],(r=f[g[n]])[a]=p,r[s]=p+=i*m;return this.value=d,t.reflow(e.modified()).modifies(o)}});const Kj=5;function eN(e){return Xx(e)&&e!==Dx}const tN=Cs(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function nN(e){Vh.call(this,null,e),this.modified(!0)}function rN(e,t,n){Kx(e)&&(Math.abs(t.reduce(((e,t)=>e+(t<0?-1:t>0?1:0)),0))!==t.length&&n.warn("Log scale domain includes zero: "+js(t)));return t}function iN(e,t,n){return Ya(e)&&(t||n)?rw(e,oN(t||[0,1],n)):e}function oN(e,t){return t?e.slice().reverse():e}function aN(e){Vh.call(this,null,e)}ds(nN,Vh,{transform(e,t){var n=t.dataflow,r=this.value,i=function(e){var t,n=e.type,r="";if(n===Dx)return Dx+"-"+bx;(function(e){const t=e.type;return Xx(t)&&t!==Ox&&t!==Ex&&(e.scheme||e.range&&e.range.length&&e.range.every(bs))})(e)&&(r=2===(t=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(null!=e.domainMid):0)?Dx+"-":3===t?jx+"-":"");return(r+n||bx).toLowerCase()}(e);for(i in r&&i===r.type||(this.value=r=Gx(i)()),e)if(!tN[i]){if("padding"===i&&eN(r.type))continue;Ya(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}return function(e,t,n){var r=e.type,i=t.round||!1,o=t.range;if(null!=t.rangeStep)o=function(e,t,n){e!==Mx&&e!==Cx&&aa("Only band and point scales support rangeStep.");var r=(null!=t.paddingOuter?t.paddingOuter:t.padding)||0,i=e===Cx?1:(null!=t.paddingInner?t.paddingInner:t.padding)||0;return[0,t.rangeStep*vx(n,i,r)]}(r,t,n);else if(t.scheme&&(o=function(e,t,n){var r,i=t.schemeExtent;ka(t.scheme)?r=iw(t.scheme,t.interpolate,t.interpolateGamma):(r=fw(t.scheme.toLowerCase()))||aa(`Unrecognized scheme name: ${t.scheme}`);return n=e===Ax?n+1:e===Px?n-1:e===Nx||e===Sx?+t.schemeCount||Kj:n,ew(e)?iN(r,i,t.reverse):Ya(r)?ow(iN(r,i),n):e===$x?r:r.slice(0,n)}(r,t,n),Ya(o))){if(e.interpolator)return e.interpolator(o);aa(`Scale type ${r} does not support interpolating color schemes.`)}if(o&&ew(r))return e.interpolator(iw(oN(o,t.reverse),t.interpolate,t.interpolateGamma));o&&t.interpolate&&e.interpolate?e.interpolate(sw(t.interpolate,t.interpolateGamma)):Ya(e.round)?e.round(i):Ya(e.rangeRound)&&e.interpolate(i?mb:pb);o&&e.range(oN(o,t.reverse))}(r,e,function(e,t,n){let r=t.bins;if(r&&!ka(r)){const t=e.domain(),n=t[0],i=Na(t),o=r.step;let a=null==r.start?n:r.start,s=null==r.stop?i:r.stop;o||aa("Scale bins parameter missing step property."),a<n&&(a=o*Math.ceil(n/o)),s>i&&(s=o*Math.floor(i/o)),r=Al(a,s+o/2,o)}r?e.bins=r:e.bins&&delete e.bins;e.type===Px&&(r?t.domain||t.domainRaw||(e.domain(r),n=r.length):e.bins=e.domain());return n}(r,e,function(e,t,n){const r=function(e,t,n){return t?(e.domain(rN(e.type,t,n)),t.length):-1}(e,t.domainRaw,n);if(r>-1)return r;var i,o,a=t.domain,s=e.type,l=t.zero||void 0===t.zero&&function(e){const t=e.type;return!e.bins&&(t===bx||t===wx||t===kx)}(e);if(!a)return 0;eN(s)&&t.padding&&a[0]!==Na(a)&&(a=function(e,t,n,r,i,o){var a=Math.abs(Na(n)-n[0]),s=a/(a-2*r),l=e===xx?Ua(t,null,s):e===kx?qa(t,null,s,.5):e===wx?qa(t,null,s,i||1):e===_x?Wa(t,null,s,o||1):Ia(t,null,s);return t=t.slice(),t[0]=l[0],t[t.length-1]=l[1],t}(s,a,t.range,t.padding,t.exponent,t.constant));if((l||null!=t.domainMin||null!=t.domainMax||null!=t.domainMid)&&(i=(a=a.slice()).length-1||1,l&&(a[0]>0&&(a[0]=0),a[i]<0&&(a[i]=0)),null!=t.domainMin&&(a[0]=t.domainMin),null!=t.domainMax&&(a[i]=t.domainMax),null!=t.domainMid)){const e=(o=t.domainMid)>a[i]?i+1:o<a[0]?0:i;e!==i&&n.warn("Scale domainMid exceeds domain min or max.",o),a.splice(e,0,o)}e.domain(rN(s,a,n)),s===$x&&e.unknown(t.domainImplicit?Py:void 0);t.nice&&e.nice&&e.nice(!0!==t.nice&&yw(e,t.nice)||null);return a.length}(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),ds(aN,Vh,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(wh(e.sort)),this.modified(n),t}});const sN="zero",lN="center",uN="normalize",cN=["y0","y1"];function fN(e){Vh.call(this,null,e)}function dN(e,t,n,r,i){for(var o,a=(t-e.sum)/2,s=e.length,l=0;l<s;++l)(o=e[l])[r]=a,o[i]=a+=Math.abs(n(o))}function hN(e,t,n,r,i){for(var o,a=1/e.sum,s=0,l=e.length,u=0,c=0;u<l;++u)(o=e[u])[r]=s,o[i]=s=a*(c+=Math.abs(n(o)))}function pN(e,t,n,r,i){for(var o,a,s=0,l=0,u=e.length,c=0;c<u;++c)(o=+n(a=e[c]))<0?(a[r]=l,a[i]=l+=o):(a[r]=s,a[i]=s+=o)}fN.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:sN,values:[sN,lN,uN]},{name:"as",type:"string",array:!0,length:2,default:cN}]},ds(fN,Vh,{transform(e,t){var n,r,i,o,a=e.as||cN,s=a[0],l=a[1],u=wh(e.sort),c=e.field||da,f=e.offset===lN?dN:e.offset===uN?hN:pN;for(n=function(e,t,n,r){var i,o,a,s,l,u,c,f,d,h=[],p=e=>e(l);if(null==t)h.push(e.slice());else for(i={},o=0,a=e.length;o<a;++o)l=e[o],(c=i[u=t.map(p)])||(i[u]=c=[],h.push(c)),c.push(l);for(u=0,d=0,s=h.length;u<s;++u){for(o=0,f=0,a=(c=h[u]).length;o<a;++o)f+=Math.abs(r(c[o]));c.sum=f,f>d&&(d=f),n&&c.sort(n)}return h.max=d,h}(t.source,e.groupby,u,c),r=0,i=n.length,o=n.max;r<i;++r)f(n[r],o,c,s,l);return t.reflow(e.modified()).modifies(a)}});var mN=Object.freeze({__proto__:null,axisticks:Rj,datajoin:Lj,encode:Ij,legendentries:Uj,linkpath:Gj,pie:Qj,scale:nN,sortitems:aN,stack:fN}),gN=1e-6,yN=1e-12,vN=Math.PI,bN=vN/2,xN=vN/4,wN=2*vN,kN=180/vN,_N=vN/180,ON=Math.abs,EN=Math.atan,DN=Math.atan2,jN=Math.cos,NN=Math.ceil,SN=Math.exp,AN=Math.hypot,$N=Math.log,CN=Math.pow,MN=Math.sin,PN=Math.sign||function(e){return e>0?1:e<0?-1:0},FN=Math.sqrt,TN=Math.tan;function zN(e){return e>1?0:e<-1?vN:Math.acos(e)}function RN(e){return e>1?bN:e<-1?-bN:Math.asin(e)}function LN(){}function BN(e,t){e&&UN.hasOwnProperty(e.type)&&UN[e.type](e,t)}var IN={Feature:function(e,t){BN(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)BN(n[r].geometry,t)}},UN={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){qN(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)qN(n[r],t,0)},Polygon:function(e,t){WN(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)WN(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)BN(n[r],t)}};function qN(e,t,n){var r,i=-1,o=e.length-n;for(t.lineStart();++i<o;)r=e[i],t.point(r[0],r[1],r[2]);t.lineEnd()}function WN(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)qN(e[n],t,1);t.polygonEnd()}function ZN(e,t){e&&IN.hasOwnProperty(e.type)?IN[e.type](e,t):BN(e,t)}var HN,GN,VN,YN,XN,JN,QN,KN,eS,tS,nS,rS,iS,oS,aS,sS,lS=new sl,uS=new sl,cS={point:LN,lineStart:LN,lineEnd:LN,polygonStart:function(){lS=new sl,cS.lineStart=fS,cS.lineEnd=dS},polygonEnd:function(){var e=+lS;uS.add(e<0?wN+e:e),this.lineStart=this.lineEnd=this.point=LN},sphere:function(){uS.add(wN)}};function fS(){cS.point=hS}function dS(){pS(HN,GN)}function hS(e,t){cS.point=pS,HN=e,GN=t,VN=e*=_N,YN=jN(t=(t*=_N)/2+xN),XN=MN(t)}function pS(e,t){var n=(e*=_N)-VN,r=n>=0?1:-1,i=r*n,o=jN(t=(t*=_N)/2+xN),a=MN(t),s=XN*a,l=YN*o+s*jN(i),u=s*r*MN(i);lS.add(DN(u,l)),VN=e,YN=o,XN=a}function mS(e){return[DN(e[1],e[0]),RN(e[2])]}function gS(e){var t=e[0],n=e[1],r=jN(n);return[r*jN(t),r*MN(t),MN(n)]}function yS(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function vS(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function bS(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function xS(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function wS(e){var t=FN(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var kS,_S,OS,ES,DS,jS,NS,SS,AS,$S,CS,MS,PS,FS,TS,zS,RS={point:LS,lineStart:IS,lineEnd:US,polygonStart:function(){RS.point=qS,RS.lineStart=WS,RS.lineEnd=ZS,oS=new sl,cS.polygonStart()},polygonEnd:function(){cS.polygonEnd(),RS.point=LS,RS.lineStart=IS,RS.lineEnd=US,lS<0?(JN=-(KN=180),QN=-(eS=90)):oS>gN?eS=90:oS<-gN&&(QN=-90),sS[0]=JN,sS[1]=KN},sphere:function(){JN=-(KN=180),QN=-(eS=90)}};function LS(e,t){aS.push(sS=[JN=e,KN=e]),t<QN&&(QN=t),t>eS&&(eS=t)}function BS(e,t){var n=gS([e*_N,t*_N]);if(iS){var r=vS(iS,n),i=vS([r[1],-r[0],0],r);wS(i),i=mS(i);var o,a=e-tS,s=a>0?1:-1,l=i[0]*kN*s,u=ON(a)>180;u^(s*tS<l&&l<s*e)?(o=i[1]*kN)>eS&&(eS=o):u^(s*tS<(l=(l+360)%360-180)&&l<s*e)?(o=-i[1]*kN)<QN&&(QN=o):(t<QN&&(QN=t),t>eS&&(eS=t)),u?e<tS?HS(JN,e)>HS(JN,KN)&&(KN=e):HS(e,KN)>HS(JN,KN)&&(JN=e):KN>=JN?(e<JN&&(JN=e),e>KN&&(KN=e)):e>tS?HS(JN,e)>HS(JN,KN)&&(KN=e):HS(e,KN)>HS(JN,KN)&&(JN=e)}else aS.push(sS=[JN=e,KN=e]);t<QN&&(QN=t),t>eS&&(eS=t),iS=n,tS=e}function IS(){RS.point=BS}function US(){sS[0]=JN,sS[1]=KN,RS.point=LS,iS=null}function qS(e,t){if(iS){var n=e-tS;oS.add(ON(n)>180?n+(n>0?360:-360):n)}else nS=e,rS=t;cS.point(e,t),BS(e,t)}function WS(){cS.lineStart()}function ZS(){qS(nS,rS),cS.lineEnd(),ON(oS)>gN&&(JN=-(KN=180)),sS[0]=JN,sS[1]=KN,iS=null}function HS(e,t){return(t-=e)<0?t+360:t}function GS(e,t){return e[0]-t[0]}function VS(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var YS={sphere:LN,point:XS,lineStart:QS,lineEnd:tA,polygonStart:function(){YS.lineStart=nA,YS.lineEnd=rA},polygonEnd:function(){YS.lineStart=QS,YS.lineEnd=tA}};function XS(e,t){e*=_N;var n=jN(t*=_N);JS(n*jN(e),n*MN(e),MN(t))}function JS(e,t,n){++kS,OS+=(e-OS)/kS,ES+=(t-ES)/kS,DS+=(n-DS)/kS}function QS(){YS.point=KS}function KS(e,t){e*=_N;var n=jN(t*=_N);FS=n*jN(e),TS=n*MN(e),zS=MN(t),YS.point=eA,JS(FS,TS,zS)}function eA(e,t){e*=_N;var n=jN(t*=_N),r=n*jN(e),i=n*MN(e),o=MN(t),a=DN(FN((a=TS*o-zS*i)*a+(a=zS*r-FS*o)*a+(a=FS*i-TS*r)*a),FS*r+TS*i+zS*o);_S+=a,jS+=a*(FS+(FS=r)),NS+=a*(TS+(TS=i)),SS+=a*(zS+(zS=o)),JS(FS,TS,zS)}function tA(){YS.point=XS}function nA(){YS.point=iA}function rA(){oA(MS,PS),YS.point=XS}function iA(e,t){MS=e,PS=t,e*=_N,t*=_N,YS.point=oA;var n=jN(t);FS=n*jN(e),TS=n*MN(e),zS=MN(t),JS(FS,TS,zS)}function oA(e,t){e*=_N;var n=jN(t*=_N),r=n*jN(e),i=n*MN(e),o=MN(t),a=TS*o-zS*i,s=zS*r-FS*o,l=FS*i-TS*r,u=AN(a,s,l),c=RN(u),f=u&&-c/u;AS.add(f*a),$S.add(f*s),CS.add(f*l),_S+=c,jS+=c*(FS+(FS=r)),NS+=c*(TS+(TS=i)),SS+=c*(zS+(zS=o)),JS(FS,TS,zS)}function aA(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,r){return(n=t.invert(n,r))&&e.invert(n[0],n[1])}),n}function sA(e,t){return ON(e)>vN&&(e-=Math.round(e/wN)*wN),[e,t]}function lA(e,t,n){return(e%=wN)?t||n?aA(cA(e),fA(t,n)):cA(e):t||n?fA(t,n):sA}function uA(e){return function(t,n){return ON(t+=e)>vN&&(t-=Math.round(t/wN)*wN),[t,n]}}function cA(e){var t=uA(e);return t.invert=uA(-e),t}function fA(e,t){var n=jN(e),r=MN(e),i=jN(t),o=MN(t);function a(e,t){var a=jN(t),s=jN(e)*a,l=MN(e)*a,u=MN(t),c=u*n+s*r;return[DN(l*i-c*o,s*n-u*r),RN(c*i+l*o)]}return a.invert=function(e,t){var a=jN(t),s=jN(e)*a,l=MN(e)*a,u=MN(t),c=u*i-l*o;return[DN(l*i+u*o,s*n+c*r),RN(c*n-s*r)]},a}function dA(e,t){(t=gS(t))[0]-=e,wS(t);var n=zN(-t[1]);return((-t[2]<0?-n:n)+wN-gN)%wN}function hA(){var e,t=[];return{point:function(t,n,r){e.push([t,n,r])},lineStart:function(){t.push(e=[])},lineEnd:LN,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function pA(e,t){return ON(e[0]-t[0])<gN&&ON(e[1]-t[1])<gN}function mA(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function gA(e,t,n,r,i){var o,a,s=[],l=[];if(e.forEach((function(e){if(!((t=e.length-1)<=0)){var t,n,r=e[0],a=e[t];if(pA(r,a)){if(!r[2]&&!a[2]){for(i.lineStart(),o=0;o<t;++o)i.point((r=e[o])[0],r[1]);return void i.lineEnd()}a[0]+=2*gN}s.push(n=new mA(r,e,null,!0)),l.push(n.o=new mA(r,null,n,!1)),s.push(n=new mA(a,e,null,!1)),l.push(n.o=new mA(a,null,n,!0))}})),s.length){for(l.sort(t),yA(s),yA(l),o=0,a=l.length;o<a;++o)l[o].e=n=!n;for(var u,c,f=s[0];;){for(var d=f,h=!0;d.v;)if((d=d.n)===f)return;u=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(o=0,a=u.length;o<a;++o)i.point((c=u[o])[0],c[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(u=d.p.z,o=u.length-1;o>=0;--o)i.point((c=u[o])[0],c[1]);else r(d.x,d.p.x,-1,i);d=d.p}u=(d=d.o).z,h=!h}while(!d.v);i.lineEnd()}}}function yA(e){if(t=e.length){for(var t,n,r=0,i=e[0];++r<t;)i.n=n=e[r],n.p=i,i=n;i.n=n=e[0],n.p=i}}function vA(e){return ON(e[0])<=vN?e[0]:PN(e[0])*((ON(e[0])+vN)%wN-vN)}function bA(e,t,n,r){return function(i){var o,a,s,l=t(i),u=hA(),c=t(u),f=!1,d={point:h,lineStart:m,lineEnd:g,polygonStart:function(){d.point=y,d.lineStart=v,d.lineEnd=b,a=[],o=[]},polygonEnd:function(){d.point=h,d.lineStart=m,d.lineEnd=g,a=Sl(a);var e=function(e,t){var n=vA(t),r=t[1],i=MN(r),o=[MN(n),-jN(n),0],a=0,s=0,l=new sl;1===i?r=bN+gN:-1===i&&(r=-bN-gN);for(var u=0,c=e.length;u<c;++u)if(d=(f=e[u]).length)for(var f,d,h=f[d-1],p=vA(h),m=h[1]/2+xN,g=MN(m),y=jN(m),v=0;v<d;++v,p=x,g=k,y=_,h=b){var b=f[v],x=vA(b),w=b[1]/2+xN,k=MN(w),_=jN(w),O=x-p,E=O>=0?1:-1,D=E*O,j=D>vN,N=g*k;if(l.add(DN(N*E*MN(D),y*_+N*jN(D))),a+=j?O+E*wN:O,j^p>=n^x>=n){var S=vS(gS(h),gS(b));wS(S);var A=vS(o,S);wS(A);var $=(j^O>=0?-1:1)*RN(A[2]);(r>$||r===$&&(S[0]||S[1]))&&(s+=j^O>=0?1:-1)}}return(a<-gN||a<gN&&l<-yN)^1&s}(o,r);a.length?(f||(i.polygonStart(),f=!0),gA(a,wA,e,n,i)):e&&(f||(i.polygonStart(),f=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),f&&(i.polygonEnd(),f=!1),a=o=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(t,n){e(t,n)&&i.point(t,n)}function p(e,t){l.point(e,t)}function m(){d.point=p,l.lineStart()}function g(){d.point=h,l.lineEnd()}function y(e,t){s.push([e,t]),c.point(e,t)}function v(){c.lineStart(),s=[]}function b(){y(s[0][0],s[0][1]),c.lineEnd();var e,t,n,r,l=c.clean(),d=u.result(),h=d.length;if(s.pop(),o.push(s),s=null,h)if(1&l){if((t=(n=d[0]).length-1)>0){for(f||(i.polygonStart(),f=!0),i.lineStart(),e=0;e<t;++e)i.point((r=n[e])[0],r[1]);i.lineEnd()}}else h>1&&2&l&&d.push(d.pop().concat(d.shift())),a.push(d.filter(xA))}return d}}function xA(e){return e.length>1}function wA(e,t){return((e=e.x)[0]<0?e[1]-bN-gN:bN-e[1])-((t=t.x)[0]<0?t[1]-bN-gN:bN-t[1])}sA.invert=sA;var kA=bA((function(){return!0}),(function(e){var t,n=NaN,r=NaN,i=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(o,a){var s=o>0?vN:-vN,l=ON(o-n);ON(l-vN)<gN?(e.point(n,r=(r+a)/2>0?bN:-bN),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(s,r),e.point(o,r),t=0):i!==s&&l>=vN&&(ON(n-i)<gN&&(n-=i*gN),ON(o-s)<gN&&(o-=s*gN),r=function(e,t,n,r){var i,o,a=MN(e-n);return ON(a)>gN?EN((MN(t)*(o=jN(r))*MN(n)-MN(r)*(i=jN(t))*MN(e))/(i*o*a)):(t+r)/2}(n,r,o,a),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(s,r),t=0),e.point(n=o,r=a),i=s},lineEnd:function(){e.lineEnd(),n=r=NaN},clean:function(){return 2-t}}}),(function(e,t,n,r){var i;if(null==e)i=n*bN,r.point(-vN,i),r.point(0,i),r.point(vN,i),r.point(vN,0),r.point(vN,-i),r.point(0,-i),r.point(-vN,-i),r.point(-vN,0),r.point(-vN,i);else if(ON(e[0]-t[0])>gN){var o=e[0]<t[0]?vN:-vN;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(t[0],t[1])}),[-vN,-bN]);function _A(e){var t=jN(e),n=6*_N,r=t>0,i=ON(t)>gN;function o(e,n){return jN(e)*jN(n)>t}function a(e,n,r){var i=[1,0,0],o=vS(gS(e),gS(n)),a=yS(o,o),s=o[0],l=a-s*s;if(!l)return!r&&e;var u=t*a/l,c=-t*s/l,f=vS(i,o),d=xS(i,u);bS(d,xS(o,c));var h=f,p=yS(d,h),m=yS(h,h),g=p*p-m*(yS(d,d)-1);if(!(g<0)){var y=FN(g),v=xS(h,(-p-y)/m);if(bS(v,d),v=mS(v),!r)return v;var b,x=e[0],w=n[0],k=e[1],_=n[1];w<x&&(b=x,x=w,w=b);var O=w-x,E=ON(O-vN)<gN;if(!E&&_<k&&(b=k,k=_,_=b),E||O<gN?E?k+_>0^v[1]<(ON(v[0]-x)<gN?k:_):k<=v[1]&&v[1]<=_:O>vN^(x<=v[0]&&v[0]<=w)){var D=xS(h,(-p+y)/m);return bS(D,d),[v,mS(D)]}}}function s(t,n){var i=r?e:vN-e,o=0;return t<-i?o|=1:t>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return bA(o,(function(e){var t,n,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(f,d){var h,p=[f,d],m=o(f,d),g=r?m?0:s(f,d):m?s(f+(f<0?vN:-vN),d):0;if(!t&&(u=l=m)&&e.lineStart(),m!==l&&(!(h=a(t,p))||pA(t,h)||pA(p,h))&&(p[2]=1),m!==l)c=0,m?(e.lineStart(),h=a(p,t),e.point(h[0],h[1])):(h=a(t,p),e.point(h[0],h[1],2),e.lineEnd()),t=h;else if(i&&t&&r^m){var y;g&n||!(y=a(p,t,!0))||(c=0,r?(e.lineStart(),e.point(y[0][0],y[0][1]),e.point(y[1][0],y[1][1]),e.lineEnd()):(e.point(y[1][0],y[1][1]),e.lineEnd(),e.lineStart(),e.point(y[0][0],y[0][1],3)))}!m||t&&pA(t,p)||e.point(p[0],p[1]),t=p,l=m,n=g},lineEnd:function(){l&&e.lineEnd(),t=null},clean:function(){return c|(u&&l)<<1}}}),(function(t,r,i,o){!function(e,t,n,r,i,o){if(n){var a=jN(t),s=MN(t),l=r*n;null==i?(i=t+r*wN,o=t-l/2):(i=dA(a,i),o=dA(a,o),(r>0?i<o:i>o)&&(i+=r*wN));for(var u,c=i;r>0?c>o:c<o;c-=l)u=mS([a,-s*jN(c),-s*MN(c)]),e.point(u[0],u[1])}}(o,e,n,i,t,r)}),r?[0,-e]:[-vN,e-vN])}var OA=1e9,EA=-OA;function DA(e,t,n,r){function i(i,o){return e<=i&&i<=n&&t<=o&&o<=r}function o(i,o,s,u){var c=0,f=0;if(null==i||(c=a(i,s))!==(f=a(o,s))||l(i,o)<0^s>0)do{u.point(0===c||3===c?e:n,c>1?r:t)}while((c=(c+s+4)%4)!==f);else u.point(o[0],o[1])}function a(r,i){return ON(r[0]-e)<gN?i>0?0:3:ON(r[0]-n)<gN?i>0?2:1:ON(r[1]-t)<gN?i>0?1:0:i>0?3:2}function s(e,t){return l(e.x,t.x)}function l(e,t){var n=a(e,1),r=a(t,1);return n!==r?n-r:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}return function(a){var l,u,c,f,d,h,p,m,g,y,v,b=a,x=hA(),w={point:k,lineStart:function(){w.point=_,u&&u.push(c=[]);y=!0,g=!1,p=m=NaN},lineEnd:function(){l&&(_(f,d),h&&g&&x.rejoin(),l.push(x.result()));w.point=k,g&&b.lineEnd()},polygonStart:function(){b=x,l=[],u=[],v=!0},polygonEnd:function(){var t=function(){for(var t=0,n=0,i=u.length;n<i;++n)for(var o,a,s=u[n],l=1,c=s.length,f=s[0],d=f[0],h=f[1];l<c;++l)o=d,a=h,d=(f=s[l])[0],h=f[1],a<=r?h>r&&(d-o)*(r-a)>(h-a)*(e-o)&&++t:h<=r&&(d-o)*(r-a)<(h-a)*(e-o)&&--t;return t}(),n=v&&t,i=(l=Sl(l)).length;(n||i)&&(a.polygonStart(),n&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),i&&gA(l,s,t,o,a),a.polygonEnd());b=a,l=u=c=null}};function k(e,t){i(e,t)&&b.point(e,t)}function _(o,a){var s=i(o,a);if(u&&c.push([o,a]),y)f=o,d=a,h=s,y=!1,s&&(b.lineStart(),b.point(o,a));else if(s&&g)b.point(o,a);else{var l=[p=Math.max(EA,Math.min(OA,p)),m=Math.max(EA,Math.min(OA,m))],x=[o=Math.max(EA,Math.min(OA,o)),a=Math.max(EA,Math.min(OA,a))];!function(e,t,n,r,i,o){var a,s=e[0],l=e[1],u=0,c=1,f=t[0]-s,d=t[1]-l;if(a=n-s,f||!(a>0)){if(a/=f,f<0){if(a<u)return;a<c&&(c=a)}else if(f>0){if(a>c)return;a>u&&(u=a)}if(a=i-s,f||!(a<0)){if(a/=f,f<0){if(a>c)return;a>u&&(u=a)}else if(f>0){if(a<u)return;a<c&&(c=a)}if(a=r-l,d||!(a>0)){if(a/=d,d<0){if(a<u)return;a<c&&(c=a)}else if(d>0){if(a>c)return;a>u&&(u=a)}if(a=o-l,d||!(a<0)){if(a/=d,d<0){if(a>c)return;a>u&&(u=a)}else if(d>0){if(a<u)return;a<c&&(c=a)}return u>0&&(e[0]=s+u*f,e[1]=l+u*d),c<1&&(t[0]=s+c*f,t[1]=l+c*d),!0}}}}}(l,x,e,t,n,r)?s&&(b.lineStart(),b.point(o,a),v=!1):(g||(b.lineStart(),b.point(l[0],l[1])),b.point(x[0],x[1]),s||b.lineEnd(),v=!1)}p=o,m=a,g=s}return w}}function jA(e,t,n){var r=Al(e,t-gN,n).concat(t);return function(e){return r.map((function(t){return[e,t]}))}}function NA(e,t,n){var r=Al(e,t-gN,n).concat(t);return function(e){return r.map((function(t){return[t,e]}))}}var SA,AA,$A,CA,MA=e=>e,PA=new sl,FA=new sl,TA={point:LN,lineStart:LN,lineEnd:LN,polygonStart:function(){TA.lineStart=zA,TA.lineEnd=BA},polygonEnd:function(){TA.lineStart=TA.lineEnd=TA.point=LN,PA.add(ON(FA)),FA=new sl},result:function(){var e=PA/2;return PA=new sl,e}};function zA(){TA.point=RA}function RA(e,t){TA.point=LA,SA=$A=e,AA=CA=t}function LA(e,t){FA.add(CA*e-$A*t),$A=e,CA=t}function BA(){LA(SA,AA)}var IA=TA,UA=1/0,qA=UA,WA=-UA,ZA=WA,HA={point:function(e,t){e<UA&&(UA=e);e>WA&&(WA=e);t<qA&&(qA=t);t>ZA&&(ZA=t)},lineStart:LN,lineEnd:LN,polygonStart:LN,polygonEnd:LN,result:function(){var e=[[UA,qA],[WA,ZA]];return WA=ZA=-(qA=UA=1/0),e}};var GA,VA,YA,XA,JA=HA,QA=0,KA=0,e$=0,t$=0,n$=0,r$=0,i$=0,o$=0,a$=0,s$={point:l$,lineStart:u$,lineEnd:d$,polygonStart:function(){s$.lineStart=h$,s$.lineEnd=p$},polygonEnd:function(){s$.point=l$,s$.lineStart=u$,s$.lineEnd=d$},result:function(){var e=a$?[i$/a$,o$/a$]:r$?[t$/r$,n$/r$]:e$?[QA/e$,KA/e$]:[NaN,NaN];return QA=KA=e$=t$=n$=r$=i$=o$=a$=0,e}};function l$(e,t){QA+=e,KA+=t,++e$}function u$(){s$.point=c$}function c$(e,t){s$.point=f$,l$(YA=e,XA=t)}function f$(e,t){var n=e-YA,r=t-XA,i=FN(n*n+r*r);t$+=i*(YA+e)/2,n$+=i*(XA+t)/2,r$+=i,l$(YA=e,XA=t)}function d$(){s$.point=l$}function h$(){s$.point=m$}function p$(){g$(GA,VA)}function m$(e,t){s$.point=g$,l$(GA=YA=e,VA=XA=t)}function g$(e,t){var n=e-YA,r=t-XA,i=FN(n*n+r*r);t$+=i*(YA+e)/2,n$+=i*(XA+t)/2,r$+=i,i$+=(i=XA*e-YA*t)*(YA+e),o$+=i*(XA+t),a$+=3*i,l$(YA=e,XA=t)}var y$=s$;function v$(e){this._context=e}v$.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._context.moveTo(e,t),this._point=1;break;case 1:this._context.lineTo(e,t);break;default:this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,wN)}},result:LN};var b$,x$,w$,k$,_$,O$=new sl,E$={point:LN,lineStart:function(){E$.point=D$},lineEnd:function(){b$&&j$(x$,w$),E$.point=LN},polygonStart:function(){b$=!0},polygonEnd:function(){b$=null},result:function(){var e=+O$;return O$=new sl,e}};function D$(e,t){E$.point=j$,x$=k$=e,w$=_$=t}function j$(e,t){k$-=e,_$-=t,O$.add(FN(k$*k$+_$*_$)),k$=e,_$=t}var N$=E$;let S$,A$,$$,C$;class M${constructor(e){this._append=null==e?P$:function(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return P$;if(t!==S$){const e=10**t;S$=t,A$=function(t){let n=1;this._+=t[0];for(const r=t.length;n<r;++n)this._+=Math.round(arguments[n]*e)/e+t[n]}}return A$}(e),this._radius=4.5,this._=""}pointRadius(e){return this._radius=+e,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){0===this._line&&(this._+="Z"),this._point=NaN}point(e,t){switch(this._point){case 0:this._append`M${e},${t}`,this._point=1;break;case 1:this._append`L${e},${t}`;break;default:if(this._append`M${e},${t}`,this._radius!==$$||this._append!==A$){const e=this._radius,t=this._;this._="",this._append`m0,${e}a${e},${e} 0 1,1 0,${-2*e}a${e},${e} 0 1,1 0,${2*e}z`,$$=e,A$=this._append,C$=this._,this._=t}this._+=C$}}result(){const e=this._;return this._="",e.length?e:null}}function P$(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function F$(e,t){let n,r,i=3,o=4.5;function a(e){return e&&("function"==typeof o&&r.pointRadius(+o.apply(this,arguments)),ZN(e,n(r))),r.result()}return a.area=function(e){return ZN(e,n(IA)),IA.result()},a.measure=function(e){return ZN(e,n(N$)),N$.result()},a.bounds=function(e){return ZN(e,n(JA)),JA.result()},a.centroid=function(e){return ZN(e,n(y$)),y$.result()},a.projection=function(t){return arguments.length?(n=null==t?(e=null,MA):(e=t).stream,a):e},a.context=function(e){return arguments.length?(r=null==e?(t=null,new M$(i)):new v$(t=e),"function"!=typeof o&&r.pointRadius(o),a):t},a.pointRadius=function(e){return arguments.length?(o="function"==typeof e?e:(r.pointRadius(+e),+e),a):o},a.digits=function(e){if(!arguments.length)return i;if(null==e)i=null;else{const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);i=t}return null===t&&(r=new M$(i)),a},a.projection(e).digits(i).context(t)}function T$(e){return function(t){var n=new z$;for(var r in e)n[r]=e[r];return n.stream=t,n}}function z$(){}function R$(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=r&&e.clipExtent(null),ZN(n,e.stream(JA)),t(JA.result()),null!=r&&e.clipExtent(r),e}function L$(e,t,n){return R$(e,(function(n){var r=t[1][0]-t[0][0],i=t[1][1]-t[0][1],o=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),a=+t[0][0]+(r-o*(n[1][0]+n[0][0]))/2,s=+t[0][1]+(i-o*(n[1][1]+n[0][1]))/2;e.scale(150*o).translate([a,s])}),n)}function B$(e,t,n){return L$(e,[[0,0],t],n)}function I$(e,t,n){return R$(e,(function(n){var r=+t,i=r/(n[1][0]-n[0][0]),o=(r-i*(n[1][0]+n[0][0]))/2,a=-i*n[0][1];e.scale(150*i).translate([o,a])}),n)}function U$(e,t,n){return R$(e,(function(n){var r=+t,i=r/(n[1][1]-n[0][1]),o=-i*n[0][0],a=(r-i*(n[1][1]+n[0][1]))/2;e.scale(150*i).translate([o,a])}),n)}z$.prototype={constructor:z$,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var q$=16,W$=jN(30*_N);function Z$(e,t){return+t?function(e,t){function n(r,i,o,a,s,l,u,c,f,d,h,p,m,g){var y=u-r,v=c-i,b=y*y+v*v;if(b>4*t&&m--){var x=a+d,w=s+h,k=l+p,_=FN(x*x+w*w+k*k),O=RN(k/=_),E=ON(ON(k)-1)<gN||ON(o-f)<gN?(o+f)/2:DN(w,x),D=e(E,O),j=D[0],N=D[1],S=j-r,A=N-i,$=v*S-y*A;($*$/b>t||ON((y*S+v*A)/b-.5)>.3||a*d+s*h+l*p<W$)&&(n(r,i,o,a,s,l,j,N,E,x/=_,w/=_,k,m,g),g.point(j,N),n(j,N,E,x,w,k,u,c,f,d,h,p,m,g))}}return function(t){var r,i,o,a,s,l,u,c,f,d,h,p,m={point:g,lineStart:y,lineEnd:b,polygonStart:function(){t.polygonStart(),m.lineStart=x},polygonEnd:function(){t.polygonEnd(),m.lineStart=y}};function g(n,r){n=e(n,r),t.point(n[0],n[1])}function y(){c=NaN,m.point=v,t.lineStart()}function v(r,i){var o=gS([r,i]),a=e(r,i);n(c,f,u,d,h,p,c=a[0],f=a[1],u=r,d=o[0],h=o[1],p=o[2],q$,t),t.point(c,f)}function b(){m.point=g,t.lineEnd()}function x(){y(),m.point=w,m.lineEnd=k}function w(e,t){v(r=e,t),i=c,o=f,a=d,s=h,l=p,m.point=v}function k(){n(c,f,u,d,h,p,i,o,r,a,s,l,q$,t),m.lineEnd=b,b()}return m}}(e,t):function(e){return T$({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}(e)}var H$=T$({point:function(e,t){this.stream.point(e*_N,t*_N)}});function G$(e,t,n,r,i,o){if(!o)return function(e,t,n,r,i){function o(o,a){return[t+e*(o*=r),n-e*(a*=i)]}return o.invert=function(o,a){return[(o-t)/e*r,(n-a)/e*i]},o}(e,t,n,r,i);var a=jN(o),s=MN(o),l=a*e,u=s*e,c=a/e,f=s/e,d=(s*n-a*t)/e,h=(s*t+a*n)/e;function p(e,o){return[l*(e*=r)-u*(o*=i)+t,n-u*e-l*o]}return p.invert=function(e,t){return[r*(c*e-f*t+d),i*(h-f*e-c*t)]},p}function V$(e){return Y$((function(){return e}))()}function Y$(e){var t,n,r,i,o,a,s,l,u,c,f=150,d=480,h=250,p=0,m=0,g=0,y=0,v=0,b=0,x=1,w=1,k=null,_=kA,O=null,E=MA,D=.5;function j(e){return l(e[0]*_N,e[1]*_N)}function N(e){return(e=l.invert(e[0],e[1]))&&[e[0]*kN,e[1]*kN]}function S(){var e=G$(f,0,0,x,w,b).apply(null,t(p,m)),r=G$(f,d-e[0],h-e[1],x,w,b);return n=lA(g,y,v),s=aA(t,r),l=aA(n,s),a=Z$(s,D),A()}function A(){return u=c=null,j}return j.stream=function(e){return u&&c===e?u:u=H$(function(e){return T$({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}(n)(_(a(E(c=e)))))},j.preclip=function(e){return arguments.length?(_=e,k=void 0,A()):_},j.postclip=function(e){return arguments.length?(E=e,O=r=i=o=null,A()):E},j.clipAngle=function(e){return arguments.length?(_=+e?_A(k=e*_N):(k=null,kA),A()):k*kN},j.clipExtent=function(e){return arguments.length?(E=null==e?(O=r=i=o=null,MA):DA(O=+e[0][0],r=+e[0][1],i=+e[1][0],o=+e[1][1]),A()):null==O?null:[[O,r],[i,o]]},j.scale=function(e){return arguments.length?(f=+e,S()):f},j.translate=function(e){return arguments.length?(d=+e[0],h=+e[1],S()):[d,h]},j.center=function(e){return arguments.length?(p=e[0]%360*_N,m=e[1]%360*_N,S()):[p*kN,m*kN]},j.rotate=function(e){return arguments.length?(g=e[0]%360*_N,y=e[1]%360*_N,v=e.length>2?e[2]%360*_N:0,S()):[g*kN,y*kN,v*kN]},j.angle=function(e){return arguments.length?(b=e%360*_N,S()):b*kN},j.reflectX=function(e){return arguments.length?(x=e?-1:1,S()):x<0},j.reflectY=function(e){return arguments.length?(w=e?-1:1,S()):w<0},j.precision=function(e){return arguments.length?(a=Z$(s,D=e*e),A()):FN(D)},j.fitExtent=function(e,t){return L$(j,e,t)},j.fitSize=function(e,t){return B$(j,e,t)},j.fitWidth=function(e,t){return I$(j,e,t)},j.fitHeight=function(e,t){return U$(j,e,t)},function(){return t=e.apply(this,arguments),j.invert=t.invert&&N,S()}}function X$(e){var t=0,n=vN/3,r=Y$(e),i=r(t,n);return i.parallels=function(e){return arguments.length?r(t=e[0]*_N,n=e[1]*_N):[t*kN,n*kN]},i}function J$(e,t){var n=MN(e),r=(n+MN(t))/2;if(ON(r)<gN)return function(e){var t=jN(e);function n(e,n){return[e*t,MN(n)/t]}return n.invert=function(e,n){return[e/t,RN(n*t)]},n}(e);var i=1+n*(2*r-n),o=FN(i)/r;function a(e,t){var n=FN(i-2*r*MN(t))/r;return[n*MN(e*=r),o-n*jN(e)]}return a.invert=function(e,t){var n=o-t,a=DN(e,ON(n))*PN(n);return n*r<0&&(a-=vN*PN(e)*PN(n)),[a/r,RN((i-(e*e+n*n)*r*r)/(2*r))]},a}function Q$(){return X$(J$).scale(155.424).center([0,33.6442])}function K$(){return Q$().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function eC(e){return function(t,n){var r=jN(t),i=jN(n),o=e(r*i);return o===1/0?[2,0]:[o*i*MN(t),o*MN(n)]}}function tC(e){return function(t,n){var r=FN(t*t+n*n),i=e(r),o=MN(i),a=jN(i);return[DN(t*o,r*a),RN(r&&n*o/r)]}}var nC=eC((function(e){return FN(2/(1+e))}));nC.invert=tC((function(e){return 2*RN(e/2)}));var rC=eC((function(e){return(e=zN(e))&&e/MN(e)}));function iC(e,t){return[e,$N(TN((bN+t)/2))]}function oC(e){var t,n,r,i=V$(e),o=i.center,a=i.scale,s=i.translate,l=i.clipExtent,u=null;function c(){var o=vN*a(),s=i(function(e){function t(t){return(t=e(t[0]*_N,t[1]*_N))[0]*=kN,t[1]*=kN,t}return e=lA(e[0]*_N,e[1]*_N,e.length>2?e[2]*_N:0),t.invert=function(t){return(t=e.invert(t[0]*_N,t[1]*_N))[0]*=kN,t[1]*=kN,t},t}(i.rotate()).invert([0,0]));return l(null==u?[[s[0]-o,s[1]-o],[s[0]+o,s[1]+o]]:e===iC?[[Math.max(s[0]-o,u),t],[Math.min(s[0]+o,n),r]]:[[u,Math.max(s[1]-o,t)],[n,Math.min(s[1]+o,r)]])}return i.scale=function(e){return arguments.length?(a(e),c()):a()},i.translate=function(e){return arguments.length?(s(e),c()):s()},i.center=function(e){return arguments.length?(o(e),c()):o()},i.clipExtent=function(e){return arguments.length?(null==e?u=t=n=r=null:(u=+e[0][0],t=+e[0][1],n=+e[1][0],r=+e[1][1]),c()):null==u?null:[[u,t],[n,r]]},c()}function aC(e){return TN((bN+e)/2)}function sC(e,t){var n=jN(e),r=e===t?MN(e):$N(n/jN(t))/$N(aC(t)/aC(e)),i=n*CN(aC(e),r)/r;if(!r)return iC;function o(e,t){i>0?t<-bN+gN&&(t=-bN+gN):t>bN-gN&&(t=bN-gN);var n=i/CN(aC(t),r);return[n*MN(r*e),i-n*jN(r*e)]}return o.invert=function(e,t){var n=i-t,o=PN(r)*FN(e*e+n*n),a=DN(e,ON(n))*PN(n);return n*r<0&&(a-=vN*PN(e)*PN(n)),[a/r,2*EN(CN(i/o,1/r))-bN]},o}function lC(e,t){return[e,t]}function uC(e,t){var n=jN(e),r=e===t?MN(e):(n-jN(t))/(t-e),i=n/r+e;if(ON(r)<gN)return lC;function o(e,t){var n=i-t,o=r*e;return[n*MN(o),i-n*jN(o)]}return o.invert=function(e,t){var n=i-t,o=DN(e,ON(n))*PN(n);return n*r<0&&(o-=vN*PN(e)*PN(n)),[o/r,i-PN(r)*FN(e*e+n*n)]},o}rC.invert=tC((function(e){return e})),iC.invert=function(e,t){return[e,2*EN(SN(t))-bN]},lC.invert=lC;var cC=1.340264,fC=-.081106,dC=893e-6,hC=.003796,pC=FN(3)/2;function mC(e,t){var n=RN(pC*MN(t)),r=n*n,i=r*r*r;return[e*jN(n)/(pC*(cC+3*fC*r+i*(7*dC+9*hC*r))),n*(cC+fC*r+i*(dC+hC*r))]}function gC(e,t){var n=jN(t),r=jN(e)*n;return[n*MN(e)/r,MN(t)/r]}function yC(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),t*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function vC(e,t){return[jN(t)*MN(e),MN(t)]}function bC(e,t){var n=jN(t),r=1+jN(e)*n;return[n*MN(e)/r,MN(t)/r]}function xC(e,t){return[$N(TN((bN+t)/2)),-e]}mC.invert=function(e,t){for(var n,r=t,i=r*r,o=i*i*i,a=0;a<12&&(o=(i=(r-=n=(r*(cC+fC*i+o*(dC+hC*i))-t)/(cC+3*fC*i+o*(7*dC+9*hC*i)))*r)*i*i,!(ON(n)<yN));++a);return[pC*e*(cC+3*fC*i+o*(7*dC+9*hC*i))/jN(r),RN(MN(r)/pC)]},gC.invert=tC(EN),yC.invert=function(e,t){var n,r=t,i=25;do{var o=r*r,a=o*o;r-=n=(r*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))-t)/(1.007226+o*(.045255+a*(.259866*o-.311325-.005916*11*a)))}while(ON(n)>gN&&--i>0);return[e/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]},vC.invert=tC(RN),bC.invert=tC((function(e){return 2*EN(e)})),xC.invert=function(e,t){return[-t,2*EN(SN(e))-bN]};var wC=Math.abs,kC=Math.cos,_C=Math.sin,OC=1e-6,EC=Math.PI,DC=EC/2,jC=function(e){return e>0?Math.sqrt(e):0}(2);function NC(e){return e>1?DC:e<-1?-DC:Math.asin(e)}function SC(e,t){var n,r=e*_C(t),i=30;do{t-=n=(t+_C(t)-r)/(1+kC(t))}while(wC(n)>OC&&--i>0);return t/2}var AC=function(e,t,n){function r(r,i){return[e*r*kC(i=SC(n,i)),t*_C(i)]}return r.invert=function(r,i){return i=NC(i/t),[r/(e*kC(i)),NC((2*i+_C(2*i))/n)]},r}(jC/DC,jC,EC);const $C=F$(),CC=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function MC(e,t){if(!e||"string"!=typeof e)throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(FC[e]=function(e,t){return function n(){const r=t();return r.type=e,r.path=F$().projection(r),r.copy=r.copy||function(){const e=n();return CC.forEach((t=>{r[t]&&e[t](r[t]())})),e.path.pointRadius(r.path.pointRadius()),e},Hx(r)}}(e,t),this):FC[e]||null}function PC(e){return e&&e.path||$C}const FC={albers:K$,albersusa:function(){var e,t,n,r,i,o,a=K$(),s=Q$().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=Q$().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(e,t){o=[e,t]}};function c(e){var t=e[0],a=e[1];return o=null,n.point(t,a),o||(r.point(t,a),o)||(i.point(t,a),o)}function f(){return e=t=null,c}return c.invert=function(e){var t=a.scale(),n=a.translate(),r=(e[0]-n[0])/t,i=(e[1]-n[1])/t;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?s:i>=.166&&i<.234&&r>=-.214&&r<-.115?l:a).invert(e)},c.stream=function(n){return e&&t===n?e:(r=[a.stream(t=n),s.stream(n),l.stream(n)],i=r.length,e={point:function(e,t){for(var n=-1;++n<i;)r[n].point(e,t)},sphere:function(){for(var e=-1;++e<i;)r[e].sphere()},lineStart:function(){for(var e=-1;++e<i;)r[e].lineStart()},lineEnd:function(){for(var e=-1;++e<i;)r[e].lineEnd()},polygonStart:function(){for(var e=-1;++e<i;)r[e].polygonStart()},polygonEnd:function(){for(var e=-1;++e<i;)r[e].polygonEnd()}});var r,i},c.precision=function(e){return arguments.length?(a.precision(e),s.precision(e),l.precision(e),f()):a.precision()},c.scale=function(e){return arguments.length?(a.scale(e),s.scale(.35*e),l.scale(e),c.translate(a.translate())):a.scale()},c.translate=function(e){if(!arguments.length)return a.translate();var t=a.scale(),o=+e[0],c=+e[1];return n=a.translate(e).clipExtent([[o-.455*t,c-.238*t],[o+.455*t,c+.238*t]]).stream(u),r=s.translate([o-.307*t,c+.201*t]).clipExtent([[o-.425*t+gN,c+.12*t+gN],[o-.214*t-gN,c+.234*t-gN]]).stream(u),i=l.translate([o-.205*t,c+.212*t]).clipExtent([[o-.214*t+gN,c+.166*t+gN],[o-.115*t-gN,c+.234*t-gN]]).stream(u),f()},c.fitExtent=function(e,t){return L$(c,e,t)},c.fitSize=function(e,t){return B$(c,e,t)},c.fitWidth=function(e,t){return I$(c,e,t)},c.fitHeight=function(e,t){return U$(c,e,t)},c.scale(1070)},azimuthalequalarea:function(){return V$(nC).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return V$(rC).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return X$(sC).scale(109.5).parallels([30,30])},conicequalarea:Q$,conicequidistant:function(){return X$(uC).scale(131.154).center([0,13.9389])},equalEarth:function(){return V$(mC).scale(177.158)},equirectangular:function(){return V$(lC).scale(152.63)},gnomonic:function(){return V$(gC).scale(144.049).clipAngle(60)},identity:function(){var e,t,n,r,i,o,a,s=1,l=0,u=0,c=1,f=1,d=0,h=null,p=1,m=1,g=T$({point:function(e,t){var n=b([e,t]);this.stream.point(n[0],n[1])}}),y=MA;function v(){return p=s*c,m=s*f,o=a=null,b}function b(n){var r=n[0]*p,i=n[1]*m;if(d){var o=i*e-r*t;r=r*e+i*t,i=o}return[r+l,i+u]}return b.invert=function(n){var r=n[0]-l,i=n[1]-u;if(d){var o=i*e+r*t;r=r*e-i*t,i=o}return[r/p,i/m]},b.stream=function(e){return o&&a===e?o:o=g(y(a=e))},b.postclip=function(e){return arguments.length?(y=e,h=n=r=i=null,v()):y},b.clipExtent=function(e){return arguments.length?(y=null==e?(h=n=r=i=null,MA):DA(h=+e[0][0],n=+e[0][1],r=+e[1][0],i=+e[1][1]),v()):null==h?null:[[h,n],[r,i]]},b.scale=function(e){return arguments.length?(s=+e,v()):s},b.translate=function(e){return arguments.length?(l=+e[0],u=+e[1],v()):[l,u]},b.angle=function(n){return arguments.length?(t=MN(d=n%360*_N),e=jN(d),v()):d*kN},b.reflectX=function(e){return arguments.length?(c=e?-1:1,v()):c<0},b.reflectY=function(e){return arguments.length?(f=e?-1:1,v()):f<0},b.fitExtent=function(e,t){return L$(b,e,t)},b.fitSize=function(e,t){return B$(b,e,t)},b.fitWidth=function(e,t){return I$(b,e,t)},b.fitHeight=function(e,t){return U$(b,e,t)},b},mercator:function(){return oC(iC).scale(961/wN)},mollweide:function(){return V$(AC).scale(169.529)},naturalEarth1:function(){return V$(yC).scale(175.295)},orthographic:function(){return V$(vC).scale(249.5).clipAngle(90+gN)},stereographic:function(){return V$(bC).scale(250).clipAngle(142)},transversemercator:function(){var e=oC(xC),t=e.center,n=e.rotate;return e.center=function(e){return arguments.length?t([-e[1],e[0]]):[(e=t())[1],-e[0]]},e.rotate=function(e){return arguments.length?n([e[0],e[1],e.length>2?e[2]+90:90]):[(e=n())[0],e[1],e[2]-90]},n([0,0,90]).scale(159.155)}};for(const Hee in FC)MC(Hee,FC[Hee]);function TC(){}const zC=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function RC(){var e=1,t=1,n=a;function r(e,t){return t.map((t=>i(e,t)))}function i(r,i){var a=[],s=[];return function(n,r,i){var a,s,l,u,c,f,d=new Array,h=new Array;a=s=-1,u=n[0]>=r,zC[u<<1].forEach(p);for(;++a<e-1;)l=u,u=n[a+1]>=r,zC[l|u<<1].forEach(p);zC[u<<0].forEach(p);for(;++s<t-1;){for(a=-1,u=n[s*e+e]>=r,c=n[s*e]>=r,zC[u<<1|c<<2].forEach(p);++a<e-1;)l=u,u=n[s*e+e+a+1]>=r,f=c,c=n[s*e+a+1]>=r,zC[l|u<<1|c<<2|f<<3].forEach(p);zC[u|c<<3].forEach(p)}a=-1,c=n[s*e]>=r,zC[c<<2].forEach(p);for(;++a<e-1;)f=c,c=n[s*e+a+1]>=r,zC[c<<2|f<<3].forEach(p);function p(e){var t,n,r=[e[0][0]+a,e[0][1]+s],l=[e[1][0]+a,e[1][1]+s],u=o(r),c=o(l);(t=h[u])?(n=d[c])?(delete h[t.end],delete d[n.start],t===n?(t.ring.push(l),i(t.ring)):d[t.start]=h[n.end]={start:t.start,end:n.end,ring:t.ring.concat(n.ring)}):(delete h[t.end],t.ring.push(l),h[t.end=c]=t):(t=d[c])?(n=h[u])?(delete d[t.start],delete h[n.end],t===n?(t.ring.push(l),i(t.ring)):d[n.start]=h[t.end]={start:n.start,end:t.end,ring:n.ring.concat(t.ring)}):(delete d[t.start],t.ring.unshift(r),d[t.start=u]=t):d[u]=h[c]={start:u,end:c,ring:[r,l]}}zC[c<<3].forEach(p)}(r,i,(e=>{n(e,r,i),function(e){var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];for(;++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}(e)>0?a.push([e]):s.push(e)})),s.forEach((e=>{for(var t,n=0,r=a.length;n<r;++n)if(-1!==LC((t=a[n])[0],e))return void t.push(e)})),{type:"MultiPolygon",value:i,coordinates:a}}function o(t){return 2*t[0]+t[1]*(e+1)*4}function a(n,r,i){n.forEach((n=>{var o,a=n[0],s=n[1],l=0|a,u=0|s,c=r[u*e+l];a>0&&a<e&&l===a&&(o=r[u*e+l-1],n[0]=a+(i-o)/(c-o)-.5),s>0&&s<t&&u===s&&(o=r[(u-1)*e+l],n[1]=s+(i-o)/(c-o)-.5)}))}return r.contour=i,r.size=function(n){if(!arguments.length)return[e,t];var i=Math.floor(n[0]),o=Math.floor(n[1]);return i>=0&&o>=0||aa("invalid size"),e=i,t=o,r},r.smooth=function(e){return arguments.length?(n=e?a:TC,r):n===a},r}function LC(e,t){for(var n,r=-1,i=t.length;++r<i;)if(n=BC(e,t[r]))return n;return 0}function BC(e,t){for(var n=t[0],r=t[1],i=-1,o=0,a=e.length,s=a-1;o<a;s=o++){var l=e[o],u=l[0],c=l[1],f=e[s],d=f[0],h=f[1];if(IC(l,f,t))return 0;c>r!=h>r&&n<(d-u)*(r-c)/(h-c)+u&&(i=-i)}return i}function IC(e,t,n){var r,i,o,a;return function(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}(e,t,n)&&(i=e[r=+(e[0]===t[0])],o=n[r],a=t[r],i<=o&&o<=a||a<=o&&o<=i)}function UC(e,t,n){return function(r){var i=os(r),o=n?Math.min(i[0],0):i[0],a=i[1],s=a-o,l=t?wl(o,a,e):s/(e+1);return Al(o+l,a,l)}}function qC(e){Vh.call(this,null,e)}function WC(e,t,n,r,i){const o=e.x1||0,a=e.y1||0,s=t*n<0;function l(e){e.forEach(u)}function u(e){s&&e.reverse(),e.forEach(c)}function c(e){e[0]=(e[0]-o)*t+r,e[1]=(e[1]-a)*n+i}return function(e){return e.coordinates.forEach(l),e}}function ZC(e,t,n){const r=e>=0?e:tp(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function HC(e){return Ya(e)?e:ns(+e)}function GC(){var e=e=>e[0],t=e=>e[1],n=da,r=[-1,-1],i=960,o=500,a=2;function s(s,l){const u=ZC(r[0],s,e)>>a,c=ZC(r[1],s,t)>>a,f=u?u+2:0,d=c?c+2:0,h=2*f+(i>>a),p=2*d+(o>>a),m=new Float32Array(h*p),g=new Float32Array(h*p);let y=m;s.forEach((r=>{const i=f+(+e(r)>>a),o=d+(+t(r)>>a);i>=0&&i<h&&o>=0&&o<p&&(m[i+o*h]+=+n(r))})),u>0&&c>0?(VC(h,p,m,g,u),YC(h,p,g,m,c),VC(h,p,m,g,u),YC(h,p,g,m,c),VC(h,p,m,g,u),YC(h,p,g,m,c)):u>0?(VC(h,p,m,g,u),VC(h,p,g,m,u),VC(h,p,m,g,u),y=g):c>0&&(YC(h,p,m,g,c),YC(h,p,g,m,c),YC(h,p,m,g,c),y=g);const v=l?Math.pow(2,-2*a):1/$l(y);for(let e=0,t=h*p;e<t;++e)y[e]*=v;return{values:y,scale:1<<a,width:h,height:p,x1:f,y1:d,x2:f+(i>>a),y2:d+(o>>a)}}return s.x=function(t){return arguments.length?(e=HC(t),s):e},s.y=function(e){return arguments.length?(t=HC(e),s):t},s.weight=function(e){return arguments.length?(n=HC(e),s):n},s.size=function(e){if(!arguments.length)return[i,o];var t=+e[0],n=+e[1];return t>=0&&n>=0||aa("invalid size"),i=t,o=n,s},s.cellSize=function(e){return arguments.length?((e=+e)>=1||aa("invalid cell size"),a=Math.floor(Math.log(e)/Math.LN2),s):1<<a},s.bandwidth=function(e){return arguments.length?(1===(e=Ga(e)).length&&(e=[+e[0],+e[0]]),2!==e.length&&aa("invalid bandwidth"),r=e,s):r},s}function VC(e,t,n,r,i){const o=1+(i<<1);for(let a=0;a<t;++a)for(let t=0,s=0;t<e+i;++t)t<e&&(s+=n[t+a*e]),t>=i&&(t>=o&&(s-=n[t-o+a*e]),r[t-i+a*e]=s/Math.min(t+1,e-1+o-t,o))}function YC(e,t,n,r,i){const o=1+(i<<1);for(let a=0;a<e;++a)for(let s=0,l=0;s<t+i;++s)s<t&&(l+=n[a+s*e]),s>=i&&(s>=o&&(l-=n[a+(s-o)*e]),r[a+(s-i)*e]=l/Math.min(s+1,t-1+o-s,o))}function XC(e){Vh.call(this,null,e)}qC.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},ds(qC,Vh,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=e.field||ca,o=RC().smooth(!1!==e.smooth),a=e.thresholds||function(e,t,n){const r=UC(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?r:r(e.map((e=>kl(t(e).values))))}(r,i,e),s=null===e.as?null:e.as||"contour",l=[];return r.forEach((t=>{const n=i(t),r=o.size([n.width,n.height])(n.values,ka(a)?a:a(n.values));!function(e,t,n,r){let i=r.scale||t.scale,o=r.translate||t.translate;Ya(i)&&(i=i(n,r));Ya(o)&&(o=o(n,r));if((1===i||null==i)&&!o)return;const a=(ys(i)?i:i[0])||1,s=(ys(i)?i:i[1])||1,l=o&&o[0]||0,u=o&&o[1]||0;e.forEach(WC(t,a,s,l,u))}(r,n,t,e),r.forEach((e=>{l.push(bh(t,yh(null!=s?{[s]:e}:e)))}))})),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}}),XC.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const JC=["x","y","weight","size","cellSize","bandwidth"];function QC(e,t){return JC.forEach((n=>null!=t[n]?e[n](t[n]):0)),e}function KC(e){Vh.call(this,null,e)}ds(XC,Vh,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=function(e,t){var n,r,i,o,a,s,l=[],u=e=>e(o);if(null==t)l.push(e);else for(n={},r=0,i=e.length;r<i;++r)o=e[r],(s=n[a=t.map(u)])||(n[a]=s=[],s.dims=a,l.push(s)),s.push(o);return l}(t.materialize(t.SOURCE).source,e.groupby),o=(e.groupby||[]).map(ta),a=QC(GC(),e),s=e.as||"grid";return n=i.map((t=>yh(function(e,t){for(let n=0;n<o.length;++n)e[o[n]]=t[n];return e}({[s]:a(t,e.counts)},t.dims)))),this.value&&(r.rem=this.value),this.value=r.source=r.add=n,r}}),KC.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},ds(KC,Vh,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n,r,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),o=RC().smooth(!1!==e.smooth),a=e.values,s=e.thresholds||UC(e.count||10,e.nice,!!a),l=e.size;return a||(a=t.materialize(t.SOURCE).source,r=WC(n=QC(GC(),e)(a,!0),n.scale||1,n.scale||1,0,0),l=[n.width,n.height],a=n.values),s=ka(s)?s:s(a),a=o.size(l)(a,s),r&&a.forEach(r),this.value&&(i.rem=this.value),this.value=i.source=i.add=(a||[]).map(yh),i}});const eM="Feature",tM="FeatureCollection";function nM(e){Vh.call(this,null,e)}function rM(e){Vh.call(this,null,e)}function iM(e){Vh.call(this,null,e)}function oM(e){Vh.call(this,null,e)}function aM(e){Vh.call(this,[],e),this.generator=function(){var e,t,n,r,i,o,a,s,l,u,c,f,d=10,h=d,p=90,m=360,g=2.5;function y(){return{type:"MultiLineString",coordinates:v()}}function v(){return Al(NN(r/p)*p,n,p).map(c).concat(Al(NN(s/m)*m,a,m).map(f)).concat(Al(NN(t/d)*d,e,d).filter((function(e){return ON(e%p)>gN})).map(l)).concat(Al(NN(o/h)*h,i,h).filter((function(e){return ON(e%m)>gN})).map(u))}return y.lines=function(){return v().map((function(e){return{type:"LineString",coordinates:e}}))},y.outline=function(){return{type:"Polygon",coordinates:[c(r).concat(f(a).slice(1),c(n).reverse().slice(1),f(s).reverse().slice(1))]}},y.extent=function(e){return arguments.length?y.extentMajor(e).extentMinor(e):y.extentMinor()},y.extentMajor=function(e){return arguments.length?(r=+e[0][0],n=+e[1][0],s=+e[0][1],a=+e[1][1],r>n&&(e=r,r=n,n=e),s>a&&(e=s,s=a,a=e),y.precision(g)):[[r,s],[n,a]]},y.extentMinor=function(n){return arguments.length?(t=+n[0][0],e=+n[1][0],o=+n[0][1],i=+n[1][1],t>e&&(n=t,t=e,e=n),o>i&&(n=o,o=i,i=n),y.precision(g)):[[t,o],[e,i]]},y.step=function(e){return arguments.length?y.stepMajor(e).stepMinor(e):y.stepMinor()},y.stepMajor=function(e){return arguments.length?(p=+e[0],m=+e[1],y):[p,m]},y.stepMinor=function(e){return arguments.length?(d=+e[0],h=+e[1],y):[d,h]},y.precision=function(d){return arguments.length?(g=+d,l=jA(o,i,90),u=NA(t,e,g),c=jA(s,a,90),f=NA(r,n,g),y):g},y.extentMajor([[-180,-90+gN],[180,90-gN]]).extentMinor([[-180,-80-gN],[180,80+gN]])}()}function sM(e){Vh.call(this,null,e)}function lM(e){if(!Ya(e))return!1;const t=Cs(na(e));return t.$x||t.$y||t.$value||t.$max}function uM(e){Vh.call(this,null,e),this.modified(!0)}function cM(e,t,n){Ya(e[t])&&e[t](n)}nM.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},ds(nM,Vh,{transform(e,t){var n,r=this._features,i=this._points,o=e.fields,a=o&&o[0],s=o&&o[1],l=e.geojson||!o&&ca,u=t.ADD;n=e.modified()||t.changed(t.REM)||t.modified(na(l))||a&&t.modified(na(a))||s&&t.modified(na(s)),this.value&&!n||(u=t.SOURCE,this._features=r=[],this._points=i=[]),l&&t.visit(u,(e=>r.push(l(e)))),a&&s&&(t.visit(u,(e=>{var t=a(e),n=s(e);null!=t&&null!=n&&(t=+t)===t&&(n=+n)===n&&i.push([t,n])})),r=r.concat({type:eM,geometry:{type:"MultiPoint",coordinates:i}})),this.value={type:tM,features:r}}}),rM.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},ds(rM,Vh,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||ca,o=e.as||"path",a=n.SOURCE;!r||e.modified()?(this.value=r=PC(e.projection),n.materialize().reflow()):a=i===ca||t.modified(i.fields)?n.ADD_MOD:n.ADD;const s=function(e,t){const n=e.pointRadius();e.context(null),null!=t&&e.pointRadius(t);return n}(r,e.pointRadius);return n.visit(a,(e=>e[o]=r(i(e)))),r.pointRadius(s),n.modifies(o)}}),iM.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},ds(iM,Vh,{transform(e,t){var n,r=e.projection,i=e.fields[0],o=e.fields[1],a=e.as||["x","y"],s=a[0],l=a[1];function u(e){const t=r([i(e),o(e)]);t?(e[s]=t[0],e[l]=t[1]):(e[s]=void 0,e[l]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,u):(n=t.modified(i.fields)||t.modified(o.fields),t.visit(n?t.ADD_MOD:t.ADD,u)),t.modifies(a)}}),oM.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},ds(oM,Vh,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.as||"shape",o=n.ADD;return r&&!e.modified()||(this.value=r=function(e,t,n){const r=null==n?n=>e(t(n)):r=>{var i=e.pointRadius(),o=e.pointRadius(n)(t(r));return e.pointRadius(i),o};return r.context=t=>(e.context(t),r),r}(PC(e.projection),e.field||la("datum"),e.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,(e=>e[i]=r)),n.modifies(i)}}),aM.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},ds(aM,Vh,{transform(e,t){var n,r=this.value,i=this.generator;if(!r.length||e.modified())for(const o in e)Ya(i[o])&&i[o](e[o]);return n=i(),r.length?t.mod.push(xh(r[0],n)):t.add.push(yh(n)),r[0]=n,t}}),sM.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},ds(sM,Vh,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r="shared"===e.resolve,i=e.field||ca,o=function(e,t){let n;Ya(e)?(n=n=>e(n,t),n.dep=lM(e)):e?n=ns(e):(n=e=>e.$value/e.$max||0,n.dep=!0);return n}(e.opacity,e),a=function(e,t){let n;Ya(e)?(n=n=>iv(e(n,t)),n.dep=lM(e)):n=ns(iv(e||"#888"));return n}(e.color,e),s=e.as||"image",l={$x:0,$y:0,$value:0,$max:r?kl(n.map((e=>kl(i(e).values)))):0};return n.forEach((e=>{const t=i(e),n=is({},e,l);r||(n.$max=kl(t.values||[])),e[s]=function(e,t,n,r){const i=e.width,o=e.height,a=e.x1||0,s=e.y1||0,l=e.x2||i,u=e.y2||o,c=e.values,f=c?e=>c[e]:fa,d=Ay(l-a,u-s),h=d.getContext("2d"),p=h.getImageData(0,0,l-a,u-s),m=p.data;for(let g=s,y=0;g<u;++g){t.$y=g-s;for(let e=a,o=g*i;e<l;++e,y+=4){t.$x=e-a,t.$value=f(e+o);const i=n(t);m[y+0]=i.r,m[y+1]=i.g,m[y+2]=i.b,m[y+3]=~~(255*r(t))}}return h.putImageData(p,0,0),d}(t,n,a.dep?a:ns(a(n)),o.dep?o:ns(o(n)))})),t.reflow(!0).modifies(s)}}),ds(uM,Vh,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=function(e){const t=MC((e||"mercator").toLowerCase());t||aa("Unrecognized projection type: "+e);return t()}(e.type),CC.forEach((t=>{null!=e[t]&&cM(n,t,e[t])}))):CC.forEach((t=>{e.modified(t)&&cM(n,t,e[t])})),null!=e.pointRadius&&n.path.pointRadius(e.pointRadius),e.fit&&function(e,t){const n=function(e){return e=Ga(e),1===e.length?e[0]:{type:tM,features:e.reduce(((e,t)=>e.concat(function(e){return e.type===tM?e.features:Ga(e).filter((e=>null!=e)).map((e=>e.type===eM?e:{type:eM,geometry:e}))}(t))),[])}}(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});var fM=Object.freeze({__proto__:null,contour:KC,geojson:nM,geopath:rM,geopoint:iM,geoshape:oM,graticule:aM,heatmap:sM,isocontour:qC,kde2d:XC,projection:uM});function dM(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,o,a,s,l,u,c,f,d,h=e._root,p={data:r},m=e._x0,g=e._y0,y=e._x1,v=e._y1;if(!h)return e._root=p,e;for(;h.length;)if((u=t>=(o=(m+y)/2))?m=o:y=o,(c=n>=(a=(g+v)/2))?g=a:v=a,i=h,!(h=h[f=c<<1|u]))return i[f]=p,e;if(s=+e._x.call(null,h.data),l=+e._y.call(null,h.data),t===s&&n===l)return p.next=h,i?i[f]=p:e._root=p,e;do{i=i?i[f]=new Array(4):e._root=new Array(4),(u=t>=(o=(m+y)/2))?m=o:y=o,(c=n>=(a=(g+v)/2))?g=a:v=a}while((f=c<<1|u)==(d=(l>=a)<<1|s>=o));return i[d]=h,i[f]=p,e}function hM(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function pM(e){return e[0]}function mM(e){return e[1]}function gM(e,t,n){var r=new yM(null==t?pM:t,null==n?mM:n,NaN,NaN,NaN,NaN);return null==e?r:r.addAll(e)}function yM(e,t,n,r,i,o){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function vM(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var bM=gM.prototype=yM.prototype;function xM(e){return function(){return e}}function wM(e){return 1e-6*(e()-.5)}function kM(e){return e.x+e.vx}function _M(e){return e.y+e.vy}function OM(e){return e.index}function EM(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}bM.copy=function(){var e,t,n=new yM(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=vM(r),n;for(e=[{source:r,target:n._root=new Array(4)}];r=e.pop();)for(var i=0;i<4;++i)(t=r.source[i])&&(t.length?e.push({source:t,target:r.target[i]=new Array(4)}):r.target[i]=vM(t));return n},bM.add=function(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return dM(this.cover(t,n),t,n,e)},bM.addAll=function(e){var t,n,r,i,o=e.length,a=new Array(o),s=new Array(o),l=1/0,u=1/0,c=-1/0,f=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(i=+this._y.call(null,t))||(a[n]=r,s[n]=i,r<l&&(l=r),r>c&&(c=r),i<u&&(u=i),i>f&&(f=i));if(l>c||u>f)return this;for(this.cover(l,u).cover(c,f),n=0;n<o;++n)dM(this,a[n],s[n],e[n]);return this},bM.cover=function(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,o=(r=Math.floor(t))+1;else{for(var a,s,l=i-n||1,u=this._root;n>e||e>=i||r>t||t>=o;)switch(s=(t<r)<<1|e<n,(a=new Array(4))[s]=u,u=a,l*=2,s){case 0:i=n+l,o=r+l;break;case 1:n=i-l,o=r+l;break;case 2:i=n+l,r=o-l;break;case 3:n=i-l,r=o-l}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},bM.data=function(){var e=[];return this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)})),e},bM.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},bM.find=function(e,t,n){var r,i,o,a,s,l,u,c=this._x0,f=this._y0,d=this._x1,h=this._y1,p=[],m=this._root;for(m&&p.push(new hM(m,c,f,d,h)),null==n?n=1/0:(c=e-n,f=t-n,d=e+n,h=t+n,n*=n);l=p.pop();)if(!(!(m=l.node)||(i=l.x0)>d||(o=l.y0)>h||(a=l.x1)<c||(s=l.y1)<f))if(m.length){var g=(i+a)/2,y=(o+s)/2;p.push(new hM(m[3],g,y,a,s),new hM(m[2],i,y,g,s),new hM(m[1],g,o,a,y),new hM(m[0],i,o,g,y)),(u=(t>=y)<<1|e>=g)&&(l=p[p.length-1],p[p.length-1]=p[p.length-1-u],p[p.length-1-u]=l)}else{var v=e-+this._x.call(null,m.data),b=t-+this._y.call(null,m.data),x=v*v+b*b;if(x<n){var w=Math.sqrt(n=x);c=e-w,f=t-w,d=e+w,h=t+w,r=m.data}}return r},bM.remove=function(e){if(isNaN(o=+this._x.call(null,e))||isNaN(a=+this._y.call(null,e)))return this;var t,n,r,i,o,a,s,l,u,c,f,d,h=this._root,p=this._x0,m=this._y0,g=this._x1,y=this._y1;if(!h)return this;if(h.length)for(;;){if((u=o>=(s=(p+g)/2))?p=s:g=s,(c=a>=(l=(m+y)/2))?m=l:y=l,t=h,!(h=h[f=c<<1|u]))return this;if(!h.length)break;(t[f+1&3]||t[f+2&3]||t[f+3&3])&&(n=t,d=f)}for(;h.data!==e;)if(r=h,!(h=h.next))return this;return(i=h.next)&&delete h.next,r?(i?r.next=i:delete r.next,this):t?(i?t[f]=i:delete t[f],(h=t[0]||t[1]||t[2]||t[3])&&h===(t[3]||t[2]||t[1]||t[0])&&!h.length&&(n?n[d]=h:this._root=h),this):(this._root=i,this)},bM.removeAll=function(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},bM.root=function(){return this._root},bM.size=function(){var e=0;return this.visit((function(t){if(!t.length)do{++e}while(t=t.next)})),e},bM.visit=function(e){var t,n,r,i,o,a,s=[],l=this._root;for(l&&s.push(new hM(l,this._x0,this._y0,this._x1,this._y1));t=s.pop();)if(!e(l=t.node,r=t.x0,i=t.y0,o=t.x1,a=t.y1)&&l.length){var u=(r+o)/2,c=(i+a)/2;(n=l[3])&&s.push(new hM(n,u,c,o,a)),(n=l[2])&&s.push(new hM(n,r,c,u,a)),(n=l[1])&&s.push(new hM(n,u,i,o,c)),(n=l[0])&&s.push(new hM(n,r,i,u,c))}return this},bM.visitAfter=function(e){var t,n=[],r=[];for(this._root&&n.push(new hM(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var i=t.node;if(i.length){var o,a=t.x0,s=t.y0,l=t.x1,u=t.y1,c=(a+l)/2,f=(s+u)/2;(o=i[0])&&n.push(new hM(o,a,s,c,f)),(o=i[1])&&n.push(new hM(o,c,s,l,f)),(o=i[2])&&n.push(new hM(o,a,f,c,u)),(o=i[3])&&n.push(new hM(o,c,f,l,u))}r.push(t)}for(;t=r.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this},bM.x=function(e){return arguments.length?(this._x=e,this):this._x},bM.y=function(e){return arguments.length?(this._y=e,this):this._y};var DM={value:()=>{}};function jM(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new NM(r)}function NM(e){this._=e}function SM(e,t){for(var n,r=0,i=e.length;r<i;++r)if((n=e[r]).name===t)return n.value}function AM(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=DM,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}NM.prototype=jM.prototype={constructor:NM,on:function(e,t){var n,r=this._,i=function(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}(e+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++o<a;)if(n=(e=i[o]).type)r[n]=AM(r[n],e.name,t);else if(null==t)for(n in r)r[n]=AM(r[n],e.name,null);return this}for(;++o<a;)if((n=(e=i[o]).type)&&(n=SM(r[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new NM(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=0,n=(r=this._[e]).length;o<n;++o)r[o].value.apply(t,i)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};var $M,CM,MM=0,PM=0,FM=0,TM=1e3,zM=0,RM=0,LM=0,BM="object"==typeof performance&&performance.now?performance:Date,IM="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function UM(){return RM||(IM(qM),RM=BM.now()+LM)}function qM(){RM=0}function WM(){this._call=this._time=this._next=null}function ZM(e,t,n){var r=new WM;return r.restart(e,t,n),r}function HM(){RM=(zM=BM.now())+LM,MM=PM=0;try{!function(){UM(),++MM;for(var e,t=$M;t;)(e=RM-t._time)>=0&&t._call.call(void 0,e),t=t._next;--MM}()}finally{MM=0,function(){var e,t,n=$M,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:$M=t);CM=e,VM(r)}(),RM=0}}function GM(){var e=BM.now(),t=e-zM;t>TM&&(LM-=t,zM=e)}function VM(e){MM||(PM&&(PM=clearTimeout(PM)),e-RM>24?(e<1/0&&(PM=setTimeout(HM,e-BM.now()-LM)),FM&&(FM=clearInterval(FM))):(FM||(zM=BM.now(),FM=setInterval(GM,TM)),MM=1,IM(HM)))}WM.prototype=ZM.prototype={constructor:WM,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?UM():+n)+(null==t?0:+t),this._next||CM===this||(CM?CM._next=this:$M=this,CM=this),this._call=e,this._time=n,VM()},stop:function(){this._call&&(this._call=null,this._time=1/0,VM())}};const YM=1664525,XM=1013904223,JM=4294967296;function QM(e){return e.x}function KM(e){return e.y}var eP=10,tP=Math.PI*(3-Math.sqrt(5));function nP(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=new Map,l=ZM(f),u=jM("tick","end"),c=function(){let e=1;return()=>(e=(YM*e+XM)%JM)/JM}();function f(){d(),u.call("tick",t),n<r&&(l.stop(),u.call("end",t))}function d(r){var l,u,c=e.length;void 0===r&&(r=1);for(var f=0;f<r;++f)for(n+=(o-n)*i,s.forEach((function(e){e(n)})),l=0;l<c;++l)null==(u=e[l]).fx?u.x+=u.vx*=a:(u.x=u.fx,u.vx=0),null==u.fy?u.y+=u.vy*=a:(u.y=u.fy,u.vy=0);return t}function h(){for(var t,n=0,r=e.length;n<r;++n){if((t=e[n]).index=n,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),isNaN(t.x)||isNaN(t.y)){var i=eP*Math.sqrt(.5+n),o=n*tP;t.x=i*Math.cos(o),t.y=i*Math.sin(o)}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0)}}function p(t){return t.initialize&&t.initialize(e,c),t}return null==e&&(e=[]),h(),t={tick:d,restart:function(){return l.restart(f),t},stop:function(){return l.stop(),t},nodes:function(n){return arguments.length?(e=n,h(),s.forEach(p),t):e},alpha:function(e){return arguments.length?(n=+e,t):n},alphaMin:function(e){return arguments.length?(r=+e,t):r},alphaDecay:function(e){return arguments.length?(i=+e,t):+i},alphaTarget:function(e){return arguments.length?(o=+e,t):o},velocityDecay:function(e){return arguments.length?(a=1-e,t):1-a},randomSource:function(e){return arguments.length?(c=e,s.forEach(p),t):c},force:function(e,n){return arguments.length>1?(null==n?s.delete(e):s.set(e,p(n)),t):s.get(e)},find:function(t,n,r){var i,o,a,s,l,u=0,c=e.length;for(null==r?r=1/0:r*=r,u=0;u<c;++u)(a=(i=t-(s=e[u]).x)*i+(o=n-s.y)*o)<r&&(l=s,r=a);return l},on:function(e,n){return arguments.length>1?(u.on(e,n),t):u.on(e)}}}const rP={center:function(e,t){var n,r=1;function i(){var i,o,a=n.length,s=0,l=0;for(i=0;i<a;++i)s+=(o=n[i]).x,l+=o.y;for(s=(s/a-e)*r,l=(l/a-t)*r,i=0;i<a;++i)(o=n[i]).x-=s,o.y-=l}return null==e&&(e=0),null==t&&(t=0),i.initialize=function(e){n=e},i.x=function(t){return arguments.length?(e=+t,i):e},i.y=function(e){return arguments.length?(t=+e,i):t},i.strength=function(e){return arguments.length?(r=+e,i):r},i},collide:function(e){var t,n,r,i=1,o=1;function a(){for(var e,a,l,u,c,f,d,h=t.length,p=0;p<o;++p)for(a=gM(t,kM,_M).visitAfter(s),e=0;e<h;++e)l=t[e],f=n[l.index],d=f*f,u=l.x+l.vx,c=l.y+l.vy,a.visit(m);function m(e,t,n,o,a){var s=e.data,h=e.r,p=f+h;if(!s)return t>u+p||o<u-p||n>c+p||a<c-p;if(s.index>l.index){var m=u-s.x-s.vx,g=c-s.y-s.vy,y=m*m+g*g;y<p*p&&(0===m&&(y+=(m=wM(r))*m),0===g&&(y+=(g=wM(r))*g),y=(p-(y=Math.sqrt(y)))/y*i,l.vx+=(m*=y)*(p=(h*=h)/(d+h)),l.vy+=(g*=y)*p,s.vx-=m*(p=1-p),s.vy-=g*p)}}}function s(e){if(e.data)return e.r=n[e.data.index];for(var t=e.r=0;t<4;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function l(){if(t){var r,i,o=t.length;for(n=new Array(o),r=0;r<o;++r)i=t[r],n[i.index]=+e(i,r,t)}}return"function"!=typeof e&&(e=xM(null==e?1:+e)),a.initialize=function(e,n){t=e,r=n,l()},a.iterations=function(e){return arguments.length?(o=+e,a):o},a.strength=function(e){return arguments.length?(i=+e,a):i},a.radius=function(t){return arguments.length?(e="function"==typeof t?t:xM(+t),l(),a):e},a},nbody:function(){var e,t,n,r,i,o=xM(-30),a=1,s=1/0,l=.81;function u(n){var i,o=e.length,a=gM(e,QM,KM).visitAfter(f);for(r=n,i=0;i<o;++i)t=e[i],a.visit(d)}function c(){if(e){var t,n,r=e.length;for(i=new Array(r),t=0;t<r;++t)n=e[t],i[n.index]=+o(n,t,e)}}function f(e){var t,n,r,o,a,s=0,l=0;if(e.length){for(r=o=a=0;a<4;++a)(t=e[a])&&(n=Math.abs(t.value))&&(s+=t.value,l+=n,r+=n*t.x,o+=n*t.y);e.x=r/l,e.y=o/l}else{(t=e).x=t.data.x,t.y=t.data.y;do{s+=i[t.data.index]}while(t=t.next)}e.value=s}function d(e,o,u,c){if(!e.value)return!0;var f=e.x-t.x,d=e.y-t.y,h=c-o,p=f*f+d*d;if(h*h/l<p)return p<s&&(0===f&&(p+=(f=wM(n))*f),0===d&&(p+=(d=wM(n))*d),p<a&&(p=Math.sqrt(a*p)),t.vx+=f*e.value*r/p,t.vy+=d*e.value*r/p),!0;if(!(e.length||p>=s)){(e.data!==t||e.next)&&(0===f&&(p+=(f=wM(n))*f),0===d&&(p+=(d=wM(n))*d),p<a&&(p=Math.sqrt(a*p)));do{e.data!==t&&(h=i[e.data.index]*r/p,t.vx+=f*h,t.vy+=d*h)}while(e=e.next)}}return u.initialize=function(t,r){e=t,n=r,c()},u.strength=function(e){return arguments.length?(o="function"==typeof e?e:xM(+e),c(),u):o},u.distanceMin=function(e){return arguments.length?(a=e*e,u):Math.sqrt(a)},u.distanceMax=function(e){return arguments.length?(s=e*e,u):Math.sqrt(s)},u.theta=function(e){return arguments.length?(l=e*e,u):Math.sqrt(l)},u},link:function(e){var t,n,r,i,o,a,s=OM,l=function(e){return 1/Math.min(i[e.source.index],i[e.target.index])},u=xM(30),c=1;function f(r){for(var i=0,s=e.length;i<c;++i)for(var l,u,f,d,h,p,m,g=0;g<s;++g)u=(l=e[g]).source,d=(f=l.target).x+f.vx-u.x-u.vx||wM(a),h=f.y+f.vy-u.y-u.vy||wM(a),d*=p=((p=Math.sqrt(d*d+h*h))-n[g])/p*r*t[g],h*=p,f.vx-=d*(m=o[g]),f.vy-=h*m,u.vx+=d*(m=1-m),u.vy+=h*m}function d(){if(r){var a,l,u=r.length,c=e.length,f=new Map(r.map(((e,t)=>[s(e,t,r),e])));for(a=0,i=new Array(u);a<c;++a)(l=e[a]).index=a,"object"!=typeof l.source&&(l.source=EM(f,l.source)),"object"!=typeof l.target&&(l.target=EM(f,l.target)),i[l.source.index]=(i[l.source.index]||0)+1,i[l.target.index]=(i[l.target.index]||0)+1;for(a=0,o=new Array(c);a<c;++a)l=e[a],o[a]=i[l.source.index]/(i[l.source.index]+i[l.target.index]);t=new Array(c),h(),n=new Array(c),p()}}function h(){if(r)for(var n=0,i=e.length;n<i;++n)t[n]=+l(e[n],n,e)}function p(){if(r)for(var t=0,i=e.length;t<i;++t)n[t]=+u(e[t],t,e)}return null==e&&(e=[]),f.initialize=function(e,t){r=e,a=t,d()},f.links=function(t){return arguments.length?(e=t,d(),f):e},f.id=function(e){return arguments.length?(s=e,f):s},f.iterations=function(e){return arguments.length?(c=+e,f):c},f.strength=function(e){return arguments.length?(l="function"==typeof e?e:xM(+e),h(),f):l},f.distance=function(e){return arguments.length?(u="function"==typeof e?e:xM(+e),p(),f):u},f},x:function(e){var t,n,r,i=xM(.1);function o(e){for(var i,o=0,a=t.length;o<a;++o)(i=t[o]).vx+=(r[o]-i.x)*n[o]*e}function a(){if(t){var o,a=t.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+e(t[o],o,t))?0:+i(t[o],o,t)}}return"function"!=typeof e&&(e=xM(null==e?0:+e)),o.initialize=function(e){t=e,a()},o.strength=function(e){return arguments.length?(i="function"==typeof e?e:xM(+e),a(),o):i},o.x=function(t){return arguments.length?(e="function"==typeof t?t:xM(+t),a(),o):e},o},y:function(e){var t,n,r,i=xM(.1);function o(e){for(var i,o=0,a=t.length;o<a;++o)(i=t[o]).vy+=(r[o]-i.y)*n[o]*e}function a(){if(t){var o,a=t.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+e(t[o],o,t))?0:+i(t[o],o,t)}}return"function"!=typeof e&&(e=xM(null==e?0:+e)),o.initialize=function(e){t=e,a()},o.strength=function(e){return arguments.length?(i="function"==typeof e?e:xM(+e),a(),o):i},o.y=function(t){return arguments.length?(e="function"==typeof t?t:xM(+t),a(),o):e},o}},iP="forces",oP=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],aP=["static","iterations"],sP=["x","y","vx","vy"];function lP(e){Vh.call(this,null,e)}function uP(e,t,n,r){var i,o,a,s,l=Ga(t.forces);for(i=0,o=oP.length;i<o;++i)(a=oP[i])!==iP&&t.modified(a)&&e[a](t[a]);for(i=0,o=l.length;i<o;++i)s=iP+i,(a=n||t.modified(iP,i)?fP(l[i]):r&&cP(l[i],r)?e.force(s):null)&&e.force(s,a);for(o=e.numForces||0;i<o;++i)e.force(iP+i,null);return e.numForces=l.length,e}function cP(e,t){var n,r;for(n in e)if(Ya(r=e[n])&&t.modified(na(r)))return 1;return 0}function fP(e){var t,n;for(n in ls(rP,e.force)||aa("Unrecognized force: "+e.force),t=rP[e.force](),e)Ya(t[n])&&dP(t[n],e[n],e);return t}function dP(e,t,n){e(Ya(t)?e=>t(e,n):t)}lP.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30,expr:!0},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:sP}]},ds(lP,Vh,{transform(e,t){var n,r,i=this.value,o=t.changed(t.ADD_REM),a=e.modified(oP),s=e.iterations||300;if(i?(o&&(t.modifies("index"),i.nodes(t.source)),(a||t.changed(t.MOD))&&uP(i,e,0,t)):(this.value=i=function(e,t){const n=nP(e),r=n.stop,i=n.restart;let o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,i()),n.stop=()=>(o=!0,r()),uP(n,t,!0).on("end",(()=>o=!0))}(t.source,e),i.on("tick",(n=t.dataflow,r=this,()=>n.touch(r).run())),e.static||(o=!0,i.tick()),t.modifies("index")),a||o||e.modified(aP)||t.changed()&&e.restart)if(i.alpha(Math.max(i.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(i.alphaMin(),1/s)),e.static)for(i.stop();--s>=0;)i.tick();else if(i.stopped()&&i.restart(),!o)return t.StopPropagation;return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let s,l=this._argops,u=0,c=l.length;u<c;++u)if(s=l[u],s.name===iP&&"link"===s.op._argval.force)for(var r,i=s.op._argops,o=0,a=i.length;o<a;++o)if("links"===i[o].name&&(r=i[o].op.source)){n.pulse(r,n.changeset().reflow());break}return t.reflow(e.modified()).modifies(sP)}});var hP=Object.freeze({__proto__:null,force:lP});function pP(e,t){return e.parent===t.parent?1:2}function mP(e,t){return e+t.x}function gP(e,t){return Math.max(e,t.y)}function yP(e){var t=0,n=e.children,r=n&&n.length;if(r)for(;--r>=0;)t+=n[r].value;else t=1;e.value=t}function vP(e,t){e instanceof Map?(e=[void 0,e],void 0===t&&(t=xP)):void 0===t&&(t=bP);for(var n,r,i,o,a,s=new _P(e),l=[s];n=l.pop();)if((i=t(n.data))&&(a=(i=Array.from(i)).length))for(n.children=i,o=a-1;o>=0;--o)l.push(r=i[o]=new _P(i[o])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(kP)}function bP(e){return e.children}function xP(e){return Array.isArray(e)?e[1]:null}function wP(e){void 0!==e.data.value&&(e.value=e.data.value),e.data=e.data.data}function kP(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function _P(e){this.data=e,this.depth=this.height=0,this.parent=null}function OP(e){return null==e?null:EP(e)}function EP(e){if("function"!=typeof e)throw new Error;return e}function DP(){return 0}function jP(e){return function(){return e}}_P.prototype=vP.prototype={constructor:_P,count:function(){return this.eachAfter(yP)},each:function(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this},eachAfter:function(e,t){for(var n,r,i,o=this,a=[o],s=[],l=-1;o=a.pop();)if(s.push(o),n=o.children)for(r=0,i=n.length;r<i;++r)a.push(n[r]);for(;o=s.pop();)e.call(t,o,++l,this);return this},eachBefore:function(e,t){for(var n,r,i=this,o=[i],a=-1;i=o.pop();)if(e.call(t,i,++a,this),n=i.children)for(r=n.length-1;r>=0;--r)o.push(n[r]);return this},find:function(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r},sum:function(e){return this.eachAfter((function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n}))},sort:function(e){return this.eachBefore((function(t){t.children&&t.children.sort(e)}))},path:function(e){for(var t=this,n=function(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;e=n.pop(),t=r.pop();for(;e===t;)i=e,e=n.pop(),t=r.pop();return i}(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){return Array.from(this)},leaves:function(){var e=[];return this.eachBefore((function(t){t.children||e.push(t)})),e},links:function(){var e=this,t=[];return e.each((function(n){n!==e&&t.push({source:n.parent,target:n})})),t},copy:function(){return vP(this).eachBefore(wP)},[Symbol.iterator]:function*(){var e,t,n,r,i=this,o=[i];do{for(e=o.reverse(),o=[];i=e.pop();)if(yield i,t=i.children)for(n=0,r=t.length;n<r;++n)o.push(t[n])}while(o.length)}};const NP=1664525,SP=1013904223,AP=4294967296;function $P(e,t){var n,r;if(PP(t,e))return[t];for(n=0;n<e.length;++n)if(CP(t,e[n])&&PP(TP(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(CP(TP(e[n],e[r]),t)&&CP(TP(e[n],t),e[r])&&CP(TP(e[r],t),e[n])&&PP(zP(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function CP(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function MP(e,t){var n=e.r-t.r+1e-9*Math.max(e.r,t.r,1),r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function PP(e,t){for(var n=0;n<t.length;++n)if(!MP(e,t[n]))return!1;return!0}function FP(e){switch(e.length){case 1:return function(e){return{x:e.x,y:e.y,r:e.r}}(e[0]);case 2:return TP(e[0],e[1]);case 3:return zP(e[0],e[1],e[2])}}function TP(e,t){var n=e.x,r=e.y,i=e.r,o=t.x,a=t.y,s=t.r,l=o-n,u=a-r,c=s-i,f=Math.sqrt(l*l+u*u);return{x:(n+o+l/f*c)/2,y:(r+a+u/f*c)/2,r:(f+i+s)/2}}function zP(e,t,n){var r=e.x,i=e.y,o=e.r,a=t.x,s=t.y,l=t.r,u=n.x,c=n.y,f=n.r,d=r-a,h=r-u,p=i-s,m=i-c,g=l-o,y=f-o,v=r*r+i*i-o*o,b=v-a*a-s*s+l*l,x=v-u*u-c*c+f*f,w=h*p-d*m,k=(p*x-m*b)/(2*w)-r,_=(m*g-p*y)/w,O=(h*b-d*x)/(2*w)-i,E=(d*y-h*g)/w,D=_*_+E*E-1,j=2*(o+k*_+O*E),N=k*k+O*O-o*o,S=-(Math.abs(D)>1e-6?(j+Math.sqrt(j*j-4*D*N))/(2*D):N/j);return{x:r+k+_*S,y:i+O+E*S,r:S}}function RP(e,t,n){var r,i,o,a,s=e.x-t.x,l=e.y-t.y,u=s*s+l*l;u?(i=t.r+n.r,i*=i,a=e.r+n.r,i>(a*=a)?(r=(u+a-i)/(2*u),o=Math.sqrt(Math.max(0,a/u-r*r)),n.x=e.x-r*s-o*l,n.y=e.y-r*l+o*s):(r=(u+i-a)/(2*u),o=Math.sqrt(Math.max(0,i/u-r*r)),n.x=t.x+r*s-o*l,n.y=t.y+r*l+o*s)):(n.x=t.x+n.r,n.y=t.y)}function LP(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function BP(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,o=(t.y*n.r+n.y*t.r)/r;return i*i+o*o}function IP(e){this._=e,this.next=null,this.previous=null}function UP(e,t){if(!(o=(e=function(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}(e)).length))return 0;var n,r,i,o,a,s,l,u,c,f,d;if((n=e[0]).x=0,n.y=0,!(o>1))return n.r;if(r=e[1],n.x=-r.r,r.x=n.r,r.y=0,!(o>2))return n.r+r.r;RP(r,n,i=e[2]),n=new IP(n),r=new IP(r),i=new IP(i),n.next=i.previous=r,r.next=n.previous=i,i.next=r.previous=n;e:for(l=3;l<o;++l){RP(n._,r._,i=e[l]),i=new IP(i),u=r.next,c=n.previous,f=r._.r,d=n._.r;do{if(f<=d){if(LP(u._,i._)){r=u,n.next=r,r.previous=n,--l;continue e}f+=u._.r,u=u.next}else{if(LP(c._,i._)){(n=c).next=r,r.previous=n,--l;continue e}d+=c._.r,c=c.previous}}while(u!==c.next);for(i.previous=n,i.next=r,n.next=r.previous=r=i,a=BP(n);(i=i.next)!==r;)(s=BP(i))<a&&(n=i,a=s);r=n.next}for(n=[r._],i=r;(i=i.next)!==r;)n.push(i._);for(i=function(e,t){for(var n,r,i=0,o=(e=function(e,t){let n,r,i=e.length;for(;i;)r=t()*i--|0,n=e[i],e[i]=e[r],e[r]=n;return e}(Array.from(e),t)).length,a=[];i<o;)n=e[i],r&&MP(r,n)?++i:(r=FP(a=$P(a,n)),i=0);return r}(n,t),l=0;l<o;++l)(n=e[l]).x-=i.x,n.y-=i.y;return i.r}function qP(e){return Math.sqrt(e.value)}function WP(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function ZP(e,t,n){return function(r){if(i=r.children){var i,o,a,s=i.length,l=e(r)*t||0;if(l)for(o=0;o<s;++o)i[o].r+=l;if(a=UP(i,n),l)for(o=0;o<s;++o)i[o].r-=l;r.r=a+l}}}function HP(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function GP(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function VP(e,t,n,r,i){for(var o,a=e.children,s=-1,l=a.length,u=e.value&&(r-t)/e.value;++s<l;)(o=a[s]).y0=n,o.y1=i,o.x0=t,o.x1=t+=o.value*u}var YP={depth:-1},XP={},JP={};function QP(e){return e.id}function KP(e){return e.parentId}function eF(){var e,t=QP,n=KP;function r(r){var i,o,a,s,l,u,c,f,d=Array.from(r),h=t,p=n,m=new Map;if(null!=e){const t=d.map(((t,n)=>function(e){e=`${e}`;let t=e.length;nF(e,t-1)&&!nF(e,t-2)&&(e=e.slice(0,-1));return"/"===e[0]?e:`/${e}`}(e(t,n,r)))),n=t.map(tF),i=new Set(t).add("");for(const e of n)i.has(e)||(i.add(e),t.push(e),n.push(tF(e)),d.push(JP));h=(e,n)=>t[n],p=(e,t)=>n[t]}for(a=0,i=d.length;a<i;++a)o=d[a],u=d[a]=new _P(o),null!=(c=h(o,a,r))&&(c+="")&&(f=u.id=c,m.set(f,m.has(f)?XP:u)),null!=(c=p(o,a,r))&&(c+="")&&(u.parent=c);for(a=0;a<i;++a)if(c=(u=d[a]).parent){if(!(l=m.get(c)))throw new Error("missing: "+c);if(l===XP)throw new Error("ambiguous: "+c);l.children?l.children.push(u):l.children=[u],u.parent=l}else{if(s)throw new Error("multiple roots");s=u}if(!s)throw new Error("no root");if(null!=e){for(;s.data===JP&&1===s.children.length;)s=s.children[0],--i;for(let e=d.length-1;e>=0&&(u=d[e]).data===JP;--e)u.data=null}if(s.parent=YP,s.eachBefore((function(e){e.depth=e.parent.depth+1,--i})).eachBefore(kP),s.parent=null,i>0)throw new Error("cycle");return s}return r.id=function(e){return arguments.length?(t=OP(e),r):t},r.parentId=function(e){return arguments.length?(n=OP(e),r):n},r.path=function(t){return arguments.length?(e=OP(t),r):e},r}function tF(e){let t=e.length;if(t<2)return"";for(;--t>1&&!nF(e,t););return e.slice(0,t)}function nF(e,t){if("/"===e[t]){let n=0;for(;t>0&&"\\"===e[--t];)++n;if(0==(1&n))return!0}return!1}function rF(e,t){return e.parent===t.parent?1:2}function iF(e){var t=e.children;return t?t[0]:e.t}function oF(e){var t=e.children;return t?t[t.length-1]:e.t}function aF(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function sF(e,t,n){return e.a.parent===t.parent?e.a:n}function lF(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}function uF(e,t,n,r,i){for(var o,a=e.children,s=-1,l=a.length,u=e.value&&(i-n)/e.value;++s<l;)(o=a[s]).x0=t,o.x1=r,o.y0=n,o.y1=n+=o.value*u}lF.prototype=Object.create(_P.prototype);var cF=(1+Math.sqrt(5))/2;function fF(e,t,n,r,i,o){for(var a,s,l,u,c,f,d,h,p,m,g,y=[],v=t.children,b=0,x=0,w=v.length,k=t.value;b<w;){l=i-n,u=o-r;do{c=v[x++].value}while(!c&&x<w);for(f=d=c,g=c*c*(m=Math.max(u/l,l/u)/(k*e)),p=Math.max(d/g,g/f);x<w;++x){if(c+=s=v[x].value,s<f&&(f=s),s>d&&(d=s),g=c*c*m,(h=Math.max(d/g,g/f))>p){c-=s;break}p=h}y.push(a={value:c,dice:l<u,children:v.slice(b,x)}),a.dice?VP(a,n,r,i,k?r+=u*c/k:o):uF(a,n,r,k?n+=l*c/k:i,o),k-=c,b=x}return y}var dF=function e(t){function n(e,n,r,i,o){fF(t,e,n,r,i,o)}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(cF);var hF=function e(t){function n(e,n,r,i,o){if((a=e._squarify)&&a.ratio===t)for(var a,s,l,u,c,f=-1,d=a.length,h=e.value;++f<d;){for(l=(s=a[f]).children,u=s.value=0,c=l.length;u<c;++u)s.value+=l[u].value;s.dice?VP(s,n,r,i,h?r+=(o-r)*s.value/h:o):uF(s,n,r,h?n+=(i-n)*s.value/h:i,o),h-=s.value}else e._squarify=a=fF(t,e,n,r,i,o),a.ratio=t}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(cF);function pF(e,t,n){const r={};return e.each((e=>{const i=e.data;n(i)&&(r[t(i)]=e)})),e.lookup=r,e}function mF(e){Vh.call(this,null,e)}mF.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const gF=e=>e.values;function yF(){const e=[],t={entries:e=>r(n(e,0),0),key:n=>(e.push(n),t)};function n(t,r){if(r>=e.length)return t;const i=t.length,o=e[r++],a={},s={};let l,u,c,f=-1;for(;++f<i;)l=o(u=t[f])+"",(c=a[l])?c.push(u):a[l]=[u];for(l in a)s[l]=n(a[l],r);return s}function r(t,n){if(++n>e.length)return t;const i=[];for(const e in t)i.push({key:e,values:r(t[e],n)});return i}return t}function vF(e){Vh.call(this,null,e)}ds(mF,Vh,{transform(e,t){t.source||aa("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),i=t.clone(),o=this.value;return(!o||r||t.changed())&&(o&&o.each((e=>{e.children&&ph(e.data)&&i.rem.push(e.data)})),this.value=o=vP({values:Ga(e.keys).reduce(((e,t)=>(e.key(t),e)),yF()).entries(i.source)},gF),n&&o.each((e=>{e.children&&(e=yh(e.data),i.add.push(e),i.source.push(e))})),pF(o,mh,mh)),i.source.root=o,i}});const bF=(e,t)=>e.parent===t.parent?1:2;ds(vF,Vh,{transform(e,t){t.source&&t.source.root||aa(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),r=this.fields,i=t.source.root,o=e.as||r;e.field?i.sum(e.field):i.count(),e.sort&&i.sort(wh(e.sort,(e=>e.data))),function(e,t,n){for(let r,i=0,o=t.length;i<o;++i)r=t[i],r in n&&e[r](n[r])}(n,this.params,e),n.separation&&n.separation(!1!==e.separation?bF:da);try{this.value=n(i)}catch(a){aa(a)}return i.each((e=>function(e,t,n){const r=e.data,i=t.length-1;for(let o=0;o<i;++o)r[n[o]]=e[t[o]];r[n[i]]=e.children?e.children.length:0}(e,r,o))),t.reflow(e.modified()).modifies(o).modifies("leaf")}});const xF=["x","y","r","depth","children"];function wF(e){vF.call(this,e)}wF.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:xF.length,default:xF}]},ds(wF,vF,{layout:function(){var e=null,t=1,n=1,r=DP;function i(i){const o=function(){let e=1;return()=>(e=(NP*e+SP)%AP)/AP}();return i.x=t/2,i.y=n/2,e?i.eachBefore(WP(e)).eachAfter(ZP(r,.5,o)).eachBefore(HP(1)):i.eachBefore(WP(qP)).eachAfter(ZP(DP,1,o)).eachAfter(ZP(r,i.r/Math.min(t,n),o)).eachBefore(HP(Math.min(t,n)/(2*i.r))),i}return i.radius=function(t){return arguments.length?(e=OP(t),i):e},i.size=function(e){return arguments.length?(t=+e[0],n=+e[1],i):[t,n]},i.padding=function(e){return arguments.length?(r="function"==typeof e?e:jP(+e),i):r},i},params:["radius","size","padding"],fields:xF});const kF=["x0","y0","x1","y1","depth","children"];function _F(e){vF.call(this,e)}function OF(e){Vh.call(this,null,e)}_F.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:kF.length,default:kF}]},ds(_F,vF,{layout:function(){var e=1,t=1,n=0,r=!1;function i(i){var o=i.height+1;return i.x0=i.y0=n,i.x1=e,i.y1=t/o,i.eachBefore(function(e,t){return function(r){r.children&&VP(r,r.x0,e*(r.depth+1)/t,r.x1,e*(r.depth+2)/t);var i=r.x0,o=r.y0,a=r.x1-n,s=r.y1-n;a<i&&(i=a=(i+a)/2),s<o&&(o=s=(o+s)/2),r.x0=i,r.y0=o,r.x1=a,r.y1=s}}(t,o)),r&&i.eachBefore(GP),i}return i.round=function(e){return arguments.length?(r=!!e,i):r},i.size=function(n){return arguments.length?(e=+n[0],t=+n[1],i):[e,t]},i.padding=function(e){return arguments.length?(n=+e,i):n},i},params:["size","round","padding"],fields:kF}),OF.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},ds(OF,Vh,{transform(e,t){t.source||aa("Stratify transform requires an upstream data source.");let n=this.value;const r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),o=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return i.source=i.source.slice(),o&&(n=i.source.length?pF(eF().id(e.key).parentId(e.parentKey)(i.source),e.key,ha):pF(eF()([{}]),e.key,e.key)),i.source.root=this.value=n,i}});const EF={tidy:function(){var e=rF,t=1,n=1,r=null;function i(i){var l=function(e){for(var t,n,r,i,o,a=new lF(e,0),s=[a];t=s.pop();)if(r=t._.children)for(t.children=new Array(o=r.length),i=o-1;i>=0;--i)s.push(n=t.children[i]=new lF(r[i],i)),n.parent=t;return(a.parent=new lF(null,0)).children=[a],a}(i);if(l.eachAfter(o),l.parent.m=-l.z,l.eachBefore(a),r)i.eachBefore(s);else{var u=i,c=i,f=i;i.eachBefore((function(e){e.x<u.x&&(u=e),e.x>c.x&&(c=e),e.depth>f.depth&&(f=e)}));var d=u===c?1:e(u,c)/2,h=d-u.x,p=t/(c.x+d+h),m=n/(f.depth||1);i.eachBefore((function(e){e.x=(e.x+h)*p,e.y=e.depth*m}))}return i}function o(t){var n=t.children,r=t.parent.children,i=t.i?r[t.i-1]:null;if(n){!function(e){for(var t,n=0,r=0,i=e.children,o=i.length;--o>=0;)(t=i[o]).z+=n,t.m+=n,n+=t.s+(r+=t.c)}(t);var o=(n[0].z+n[n.length-1].z)/2;i?(t.z=i.z+e(t._,i._),t.m=t.z-o):t.z=o}else i&&(t.z=i.z+e(t._,i._));t.parent.A=function(t,n,r){if(n){for(var i,o=t,a=t,s=n,l=o.parent.children[0],u=o.m,c=a.m,f=s.m,d=l.m;s=oF(s),o=iF(o),s&&o;)l=iF(l),(a=oF(a)).a=t,(i=s.z+f-o.z-u+e(s._,o._))>0&&(aF(sF(s,t,r),t,i),u+=i,c+=i),f+=s.m,u+=o.m,d+=l.m,c+=a.m;s&&!oF(a)&&(a.t=s,a.m+=f-c),o&&!iF(l)&&(l.t=o,l.m+=u-d,r=t)}return r}(t,i,t.parent.A||r[0])}function a(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function s(e){e.x*=t,e.y=e.depth*n}return i.separation=function(t){return arguments.length?(e=t,i):e},i.size=function(e){return arguments.length?(r=!1,t=+e[0],n=+e[1],i):r?null:[t,n]},i.nodeSize=function(e){return arguments.length?(r=!0,t=+e[0],n=+e[1],i):r?[t,n]:null},i},cluster:function(){var e=pP,t=1,n=1,r=!1;function i(i){var o,a=0;i.eachAfter((function(t){var n=t.children;n?(t.x=function(e){return e.reduce(mP,0)/e.length}(n),t.y=function(e){return 1+e.reduce(gP,0)}(n)):(t.x=o?a+=e(t,o):0,t.y=0,o=t)}));var s=function(e){for(var t;t=e.children;)e=t[0];return e}(i),l=function(e){for(var t;t=e.children;)e=t[t.length-1];return e}(i),u=s.x-e(s,l)/2,c=l.x+e(l,s)/2;return i.eachAfter(r?function(e){e.x=(e.x-i.x)*t,e.y=(i.y-e.y)*n}:function(e){e.x=(e.x-u)/(c-u)*t,e.y=(1-(i.y?e.y/i.y:1))*n})}return i.separation=function(t){return arguments.length?(e=t,i):e},i.size=function(e){return arguments.length?(r=!1,t=+e[0],n=+e[1],i):r?null:[t,n]},i.nodeSize=function(e){return arguments.length?(r=!0,t=+e[0],n=+e[1],i):r?[t,n]:null},i}},DF=["x","y","depth","children"];function jF(e){vF.call(this,e)}function NF(e){Vh.call(this,[],e)}jF.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:DF.length,default:DF}]},ds(jF,vF,{layout(e){const t=e||"tidy";if(ls(EF,t))return EF[t]();aa("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:DF}),NF.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},ds(NF,Vh,{transform(e,t){const n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),o={};return r||aa("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(i.rem=n,t.visit(t.SOURCE,(e=>o[mh(e)]=1)),r.each((e=>{const t=e.data,n=e.parent&&e.parent.data;n&&o[mh(t)]&&o[mh(n)]&&i.add.push(yh({source:n,target:t}))})),this.value=i.add):t.changed(t.MOD)&&(t.visit(t.MOD,(e=>o[mh(e)]=1)),n.forEach((e=>{(o[mh(e.source)]||o[mh(e.target)])&&i.mod.push(e)}))),i}});const SF={binary:function(e,t,n,r,i){var o,a,s=e.children,l=s.length,u=new Array(l+1);for(u[0]=a=o=0;o<l;++o)u[o+1]=a+=s[o].value;!function e(t,n,r,i,o,a,l){if(t>=n-1){var c=s[t];return c.x0=i,c.y0=o,c.x1=a,void(c.y1=l)}var f=u[t],d=r/2+f,h=t+1,p=n-1;for(;h<p;){var m=h+p>>>1;u[m]<d?h=m+1:p=m}d-u[h-1]<u[h]-d&&t+1<h&&--h;var g=u[h]-f,y=r-g;if(a-i>l-o){var v=r?(i*y+a*g)/r:a;e(t,h,g,i,o,v,l),e(h,n,y,v,o,a,l)}else{var b=r?(o*y+l*g)/r:l;e(t,h,g,i,o,a,b),e(h,n,y,i,b,a,l)}}(0,l,e.value,t,n,r,i)},dice:VP,slice:uF,slicedice:function(e,t,n,r,i){(1&e.depth?uF:VP)(e,t,n,r,i)},squarify:dF,resquarify:hF},AF=["x0","y0","x1","y1","depth","children"];function $F(e){vF.call(this,e)}$F.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:AF.length,default:AF}]},ds($F,vF,{layout(){const e=function(){var e=dF,t=!1,n=1,r=1,i=[0],o=DP,a=DP,s=DP,l=DP,u=DP;function c(e){return e.x0=e.y0=0,e.x1=n,e.y1=r,e.eachBefore(f),i=[0],t&&e.eachBefore(GP),e}function f(t){var n=i[t.depth],r=t.x0+n,c=t.y0+n,f=t.x1-n,d=t.y1-n;f<r&&(r=f=(r+f)/2),d<c&&(c=d=(c+d)/2),t.x0=r,t.y0=c,t.x1=f,t.y1=d,t.children&&(n=i[t.depth+1]=o(t)/2,r+=u(t)-n,c+=a(t)-n,(f-=s(t)-n)<r&&(r=f=(r+f)/2),(d-=l(t)-n)<c&&(c=d=(c+d)/2),e(t,r,c,f,d))}return c.round=function(e){return arguments.length?(t=!!e,c):t},c.size=function(e){return arguments.length?(n=+e[0],r=+e[1],c):[n,r]},c.tile=function(t){return arguments.length?(e=EP(t),c):e},c.padding=function(e){return arguments.length?c.paddingInner(e).paddingOuter(e):c.paddingInner()},c.paddingInner=function(e){return arguments.length?(o="function"==typeof e?e:jP(+e),c):o},c.paddingOuter=function(e){return arguments.length?c.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):c.paddingTop()},c.paddingTop=function(e){return arguments.length?(a="function"==typeof e?e:jP(+e),c):a},c.paddingRight=function(e){return arguments.length?(s="function"==typeof e?e:jP(+e),c):s},c.paddingBottom=function(e){return arguments.length?(l="function"==typeof e?e:jP(+e),c):l},c.paddingLeft=function(e){return arguments.length?(u="function"==typeof e?e:jP(+e),c):u},c}();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{ls(SF,t)?e.tile(SF[t]):aa("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:AF});var CF=Object.freeze({__proto__:null,nest:mF,pack:wF,partition:_F,stratify:OF,tree:jF,treelinks:NF,treemap:$F});const MF=4278190080;function PF(e,t,n){return new Uint32Array(e.getImageData(0,0,t,n).data.buffer)}function FF(e,t,n){if(!t.length)return;const r=t[0].mark.marktype;"group"===r?t.forEach((t=>{t.items.forEach((t=>FF(e,t.items,n)))})):CO[r].draw(e,{items:n?t.map(TF):t})}function TF(e){const t=bh(e,{});return t.stroke&&0!==t.strokeOpacity||t.fill&&0!==t.fillOpacity?{...t,strokeOpacity:1,stroke:"#000",fillOpacity:0}:t}const zF=5,RF=31,LF=32,BF=new Uint32Array(LF+1),IF=new Uint32Array(LF+1);IF[0]=0,BF[0]=~IF[0];for(let Hee=1;Hee<=LF;++Hee)IF[Hee]=IF[Hee-1]<<1|1,BF[Hee]=~IF[Hee];function UF(e,t,n){const r=Math.max(1,Math.sqrt(e*t/1e6)),i=~~((e+2*n+r)/r),o=~~((t+2*n+r)/r),a=e=>~~((e+n)/r);return a.invert=e=>e*r-n,a.bitmap=()=>function(e,t){const n=new Uint32Array(~~((e*t+LF)/LF));function r(e,t){n[e]|=t}function i(e,t){n[e]&=t}return{array:n,get:(t,r)=>{const i=r*e+t;return n[i>>>zF]&1<<(i&RF)},set:(t,n)=>{const i=n*e+t;r(i>>>zF,1<<(i&RF))},clear:(t,n)=>{const r=n*e+t;i(r>>>zF,~(1<<(r&RF)))},getRange:(t,r,i,o)=>{let a,s,l,u,c=o;for(;c>=r;--c)if(a=c*e+t,s=c*e+i,l=a>>>zF,u=s>>>zF,l===u){if(n[l]&BF[a&RF]&IF[1+(s&RF)])return!0}else{if(n[l]&BF[a&RF])return!0;if(n[u]&IF[1+(s&RF)])return!0;for(let e=l+1;e<u;++e)if(n[e])return!0}return!1},setRange:(t,n,i,o)=>{let a,s,l,u,c;for(;n<=o;++n)if(a=n*e+t,s=n*e+i,l=a>>>zF,u=s>>>zF,l===u)r(l,BF[a&RF]&IF[1+(s&RF)]);else for(r(l,BF[a&RF]),r(u,IF[1+(s&RF)]),c=l+1;c<u;++c)r(c,4294967295)},clearRange:(t,n,r,o)=>{let a,s,l,u,c;for(;n<=o;++n)if(a=n*e+t,s=n*e+r,l=a>>>zF,u=s>>>zF,l===u)i(l,IF[a&RF]|BF[1+(s&RF)]);else for(i(l,IF[a&RF]),i(u,BF[1+(s&RF)]),c=l+1;c<u;++c)i(c,0)},outOfBounds:(n,r,i,o)=>n<0||r<0||o>=t||i>=e}}(i,o),a.ratio=r,a.padding=n,a.width=e,a.height=t,a}function qF(e,t,n,r,i,o){let a=n/2;return e-a<0||e+a>i||t-(a=r/2)<0||t+a>o}function WF(e,t,n,r,i,o,a,s){const l=i*o/(2*r),u=e(t-l),c=e(t+l),f=e(n-(o/=2)),d=e(n+o);return a.outOfBounds(u,f,c,d)||a.getRange(u,f,c,d)||s&&s.getRange(u,f,c,d)}const ZF=[-1,-1,1,1],HF=[-1,1,-1,1];const GF=["right","center","left"],VF=["bottom","middle","top"];function YF(e,t,n,r,i,o,a,s,l,u,c,f){return!(i.outOfBounds(e,n,t,r)||(f&&o||i).getRange(e,n,t,r))}const XF={"top-left":0,top:1,"top-right":2,left:4,middle:5,right:6,"bottom-left":8,bottom:9,"bottom-right":10},JF={naive:function(e,t,n,r){const i=e.width,o=e.height;return function(e){const t=e.datum.datum.items[r].items,n=t.length,a=e.datum.fontSize,s=dO.width(e.datum,e.datum.text);let l,u,c,f,d,h,p,m=0;for(let r=0;r<n;++r)l=t[r].x,c=t[r].y,u=void 0===t[r].x2?l:t[r].x2,f=void 0===t[r].y2?c:t[r].y2,d=(l+u)/2,h=(c+f)/2,p=Math.abs(u-l+f-c),p>=m&&(m=p,e.x=d,e.y=h);return d=s/2,h=a/2,l=e.x-d,u=e.x+d,c=e.y-h,f=e.y+h,e.align="center",l<0&&u<=i?e.align="left":0<=l&&i<u&&(e.align="right"),e.baseline="middle",c<0&&f<=o?e.baseline="top":0<=c&&o<f&&(e.baseline="bottom"),!0}},"reduced-search":function(e,t,n,r){const i=e.width,o=e.height,a=t[0],s=t[1];function l(t,n,r,l,u){const c=e.invert(t),f=e.invert(n);let d,h=r,p=o;if(!qF(c,f,l,u,i,o)&&!WF(e,c,f,u,l,h,a,s)&&!WF(e,c,f,u,l,u,a,null)){for(;p-h>=1;)d=(h+p)/2,WF(e,c,f,u,l,d,a,s)?p=d:h=d;if(h>r)return[c,f,h,!0]}}return function(t){const s=t.datum.datum.items[r].items,u=s.length,c=t.datum.fontSize,f=dO.width(t.datum,t.datum.text);let d,h,p,m,g,y,v,b,x,w,k,_,O,E,D,j,N,S=n?c:0,A=!1,$=!1,C=0;for(let r=0;r<u;++r){for(d=s[r].x,p=s[r].y,h=void 0===s[r].x2?d:s[r].x2,m=void 0===s[r].y2?p:s[r].y2,d>h&&(N=d,d=h,h=N),p>m&&(N=p,p=m,m=N),x=e(d),k=e(h),w=~~((x+k)/2),_=e(p),E=e(m),O=~~((_+E)/2),v=w;v>=x;--v)for(b=O;b>=_;--b)j=l(v,b,S,f,c),j&&([t.x,t.y,S,A]=j);for(v=w;v<=k;++v)for(b=O;b<=E;++b)j=l(v,b,S,f,c),j&&([t.x,t.y,S,A]=j);A||n||(D=Math.abs(h-d+m-p),g=(d+h)/2,y=(p+m)/2,D>=C&&!qF(g,y,f,c,i,o)&&!WF(e,g,y,c,f,c,a,null)&&(C=D,t.x=g,t.y=y,$=!0))}return!(!A&&!$)&&(g=f/2,y=c/2,a.setRange(e(t.x-g),e(t.y-y),e(t.x+g),e(t.y+y)),t.align="center",t.baseline="middle",!0)}},floodfill:function(e,t,n,r){const i=e.width,o=e.height,a=t[0],s=t[1],l=e.bitmap();return function(t){const u=t.datum.datum.items[r].items,c=u.length,f=t.datum.fontSize,d=dO.width(t.datum,t.datum.text),h=[];let p,m,g,y,v,b,x,w,k,_,O,E,D=n?f:0,j=!1,N=!1,S=0;for(let r=0;r<c;++r){for(p=u[r].x,g=u[r].y,m=void 0===u[r].x2?p:u[r].x2,y=void 0===u[r].y2?g:u[r].y2,h.push([e((p+m)/2),e((g+y)/2)]);h.length;)if([x,w]=h.pop(),!(a.get(x,w)||s.get(x,w)||l.get(x,w))){l.set(x,w);for(let e=0;e<4;++e)v=x+ZF[e],b=w+HF[e],l.outOfBounds(v,b,v,b)||h.push([v,b]);if(v=e.invert(x),b=e.invert(w),k=D,_=o,!qF(v,b,d,f,i,o)&&!WF(e,v,b,f,d,k,a,s)&&!WF(e,v,b,f,d,f,a,null)){for(;_-k>=1;)O=(k+_)/2,WF(e,v,b,f,d,O,a,s)?_=O:k=O;k>D&&(t.x=v,t.y=b,D=k,j=!0)}}j||n||(E=Math.abs(m-p+y-g),v=(p+m)/2,b=(g+y)/2,E>=S&&!qF(v,b,d,f,i,o)&&!WF(e,v,b,f,d,f,a,null)&&(S=E,t.x=v,t.y=b,N=!0))}return!(!j&&!N)&&(v=d/2,b=f/2,a.setRange(e(t.x-v),e(t.y-b),e(t.x+v),e(t.y+b)),t.align="center",t.baseline="middle",!0)}}};function QF(e,t,n,r,i,o,a,s,l,u,c){if(!e.length)return e;const f=Math.max(r.length,i.length),d=function(e,t){const n=new Float64Array(t),r=e.length;for(let i=0;i<r;++i)n[i]=e[i]||0;for(let i=r;i<t;++i)n[i]=n[r-1];return n}(r,f),h=function(e,t){const n=new Int8Array(t),r=e.length;for(let i=0;i<r;++i)n[i]|=XF[e[i]];for(let i=r;i<t;++i)n[i]=n[r-1];return n}(i,f),p=(x=e[0].datum)&&x.mark&&x.mark.marktype,m="group"===p&&e[0].datum.items[l].marktype,g="area"===m,y=function(e,t,n,r){const i=e=>[e.x,e.x,e.x,e.y,e.y,e.y];return e?"line"===e||"area"===e?e=>i(e.datum):"line"===t?e=>{const t=e.datum.items[r].items;return i(t.length?t["start"===n?0:t.length-1]:{x:NaN,y:NaN})}:e=>{const t=e.datum.bounds;return[t.x1,(t.x1+t.x2)/2,t.x2,t.y1,(t.y1+t.y2)/2,t.y2]}:i}(p,m,s,l),v=null===u||u===1/0,b=g&&"naive"===c;var x;let w=-1,k=-1;const _=e.map((e=>{const t=v?dO.width(e,e.text):void 0;return w=Math.max(w,t),k=Math.max(k,e.fontSize),{datum:e,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(e),textWidth:t}}));u=null===u||u===1/0?Math.max(w,k)+Math.max(...r):u;const O=UF(t[0],t[1],u);let E;if(!b){n&&_.sort(((e,t)=>n(e.datum,t.datum)));let t=!1;for(let e=0;e<h.length&&!t;++e)t=5===h[e]||d[e]<0;const r=(p&&a||g)&&e.map((e=>e.datum));E=o.length||r?function(e,t,n,r,i){const o=e.width,a=e.height,s=r||i,l=Ay(o,a).getContext("2d"),u=Ay(o,a).getContext("2d"),c=s&&Ay(o,a).getContext("2d");n.forEach((e=>FF(l,e,!1))),FF(u,t,!1),s&&FF(c,t,!0);const f=PF(l,o,a),d=PF(u,o,a),h=s&&PF(c,o,a),p=e.bitmap(),m=s&&e.bitmap();let g,y,v,b,x,w,k,_;for(y=0;y<a;++y)for(g=0;g<o;++g)x=y*o+g,w=f[x]&MF,_=d[x]&MF,k=s&&h[x]&MF,(w||k||_)&&(v=e(g),b=e(y),i||!w&&!_||p.set(v,b),s&&(w||k)&&m.set(v,b));return[p,m]}(O,r||[],o,t,g):function(e,t){const n=e.bitmap();return(t||[]).forEach((t=>n.set(e(t.boundary[0]),e(t.boundary[3])))),[n,void 0]}(O,a&&_)}const D=g?JF[c](O,E,a,l):function(e,t,n,r){const i=e.width,o=e.height,a=t[0],s=t[1],l=r.length;return function(t){const u=t.boundary,c=t.datum.fontSize;if(u[2]<0||u[5]<0||u[0]>i||u[3]>o)return!1;let f,d,h,p,m,g,y,v,b,x,w,k,_,O,E,D=t.textWidth??0;for(let i=0;i<l;++i){if(f=(3&n[i])-1,d=(n[i]>>>2&3)-1,h=0===f&&0===d||r[i]<0,p=f&&d?Math.SQRT1_2:1,m=r[i]<0?-1:1,g=u[1+f]+r[i]*f*p,w=u[4+d]+m*c*d/2+r[i]*d*p,v=w-c/2,b=w+c/2,k=e(g),O=e(v),E=e(b),!D){if(!YF(k,k,O,E,a,s,0,0,0,0,0,h))continue;D=dO.width(t.datum,t.datum.text)}if(x=g+m*D*f/2,g=x-D/2,y=x+D/2,k=e(g),_=e(y),YF(k,_,O,E,a,s,0,0,0,0,0,h))return t.x=f?f*m<0?y:g:x,t.y=d?d*m<0?b:v:w,t.align=GF[f*m+1],t.baseline=VF[d*m+1],a.setRange(k,O,_,E),!0}return!1}}(O,E,h,d);return _.forEach((e=>e.opacity=+D(e))),_}const KF=["x","y","opacity","align","baseline"],eT=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function tT(e){Vh.call(this,null,e)}tT.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:eT},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:KF.length,default:KF}]},ds(tT,Vh,{transform(e,t){const n=e.modified();if(!(n||t.changed(t.ADD_REM)||function(n){const r=e[n];return Ya(r)&&t.modified(r.fields)}("sort")))return;e.size&&2===e.size.length||aa("Size parameter should be specified as a [width, height] array.");const r=e.as||KF;return QF(t.materialize(t.SOURCE).source||[],e.size,e.sort,Ga(null==e.offset?1:e.offset),Ga(e.anchor||eT),e.avoidMarks||[],!1!==e.avoidBaseMark,e.lineAnchor||"end",e.markIndex||0,void 0===e.padding?0:e.padding,e.method||"naive").forEach((e=>{const t=e.datum;t[r[0]]=e.x,t[r[1]]=e.y,t[r[2]]=e.opacity,t[r[3]]=e.align,t[r[4]]=e.baseline})),t.reflow(n).modifies(r)}});var nT=Object.freeze({__proto__:null,label:tT});function rT(e,t){var n,r,i,o,a,s,l=[],u=function(e){return e(o)};if(null==t)l.push(e);else for(n={},r=0,i=e.length;r<i;++r)o=e[r],(s=n[a=t.map(u)])||(n[a]=s=[],s.dims=a,l.push(s)),s.push(o);return l}function iT(e){Vh.call(this,null,e)}iT.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},ds(iT,Vh,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=rT(t.materialize(t.SOURCE).source,e.groupby),i=(e.groupby||[]).map(ta),o=i.length,a=e.as||[ta(e.x),ta(e.y)],s=[];r.forEach((t=>{Rp(t,e.x,e.y,e.bandwidth||.3).forEach((e=>{const n={};for(let r=0;r<o;++r)n[i[r]]=t.dims[r];n[a[0]]=e[0],n[a[1]]=e[1],s.push(yh(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=s}return n}});const oT={constant:Dp,linear:$p,log:Cp,exp:Mp,pow:Pp,quad:Fp,poly:Tp};function aT(e){Vh.call(this,null,e)}aT.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(oT)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},ds(aT,Vh,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=rT(t.materialize(t.SOURCE).source,e.groupby),i=(e.groupby||[]).map(ta),o=e.method||"linear",a=null==e.order?3:e.order,s=((e,t)=>"poly"===e?t:"quad"===e?2:1)(o,a),l=e.as||[ta(e.x),ta(e.y)],u=oT[o],c=[];let f=e.extent;ls(oT,o)||aa("Invalid regression method: "+o),null!=f&&"log"===o&&f[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),f=null),r.forEach((n=>{if(n.length<=s)return void t.dataflow.warn("Skipping regression with more parameters than data points.");const r=u(n,e.x,e.y,a);if(e.params)return void c.push(yh({keys:n.dims,coef:r.coef,rSquared:r.rSquared}));const d=f||os(n,e.x),h=e=>{const t={};for(let r=0;r<i.length;++r)t[i[r]]=n.dims[r];t[l[0]]=e[0],t[l[1]]=e[1],c.push(yh(t))};"linear"===o||"constant"===o?d.forEach((e=>h([e,r.predict(e)]))):Up(r.predict,d,25,200).forEach(h)})),this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n}});var sT=Object.freeze({__proto__:null,loess:iT,regression:aT});const lT=134217729,uT=33306690738754706e-32;function cT(e,t,n,r,i){let o,a,s,l,u=t[0],c=r[0],f=0,d=0;c>u==c>-u?(o=u,u=t[++f]):(o=c,c=r[++d]);let h=0;if(f<e&&d<n)for(c>u==c>-u?(a=u+o,s=o-(a-u),u=t[++f]):(a=c+o,s=o-(a-c),c=r[++d]),o=a,0!==s&&(i[h++]=s);f<e&&d<n;)c>u==c>-u?(a=o+u,l=a-o,s=o-(a-l)+(u-l),u=t[++f]):(a=o+c,l=a-o,s=o-(a-l)+(c-l),c=r[++d]),o=a,0!==s&&(i[h++]=s);for(;f<e;)a=o+u,l=a-o,s=o-(a-l)+(u-l),u=t[++f],o=a,0!==s&&(i[h++]=s);for(;d<n;)a=o+c,l=a-o,s=o-(a-l)+(c-l),c=r[++d],o=a,0!==s&&(i[h++]=s);return 0===o&&0!==h||(i[h++]=o),h}function fT(e){return new Float64Array(e)}const dT=22204460492503146e-32,hT=11093356479670487e-47,pT=fT(4),mT=fT(8),gT=fT(12),yT=fT(16),vT=fT(4);function bT(e,t,n,r,i,o){const a=(t-o)*(n-i),s=(e-i)*(r-o),l=a-s,u=Math.abs(a+s);return Math.abs(l)>=33306690738754716e-32*u?l:-function(e,t,n,r,i,o,a){let s,l,u,c,f,d,h,p,m,g,y,v,b,x,w,k,_,O;const E=e-i,D=n-i,j=t-o,N=r-o;x=E*N,d=lT*E,h=d-(d-E),p=E-h,d=lT*N,m=d-(d-N),g=N-m,w=p*g-(x-h*m-p*m-h*g),k=j*D,d=lT*j,h=d-(d-j),p=j-h,d=lT*D,m=d-(d-D),g=D-m,_=p*g-(k-h*m-p*m-h*g),y=w-_,f=w-y,pT[0]=w-(y+f)+(f-_),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-k,f=b-y,pT[1]=b-(y+f)+(f-k),O=v+y,f=O-v,pT[2]=v-(O-f)+(y-f),pT[3]=O;let S=function(e,t){let n=t[0];for(let r=1;r<e;r++)n+=t[r];return n}(4,pT),A=dT*a;if(S>=A||-S>=A)return S;if(f=e-E,s=e-(E+f)+(f-i),f=n-D,u=n-(D+f)+(f-i),f=t-j,l=t-(j+f)+(f-o),f=r-N,c=r-(N+f)+(f-o),0===s&&0===l&&0===u&&0===c)return S;if(A=hT*a+uT*Math.abs(S),S+=E*c+N*s-(j*u+D*l),S>=A||-S>=A)return S;x=s*N,d=lT*s,h=d-(d-s),p=s-h,d=lT*N,m=d-(d-N),g=N-m,w=p*g-(x-h*m-p*m-h*g),k=l*D,d=lT*l,h=d-(d-l),p=l-h,d=lT*D,m=d-(d-D),g=D-m,_=p*g-(k-h*m-p*m-h*g),y=w-_,f=w-y,vT[0]=w-(y+f)+(f-_),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-k,f=b-y,vT[1]=b-(y+f)+(f-k),O=v+y,f=O-v,vT[2]=v-(O-f)+(y-f),vT[3]=O;const $=cT(4,pT,4,vT,mT);x=E*c,d=lT*E,h=d-(d-E),p=E-h,d=lT*c,m=d-(d-c),g=c-m,w=p*g-(x-h*m-p*m-h*g),k=j*u,d=lT*j,h=d-(d-j),p=j-h,d=lT*u,m=d-(d-u),g=u-m,_=p*g-(k-h*m-p*m-h*g),y=w-_,f=w-y,vT[0]=w-(y+f)+(f-_),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-k,f=b-y,vT[1]=b-(y+f)+(f-k),O=v+y,f=O-v,vT[2]=v-(O-f)+(y-f),vT[3]=O;const C=cT($,mT,4,vT,gT);x=s*c,d=lT*s,h=d-(d-s),p=s-h,d=lT*c,m=d-(d-c),g=c-m,w=p*g-(x-h*m-p*m-h*g),k=l*u,d=lT*l,h=d-(d-l),p=l-h,d=lT*u,m=d-(d-u),g=u-m,_=p*g-(k-h*m-p*m-h*g),y=w-_,f=w-y,vT[0]=w-(y+f)+(f-_),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-k,f=b-y,vT[1]=b-(y+f)+(f-k),O=v+y,f=O-v,vT[2]=v-(O-f)+(y-f),vT[3]=O;const M=cT(C,gT,4,vT,yT);return yT[M-1]}(e,t,n,r,i,o,u)}const xT=Math.pow(2,-52),wT=new Uint32Array(512);class kT{static from(e,t,n){void 0===t&&(t=NT),void 0===n&&(n=ST);const r=e.length,i=new Float64Array(2*r);for(let o=0;o<r;o++){const r=e[o];i[2*o]=t(r),i[2*o+1]=n(r)}return new kT(i)}constructor(e){const t=e.length>>1;if(t>0&&"number"!=typeof e[0])throw new Error("Expected coords to contain numbers.");this.coords=e;const n=Math.max(2*t-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(t)),this._hullPrev=new Uint32Array(t),this._hullNext=new Uint32Array(t),this._hullTri=new Uint32Array(t),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(t),this._dists=new Float64Array(t),this.update()}update(){const{coords:e,_hullPrev:t,_hullNext:n,_hullTri:r,_hullHash:i}=this,o=e.length>>1;let a=1/0,s=1/0,l=-1/0,u=-1/0;for(let E=0;E<o;E++){const t=e[2*E],n=e[2*E+1];t<a&&(a=t),n<s&&(s=n),t>l&&(l=t),n>u&&(u=n),this._ids[E]=E}const c=(a+l)/2,f=(s+u)/2;let d,h,p,m=1/0;for(let E=0;E<o;E++){const t=_T(c,f,e[2*E],e[2*E+1]);t<m&&(d=E,m=t)}const g=e[2*d],y=e[2*d+1];m=1/0;for(let E=0;E<o;E++){if(E===d)continue;const t=_T(g,y,e[2*E],e[2*E+1]);t<m&&t>0&&(h=E,m=t)}let v=e[2*h],b=e[2*h+1],x=1/0;for(let E=0;E<o;E++){if(E===d||E===h)continue;const t=ET(g,y,v,b,e[2*E],e[2*E+1]);t<x&&(p=E,x=t)}let w=e[2*p],k=e[2*p+1];if(x===1/0){for(let r=0;r<o;r++)this._dists[r]=e[2*r]-e[0]||e[2*r+1]-e[1];DT(this._ids,this._dists,0,o-1);const t=new Uint32Array(o);let n=0;for(let e=0,r=-1/0;e<o;e++){const i=this._ids[e];this._dists[i]>r&&(t[n++]=i,r=this._dists[i])}return this.hull=t.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(bT(g,y,v,b,w,k)<0){const e=h,t=v,n=b;h=p,v=w,b=k,p=e,w=t,k=n}const _=function(e,t,n,r,i,o){const a=n-e,s=r-t,l=i-e,u=o-t,c=a*a+s*s,f=l*l+u*u,d=.5/(a*u-s*l),h=e+(u*c-s*f)*d,p=t+(a*f-l*c)*d;return{x:h,y:p}}(g,y,v,b,w,k);this._cx=_.x,this._cy=_.y;for(let E=0;E<o;E++)this._dists[E]=_T(e[2*E],e[2*E+1],_.x,_.y);DT(this._ids,this._dists,0,o-1),this._hullStart=d;let O=3;n[d]=t[p]=h,n[h]=t[d]=p,n[p]=t[h]=d,r[d]=0,r[h]=1,r[p]=2,i.fill(-1),i[this._hashKey(g,y)]=d,i[this._hashKey(v,b)]=h,i[this._hashKey(w,k)]=p,this.trianglesLen=0,this._addTriangle(d,h,p,-1,-1,-1);for(let E,D,j=0;j<this._ids.length;j++){const o=this._ids[j],a=e[2*o],s=e[2*o+1];if(j>0&&Math.abs(a-E)<=xT&&Math.abs(s-D)<=xT)continue;if(E=a,D=s,o===d||o===h||o===p)continue;let l=0;for(let e=0,t=this._hashKey(a,s);e<this._hashSize&&(l=i[(t+e)%this._hashSize],-1===l||l===n[l]);e++);l=t[l];let u,c=l;for(;u=n[c],bT(a,s,e[2*c],e[2*c+1],e[2*u],e[2*u+1])>=0;)if(c=u,c===l){c=-1;break}if(-1===c)continue;let f=this._addTriangle(c,o,n[c],-1,-1,r[c]);r[o]=this._legalize(f+2),r[c]=f,O++;let m=n[c];for(;u=n[m],bT(a,s,e[2*m],e[2*m+1],e[2*u],e[2*u+1])<0;)f=this._addTriangle(m,o,u,r[o],-1,r[m]),r[o]=this._legalize(f+2),n[m]=m,O--,m=u;if(c===l)for(;u=t[c],bT(a,s,e[2*u],e[2*u+1],e[2*c],e[2*c+1])<0;)f=this._addTriangle(u,o,c,-1,r[c],r[u]),this._legalize(f+2),r[u]=f,n[c]=c,O--,c=u;this._hullStart=t[o]=c,n[c]=t[m]=o,n[o]=m,i[this._hashKey(a,s)]=o,i[this._hashKey(e[2*c],e[2*c+1])]=c}this.hull=new Uint32Array(O);for(let E=0,D=this._hullStart;E<O;E++)this.hull[E]=D,D=n[D];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,t){return Math.floor(function(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:t,_halfedges:n,coords:r}=this;let i=0,o=0;for(;;){const a=n[e],s=e-e%3;if(o=s+(e+2)%3,-1===a){if(0===i)break;e=wT[--i];continue}const l=a-a%3,u=s+(e+1)%3,c=l+(a+2)%3,f=t[o],d=t[e],h=t[u],p=t[c];if(OT(r[2*f],r[2*f+1],r[2*d],r[2*d+1],r[2*h],r[2*h+1],r[2*p],r[2*p+1])){t[e]=p,t[a]=f;const r=n[c];if(-1===r){let t=this._hullStart;do{if(this._hullTri[t]===c){this._hullTri[t]=e;break}t=this._hullPrev[t]}while(t!==this._hullStart)}this._link(e,r),this._link(a,n[o]),this._link(o,c);const s=l+(a+1)%3;i<wT.length&&(wT[i++]=s)}else{if(0===i)break;e=wT[--i]}}return o}_link(e,t){this._halfedges[e]=t,-1!==t&&(this._halfedges[t]=e)}_addTriangle(e,t,n,r,i,o){const a=this.trianglesLen;return this._triangles[a]=e,this._triangles[a+1]=t,this._triangles[a+2]=n,this._link(a,r),this._link(a+1,i),this._link(a+2,o),this.trianglesLen+=3,a}}function _T(e,t,n,r){const i=e-n,o=t-r;return i*i+o*o}function OT(e,t,n,r,i,o,a,s){const l=e-a,u=t-s,c=n-a,f=r-s,d=i-a,h=o-s,p=c*c+f*f,m=d*d+h*h;return l*(f*m-p*h)-u*(c*m-p*d)+(l*l+u*u)*(c*h-f*d)<0}function ET(e,t,n,r,i,o){const a=n-e,s=r-t,l=i-e,u=o-t,c=a*a+s*s,f=l*l+u*u,d=.5/(a*u-s*l),h=(u*c-s*f)*d,p=(a*f-l*c)*d;return h*h+p*p}function DT(e,t,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const r=e[i],o=t[r];let a=i-1;for(;a>=n&&t[e[a]]>o;)e[a+1]=e[a--];e[a+1]=r}else{let i=n+1,o=r;jT(e,n+r>>1,i),t[e[n]]>t[e[r]]&&jT(e,n,r),t[e[i]]>t[e[r]]&&jT(e,i,r),t[e[n]]>t[e[i]]&&jT(e,n,i);const a=e[i],s=t[a];for(;;){do{i++}while(t[e[i]]<s);do{o--}while(t[e[o]]>s);if(o<i)break;jT(e,i,o)}e[n+1]=e[o],e[o]=a,r-i+1>=o-n?(DT(e,t,i,r),DT(e,t,n,o-1)):(DT(e,t,n,o-1),DT(e,t,i,r))}}function jT(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function NT(e){return e[0]}function ST(e){return e[1]}const AT=1e-6;class $T{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,t){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,t){this._+=`L${this._x1=+e},${this._y1=+t}`}arc(e,t,n){const r=(e=+e)+(n=+n),i=t=+t;if(n<0)throw new Error("negative radius");null===this._x1?this._+=`M${r},${i}`:(Math.abs(this._x1-r)>AT||Math.abs(this._y1-i)>AT)&&(this._+="L"+r+","+i),n&&(this._+=`A${n},${n},0,1,1,${e-n},${t}A${n},${n},0,1,1,${this._x1=r},${this._y1=i}`)}rect(e,t,n,r){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${+n}v${+r}h${-n}Z`}value(){return this._||null}}class CT{constructor(){this._=[]}moveTo(e,t){this._.push([e,t])}closePath(){this._.push(this._[0].slice())}lineTo(e,t){this._.push([e,t])}value(){return this._.length?this._:null}}const MT=2*Math.PI,PT=Math.pow;function FT(e){return e[0]}function TT(e){return e[1]}function zT(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class RT{static from(e,t,n,r){return void 0===t&&(t=FT),void 0===n&&(n=TT),new RT("length"in e?function(e,t,n,r){const i=e.length,o=new Float64Array(2*i);for(let a=0;a<i;++a){const i=e[a];o[2*a]=t.call(r,i,a,e),o[2*a+1]=n.call(r,i,a,e)}return o}(e,t,n,r):Float64Array.from(function*(e,t,n,r){let i=0;for(const o of e)yield t.call(r,o,i,e),yield n.call(r,o,i,e),++i}(e,t,n,r)))}constructor(e){this._delaunator=new kT(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&function(e){const{triangles:t,coords:n}=e;for(let r=0;r<t.length;r+=3){const e=2*t[r],i=2*t[r+1],o=2*t[r+2];if((n[o]-n[e])*(n[i+1]-n[e+1])-(n[i]-n[e])*(n[o+1]-n[e+1])>1e-10)return!1}return!0}(e)){this.collinear=Int32Array.from({length:t.length/2},((e,t)=>t)).sort(((e,n)=>t[2*e]-t[2*n]||t[2*e+1]-t[2*n+1]));const e=this.collinear[0],n=this.collinear[this.collinear.length-1],r=[t[2*e],t[2*e+1],t[2*n],t[2*n+1]],i=1e-8*Math.hypot(r[3]-r[1],r[2]-r[0]);for(let o=0,a=t.length/2;o<a;++o){const e=zT(t[2*o],t[2*o+1],i);t[2*o]=e[0],t[2*o+1]=e[1]}this._delaunator=new kT(t)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,i=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let s=0,l=n.length;s<l;++s){const e=i[s%3==2?s-2:s+1];-1!==n[s]&&-1!==o[e]||(o[e]=s)}for(let s=0,l=r.length;s<l;++s)a[r[s]]=s;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],o[r[0]]=1,2===r.length&&(o[r[1]]=0,this.triangles[1]=r[1],this.triangles[2]=r[1]))}voronoi(e){return new class{constructor(e,t){let[n,r,i,o]=void 0===t?[0,0,960,500]:t;if(!((i=+i)>=(n=+n)&&(o=+o)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(2*e.points.length),this.vectors=new Float64Array(2*e.points.length),this.xmax=i,this.xmin=n,this.ymax=o,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:t,triangles:n},vectors:r}=this;let i,o;const a=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let p,m,g=0,y=0,v=n.length;g<v;g+=3,y+=2){const r=2*n[g],s=2*n[g+1],l=2*n[g+2],u=e[r],c=e[r+1],f=e[s],d=e[s+1],h=e[l],v=e[l+1],b=f-u,x=d-c,w=h-u,k=v-c,_=2*(b*k-x*w);if(Math.abs(_)<1e-9){if(void 0===i){i=o=0;for(const n of t)i+=e[2*n],o+=e[2*n+1];i/=t.length,o/=t.length}const n=1e9*Math.sign((i-u)*k-(o-c)*w);p=(u+h)/2-n*k,m=(c+v)/2+n*w}else{const e=1/_,t=b*b+x*x,n=w*w+k*k;p=u+(k*t-x*n)*e,m=c+(b*n-w*t)*e}a[y]=p,a[y+1]=m}let s,l,u,c=t[t.length-1],f=4*c,d=e[2*c],h=e[2*c+1];r.fill(0);for(let p=0;p<t.length;++p)c=t[p],s=f,l=d,u=h,f=4*c,d=e[2*c],h=e[2*c+1],r[s+2]=r[f]=u-h,r[s+3]=r[f+1]=d-l}render(e){const t=null==e?e=new $T:void 0,{delaunay:{halfedges:n,inedges:r,hull:i},circumcenters:o,vectors:a}=this;if(i.length<=1)return null;for(let u=0,c=n.length;u<c;++u){const t=n[u];if(t<u)continue;const r=2*Math.floor(u/3),i=2*Math.floor(t/3),a=o[r],s=o[r+1],l=o[i],c=o[i+1];this._renderSegment(a,s,l,c,e)}let s,l=i[i.length-1];for(let u=0;u<i.length;++u){s=l,l=i[u];const t=2*Math.floor(r[l]/3),n=o[t],c=o[t+1],f=4*s,d=this._project(n,c,a[f+2],a[f+3]);d&&this._renderSegment(n,c,d[0],d[1],e)}return t&&t.value()}renderBounds(e){const t=null==e?e=new $T:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}renderCell(e,t){const n=null==t?t=new $T:void 0,r=this._clip(e);if(null===r||!r.length)return;t.moveTo(r[0],r[1]);let i=r.length;for(;r[0]===r[i-2]&&r[1]===r[i-1]&&i>1;)i-=2;for(let o=2;o<i;o+=2)r[o]===r[o-2]&&r[o+1]===r[o-1]||t.lineTo(r[o],r[o+1]);return t.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let t=0,n=e.length/2;t<n;++t){const e=this.cellPolygon(t);e&&(e.index=t,yield e)}}cellPolygon(e){const t=new CT;return this.renderCell(e,t),t.value()}_renderSegment(e,t,n,r,i){let o;const a=this._regioncode(e,t),s=this._regioncode(n,r);0===a&&0===s?(i.moveTo(e,t),i.lineTo(n,r)):(o=this._clipSegment(e,t,n,r,a,s))&&(i.moveTo(o[0],o[1]),i.lineTo(o[2],o[3]))}contains(e,t,n){return(t=+t)==t&&(n=+n)==n&&this.delaunay._step(e,t,n)===e}*neighbors(e){const t=this._clip(e);if(t)for(const n of this.delaunay.neighbors(e)){const e=this._clip(n);if(e)e:for(let r=0,i=t.length;r<i;r+=2)for(let o=0,a=e.length;o<a;o+=2)if(t[r]===e[o]&&t[r+1]===e[o+1]&&t[(r+2)%i]===e[(o+a-2)%a]&&t[(r+3)%i]===e[(o+a-1)%a]){yield n;break e}}}_cell(e){const{circumcenters:t,delaunay:{inedges:n,halfedges:r,triangles:i}}=this,o=n[e];if(-1===o)return null;const a=[];let s=o;do{const n=Math.floor(s/3);if(a.push(t[2*n],t[2*n+1]),s=s%3==2?s-2:s+1,i[s]!==e)break;s=r[s]}while(s!==o&&-1!==s);return a}_clip(e){if(0===e&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const t=this._cell(e);if(null===t)return null;const{vectors:n}=this,r=4*e;return this._simplify(n[r]||n[r+1]?this._clipInfinite(e,t,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(e,t))}_clipFinite(e,t){const n=t.length;let r,i,o,a,s=null,l=t[n-2],u=t[n-1],c=this._regioncode(l,u),f=0;for(let d=0;d<n;d+=2)if(r=l,i=u,l=t[d],u=t[d+1],o=c,c=this._regioncode(l,u),0===o&&0===c)a=f,f=0,s?s.push(l,u):s=[l,u];else{let t,n,d,h,p;if(0===o){if(null===(t=this._clipSegment(r,i,l,u,o,c)))continue;[n,d,h,p]=t}else{if(null===(t=this._clipSegment(l,u,r,i,c,o)))continue;[h,p,n,d]=t,a=f,f=this._edgecode(n,d),a&&f&&this._edge(e,a,f,s,s.length),s?s.push(n,d):s=[n,d]}a=f,f=this._edgecode(h,p),a&&f&&this._edge(e,a,f,s,s.length),s?s.push(h,p):s=[h,p]}if(s)a=f,f=this._edgecode(s[0],s[1]),a&&f&&this._edge(e,a,f,s,s.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return s}_clipSegment(e,t,n,r,i,o){const a=i<o;for(a&&([e,t,n,r,i,o]=[n,r,e,t,o,i]);;){if(0===i&&0===o)return a?[n,r,e,t]:[e,t,n,r];if(i&o)return null;let s,l,u=i||o;8&u?(s=e+(n-e)*(this.ymax-t)/(r-t),l=this.ymax):4&u?(s=e+(n-e)*(this.ymin-t)/(r-t),l=this.ymin):2&u?(l=t+(r-t)*(this.xmax-e)/(n-e),s=this.xmax):(l=t+(r-t)*(this.xmin-e)/(n-e),s=this.xmin),i?(e=s,t=l,i=this._regioncode(e,t)):(n=s,r=l,o=this._regioncode(n,r))}}_clipInfinite(e,t,n,r,i,o){let a,s=Array.from(t);if((a=this._project(s[0],s[1],n,r))&&s.unshift(a[0],a[1]),(a=this._project(s[s.length-2],s[s.length-1],i,o))&&s.push(a[0],a[1]),s=this._clipFinite(e,s))for(let l,u=0,c=s.length,f=this._edgecode(s[c-2],s[c-1]);u<c;u+=2)l=f,f=this._edgecode(s[u],s[u+1]),l&&f&&(u=this._edge(e,l,f,s,u),c=s.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(e,t,n,r,i){for(;t!==n;){let n,o;switch(t){case 5:t=4;continue;case 4:t=6,n=this.xmax,o=this.ymin;break;case 6:t=2;continue;case 2:t=10,n=this.xmax,o=this.ymax;break;case 10:t=8;continue;case 8:t=9,n=this.xmin,o=this.ymax;break;case 9:t=1;continue;case 1:t=5,n=this.xmin,o=this.ymin}r[i]===n&&r[i+1]===o||!this.contains(e,n,o)||(r.splice(i,0,n,o),i+=2)}return i}_project(e,t,n,r){let i,o,a,s=1/0;if(r<0){if(t<=this.ymin)return null;(i=(this.ymin-t)/r)<s&&(a=this.ymin,o=e+(s=i)*n)}else if(r>0){if(t>=this.ymax)return null;(i=(this.ymax-t)/r)<s&&(a=this.ymax,o=e+(s=i)*n)}if(n>0){if(e>=this.xmax)return null;(i=(this.xmax-e)/n)<s&&(o=this.xmax,a=t+(s=i)*r)}else if(n<0){if(e<=this.xmin)return null;(i=(this.xmin-e)/n)<s&&(o=this.xmin,a=t+(s=i)*r)}return[o,a]}_edgecode(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}_regioncode(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}_simplify(e){if(e&&e.length>4){for(let t=0;t<e.length;t+=2){const n=(t+2)%e.length,r=(t+4)%e.length;(e[t]===e[n]&&e[n]===e[r]||e[t+1]===e[n+1]&&e[n+1]===e[r+1])&&(e.splice(n,2),t-=2)}e.length||(e=null)}return e}}(this,e)}*neighbors(e){const{inedges:t,hull:n,_hullIndex:r,halfedges:i,triangles:o,collinear:a}=this;if(a){const t=a.indexOf(e);return t>0&&(yield a[t-1]),void(t<a.length-1&&(yield a[t+1]))}const s=t[e];if(-1===s)return;let l=s,u=-1;do{if(yield u=o[l],l=l%3==2?l-2:l+1,o[l]!==e)return;if(l=i[l],-1===l){const t=n[(r[e]+1)%n.length];return void(t!==u&&(yield t))}}while(l!==s)}find(e,t,n){if(void 0===n&&(n=0),(e=+e)!=e||(t=+t)!=t)return-1;const r=n;let i;for(;(i=this._step(n,e,t))>=0&&i!==n&&i!==r;)n=i;return i}_step(e,t,n){const{inedges:r,hull:i,_hullIndex:o,halfedges:a,triangles:s,points:l}=this;if(-1===r[e]||!l.length)return(e+1)%(l.length>>1);let u=e,c=PT(t-l[2*e],2)+PT(n-l[2*e+1],2);const f=r[e];let d=f;do{let r=s[d];const f=PT(t-l[2*r],2)+PT(n-l[2*r+1],2);if(f<c&&(c=f,u=r),d=d%3==2?d-2:d+1,s[d]!==e)break;if(d=a[d],-1===d){if(d=i[(o[e]+1)%i.length],d!==r&&PT(t-l[2*d],2)+PT(n-l[2*d+1],2)<c)return d;break}}while(d!==f);return u}render(e){const t=null==e?e=new $T:void 0,{points:n,halfedges:r,triangles:i}=this;for(let o=0,a=r.length;o<a;++o){const t=r[o];if(t<o)continue;const a=2*i[o],s=2*i[t];e.moveTo(n[a],n[a+1]),e.lineTo(n[s],n[s+1])}return this.renderHull(e),t&&t.value()}renderPoints(e,t){void 0!==t||e&&"function"==typeof e.moveTo||(t=e,e=null),t=null==t?2:+t;const n=null==e?e=new $T:void 0,{points:r}=this;for(let i=0,o=r.length;i<o;i+=2){const n=r[i],o=r[i+1];e.moveTo(n+t,o),e.arc(n,o,t,0,MT)}return n&&n.value()}renderHull(e){const t=null==e?e=new $T:void 0,{hull:n,points:r}=this,i=2*n[0],o=n.length;e.moveTo(r[i],r[i+1]);for(let a=1;a<o;++a){const t=2*n[a];e.lineTo(r[t],r[t+1])}return e.closePath(),t&&t.value()}hullPolygon(){const e=new CT;return this.renderHull(e),e.value()}renderTriangle(e,t){const n=null==t?t=new $T:void 0,{points:r,triangles:i}=this,o=2*i[e*=3],a=2*i[e+1],s=2*i[e+2];return t.moveTo(r[o],r[o+1]),t.lineTo(r[a],r[a+1]),t.lineTo(r[s],r[s+1]),t.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:e}=this;for(let t=0,n=e.length/3;t<n;++t)yield this.trianglePolygon(t)}trianglePolygon(e){const t=new CT;return this.renderTriangle(e,t),t.value()}}function LT(e){Vh.call(this,null,e)}LT.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const BT=[-1e5,-1e5,1e5,1e5];function IT(e){const t=e[0][0],n=e[0][1];let r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}ds(LT,Vh,{transform(e,t){const n=e.as||"path",r=t.source;if(!r||!r.length)return t;let i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:BT;const o=this.value=RT.from(r,e.x,e.y).voronoi(i);for(let a=0,s=r.length;a<s;++a){const e=o.cellPolygon(a);r[a][n]=e?IT(e):null}return t.reflow(e.modified()).modifies(n)}});var UT=Object.freeze({__proto__:null,voronoi:LT}),qT=Math.PI/180,WT=64,ZT=2048;function HT(){var e,t,n,r,i,o,a,s=[256,256],l=JT,u=[],c=Math.random,f={};function d(e,t,n){for(var r,i,o,a=t.x,u=t.y,f=Math.sqrt(s[0]*s[0]+s[1]*s[1]),d=l(s),h=c()<.5?1:-1,p=-h;(r=d(p+=h))&&(i=~~r[0],o=~~r[1],!(Math.min(Math.abs(i),Math.abs(o))>=f));)if(t.x=a+i,t.y=u+o,!(t.x+t.x0<0||t.y+t.y0<0||t.x+t.x1>s[0]||t.y+t.y1>s[1])&&(!n||!VT(t,e,s[0]))&&(!n||XT(t,n))){for(var m,g=t.sprite,y=t.width>>5,v=s[0]>>5,b=t.x-(y<<4),x=127&b,w=32-x,k=t.y1-t.y0,_=(t.y+t.y0)*v+(b>>5),O=0;O<k;O++){m=0;for(var E=0;E<=y;E++)e[_+E]|=m<<w|(E<y?(m=g[O*y+E])>>>x:0);_+=v}return t.sprite=null,!0}return!1}return f.layout=function(){for(var l=function(e){e.width=e.height=1;var t=Math.sqrt(e.getContext("2d").getImageData(0,0,1,1).data.length>>2);e.width=(WT<<5)/t,e.height=ZT/t;var n=e.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:t}}(Ay()),f=function(e){var t=[],n=-1;for(;++n<e;)t[n]=0;return t}((s[0]>>5)*s[1]),h=null,p=u.length,m=-1,g=[],y=u.map((s=>({text:e(s),font:t(s),style:r(s),weight:i(s),rotate:o(s),size:~~(n(s)+1e-14),padding:a(s),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:s}))).sort(((e,t)=>t.size-e.size));++m<p;){var v=y[m];v.x=s[0]*(c()+.5)>>1,v.y=s[1]*(c()+.5)>>1,GT(l,v,y,m),v.hasText&&d(f,v,h)&&(g.push(v),h?YT(h,v):h=[{x:v.x+v.x0,y:v.y+v.y0},{x:v.x+v.x1,y:v.y+v.y1}],v.x-=s[0]>>1,v.y-=s[1]>>1)}return g},f.words=function(e){return arguments.length?(u=e,f):u},f.size=function(e){return arguments.length?(s=[+e[0],+e[1]],f):s},f.font=function(e){return arguments.length?(t=QT(e),f):t},f.fontStyle=function(e){return arguments.length?(r=QT(e),f):r},f.fontWeight=function(e){return arguments.length?(i=QT(e),f):i},f.rotate=function(e){return arguments.length?(o=QT(e),f):o},f.text=function(t){return arguments.length?(e=QT(t),f):e},f.spiral=function(e){return arguments.length?(l=KT[e]||e,f):l},f.fontSize=function(e){return arguments.length?(n=QT(e),f):n},f.padding=function(e){return arguments.length?(a=QT(e),f):a},f.random=function(e){return arguments.length?(c=e,f):c},f}function GT(e,t,n,r){if(!t.sprite){var i=e.context,o=e.ratio;i.clearRect(0,0,(WT<<5)/o,ZT/o);var a,s,l,u,c,f=0,d=0,h=0,p=n.length;for(--r;++r<p;){if(t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/o)+"px "+t.font,a=i.measureText(t.text+"m").width*o,l=t.size<<1,t.rotate){var m=Math.sin(t.rotate*qT),g=Math.cos(t.rotate*qT),y=a*g,v=a*m,b=l*g,x=l*m;a=Math.max(Math.abs(y+x),Math.abs(y-x))+31>>5<<5,l=~~Math.max(Math.abs(v+b),Math.abs(v-b))}else a=a+31>>5<<5;if(l>h&&(h=l),f+a>=WT<<5&&(f=0,d+=h,h=0),d+l>=ZT)break;i.translate((f+(a>>1))/o,(d+(l>>1))/o),t.rotate&&i.rotate(t.rotate*qT),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=a,t.height=l,t.xoff=f,t.yoff=d,t.x1=a>>1,t.y1=l>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,f+=a}for(var w=i.getImageData(0,0,(WT<<5)/o,ZT/o).data,k=[];--r>=0;)if((t=n[r]).hasText){for(s=(a=t.width)>>5,l=t.y1-t.y0,u=0;u<l*s;u++)k[u]=0;if(null==(f=t.xoff))return;d=t.yoff;var _=0,O=-1;for(c=0;c<l;c++){for(u=0;u<a;u++){var E=s*c+(u>>5),D=w[(d+c)*(WT<<5)+(f+u)<<2]?1<<31-u%32:0;k[E]|=D,_|=D}_?O=c:(t.y0++,l--,c--,d++)}t.y1=t.y0+O,t.sprite=k.slice(0,(t.y1-t.y0)*s)}}}function VT(e,t,n){n>>=5;for(var r,i=e.sprite,o=e.width>>5,a=e.x-(o<<4),s=127&a,l=32-s,u=e.y1-e.y0,c=(e.y+e.y0)*n+(a>>5),f=0;f<u;f++){r=0;for(var d=0;d<=o;d++)if((r<<l|(d<o?(r=i[f*o+d])>>>s:0))&t[c+d])return!0;c+=n}return!1}function YT(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function XT(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function JT(e){var t=e[0]/e[1];return function(e){return[t*(e*=.1)*Math.cos(e),e*Math.sin(e)]}}function QT(e){return"function"==typeof e?e:function(){return e}}var KT={archimedean:JT,rectangular:function(e){var t=4*e[0]/e[1],n=0,r=0;return function(e){var i=e<0?-1:1;switch(Math.sqrt(1+4*i*e)-i&3){case 0:n+=t;break;case 1:r+=4;break;case 2:n-=t;break;default:r-=4}return[n,r]}}};const ez=["x","y","font","fontSize","fontStyle","fontWeight","angle"],tz=["text","font","rotate","fontSize","fontStyle","fontWeight"];function nz(e){Vh.call(this,HT(),e)}nz.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:ez}]},ds(nz,Vh,{transform(e,t){!e.size||e.size[0]&&e.size[1]||aa("Wordcloud size dimensions must be non-zero.");const n=e.modified();if(!(n||t.changed(t.ADD_REM)||tz.some((function(n){const r=e[n];return Ya(r)&&t.modified(r.fields)}))))return;const r=t.materialize(t.SOURCE).source,i=this.value,o=e.as||ez;let a,s=e.fontSize||14;if(Ya(s)?a=e.fontSizeRange:s=ns(s),a){const e=s,t=Gx("sqrt")().domain(os(r,e)).range(a);s=n=>t(e(n))}r.forEach((e=>{e[o[0]]=NaN,e[o[1]]=NaN,e[o[3]]=0}));const l=i.words(r).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(s).random(rp).layout(),u=i.size(),c=u[0]>>1,f=u[1]>>1,d=l.length;for(let h,p,m=0;m<d;++m)h=l[m],p=h.datum,p[o[0]]=h.x+c,p[o[1]]=h.y+f,p[o[2]]=h.font,p[o[3]]=h.size,p[o[4]]=h.style,p[o[5]]=h.weight,p[o[6]]=h.rotate;return t.reflow(n).modifies(o)}});var rz=Object.freeze({__proto__:null,wordcloud:nz});const iz=e=>new Uint8Array(e),oz=e=>new Uint16Array(e),az=e=>new Uint32Array(e);function sz(e,t,n){const r=(t<257?iz:t<65537?oz:az)(e);return n&&r.set(n),r}function lz(e,t,n){const r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(e,t){const n=this,i=n.bisect(n.range,e.value),o=e.index,a=i[0],s=i[1],l=o.length;let u;for(u=0;u<a;++u)t[o[u]]|=r;for(u=s;u<l;++u)t[o[u]]|=r;return n}}}function uz(){let e=az(0),t=[],n=0;return{insert:function(r,i,o){if(!i.length)return[];const a=n,s=i.length,l=az(s);let u,c,f,d=Array(s);for(f=0;f<s;++f)d[f]=r(i[f]),l[f]=f;if(d=function(e,t){return e.sort.call(t,((t,n)=>{const r=e[t],i=e[n];return r<i?-1:r>i?1:0})),function(e,t){return Array.from(t,(t=>e[t]))}(e,t)}(d,l),a)u=t,c=e,t=Array(a+s),e=az(a+s),function(e,t,n,r,i,o,a,s,l){let u,c=0,f=0;for(u=0;c<r&&f<a;++u)t[c]<i[f]?(s[u]=t[c],l[u]=n[c++]):(s[u]=i[f],l[u]=o[f++]+e);for(;c<r;++c,++u)s[u]=t[c],l[u]=n[c];for(;f<a;++f,++u)s[u]=i[f],l[u]=o[f]+e}(o,u,c,a,d,l,s,t,e);else{if(o>0)for(f=0;f<s;++f)l[f]+=o;t=d,e=l}return n=a+s,{index:l,value:d}},remove:function(r,i){const o=n;let a,s,l;for(s=0;!i[e[s]]&&s<o;++s);for(l=s;s<o;++s)i[a=e[s]]||(e[l]=a,t[l]=t[s],++l);n=o-r},bisect:function(e,r){let i;return r?i=r.length:(r=t,i=n),[ol(r,e[0],0,i),il(r,e[1],0,i)]},reindex:function(t){for(let r=0,i=n;r<i;++r)e[r]=t[e[r]]},index:()=>e,size:()=>n}}function cz(e){Vh.call(this,function(){let e=8,t=[],n=az(0),r=sz(0,e),i=sz(0,e);return{data:()=>t,seen:()=>n=function(e,t,n){return e.length>=t?e:((n=n||new e.constructor(t)).set(e),n)}(n,t.length),add(e){for(let n,r=0,i=t.length,o=e.length;r<o;++r)n=e[r],n._index=i++,t.push(n)},remove(e,n){const o=t.length,a=Array(o-e),s=t;let l,u,c;for(u=0;!n[u]&&u<o;++u)a[u]=t[u],s[u]=u;for(c=u;u<o;++u)l=t[u],n[u]?s[u]=-1:(s[u]=c,r[c]=r[u],i[c]=i[u],a[c]=l,l._index=c++),r[u]=0;return t=a,s},size:()=>t.length,curr:()=>r,prev:()=>i,reset:e=>i[e]=r[e],all:()=>e<257?255:e<65537?65535:4294967295,set(e,t){r[e]|=t},clear(e,t){r[e]&=~t},resize(t,n){(t>r.length||n>e)&&(e=Math.max(n,e),r=sz(t,e,r),i=sz(t,e))}}}(),e),this._indices=null,this._dims=null}function fz(e){Vh.call(this,null,e)}cz.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},ds(cz,Vh,{transform(e,t){return this._dims?e.modified("fields")||e.fields.some((e=>t.modified(e.fields)))?this.reinit(e,t):this.eval(e,t):this.init(e,t)},init(e,t){const n=e.fields,r=e.query,i=this._indices={},o=this._dims=[],a=r.length;let s,l,u=0;for(;u<a;++u)s=n[u].fname,l=i[s]||(i[s]=uz()),o.push(lz(l,u,r[u]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),r=e.fields,i=e.query,o=this._indices,a=this._dims,s=this.value,l=s.curr(),u=s.prev(),c=s.all(),f=n.rem=n.add,d=n.mod,h=i.length,p={};let m,g,y,v,b,x,w,k,_;if(u.set(l),t.rem.length&&(b=this.remove(e,t,n)),t.add.length&&s.add(t.add),t.mod.length)for(x={},v=t.mod,w=0,k=v.length;w<k;++w)x[v[w]._index]=1;for(w=0;w<h;++w)_=r[w],(!a[w]||e.modified("fields",w)||t.modified(_.fields))&&(y=_.fname,(m=p[y])||(o[y]=g=uz(),p[y]=m=g.insert(_,t.source,0)),a[w]=lz(g,w,i[w]).onAdd(m,l));for(w=0,k=s.data().length;w<k;++w)b[w]||(u[w]!==l[w]?f.push(w):x[w]&&l[w]!==c&&d.push(w));return s.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),r=this._dims.length;let i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<r)-1),t.mod.length&&(this.modify(t,n),i|=(1<<r)-1),this.value.mask=i,n},insert(e,t,n){const r=t.add,i=this.value,o=this._dims,a=this._indices,s=e.fields,l={},u=n.add,c=i.size()+r.length,f=o.length;let d,h,p,m=i.size();i.resize(c,f),i.add(r);const g=i.curr(),y=i.prev(),v=i.all();for(d=0;d<f;++d)h=s[d].fname,p=l[h]||(l[h]=a[h].insert(s[d],r,m)),o[d].onAdd(p,g);for(;m<c;++m)y[m]=v,g[m]!==v&&u.push(m)},modify(e,t){const n=t.mod,r=this.value,i=r.curr(),o=r.all(),a=e.mod;let s,l,u;for(s=0,l=a.length;s<l;++s)u=a[s]._index,i[u]!==o&&n.push(u)},remove(e,t,n){const r=this._indices,i=this.value,o=i.curr(),a=i.prev(),s=i.all(),l={},u=n.rem,c=t.rem;let f,d,h,p;for(f=0,d=c.length;f<d;++f)h=c[f]._index,l[h]=1,a[h]=p=o[h],o[h]=s,p!==s&&u.push(h);for(h in r)r[h].remove(d,l);return this.reindex(t,d,l),l},reindex(e,t,n){const r=this._indices,i=this.value;e.runAfter((()=>{const e=i.remove(t,n);for(const t in r)r[t].reindex(e)}))},update(e,t,n){const r=this._dims,i=e.query,o=t.stamp,a=r.length;let s,l,u=0;for(n.filters=0,l=0;l<a;++l)e.modified("query",l)&&(s=l,++u);if(1===u)u=r[s].one,this.incrementOne(r[s],i[s],n.add,n.rem);else for(l=0,u=0;l<a;++l)e.modified("query",l)&&(u|=r[l].one,this.incrementAll(r[l],i[l],o,n.add),n.rem=n.add);return u},incrementAll(e,t,n,r){const i=this.value,o=i.seen(),a=i.curr(),s=i.prev(),l=e.index(),u=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=u[0],p=u[1],m=e.one;let g,y,v;if(f<h)for(g=f,y=Math.min(h,d);g<y;++g)v=l[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;else if(f>h)for(g=h,y=Math.min(f,p);g<y;++g)v=l[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;if(d>p)for(g=Math.max(f,p),y=d;g<y;++g)v=l[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;else if(d<p)for(g=Math.max(h,d),y=p;g<y;++g)v=l[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;e.range=t.slice()},incrementOne(e,t,n,r){const i=this.value.curr(),o=e.index(),a=e.bisect(e.range),s=e.bisect(t),l=s[0],u=s[1],c=a[0],f=a[1],d=e.one;let h,p,m;if(l<c)for(h=l,p=Math.min(c,u);h<p;++h)m=o[h],i[m]^=d,n.push(m);else if(l>c)for(h=c,p=Math.min(l,f);h<p;++h)m=o[h],i[m]^=d,r.push(m);if(u>f)for(h=Math.max(l,f),p=u;h<p;++h)m=o[h],i[m]^=d,n.push(m);else if(u<f)for(h=Math.max(c,u),p=f;h<p;++h)m=o[h],i[m]^=d,r.push(m);e.range=t.slice()}}),fz.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},ds(fz,Vh,{transform(e,t){const n=~(e.ignore||0),r=e.filter,i=r.mask;if(0==(i&n))return t.StopPropagation;const o=t.fork(t.ALL),a=r.data(),s=r.curr(),l=r.prev(),u=e=>s[e]&n?null:a[e];return o.filter(o.MOD,u),i&i-1?(o.filter(o.ADD,(e=>{const t=s[e]&n;return!t&&t^l[e]&n?a[e]:null})),o.filter(o.REM,(e=>{const t=s[e]&n;return t&&!(t^t^l[e]&n)?a[e]:null}))):(o.filter(o.ADD,u),o.filter(o.REM,(e=>(s[e]&n)===i?a[e]:null))),o.filter(o.SOURCE,(e=>u(e._index)))}});var dz=Object.freeze({__proto__:null,crossfilter:cz,resolvefilter:fz});const hz="Literal",pz="Property",mz="ArrayExpression",gz="BinaryExpression",yz="CallExpression",vz="ConditionalExpression",bz="LogicalExpression",xz="MemberExpression",wz="ObjectExpression",kz="UnaryExpression";function _z(e){this.type=e}var Oz,Ez,Dz,jz,Nz;_z.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=function(e){switch(e.type){case mz:return e.elements;case gz:case bz:return[e.left,e.right];case yz:return[e.callee].concat(e.arguments);case vz:return[e.test,e.consequent,e.alternate];case xz:return[e.object,e.property];case wz:return e.properties;case pz:return[e.key,e.value];case kz:return[e.argument];default:return[]}}(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};var Sz=1,Az=2,$z=3,Cz=4,Mz=5,Pz=6,Fz=7,Tz=8;(Oz={})[Sz]="Boolean",Oz[Az]="<end>",Oz[$z]="Identifier",Oz[Cz]="Keyword",Oz[Mz]="Null",Oz[Pz]="Numeric",Oz[Fz]="Punctuator",Oz[Tz]="String",Oz[9]="RegularExpression";var zz="ArrayExpression",Rz="BinaryExpression",Lz="CallExpression",Bz="ConditionalExpression",Iz="Identifier",Uz="Literal",qz="LogicalExpression",Wz="MemberExpression",Zz="ObjectExpression",Hz="Property",Gz="UnaryExpression",Vz="Unexpected token %0",Yz="Unexpected number",Xz="Unexpected string",Jz="Unexpected identifier",Qz="Unexpected reserved word",Kz="Unexpected end of input",eR="Invalid regular expression",tR="Invalid regular expression: missing /",nR="Octal literals are not allowed in strict mode.",rR="Duplicate data property in object literal not allowed in strict mode",iR="ILLEGAL",oR="Disabled.",aR=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),sR=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function lR(e,t){if(!e)throw new Error("ASSERT: "+t)}function uR(e){return e>=48&&e<=57}function cR(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function fR(e){return"01234567".indexOf(e)>=0}function dR(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function hR(e){return 10===e||13===e||8232===e||8233===e}function pR(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&aR.test(String.fromCharCode(e))}function mR(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&sR.test(String.fromCharCode(e))}const gR={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function yR(){for(;Dz<jz;){const e=Ez.charCodeAt(Dz);if(!dR(e)&&!hR(e))break;++Dz}}function vR(e){var t,n,r,i=0;for(n="u"===e?4:2,t=0;t<n;++t)Dz<jz&&cR(Ez[Dz])?(r=Ez[Dz++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):PR({},Vz,iR);return String.fromCharCode(i)}function bR(){var e,t,n,r;for(t=0,"}"===(e=Ez[Dz])&&PR({},Vz,iR);Dz<jz&&cR(e=Ez[Dz++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&PR({},Vz,iR),t<=65535?String.fromCharCode(t):(n=55296+(t-65536>>10),r=56320+(t-65536&1023),String.fromCharCode(n,r))}function xR(){var e,t;for(e=Ez.charCodeAt(Dz++),t=String.fromCharCode(e),92===e&&(117!==Ez.charCodeAt(Dz)&&PR({},Vz,iR),++Dz,(e=vR("u"))&&"\\"!==e&&pR(e.charCodeAt(0))||PR({},Vz,iR),t=e);Dz<jz&&mR(e=Ez.charCodeAt(Dz));)++Dz,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==Ez.charCodeAt(Dz)&&PR({},Vz,iR),++Dz,(e=vR("u"))&&"\\"!==e&&mR(e.charCodeAt(0))||PR({},Vz,iR),t+=e);return t}function wR(){var e,t;return e=Dz,t=92===Ez.charCodeAt(Dz)?xR():function(){var e,t;for(e=Dz++;Dz<jz;){if(92===(t=Ez.charCodeAt(Dz)))return Dz=e,xR();if(!mR(t))break;++Dz}return Ez.slice(e,Dz)}(),{type:1===t.length?$z:gR.hasOwnProperty(t)?Cz:"null"===t?Mz:"true"===t||"false"===t?Sz:$z,value:t,start:e,end:Dz}}function kR(){var e,t,n,r,i=Dz,o=Ez.charCodeAt(Dz),a=Ez[Dz];switch(o){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++Dz,{type:Fz,value:String.fromCharCode(o),start:i,end:Dz};default:if(61===(e=Ez.charCodeAt(Dz+1)))switch(o){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return Dz+=2,{type:Fz,value:String.fromCharCode(o)+String.fromCharCode(e),start:i,end:Dz};case 33:case 61:return Dz+=2,61===Ez.charCodeAt(Dz)&&++Dz,{type:Fz,value:Ez.slice(i,Dz),start:i,end:Dz}}}return">>>="===(r=Ez.substr(Dz,4))?{type:Fz,value:r,start:i,end:Dz+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:Fz,value:n,start:i,end:Dz+=3}:a===(t=n.substr(0,2))[1]&&"+-<>&|".indexOf(a)>=0||"=>"===t?{type:Fz,value:t,start:i,end:Dz+=2}:("//"===t&&PR({},Vz,iR),"<>=!+-*%&|^/".indexOf(a)>=0?(++Dz,{type:Fz,value:a,start:i,end:Dz}):void PR({},Vz,iR))}function _R(){var e,t,n;if(lR(uR((n=Ez[Dz]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=Dz,e="","."!==n){if(e=Ez[Dz++],n=Ez[Dz],"0"===e){if("x"===n||"X"===n)return++Dz,function(e){let t="";for(;Dz<jz&&cR(Ez[Dz]);)t+=Ez[Dz++];return 0===t.length&&PR({},Vz,iR),pR(Ez.charCodeAt(Dz))&&PR({},Vz,iR),{type:Pz,value:parseInt("0x"+t,16),start:e,end:Dz}}(t);if(fR(n))return function(e){let t="0"+Ez[Dz++];for(;Dz<jz&&fR(Ez[Dz]);)t+=Ez[Dz++];return(pR(Ez.charCodeAt(Dz))||uR(Ez.charCodeAt(Dz)))&&PR({},Vz,iR),{type:Pz,value:parseInt(t,8),octal:!0,start:e,end:Dz}}(t);n&&uR(n.charCodeAt(0))&&PR({},Vz,iR)}for(;uR(Ez.charCodeAt(Dz));)e+=Ez[Dz++];n=Ez[Dz]}if("."===n){for(e+=Ez[Dz++];uR(Ez.charCodeAt(Dz));)e+=Ez[Dz++];n=Ez[Dz]}if("e"===n||"E"===n)if(e+=Ez[Dz++],"+"!==(n=Ez[Dz])&&"-"!==n||(e+=Ez[Dz++]),uR(Ez.charCodeAt(Dz)))for(;uR(Ez.charCodeAt(Dz));)e+=Ez[Dz++];else PR({},Vz,iR);return pR(Ez.charCodeAt(Dz))&&PR({},Vz,iR),{type:Pz,value:parseFloat(e),start:t,end:Dz}}function OR(){var e,t,n,r;return Nz=null,yR(),e=Dz,t=function(){var e,t,n,r;for(lR("/"===(e=Ez[Dz]),"Regular expression literal must start with a slash"),t=Ez[Dz++],n=!1,r=!1;Dz<jz;)if(t+=e=Ez[Dz++],"\\"===e)hR((e=Ez[Dz++]).charCodeAt(0))&&PR({},tR),t+=e;else if(hR(e.charCodeAt(0)))PR({},tR);else if(n)"]"===e&&(n=!1);else{if("/"===e){r=!0;break}"["===e&&(n=!0)}return r||PR({},tR),{value:t.substr(1,t.length-2),literal:t}}(),n=function(){var e,t,n;for(t="",n="";Dz<jz&&mR((e=Ez[Dz]).charCodeAt(0));)++Dz,"\\"===e&&Dz<jz?PR({},Vz,iR):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&PR({},eR,n),{value:n,literal:t}}(),r=function(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,((e,t)=>{if(parseInt(t,16)<=1114111)return"x";PR({},eR)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(S9){PR({},eR)}try{return new RegExp(e,t)}catch(r){return null}}(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:Dz}}function ER(){if(yR(),Dz>=jz)return{type:Az,start:Dz,end:Dz};const e=Ez.charCodeAt(Dz);return pR(e)?wR():40===e||41===e||59===e?kR():39===e||34===e?function(){var e,t,n,r,i="",o=!1;for(lR("'"===(e=Ez[Dz])||'"'===e,"String literal must starts with a quote"),t=Dz,++Dz;Dz<jz;){if((n=Ez[Dz++])===e){e="";break}if("\\"===n)if((n=Ez[Dz++])&&hR(n.charCodeAt(0)))"\r"===n&&"\n"===Ez[Dz]&&++Dz;else switch(n){case"u":case"x":"{"===Ez[Dz]?(++Dz,i+=bR()):i+=vR(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:fR(n)?(0!==(r="01234567".indexOf(n))&&(o=!0),Dz<jz&&fR(Ez[Dz])&&(o=!0,r=8*r+"01234567".indexOf(Ez[Dz++]),"0123".indexOf(n)>=0&&Dz<jz&&fR(Ez[Dz])&&(r=8*r+"01234567".indexOf(Ez[Dz++]))),i+=String.fromCharCode(r)):i+=n}else{if(hR(n.charCodeAt(0)))break;i+=n}}return""!==e&&PR({},Vz,iR),{type:Tz,value:i,octal:o,start:t,end:Dz}}():46===e?uR(Ez.charCodeAt(Dz+1))?_R():kR():uR(e)?_R():kR()}function DR(){const e=Nz;return Dz=e.end,Nz=ER(),Dz=e.end,e}function jR(){const e=Dz;Nz=ER(),Dz=e}function NR(e,t,n){const r=new _z("||"===e||"&&"===e?qz:Rz);return r.operator=e,r.left=t,r.right=n,r}function SR(e,t){const n=new _z(Lz);return n.callee=e,n.arguments=t,n}function AR(e){const t=new _z(Iz);return t.name=e,t}function $R(e){const t=new _z(Uz);return t.value=e.value,t.raw=Ez.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function CR(e,t,n){const r=new _z(Wz);return r.computed="["===e,r.object=t,r.property=n,r.computed||(n.member=!0),r}function MR(e,t,n){const r=new _z(Hz);return r.key=t,r.value=n,r.kind=e,r}function PR(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,((e,t)=>(lR(t<r.length,"Message reference must be in range"),r[t])));throw(n=new Error(i)).index=Dz,n.description=i,n}function FR(e){e.type===Az&&PR(e,Kz),e.type===Pz&&PR(e,Yz),e.type===Tz&&PR(e,Xz),e.type===$z&&PR(e,Jz),e.type===Cz&&PR(e,Qz),PR(e,Vz,e.value)}function TR(e){const t=DR();t.type===Fz&&t.value===e||FR(t)}function zR(e){return Nz.type===Fz&&Nz.value===e}function RR(e){return Nz.type===Cz&&Nz.value===e}function LR(){const e=[];for(Dz=Nz.start,TR("[");!zR("]");)zR(",")?(DR(),e.push(null)):(e.push(JR()),zR("]")||TR(","));return DR(),function(e){const t=new _z(zz);return t.elements=e,t}(e)}function BR(){Dz=Nz.start;const e=DR();return e.type===Tz||e.type===Pz?(e.octal&&PR(e,nR),$R(e)):AR(e.value)}function IR(){var e,t,n;return Dz=Nz.start,(e=Nz).type===$z?(n=BR(),TR(":"),MR("init",n,JR())):e.type!==Az&&e.type!==Fz?(t=BR(),TR(":"),MR("init",t,JR())):void FR(e)}function UR(){var e,t,n=[],r={},i=String;for(Dz=Nz.start,TR("{");!zR("}");)t="$"+((e=IR()).key.type===Iz?e.key.name:i(e.key.value)),Object.prototype.hasOwnProperty.call(r,t)?PR({},rR):r[t]=!0,n.push(e),zR("}")||TR(",");return TR("}"),function(e){const t=new _z(Zz);return t.properties=e,t}(n)}const qR={if:1};function WR(){var e,t,n;if(zR("("))return function(){TR("(");const e=QR();return TR(")"),e}();if(zR("["))return LR();if(zR("{"))return UR();if(e=Nz.type,Dz=Nz.start,e===$z||qR[Nz.value])n=AR(DR().value);else if(e===Tz||e===Pz)Nz.octal&&PR(Nz,nR),n=$R(DR());else{if(e===Cz)throw new Error(oR);e===Sz?((t=DR()).value="true"===t.value,n=$R(t)):e===Mz?((t=DR()).value=null,n=$R(t)):zR("/")||zR("/=")?(n=$R(OR()),jR()):FR(DR())}return n}function ZR(){const e=[];if(TR("("),!zR(")"))for(;Dz<jz&&(e.push(JR()),!zR(")"));)TR(",");return TR(")"),e}function HR(){Dz=Nz.start;const e=DR();return function(e){return e.type===$z||e.type===Cz||e.type===Sz||e.type===Mz}(e)||FR(e),AR(e.value)}function GR(){TR("[");const e=QR();return TR("]"),e}function VR(){const e=function(){var e;for(e=WR();;)if(zR("."))TR("."),e=CR(".",e,HR());else if(zR("("))e=SR(e,ZR());else{if(!zR("["))break;e=CR("[",e,GR())}return e}();if(Nz.type===Fz&&(zR("++")||zR("--")))throw new Error(oR);return e}function YR(){var e,t;if(Nz.type!==Fz&&Nz.type!==Cz)t=VR();else{if(zR("++")||zR("--"))throw new Error(oR);if(zR("+")||zR("-")||zR("~")||zR("!"))e=DR(),t=YR(),t=function(e,t){const n=new _z(Gz);return n.operator=e,n.argument=t,n.prefix=!0,n}(e.value,t);else{if(RR("delete")||RR("void")||RR("typeof"))throw new Error(oR);t=VR()}}return t}function XR(e){let t=0;if(e.type!==Fz&&e.type!==Cz)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function JR(){var e,t;return e=function(){var e,t,n,r,i,o,a,s,l,u;if(e=Nz,l=YR(),0===(i=XR(r=Nz)))return l;for(r.prec=i,DR(),t=[e,Nz],o=[l,r,a=YR()];(i=XR(Nz))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)a=o.pop(),s=o.pop().value,l=o.pop(),t.pop(),n=NR(s,l,a),o.push(n);(r=DR()).prec=i,o.push(r),t.push(Nz),n=YR(),o.push(n)}for(n=o[u=o.length-1],t.pop();u>1;)t.pop(),n=NR(o[u-1].value,o[u-2],n),u-=2;return n}(),zR("?")&&(DR(),t=JR(),TR(":"),e=function(e,t,n){const r=new _z(Bz);return r.test=e,r.consequent=t,r.alternate=n,r}(e,t,JR())),e}function QR(){const e=JR();if(zR(","))throw new Error(oR);return e}function KR(e){Dz=0,jz=(Ez=e).length,Nz=null,jR();const t=QR();if(Nz.type!==Az)throw new Error("Unexpect token after expression.");return t}var eL={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function tL(e){function t(t,n,r){return i=>function(t,n,r,i){let o=e(n[0]);return r&&(o=r+"("+o+")",0===r.lastIndexOf("new ",0)&&(o="("+o+")")),o+"."+t+(i<0?"":0===i?"()":"("+n.slice(1).map(e).join(",")+")")}(t,i,n,r)}const n="new Date",r="String",i="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(t){t.length<3&&aa("Missing arguments to clamp function."),t.length>3&&aa("Too many arguments to clamp function.");const n=t.map(e);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:t("getDate",n,0),day:t("getDay",n,0),year:t("getFullYear",n,0),month:t("getMonth",n,0),hours:t("getHours",n,0),minutes:t("getMinutes",n,0),seconds:t("getSeconds",n,0),milliseconds:t("getMilliseconds",n,0),time:t("getTime",n,0),timezoneoffset:t("getTimezoneOffset",n,0),utcdate:t("getUTCDate",n,0),utcday:t("getUTCDay",n,0),utcyear:t("getUTCFullYear",n,0),utcmonth:t("getUTCMonth",n,0),utchours:t("getUTCHours",n,0),utcminutes:t("getUTCMinutes",n,0),utcseconds:t("getUTCSeconds",n,0),utcmilliseconds:t("getUTCMilliseconds",n,0),length:t("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:t("toUpperCase",r,0),lower:t("toLowerCase",r,0),substring:t("substring",r),split:t("split",r),trim:t("trim",r,0),regexp:i,test:t("test",i),if:function(t){t.length<3&&aa("Missing arguments to if function."),t.length>3&&aa("Too many arguments to if function.");const n=t.map(e);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}function nL(e){const t=(e=e||{}).allowed?Cs(e.allowed):{},n=e.forbidden?Cs(e.forbidden):{},r=e.constants||eL,i=(e.functions||tL)(f),o=e.globalvar,a=e.fieldvar,s=Ya(o)?o:e=>`${o}["${e}"]`;let l={},u={},c=0;function f(e){if(bs(e))return e;const t=d[e.type];return null==t&&aa("Unsupported type: "+e.type),t(e)}const d={Literal:e=>e.raw,Identifier:e=>{const i=e.name;return c>0?i:ls(n,i)?aa("Illegal identifier: "+i):ls(r,i)?r[i]:ls(t,i)?i:(l[i]=1,s(i))},MemberExpression:e=>{const t=!e.computed,n=f(e.object);t&&(c+=1);const r=f(e.property);return n===a&&(u[function(e){const t=e&&e.length-1;return t&&('"'===e[0]&&'"'===e[t]||"'"===e[0]&&"'"===e[t])?e.slice(1,-1):e}(r)]=1),t&&(c-=1),n+(t?"."+r:"["+r+"]")},CallExpression:e=>{"Identifier"!==e.callee.type&&aa("Illegal callee type: "+e.callee.type);const t=e.callee.name,n=e.arguments,r=ls(i,t)&&i[t];return r||aa("Unrecognized function: "+t),Ya(r)?r(n):r+"("+n.map(f).join(",")+")"},ArrayExpression:e=>"["+e.elements.map(f).join(",")+"]",BinaryExpression:e=>"("+f(e.left)+" "+e.operator+" "+f(e.right)+")",UnaryExpression:e=>"("+e.operator+f(e.argument)+")",ConditionalExpression:e=>"("+f(e.test)+"?"+f(e.consequent)+":"+f(e.alternate)+")",LogicalExpression:e=>"("+f(e.left)+e.operator+f(e.right)+")",ObjectExpression:e=>"{"+e.properties.map(f).join(",")+"}",Property:e=>{c+=1;const t=f(e.key);return c-=1,t+":"+f(e.value)}};function h(e){const t={code:f(e),globals:Object.keys(l),fields:Object.keys(u)};return l={},u={},t}return h.functions=i,h.constants=r,h}function rL(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function iL(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function oL(){return 0}function aL(e){return e instanceof ul?e:new ul(e)}const sL="intersect",lL="union",uL="_vgsid_",cL=la(uL),fL="E",dL="R",hL="R-E",pL="R-LE",mL="R-RE",gL="index:unit";function yL(e,t){for(var n,r,i=t.fields,o=t.values,a=i.length,s=0;s<a;++s)if((r=i[s]).getter=la.getter||la(r.field),ms(n=r.getter(e))&&(n=Sa(n)),ms(o[s])&&(o[s]=Sa(o[s])),ms(o[s][0])&&(o[s]=o[s].map(Sa)),r.type===fL){if(ka(o[s])?o[s].indexOf(n)<0:n!==o[s])return!1}else if(r.type===dL){if(!hs(n,o[s]))return!1}else if(r.type===mL){if(!hs(n,o[s],!0,!1))return!1}else if(r.type===hL){if(!hs(n,o[s],!1,!1))return!1}else if(r.type===pL&&!hs(n,o[s],!1,!0))return!1;return!0}const vL=function(e){let t,n,r;function i(e,r,i,o){if(void 0===i&&(i=0),void 0===o&&(o=e.length),i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<0?i=t+1:o=t}while(i<o)}return i}return 2!==e.length?(t=rL,n=(t,n)=>rL(e(t),n),r=(t,n)=>e(t)-n):(t=e===rL||e===iL?e:oL,n=e,r=e),{left:i,center:function(e,t,n,o){void 0===n&&(n=0),void 0===o&&(o=e.length);const a=i(e,t,n,o-1);return a>n&&r(e[a-1],t)>-r(e[a],t)?a-1:a},right:function(e,r,i,o){if(void 0===i&&(i=0),void 0===o&&(o=e.length),i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<=0?i=t+1:o=t}while(i<o)}return i}}}(cL),bL=vL.left,xL=vL.right;var wL={[`${uL}_union`]:function(){const e=new ul;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)for(const t of i)e.add(t);return e},[`${uL}_intersect`]:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e=new ul(e),n=n.map(aL);e:for(const i of e)for(const t of n)if(!t.has(i)){e.delete(i);continue e}return e},E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter((e=>t.indexOf(e)>=0)):t},R_union:function(e,t){var n=Sa(t[0]),r=Sa(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]},R_intersect:function(e,t){var n=Sa(t[0]),r=Sa(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]}};function kL(e,t,n,r){t[0].type!==hz&&aa("First argument to selection functions must be a string literal.");const i=t[0].value,o="unit",a="@"+o,s=":"+i;(t.length>=2&&Na(t).value)!==sL||ls(r,a)||(r[a]=n.getData(i).indataRef(n,o)),ls(r,s)||(r[s]=n.getData(i).tuplesRef())}function _L(e){const t=this.context.data[e];return t?t.values.value:[]}const OL=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},EL=OL("format"),DL=OL("timeFormat"),jL=OL("utcFormat"),NL=OL("timeParse"),SL=OL("utcParse"),AL=new Date(2e3,0,1);function $L(e,t,n){return Number.isInteger(e)&&Number.isInteger(t)?(AL.setYear(2e3),AL.setMonth(e),AL.setDate(t),DL.call(this,AL,n)):""}const CL="%",ML="$";function PL(e,t,n,r){t[0].type!==hz&&aa("First argument to data functions must be a string literal.");const i=t[0].value,o=":"+i;if(!ls(o,r))try{r[o]=n.getData(i).tuplesRef()}catch(a){}}function FL(e,t,n,r){if(t[0].type===hz)TL(n,r,t[0].value);else for(e in n.scales)TL(n,r,e)}function TL(e,t,n){const r=CL+n;if(!ls(t,r))try{t[r]=e.scaleRef(n)}catch(i){}}function zL(e,t){if(Ya(e))return e;if(bs(e)){const n=t.scales[e];return n&&function(e){return e&&!0===e[Zx]}(n.value)?n.value:void 0}}function RL(e,t,n){t.__bandwidth=e=>e&&e.bandwidth?e.bandwidth():0,n._bandwidth=FL,n._range=FL,n._scale=FL;const r=t=>"_["+(t.type===hz?js(CL+t.value):js(CL)+"+"+e(t))+"]";return{_bandwidth:e=>`this.__bandwidth(${r(e[0])})`,_range:e=>`${r(e[0])}.range()`,_scale:t=>`${r(t[0])}(${e(t[1])})`}}function LL(e,t){return function(n,r,i){if(n){const t=zL(n,(i||this).context);return t&&t.path[e](r)}return t(r)}}const BL=LL("area",(function(e){return uS=new sl,ZN(e,cS),2*uS})),IL=LL("bounds",(function(e){var t,n,r,i,o,a,s;if(eS=KN=-(JN=QN=1/0),aS=[],ZN(e,RS),n=aS.length){for(aS.sort(GS),t=1,o=[r=aS[0]];t<n;++t)VS(r,(i=aS[t])[0])||VS(r,i[1])?(HS(r[0],i[1])>HS(r[0],r[1])&&(r[1]=i[1]),HS(i[0],r[1])>HS(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(a=-1/0,t=0,r=o[n=o.length-1];t<=n;r=i,++t)i=o[t],(s=HS(r[1],i[0]))>a&&(a=s,JN=i[0],KN=r[1])}return aS=sS=null,JN===1/0||QN===1/0?[[NaN,NaN],[NaN,NaN]]:[[JN,QN],[KN,eS]]})),UL=LL("centroid",(function(e){kS=_S=OS=ES=DS=jS=NS=SS=0,AS=new sl,$S=new sl,CS=new sl,ZN(e,YS);var t=+AS,n=+$S,r=+CS,i=AN(t,n,r);return i<yN&&(t=jS,n=NS,r=SS,_S<gN&&(t=OS,n=ES,r=DS),(i=AN(t,n,r))<yN)?[NaN,NaN]:[DN(n,t)*kN,RN(r/i)*kN]}));function qL(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function WL(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function ZL(e){const t=iv(e);return.2126*WL(t.r)+.7152*WL(t.g)+.0722*WL(t.b)}function HL(e,t){return e===t||e!=e&&t!=t||(ka(e)?!(!ka(t)||e.length!==t.length)&&function(e,t){for(let n=0,r=e.length;n<r;++n)if(!HL(e[n],t[n]))return!1;return!0}(e,t):!(!_a(e)||!_a(t))&&GL(e,t))}function GL(e,t){for(const n in e)if(!HL(e[n],t[n]))return!1;return!0}function VL(e){return t=>GL(e,t)}const YL={};function XL(e){return ka(e)||ArrayBuffer.isView(e)?e:null}function JL(e){return XL(e)||(bs(e)?e:null)}const QL=e=>e.data;function KL(e,t){const n=_L.call(t,e);return n.root&&n.root.lookup||{}}const eB=()=>"undefined"!=typeof window&&window||null;function tB(e,t,n){if(!e)return[];const[r,i]=e,o=(new Fk).set(r[0],r[1],i[0],i[1]);return cD(n||this.context.dataflow.scenegraph().root,o,function(e){let t=null;if(e){const n=Ga(e.marktype),r=Ga(e.markname);t=e=>(!n.length||n.some((t=>e.marktype===t)))&&(!r.length||r.some((t=>e.name===t)))}return t}(t))}const nB={random:()=>rp(),cumulativeNormal:fp,cumulativeLogNormal:yp,cumulativeUniform:_p,densityNormal:cp,densityLogNormal:gp,densityUniform:kp,quantileNormal:dp,quantileLogNormal:vp,quantileUniform:Op,sampleNormal:up,sampleLogNormal:mp,sampleUniform:wp,isArray:ka,isBoolean:ps,isDate:ms,isDefined:e=>void 0!==e,isNumber:ys,isObject:_a,isRegExp:vs,isString:bs,isTuple:ph,isValid:e=>null!=e&&e==e,toBoolean:Ns,toDate:e=>As(e),toNumber:Sa,toString:$s,indexof:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return JL(e).indexOf(...n)},join:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return XL(e).join(...n)},lastindexof:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return JL(e).lastIndexOf(...n)},replace:function(e,t,n){return Ya(n)&&aa("Function argument passed to replace."),String(e).replace(t,n)},reverse:function(e){return XL(e).slice().reverse()},slice:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return JL(e).slice(...n)},flush:fs,lerp:ws,merge:function(){const e=[].slice.call(arguments);return e.unshift({}),is(...e)},pad:Es,peek:Na,pluck:function(e,t){const n=YL[t]||(YL[t]=la(t));return ka(e)?e.map(n):n(e)},span:Ds,inrange:hs,truncate:Ms,rgb:iv,lab:Nv,hcl:Pv,hsl:hv,luminance:ZL,contrast:function(e,t){const n=ZL(e),r=ZL(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},sequence:Al,format:EL,utcFormat:jL,utcParse:SL,utcOffset:Ac,utcSequence:Mc,timeFormat:DL,timeParse:NL,timeOffset:Sc,timeSequence:Cc,timeUnitSpecifier:tc,monthFormat:function(e){return $L.call(this,e,1,"%B")},monthAbbrevFormat:function(e){return $L.call(this,e,1,"%b")},dayFormat:function(e){return $L.call(this,0,2+e,"%A")},dayAbbrevFormat:function(e){return $L.call(this,0,2+e,"%a")},quarter:Za,utcquarter:Ha,week:oc,utcweek:fc,dayofyear:ic,utcdayofyear:cc,warn:function(){return qL(this.context.dataflow,"warn",arguments)},info:function(){return qL(this.context.dataflow,"info",arguments)},debug:function(){return qL(this.context.dataflow,"debug",arguments)},extent:e=>os(e),inScope:function(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n},intersect:tB,clampRange:Va,pinchDistance:function(e){const t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.hypot(n,r)},pinchAngle:function(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)},screen:function(){const e=eB();return e?e.screen:{}},containerSize:function(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]},windowSize:function(){const e=eB();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]},bandspace:function(e,t,n){return vx(e||0,t||0,n||0)},setdata:function(e,t){const n=this.context.dataflow,r=this.context.data[e].input;return n.pulse(r,n.changeset().remove(ha).insert(t)),1},pathShape:function(e){let t=null;return function(n){return n?ik(n,t=t||Gw(e)):e}},panLinear:Ta,panLog:za,panPow:Ra,panSymlog:La,zoomLinear:Ia,zoomLog:Ua,zoomPow:qa,zoomSymlog:Wa,encode:function(e,t,n){if(e){const n=this.context.dataflow,r=e.mark.source;n.pulse(r,n.changeset().encode(e,t))}return void 0!==n?n:e},modify:function(e,t,n,r,i,o){const a=this.context.dataflow,s=this.context.data[e],l=s.input,u=a.stamp();let c,f,d=s.changes;if(!1===a._trigger||!(l.value.length||t||r))return 0;if((!d||d.stamp<u)&&(s.changes=d=a.changeset(),d.stamp=u,a.runAfter((()=>{s.modified=!0,a.pulse(l,d).run()}),!0,1)),n&&(c=!0===n?ha:ka(n)||ph(n)?n:VL(n),d.remove(c)),t&&d.insert(t),r&&(c=VL(r),l.value.some(c)?d.remove(c):d.insert(r)),i)for(f in o)d.modify(i,f,o[f]);return 1},lassoAppend:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;const i=(e=Ga(e))[e.length-1];return void 0===i||Math.hypot(i[0]-t,i[1]-n)>r?[...e,[t,n]]:e},lassoPath:function(e){return Ga(e).reduce(((t,n,r)=>{let[i,o]=n;return t+(0==r?`M ${i},${o} `:r===e.length-1?" Z":`L ${i},${o} `)}),"")},intersectLasso:function(e,t,n){const{x:r,y:i,mark:o}=n,a=(new Fk).set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[s,l]of t)s<a.x1&&(a.x1=s),s>a.x2&&(a.x2=s),l<a.y1&&(a.y1=l),l>a.y2&&(a.y2=l);return a.translate(r,i),tB([[a.x1,a.y1],[a.x2,a.y2]],e,o).filter((e=>function(e,t,n){let r=0;for(let i=0,o=n.length-1;i<n.length;o=i++){const[a,s]=n[o],[l,u]=n[i];u>t!=s>t&&e<(a-l)*(t-u)/(s-u)+l&&r++}return 1&r}(e.x,e.y,t)))}},rB=["view","item","group","xy","x","y"],iB="this.",oB={},aB={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${js(ML+e)}]`,functions:function(e){const t=tL(e);rB.forEach((e=>t[e]="event.vega."+e));for(const n in nB)t[n]=iB+n;return is(t,RL(e,nB,oB)),t},constants:eL,visitors:oB},sB=nL(aB);function lB(e,t,n){return 1===arguments.length?nB[e]:(nB[e]=t,n&&(oB[e]=n),sB&&(sB.functions[e]=iB+e),this)}function uB(e,t){const n={};let r;try{r=KR(e=bs(e)?e:js(e)+"")}catch(o){aa("Expression parse error: "+e)}r.visit((e=>{if(e.type!==yz)return;const r=e.callee.name,i=aB.visitors[r];i&&i(r,e.arguments,t,n)}));const i=sB(r);return i.globals.forEach((e=>{const r=ML+e;!ls(n,r)&&t.getSignal(e)&&(n[r]=t.signalRef(e))})),{$expr:is({code:i.code},t.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}lB("bandwidth",(function(e,t){const n=zL(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}),FL),lB("copy",(function(e,t){const n=zL(e,(t||this).context);return n?n.copy():void 0}),FL),lB("domain",(function(e,t){const n=zL(e,(t||this).context);return n?n.domain():[]}),FL),lB("range",(function(e,t){const n=zL(e,(t||this).context);return n&&n.range?n.range():[]}),FL),lB("invert",(function(e,t,n){const r=zL(e,(n||this).context);return r?ka(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}),FL),lB("scale",(function(e,t,n){const r=zL(e,(n||this).context);return r?r(t):void 0}),FL),lB("gradient",(function(e,t,n,r,i){e=zL(e,(i||this).context);const o=Lw(t,n);let a=e.domain(),s=a[0],l=Na(a),u=ca;return l-s?u=aw(e,s,l):e=(e.interpolator?Gx("sequential")().interpolator(e.interpolator()):Gx("linear")().interpolate(e.interpolate()).range(e.range())).domain([s=0,l=1]),e.ticks&&(a=e.ticks(+r||15),s!==a[0]&&a.unshift(s),l!==Na(a)&&a.push(l)),a.forEach((t=>o.stop(u(t),e(t)))),o}),FL),lB("geoArea",BL,FL),lB("geoBounds",IL,FL),lB("geoCentroid",UL,FL),lB("geoShape",(function(e,t,n){const r=zL(e,(n||this).context);return function(e){return r?r.path.context(e)(t):""}}),FL),lB("indata",(function(e,t,n){const r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i?i.count:i}),(function(e,t,n,r){t[0].type!==hz&&aa("First argument to indata must be a string literal."),t[1].type!==hz&&aa("Second argument to indata must be a string literal.");const i=t[0].value,o=t[1].value,a="@"+o;ls(a,r)||(r[a]=n.getData(i).indataRef(n,o))})),lB("data",_L,PL),lB("treePath",(function(e,t,n){const r=KL(e,this),i=r[t],o=r[n];return i&&o?i.path(o).map(QL):void 0}),PL),lB("treeAncestors",(function(e,t){const n=KL(e,this)[t];return n?n.ancestors().map(QL):void 0}),PL),lB("vlSelectionTest",(function(e,t,n){for(var r,i,o,a,s,l=this.context.data[e],u=l?l.values.value:[],c=l?l[gL]&&l[gL].value:void 0,f=n===sL,d=u.length,h=0;h<d;++h)if(r=u[h],c&&f){if(-1===(o=(i=i||{})[a=r.unit]||0))continue;if(s=yL(t,r),i[a]=s?-1:++o,s&&1===c.size)return!0;if(!s&&o===c.get(a).count)return!1}else if(f^(s=yL(t,r)))return s;return d&&f}),kL),lB("vlSelectionIdTest",(function(e,t,n){const r=this.context.data[e],i=r?r.values.value:[],o=r?r[gL]&&r[gL].value:void 0,a=n===sL,s=cL(t),l=bL(i,s);if(l===i.length)return!1;if(cL(i[l])!==s)return!1;if(o&&a){if(1===o.size)return!0;if(xL(i,s)-l<o.size)return!1}return!0}),kL),lB("vlSelectionResolve",(function(e,t,n,r){for(var i,o,a,s,l,u,c,f,d,h,p,m,g=this.context.data[e],y=g?g.values.value:[],v={},b={},x={},w=y.length,k=0;k<w;++k)if(s=(i=y[k]).unit,o=i.fields,a=i.values,o&&a){for(p=0,m=o.length;p<m;++p)l=o[p],f=(c=v[l.field]||(v[l.field]={}))[s]||(c[s]=[]),x[l.field]=d=l.type.charAt(0),h=wL[`${d}_union`],c[s]=h(f,Ga(a[p]));n&&(f=b[s]||(b[s]=[])).push(Ga(a).reduce(((e,t,n)=>(e[o[n].field]=t,e)),{}))}else l=uL,u=cL(i),(f=(c=v[l]||(v[l]={}))[s]||(c[s]=[])).push(u),n&&(f=b[s]||(b[s]=[])).push({[uL]:u});if(t=t||lL,v[uL]?v[uL]=wL[`${uL}_${t}`](...Object.values(v[uL])):Object.keys(v).forEach((e=>{v[e]=Object.keys(v[e]).map((t=>v[e][t])).reduce(((n,r)=>void 0===n?r:wL[`${x[e]}_${t}`](n,r)))})),y=Object.keys(b),n&&y.length){v[r?"vlPoint":"vlMulti"]=t===lL?{or:y.reduce(((e,t)=>(e.push(...b[t]),e)),[])}:{and:y.map((e=>({or:b[e]})))}}return v}),kL),lB("vlSelectionTuples",(function(e,t){return e.map((e=>is(t.fields?{values:t.fields.map((t=>(t.getter||(t.getter=la(t.field)))(e.datum)))}:{[uL]:cL(e.datum)},t)))}));const cB=Cs(["rule"]),fB=Cs(["group","image","rect"]);function dB(e){return(e+"").toLowerCase()}function hB(e,t,n){n.endsWith(";")||(n="return("+n+");");const r=Function(...t.concat(n));return e&&e.functions?r.bind(e.functions):r}var pB={operator:(e,t)=>hB(e,["_"],t.code),parameter:(e,t)=>hB(e,["datum","_"],t.code),event:(e,t)=>hB(e,["event"],t.code),handler:(e,t)=>hB(e,["_","event"],`var datum=event.item&&event.item.datum;return ${t.code};`),encode:(e,t)=>{const{marktype:n,channels:r}=t;let i="var o=item,datum=o.datum,m=0,$;";for(const o in r){const e="o["+js(o)+"]";i+=`$=${r[o].code};if(${e}!==$)${e}=$,m=1;`}return i+=function(e,t){let n="";return cB[t]||(e.x2&&(e.x?(fB[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(fB[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}(r,n),i+="return m;",hB(e,["item","_"],i)},codegen:{get(e){const t=`[${e.map(js).join("][")}]`,n=Function("_",`return _${t};`);return n.path=t,n},comparator(e,t){let n;const r=Function("a","b","var u, v; return "+e.map(((e,r)=>{const i=t[r];let o,a;return e.path?(o=`a${e.path}`,a=`b${e.path}`):((n=n||{})["f"+r]=e,o=`this.f${r}(a)`,a=`this.f${r}(b)`),function(e,t,n,r){return`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n}\n  : (u > v || v == null) && u != null ? ${r}\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}\n  : v !== v && u === u ? ${r} : `}(o,a,-i,i)})).join("")+"0;");return n?r.bind(n):r}}};function mB(e,t,n){if(!e||!_a(e))return e;for(let r,i=0,o=gB.length;i<o;++i)if(r=gB[i],ls(e,r.key))return r.parse(e,t,n);return e}var gB=[{key:"$ref",parse:function(e,t){return t.get(e.$ref)||aa("Operator not defined: "+e.$ref)}},{key:"$key",parse:function(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=xs(e.$key,e.$flat,t.expr.codegen))}},{key:"$expr",parse:function(e,t,n){e.$params&&t.parseParameters(e.$params,n);const r="e:"+e.$expr.code;return t.fn[r]||(t.fn[r]=ea(t.parameterExpression(e.$expr),e.$fields))}},{key:"$field",parse:function(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=la(e.$field,e.$name,t.expr.codegen))}},{key:"$encode",parse:function(e,t){const n=e.$encode,r={};for(const i in n){const e=n[i];r[i]=ea(t.encodeExpression(e.$expr),e.$fields),r[i].output=e.$output}return r}},{key:"$compare",parse:function(e,t){const n="c:"+e.$compare+"_"+e.$order,r=Ga(e.$compare).map((e=>e&&e.$tupleid?mh:e));return t.fn[n]||(t.fn[n]=Ja(r,e.$order,t.expr.codegen))}},{key:"$context",parse:function(e,t){return t}},{key:"$subflow",parse:function(e,t){const n=e.$subflow;return function(e,r,i){const o=t.fork().parse(n),a=o.get(n.operators[0].id),s=o.signals.parent;return s&&s.set(i),a.detachSubflow=()=>t.detach(o),a}}},{key:"$tupleid",parse:function(){return mh}}];const yB={skip:!0};function vB(e,t,n,r){return new bB(e,t,n,r)}function bB(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||pB,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function xB(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}function wB(e,t){e&&(null==t?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}bB.prototype=xB.prototype={fork(){const e=new xB(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter((t=>t!==e));const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,r=n.dataflow,i=e.value;if(n.set(e.id,t),function(e){return"collect"===dB(e)}(e.type)&&i&&(i.$ingest?r.ingest(t,i.$ingest,i.$format):i.$request?r.preload(t,i.$request,i.$format):r.pulse(t,r.changeset().insert(i))),e.root&&(n.root=t),e.parent){let i=n.get(e.parent.$ref);i?(r.connect(i,[t]),t.targets().add(i)):(n.unresolved=n.unresolved||[]).push((()=>{i=n.get(e.parent.$ref),r.connect(i,[t]),t.targets().add(i)}))}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const o in e.data){const r=n.data[o]||(n.data[o]={});e.data[o].forEach((e=>r[e]=t))}},resolve(){return(this.unresolved||[]).forEach((e=>e())),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[dB(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:function(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach((e=>t.parseOperator(e))),n.forEach((e=>t.parseOperatorParameters(e))),(e.streams||[]).forEach((e=>t.parseStream(e))),(e.updates||[]).forEach((e=>t.parseUpdate(e))),t.resolve()},parseOperator:function(e){const t=this;!function(e){return"operator"===dB(e)}(e.type)&&e.type?t.transform(e,e.type):t.operator(e,e.update?t.operatorExpression(e.update):null)},parseOperatorParameters:function(e){const t=this;if(e.params){const n=t.get(e.id);n||aa("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}},parseParameters:function(e,t){t=t||{};const n=this;for(const r in e){const i=e[r];t[r]=ka(i)?i.map((e=>mB(e,n,t))):mB(i,n,t)}return t},parseStream:function(e){var t,n=this,r=null!=e.filter?n.eventExpression(e.filter):void 0,i=null!=e.stream?n.get(e.stream):void 0;e.source?i=n.events(e.source,e.type,r):e.merge&&(i=(t=e.merge.map((e=>n.get(e))))[0].merge.apply(t[0],t.slice(1))),e.between&&(t=e.between.map((e=>n.get(e))),i=i.between(t[0],t[1])),e.filter&&(i=i.filter(r)),null!=e.throttle&&(i=i.throttle(+e.throttle)),null!=e.debounce&&(i=i.debounce(+e.debounce)),null==i&&aa("Invalid stream definition: "+JSON.stringify(e)),e.consume&&i.consume(!0),n.stream(e,i)},parseUpdate:function(e){var t,n=this,r=_a(r=e.source)?r.$ref:r,i=n.get(r),o=e.update,a=void 0;i||aa("Source not defined: "+e.source),t=e.target&&e.target.$expr?n.eventExpression(e.target.$expr):n.get(e.target),o&&o.$expr&&(o.$params&&(a=n.parseParameters(o.$params)),o=n.handlerExpression(o.$expr)),n.update(e,i,t,o,a)},getState:function(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach((n=>{const i=t.signals[n];e.signals(n,i)&&(r[n]=i.value)}))}if(e.data){var i=n.data={};Object.keys(t.data).forEach((n=>{const r=t.data[n];e.data(n,r)&&(i[n]=r.input.value)}))}return t.subcontext&&!1!==e.recurse&&(n.subcontext=t.subcontext.map((t=>t.getState(e)))),n},setState:function(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach((e=>{n.update(t.signals[e],i[e],yB)})),Object.keys(r||{}).forEach((e=>{n.pulse(t.data[e].input,n.changeset().remove(ha).insert(r[e]))})),(e.subcontext||[]).forEach(((e,n)=>{const r=t.subcontext[n];r&&r.setState(e)}))}};const kB="default";function _B(e,t){const n=e.globalCursor()?"undefined"!=typeof document&&document.body:e.container();if(n)return null==t?n.style.removeProperty("cursor"):n.style.cursor=t}function OB(e,t){var n=e._runtime.data;return ls(n,t)||aa("Unrecognized data set: "+t),n[t]}function EB(e,t){kh(t)||aa("Second argument to changes must be a changeset.");const n=OB(this,e);return n.modified=!0,this.pulse(n.input,t)}function DB(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function jB(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function NB(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function SB(e,t,n){var r,i,o=e._renderer,a=o&&o.canvas();return a&&(i=NB(e),(r=GO(t.changedTouches?t.changedTouches[0]:t,a))[0]-=i[0],r[1]-=i[1]),t.dataflow=e,t.item=n,t.vega=function(e,t,n){const r=t?"group"===t.mark.marktype?t:t.mark.group:null;function i(e){var n,i=r;if(e)for(n=t;n;n=n.mark.group)if(n.mark.name===e){i=n;break}return i&&i.mark&&i.mark.interactive?i:{}}function o(e){if(!e)return n;bs(e)&&(e=i(e));const t=n.slice();for(;e;)t[0]-=e.x||0,t[1]-=e.y||0,e=e.mark&&e.mark.group;return t}return{view:ns(e),item:ns(t||{}),group:i,xy:o,x:e=>o(e)[0],y:e=>o(e)[1]}}(e,n,r),t}const AB="view",$B={trap:!1};function CB(e,t,n,r){e._eventListeners.push({type:n,sources:Ga(t),handler:r})}function MB(e,t,n){const r=e._eventConfig&&e._eventConfig[t];return!(!1===r||_a(r)&&!r[n])||(e.warn(`Blocked ${t} ${n} event listener.`),!1)}function PB(e){return e.item}function FB(e){return e.item.mark.source}function TB(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function zB(e,t,n){const r=document.createElement(e);for(const i in t)r.setAttribute(i,t[i]);return null!=n&&(r.textContent=n),r}const RB="vega-bind",LB="vega-bind-name",BB="vega-bind-radio";function IB(e,t,n,r){const i=n.event||"input",o=()=>e.update(t.value);r.signal(n.signal,t.value),t.addEventListener(i,o),CB(r,t,i,o),e.set=e=>{t.value=e,t.dispatchEvent(function(e){return"undefined"!=typeof Event?new Event(e):{type:e}}(i))}}function UB(e,t,n,r){const i=r.signal(n.signal),o=zB("div",{class:RB}),a="radio"===n.input?o:o.appendChild(zB("label"));a.appendChild(zB("span",{class:LB},n.name||n.signal)),t.appendChild(o);let s=qB;switch(n.input){case"checkbox":s=WB;break;case"select":s=ZB;break;case"radio":s=HB;break;case"range":s=GB}s(e,a,n,i)}function qB(e,t,n,r){const i=zB("input");for(const o in n)"signal"!==o&&"element"!==o&&i.setAttribute("input"===o?"type":o,n[o]);i.setAttribute("name",n.signal),i.value=r,t.appendChild(i),i.addEventListener("input",(()=>e.update(i.value))),e.elements=[i],e.set=e=>i.value=e}function WB(e,t,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const o=zB("input",i);t.appendChild(o),o.addEventListener("change",(()=>e.update(o.checked))),e.elements=[o],e.set=e=>o.checked=!!e||null}function ZB(e,t,n,r){const i=zB("select",{name:n.signal}),o=n.labels||[];n.options.forEach(((e,t)=>{const n={value:e};VB(e,r)&&(n.selected=!0),i.appendChild(zB("option",n,(o[t]||e)+""))})),t.appendChild(i),i.addEventListener("change",(()=>{e.update(n.options[i.selectedIndex])})),e.elements=[i],e.set=e=>{for(let t=0,r=n.options.length;t<r;++t)if(VB(n.options[t],e))return void(i.selectedIndex=t)}}function HB(e,t,n,r){const i=zB("span",{class:BB}),o=n.labels||[];t.appendChild(i),e.elements=n.options.map(((t,a)=>{const s={type:"radio",name:n.signal,value:t};VB(t,r)&&(s.checked=!0);const l=zB("input",s);l.addEventListener("change",(()=>e.update(t)));const u=zB("label",{},(o[a]||t)+"");return u.prepend(l),i.appendChild(u),l})),e.set=t=>{const n=e.elements,r=n.length;for(let e=0;e<r;++e)VB(n[e].value,t)&&(n[e].checked=!0)}}function GB(e,t,n,r){r=void 0!==r?r:(+n.max+ +n.min)/2;const i=null!=n.max?n.max:Math.max(100,+r)||100,o=n.min||Math.min(0,i,+r)||0,a=n.step||wl(o,i,100),s=zB("input",{type:"range",name:n.signal,min:o,max:i,step:a});s.value=r;const l=zB("span",{},+r);t.appendChild(s),t.appendChild(l);const u=()=>{l.textContent=s.value,e.update(+s.value)};s.addEventListener("input",u),s.addEventListener("change",u),e.elements=[s],e.set=e=>{s.value=e,l.textContent=e}}function VB(e,t){return e===t||e+""==t+""}function YB(e,t,n,r,i,o){return(t=t||new r(e.loader())).initialize(n,DB(e),jB(e),NB(e),i,o).background(e.background())}function XB(e,t){return t?function(){try{t.apply(this,arguments)}catch(aa){e.error(aa)}}:null}function JB(e,t,n){if("string"==typeof t){if("undefined"==typeof document)return e.error("DOM document instance not found."),null;if(!(t=document.querySelector(t)))return e.error("Signal bind element not found: "+t),null}if(t&&n)try{t.textContent=""}catch(S9){t=null,e.error(S9)}return t}const QB=e=>+e||0;function KB(e){return _a(e)?{top:QB(e.top),bottom:QB(e.bottom),left:QB(e.left),right:QB(e.right)}:(e=>({top:e,bottom:e,left:e,right:e}))(QB(e))}async function eI(e,t,n,r){const i=uD(t),o=i&&i.headless;return o||aa("Unrecognized renderer type: "+t),await e.runAsync(),YB(e,null,null,o,n,r).renderAsync(e._scenegraph.root)}var tI="width",nI="height",rI="padding",iI={skip:!0};function oI(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===rI?r.left+r.right:0)}function aI(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===rI?r.top+r.bottom:0)}function sI(e,t){return t.modified&&ka(t.input.value)&&e.indexOf("_:vega:_")}function lI(e,t){return!("parent"===e||t instanceof Yh.proxy)}function uI(e,t,n,r){const i=e.element();i&&i.setAttribute("title",function(e){return null==e?"":ka(e)?cI(e):_a(e)&&!ms(e)?(t=e,Object.keys(t).map((e=>{const n=t[e];return e+": "+(ka(n)?cI(n):fI(n))})).join("\n")):e+"";var t}(r))}function cI(e){return"["+e.map(fI).join(", ")+"]"}function fI(e){return ka(e)?"[\u2026]":_a(e)&&!ms(e)?"{\u2026}":e}function dI(e,t){const n=this;if(t=t||{},Hh.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),null!=t.logLevel&&n.logLevel(t.logLevel),t.locale||e.locale){const r=is({},e.locale,t.locale);n.locale(Fd(r.number,r.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||sD.Canvas,n._scenegraph=new BO;const r=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||uI,n._redraw=!0,n._handler=(new dE).scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=function(e){const t=is({defaults:{}},e),n=(e,t)=>{t.forEach((t=>{ka(e[t])&&(e[t]=Cs(e[t]))}))};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=function(e,t,n){return vB(e,Yh,nB,n).parse(t)}(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map((e=>({state:null,param:is({},e)}))),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=oI(n,n._width),n._viewHeight=aI(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,function(e){var t=e._signals,n=t[tI],r=t[nI],i=t[rI];function o(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,(t=>{e._width=t.size,e._viewWidth=oI(e,t.size),o()}),{size:n}),e._resizeHeight=e.add(null,(t=>{e._height=t.size,e._viewHeight=aI(e,t.size),o()}),{size:r});const a=e.add(null,o,{pad:i});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,a.rank=i.rank+1}(n),function(e){e.add(null,(t=>(e._background=t.bg,e._resize=1,t.bg)),{bg:e._signals.background})}(n),function(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:kB,item:null}));e.on(e.events("view","mousemove"),t,((e,n)=>{const r=t.value,i=r?bs(r)?r:r.user:kB,o=n.item&&n.item.cursor||null;return r&&i===r.user&&o==r.item?r:{user:i,item:o}})),e.add(null,(function(t){let n=t.cursor,r=this.value;return bs(n)||(r=n.item,n=n.user),_B(e,n&&n!==kB?n:r||n),r}),{cursor:t})}(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function hI(e,t){return ls(e._signals,t)?e._signals[t]:aa("Unrecognized signal name: "+js(t))}function pI(e,t){const n=(e._targets||[]).filter((e=>e._update&&e._update.handler===t));return n.length?n[0]:null}function mI(e,t,n,r){let i=pI(n,r);return i||(i=XB(e,(()=>r(t,n.value))),i.handler=r,e.on(n,null,i)),e}function gI(e,t,n){const r=pI(t,n);return r&&t._targets.remove(r),e}ds(dI,Hh,{async evaluate(e,t,n){if(await Hh.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,function(e){var t=NB(e),n=DB(e),r=jB(e);e._renderer.background(e.background()),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach((t=>{try{t(n,r)}catch(aa){e.error(aa)}}))}(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(S9){this.error(S9)}return n&&fh(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=null!=e?e+"":null;return t!==this._desc&&wB(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const r=hI(this,e);return 1===arguments.length?r.value:this.update(r,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",KB(e)):KB(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(uD(e)||aa("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(Hh.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(hI(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:function(e,t,n,r,i,o){this.runAfter((a=>{let s=0;a._autosize=0,a.width()!==n&&(s=1,a.signal(tI,n,iI),a._resizeWidth.skip(!0)),a.height()!==r&&(s=1,a.signal(nI,r,iI),a._resizeHeight.skip(!0)),a._viewWidth!==e&&(a._resize=1,a._viewWidth=e),a._viewHeight!==t&&(a._resize=1,a._viewHeight=t),a._origin[0]===i[0]&&a._origin[1]===i[1]||(a._resize=1,a._origin=i),s&&a.run("enter"),o&&a.runAfter((e=>e.resize()))}),!1,1)},addEventListener(e,t,n){let r=t;return n&&!1===n.trap||(r=XB(this,t),r.raw=t),this._handler.on(e,r),this},removeEventListener(e,t){for(var n,r,i=this._handler.handlers(e),o=i.length;--o>=0;)if(r=i[o].type,n=i[o].handler,e===r&&(t===n||t===n.raw)){this._handler.off(r,n);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return mI(this,e,hI(this,e),t)},removeSignalListener(e,t){return gI(this,hI(this,e),t)},addDataListener(e,t){return mI(this,e,OB(this,e).values,t)},removeDataListener(e,t){return gI(this,OB(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=_B(this,null);this._globalCursor=!!e,t&&_B(this,t)}return this}return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:function(e,t){this._timers.push(function(e,t,n){var r=new WM,i=t;return null==t?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(e,t,n){t=+t,n=null==n?UM():+n,r._restart((function o(a){a+=i,r._restart(o,i+=t,n),e(a)}),t,n)},r.restart(e,t,n),r)}((function(t){e({timestamp:Date.now(),elapsed:t})}),t))},events:function(e,t,n){var r,i=this,o=new $h(n),a=function(n,r){i.runAsync(null,(()=>{e===AB&&function(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return!1!==r&&!0!==i&&(!0===r||!1===i||(r?r[t]:i?!i[t]:e.preventDefault()))}(i,t)&&n.preventDefault(),o.receive(SB(i,n,r))}))};if("timer"===e)MB(i,"timer",t)&&i.timer(a,t);else if(e===AB)MB(i,"view",t)&&i.addEventListener(t,a,$B);else if("window"===e?MB(i,"window",t)&&"undefined"!=typeof window&&(r=[window]):"undefined"!=typeof document&&MB(i,"selector",t)&&(r=Array.from(document.querySelectorAll(e))),r){for(var s=0,l=r.length;s<l;++s)r[s].addEventListener(t,a);CB(i,r,t,a)}else i.warn("Can not resolve event source: "+e);return o},finalize:function(){var e,t,n,r=this._tooltip,i=this._timers,o=this._eventListeners;for(e=i.length;--e>=0;)i[e].stop();for(e=o.length;--e>=0;)for(t=(n=o[e]).sources.length;--t>=0;)n.sources[t].removeEventListener(n.type,n.handler);return r&&r.call(this,this._handler,null,null,null),this},hover:function(e,t){return t=[t||"update",(e=[e||"hover"])[0]],this.on(this.events("view","mouseover",PB),FB,TB(e)),this.on(this.events("view","mouseout",PB),FB,TB(t)),this},data:function(e,t){return arguments.length<2?OB(this,e).values.value:EB.call(this,e,_h().remove(ha).insert(t))},change:EB,insert:function(e,t){return EB.call(this,e,_h().insert(t))},remove:function(e,t){return EB.call(this,e,_h().remove(t))},scale:function(e){var t=this._runtime.scales;return ls(t,e)||aa("Unrecognized scale or projection: "+e),t[e].value},initialize:function(e,t){const n=this,r=n._renderType,i=n._eventConfig.bind,o=uD(r);e=n._el=e?JB(n,e,!0):null,function(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),wB(t,e.description()))}(n),o||n.error("Unrecognized renderer type: "+r);const a=o.handler||dE,s=e?o.renderer:o.headless;return n._renderer=s?YB(n,n._renderer,e,s):null,n._handler=function(e,t,n,r){const i=new r(e.loader(),XB(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,NB(e),e);return t&&t.handlers().forEach((e=>{i.on(e.type,e.handler)})),i}(n,n._handler,e,a),n._redraw=!0,e&&"none"!==i&&(t=t?n._elBind=JB(n,t,!0):e.appendChild(zB("form",{class:"vega-bindings"})),n._bind.forEach((e=>{e.param.element&&"container"!==i&&(e.element=JB(n,e.param.element,!!e.param.input))})),n._bind.forEach((e=>{!function(e,t,n){if(!t)return;const r=n.param;let i=n.state;i||(i=n.state={elements:null,active:!1,set:null,update:t=>{t!=e.signal(r.signal)&&e.runAsync(null,(()=>{i.source=!0,e.signal(r.signal,t)}))}},r.debounce&&(i.update=rs(r.debounce,i.update))),(null==r.input&&r.element?IB:UB)(i,t,r,e),i.active||(e.on(e._signals[r.signal],null,(()=>{i.source?i.source=!1:i.set(e.signal(r.signal))})),i.active=!0)}(n,e.element||t,e)}))),n},toImageURL:async function(e,t){e!==sD.Canvas&&e!==sD.SVG&&e!==sD.PNG&&aa("Unrecognized image type: "+e);const n=await eI(this,e,t);return e===sD.SVG?function(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")},toCanvas:async function(e,t){return(await eI(this,sD.Canvas,e,t)).canvas()},toSVG:async function(e){return(await eI(this,sD.SVG,e)).svg()},getState:function(e){return this._runtime.getState(e||{data:sI,signals:lI,recurse:!0})},setState:function(e){return this.runAsync(null,(t=>{t._trigger=!1,t._runtime.setState(e)}),(e=>{e._trigger=!0})),this}});const yI="view",vI="[",bI="]",xI="{",wI="}",kI=":",_I=",",OI="@",EI=">",DI=/[[\]{}]/,jI={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let NI,SI;function AI(e,t,n){return NI=t||yI,SI=n||jI,CI(e.trim()).map(MI)}function $I(e,t,n,r,i){const o=e.length;let a,s=0;for(;t<o;++t){if(a=e[t],!s&&a===n)return t;i&&i.indexOf(a)>=0?--s:r&&r.indexOf(a)>=0&&++s}return t}function CI(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=$I(e,i,_I,vI+xI,bI+wI),t.push(e.substring(r,i).trim()),r=++i;if(0===t.length)throw"Empty event selector: "+e;return t}function MI(e){return"["===e[0]?function(e){const t=e.length;let n,r=1;if(r=$I(e,r,bI,vI,bI),r===t)throw"Empty between selector: "+e;if(n=CI(e.substring(1,r)),2!==n.length)throw"Between selector must have two elements: "+e;if(e=e.slice(r+1).trim(),e[0]!==EI)throw"Expected '>' after between selector: "+e;n=n.map(MI);const i=MI(e.slice(1).trim());if(i.between)return{between:n,stream:i};i.between=n;return i}(e):function(e){const t={source:NI},n=[];let r,i,o=[0,0],a=0,s=0,l=e.length,u=0;if(e[l-1]===wI){if(u=e.lastIndexOf(xI),!(u>=0))throw"Unmatched right brace: "+e;try{o=function(e){const t=e.split(_I);if(!e.length||t.length>2)throw e;return t.map((t=>{const n=+t;if(n!=n)throw e;return n}))}(e.substring(u+1,l-1))}catch(S9){throw"Invalid throttle specification: "+e}l=(e=e.slice(0,u).trim()).length,u=0}if(!l)throw e;e[0]===OI&&(a=++u);r=$I(e,u,kI),r<l&&(n.push(e.substring(s,r).trim()),s=u=++r);if(u=$I(e,u,vI),u===l)n.push(e.substring(s,l).trim());else if(n.push(e.substring(s,u).trim()),i=[],s=++u,s===l)throw"Unmatched left bracket: "+e;for(;u<l;){if(u=$I(e,u,bI),u===l)throw"Unmatched left bracket: "+e;if(i.push(e.substring(s,u).trim()),u<l-1&&e[++u]!==vI)throw"Expected left bracket: "+e;s=++u}if(!(l=n.length)||DI.test(n[l-1]))throw"Invalid event selector: "+e;l>1?(t.type=n[1],a?t.markname=n[0].slice(1):!function(e){return SI[e]}(n[0])?t.source=n[0]:t.marktype=n[0]):t.type=n[0];"!"===t.type.slice(-1)&&(t.consume=!0,t.type=t.type.slice(0,-1));null!=i&&(t.filter=i);o[0]&&(t.throttle=o[0]);o[1]&&(t.debounce=o[1]);return t}(e)}function PI(e){return _a(e)?e:{type:e||"pad"}}const FI=e=>+e||0,TI=e=>({top:e,bottom:e,left:e,right:e});function zI(e){return _a(e)?e.signal?e:{top:FI(e.top),bottom:FI(e.bottom),left:FI(e.left),right:FI(e.right)}:TI(FI(e))}const RI=e=>_a(e)&&!ka(e)?is({},e):{value:e};function LI(e,t,n,r){if(null!=n){return _a(n)&&!ka(n)||ka(n)&&n.length&&_a(n[0])?e.update[t]=n:e[r||"enter"][t]={value:n},1}return 0}function BI(e,t,n){for(const r in t)LI(e,r,t[r]);for(const r in n)LI(e,r,n[r],"update")}function II(e,t,n){for(const r in t)n&&ls(n,r)||(e[r]=is(e[r]||{},t[r]));return e}function UI(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const qI="mark",WI="frame",ZI="scope",HI="axis",GI="axis-domain",VI="axis-grid",YI="axis-label",XI="axis-tick",JI="axis-title",QI="legend",KI="legend-band",eU="legend-entry",tU="legend-gradient",nU="legend-label",rU="legend-symbol",iU="legend-title",oU="title",aU="title-text",sU="title-subtitle";function lU(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const uU=e=>bs(e)?js(e):e.signal?`(${e.signal})`:hU(e);function cU(e){if(null!=e.gradient)return function(e){const t=[e.start,e.stop,e.count].map((e=>null==e?null:js(e)));for(;t.length&&null==Na(t);)t.pop();return t.unshift(uU(e.gradient)),`gradient(${t.join(",")})`}(e);let t=e.signal?`(${e.signal})`:e.color?function(e){return e.c?fU("hcl",e.h,e.c,e.l):e.h||e.s?fU("hsl",e.h,e.s,e.l):e.l||e.a?fU("lab",e.l,e.a,e.b):e.r||e.g||e.b?fU("rgb",e.r,e.g,e.b):null}(e.color):null!=e.field?hU(e.field):void 0!==e.value?js(e.value):void 0;return null!=e.scale&&(t=function(e,t){const n=uU(e.scale);null!=e.range?t=`lerp(_range(${n}), ${+e.range})`:(void 0!==t&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(1==+e.band?"":"*"+dU(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),null==t&&(t="0"));return t}(e,t)),void 0===t&&(t=null),null!=e.exponent&&(t=`pow(${t},${dU(e.exponent)})`),null!=e.mult&&(t+=`*${dU(e.mult)}`),null!=e.offset&&(t+=`+${dU(e.offset)}`),e.round&&(t=`round(${t})`),t}const fU=(e,t,n,r)=>`(${e}(${[t,n,r].map(cU).join(",")})+'')`;function dU(e){return _a(e)?"("+cU(e)+")":e}function hU(e){return pU(_a(e)?e:{datum:e})}function pU(e){let t,n,r;if(e.signal)t="datum",r=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(r=e.parent,t+=".datum"):r=e.group}else e.datum?(t="datum",r=e.datum):aa("Invalid field reference: "+js(e));return e.signal||(r=bs(r)?sa(r).map(js).join("]["):pU(r)),t+"["+r+"]"}function mU(e,t,n,r,i,o){const a={};(o=o||{}).encoders={$encode:a},e=function(e,t,n,r,i){const o={},a={};let s,l,u,c;for(l in l="lineBreak","text"!==t||null==i[l]||UI(l,e)||lU(o,l,i[l]),("legend"==n||String(n).startsWith("axis"))&&(n=null),c=n===WI?i.group:n===qI?is({},i.mark,i[t]):null,c)u=UI(l,e)||("fill"===l||"stroke"===l)&&(UI("fill",e)||UI("stroke",e)),u||lU(o,l,c[l]);for(l in Ga(r).forEach((t=>{const n=i.style&&i.style[t];for(const r in n)UI(r,e)||lU(o,r,n[r])})),e=is({},e),o)c=o[l],c.signal?(s=s||{})[l]=c:a[l]=c;return e.enter=is(a,e.enter),s&&(e.update=is(s,e.update)),e}(e,t,n,r,i.config);for(const s in e)a[s]=gU(e[s],t,o,i);return o}function gU(e,t,n,r){const i={},o={};for(const s in e)null!=e[s]&&(i[s]=yU((a=e[s],ka(a)?function(e){let t="";return e.forEach((e=>{const n=cU(e);t+=e.test?`(${e.test})?${n}:`:n})),":"===Na(t)&&(t+="null"),t}(a):cU(a)),r,n,o));var a;return{$expr:{marktype:t,channels:i},$fields:Object.keys(o),$output:Object.keys(e)}}function yU(e,t,n,r){const i=uB(e,t);return i.$fields.forEach((e=>r[e]=1)),is(n,i.$params),i.$expr}const vU="outer",bU=["value","update","init","react","bind"];function xU(e,t){aa(e+' for "outer" push: '+js(t))}function wU(e,t){const n=e.name;if(e.push===vU)t.signals[n]||xU("No prior signal definition",n),bU.forEach((t=>{void 0!==e[t]&&xU("Invalid property ",t)}));else{const r=t.addSignal(n,e.value);!1===e.react&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function kU(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function _U(e,t,n,r){return new kU(e,t,n,r)}function OU(e,t){return _U("operator",e,t)}function EU(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function DU(e,t){return t?{$field:e,$name:t}:{$field:e}}const jU=DU("key");function NU(e,t){return{$compare:e,$order:t}}const SU="descending";function AU(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const $U="scope",CU="view";function MU(e){return e&&e.signal}function PU(e){if(MU(e))return!0;if(_a(e))for(const t in e)if(PU(e[t]))return!0;return!1}function FU(e,t){return null!=e?e:t}function TU(e){return e&&e.signal||e}const zU="timer";function RU(e,t){return(e.merge?LU:e.stream?BU:e.type?IU:aa("Invalid stream specification: "+js(e)))(e,t)}function LU(e,t){const n=UU({merge:e.merge.map((e=>RU(e,t)))},e,t);return t.addStream(n).id}function BU(e,t){const n=UU({stream:RU(e.stream,t)},e,t);return t.addStream(n).id}function IU(e,t){let n;e.type===zU?(n=t.event(zU,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(function(e){return e===$U?CU:e||CU}(e.source),e.type);const r=UU({stream:n},e,t);return 1===Object.keys(r).length?n:t.addStream(r).id}function UU(e,t,n){let r=t.between;return r&&(2!==r.length&&aa('Stream "between" parameter must have 2 entries: '+js(t)),e.between=[RU(r[0],n),RU(r[1],n)]),r=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push(function(e,t,n){const r="event.item";return r+(e&&"*"!==e?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}(t.marktype,t.markname,t.markrole)),t.source===$U&&r.push("inScope(event.item)"),r.length&&(e.filter=uB("("+r.join(")&&(")+")",n).$expr),null!=(r=t.throttle)&&(e.throttle=+r),null!=(r=t.debounce)&&(e.debounce=+r),t.consume&&(e.consume=!0),e}const qU={code:"_.$value",ast:{type:"Identifier",value:"value"}};function WU(e,t,n){const r=e.encode,i={target:n};let o=e.events,a=e.update,s=[];o||aa("Signal update missing events specification."),bs(o)&&(o=AI(o,t.isSubscope()?$U:CU)),o=Ga(o).filter((e=>e.signal||e.scale?(s.push(e),0):1)),s.length>1&&(s=[ZU(s)]),o.length&&s.push(o.length>1?{merge:o}:o[0]),null!=r&&(a&&aa("Signal encode and update are mutually exclusive."),a="encode(item(),"+js(r)+")"),i.update=bs(a)?uB(a,t):null!=a.expr?uB(a.expr,t):null!=a.value?a.value:null!=a.signal?{$expr:qU,$params:{$value:t.signalRef(a.signal)}}:aa("Invalid signal update specification."),e.force&&(i.options={force:!0}),s.forEach((e=>t.addUpdate(is(function(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):RU(e,t)}}(e,t),i))))}function ZU(e){return{signal:"["+e.map((e=>e.scale?'scale("'+e.scale+'")':e.signal))+"]"}}const HU=e=>(t,n,r)=>_U(e,n,t||void 0,r),GU=HU("aggregate"),VU=HU("axisticks"),YU=HU("bound"),XU=HU("collect"),JU=HU("compare"),QU=HU("datajoin"),KU=HU("encode"),eq=HU("expression"),tq=HU("facet"),nq=HU("field"),rq=HU("key"),iq=HU("legendentries"),oq=HU("load"),aq=HU("mark"),sq=HU("multiextent"),lq=HU("multivalues"),uq=HU("overlap"),cq=HU("params"),fq=HU("prefacet"),dq=HU("projection"),hq=HU("proxy"),pq=HU("relay"),mq=HU("render"),gq=HU("scale"),yq=HU("sieve"),vq=HU("sortitems"),bq=HU("viewlayout"),xq=HU("values");let wq=0;const kq={min:"min",max:"max",count:"sum"};function _q(e,t){const n=t.getScale(e.name).params;let r;for(r in n.domain=jq(e.domain,e,t),null!=e.range&&(n.range=Fq(e,t,n)),null!=e.interpolate&&function(e,t){t.interpolate=Oq(e.type||e),null!=e.gamma&&(t.interpolateGamma=Oq(e.gamma))}(e.interpolate,n),null!=e.nice&&(n.nice=function(e){return _a(e)?{interval:Oq(e.interval),step:Oq(e.step)}:Oq(e)}(e.nice)),null!=e.bins&&(n.bins=function(e,t){return e.signal||ka(e)?Eq(e,t):t.objectProperty(e)}(e.bins,t)),e)ls(n,r)||"name"===r||(n[r]=Oq(e[r],t))}function Oq(e,t){return _a(e)?e.signal?t.signalRef(e.signal):aa("Unsupported object: "+js(e)):e}function Eq(e,t){return e.signal?t.signalRef(e.signal):e.map((e=>Oq(e,t)))}function Dq(e){aa("Can not find data set: "+js(e))}function jq(e,t,n){if(e)return e.signal?n.signalRef(e.signal):(ka(e)?Nq:e.fields?Aq:Sq)(e,t,n);null==t.domainMin&&null==t.domainMax||aa("No scale domain defined for domainMin/domainMax to override.")}function Nq(e,t,n){return e.map((e=>Oq(e,n)))}function Sq(e,t,n){const r=n.getData(e.data);return r||Dq(e.data),Jx(t.type)?r.valuesRef(n,e.field,Cq(e.sort,!1)):tw(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function Aq(e,t,n){const r=e.data,i=e.fields.reduce(((e,t)=>(t=bs(t)?{data:r,field:t}:ka(t)||t.signal?function(e,t){const n="_:vega:_"+wq++,r=XU({});if(ka(e))r.value={$ingest:e};else if(e.signal){const i="setdata("+js(n)+","+e.signal+")";r.params.input=t.signalRef(i)}return t.addDataPipeline(n,[r,yq({})]),{data:n,field:"data"}}(t,n):t,e.push(t),e)),[]);return(Jx(t.type)?$q:tw(t.type)?Mq:Pq)(e,n,i)}function $q(e,t,n){const r=Cq(e.sort,!0);let i,o;const a=n.map((e=>{const n=t.getData(e.data);return n||Dq(e.data),n.countsRef(t,e.field,r)})),s={groupby:jU,pulse:a};r&&(i=r.op||"count",o=r.field?AU(i,r.field):"count",s.ops=[kq[i]],s.fields=[t.fieldRef(o)],s.as=[o]),i=t.add(GU(s));const l=t.add(XU({pulse:EU(i)}));return o=t.add(xq({field:jU,sort:t.sortRef(r),pulse:EU(l)})),EU(o)}function Cq(e,t){return e&&(e.field||e.op?e.field||"count"===e.op?t&&e.field&&e.op&&!kq[e.op]&&aa("Multiple domain scales can not be sorted using "+e.op):aa("No field provided for sort aggregate op: "+e.op):_a(e)?e.field="key":e={field:"key"}),e}function Mq(e,t,n){const r=n.map((e=>{const n=t.getData(e.data);return n||Dq(e.data),n.domainRef(t,e.field)}));return EU(t.add(lq({values:r})))}function Pq(e,t,n){const r=n.map((e=>{const n=t.getData(e.data);return n||Dq(e.data),n.extentRef(t,e.field)}));return EU(t.add(sq({extents:r})))}function Fq(e,t,n){const r=t.config.range;let i=e.range;if(i.signal)return t.signalRef(i.signal);if(bs(i)){if(r&&ls(r,i))return Fq(e=is({},e,{range:r[i]}),t,n);"width"===i?i=[0,{signal:"width"}]:"height"===i?i=Jx(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:aa("Unrecognized scale range value: "+js(i))}else{if(i.scheme)return n.scheme=ka(i.scheme)?Eq(i.scheme,t):Oq(i.scheme,t),i.extent&&(n.schemeExtent=Eq(i.extent,t)),void(i.count&&(n.schemeCount=Oq(i.count,t)));if(i.step)return void(n.rangeStep=Oq(i.step,t));if(Jx(e.type)&&!ka(i))return jq(i,e,t);ka(i)||aa("Unsupported range type: "+js(i))}return i.map((e=>(ka(e)?Eq:Oq)(e,t)))}function Tq(e,t,n){return ka(e)?e.map((e=>Tq(e,t,n))):_a(e)?e.signal?n.signalRef(e.signal):"fit"===t?e:aa("Unsupported parameter object: "+js(e)):e}const zq="top",Rq="left",Lq="right",Bq="bottom",Iq="center",Uq="vertical",qq="start",Wq="end",Zq="index",Hq="label",Gq="offset",Vq="perc",Yq="perc2",Xq="value",Jq="guide-label",Qq="guide-title",Kq="group-title",eW="group-subtitle",tW="symbol",nW="gradient",rW="discrete",iW="size",oW=[iW,"shape","fill","stroke","strokeWidth","strokeDash","opacity"],aW={name:1,style:1,interactive:1},sW={value:0},lW={value:1},uW="group",cW="rect",fW="rule",dW="symbol",hW="text";function pW(e){return e.type=uW,e.interactive=e.interactive||!1,e}function mW(e,t){const n=(n,r)=>FU(e[n],FU(t[n],r));return n.isVertical=n=>Uq===FU(e.direction,t.direction||(n?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>FU(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>FU(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>FU(e.columns,FU(t.columns,+n.isVertical(!0))),n}function gW(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function yW(e,t,n){return`item.anchor === '${qq}' ? ${e} : item.anchor === '${Wq}' ? ${t} : ${n}`}const vW=yW(js(Rq),js(Lq),js(Iq));function bW(e,t){return t?e?_a(e)?Object.assign({},e,{offset:bW(e.offset,t)}):{value:e,offset:t}:t:e}function xW(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=II(e.encode,t,aW)):e.interactive=!1,e}function wW(e,t,n,r){const i=mW(e,n),o=i.isVertical(),a=i.gradientThickness(),s=i.gradientLength();let l,u,c,f,d;o?(u=[0,1],c=[0,0],f=a,d=s):(u=[0,0],c=[1,0],f=s,d=a);const h={enter:l={opacity:sW,x:sW,y:sW,width:RI(f),height:RI(d)},update:is({},l,{opacity:lW,fill:{gradient:t,start:u,stop:c}}),exit:{opacity:sW}};return BI(h,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),xW({type:cW,role:tU,encode:h},r)}function kW(e,t,n,r,i){const o=mW(e,n),a=o.isVertical(),s=o.gradientThickness(),l=o.gradientLength();let u,c,f,d,h="";a?(u="y",f="y2",c="x",d="width",h="1-"):(u="x",f="x2",c="y",d="height");const p={opacity:sW,fill:{scale:t,field:Xq}};p[u]={signal:h+"datum."+Vq,mult:l},p[c]=sW,p[f]={signal:h+"datum."+Yq,mult:l},p[d]=RI(s);const m={enter:p,update:is({},p,{opacity:lW}),exit:{opacity:sW}};return BI(m,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")}),xW({type:cW,role:KI,key:Xq,from:i,encode:m},r)}const _W=`datum.${Vq}<=0?"${Rq}":datum.${Vq}>=1?"${Lq}":"${Iq}"`,OW=`datum.${Vq}<=0?"${Bq}":datum.${Vq}>=1?"${zq}":"middle"`;function EW(e,t,n,r){const i=mW(e,t),o=i.isVertical(),a=RI(i.gradientThickness()),s=i.gradientLength();let l,u,c,f,d=i("labelOverlap"),h="";const p={enter:l={opacity:sW},update:u={opacity:lW,text:{field:Hq}},exit:{opacity:sW}};return BI(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:FU(e.labelLimit,t.gradientLabelLimit)}),o?(l.align={value:"left"},l.baseline=u.baseline={signal:OW},c="y",f="x",h="1-"):(l.align=u.align={signal:_W},l.baseline={value:"top"},c="x",f="y"),l[c]=u[c]={signal:h+"datum."+Vq,mult:s},l[f]=u[f]=a,a.offset=FU(e.labelOffset,t.gradientLabelOffset)||0,d=d?{separation:i("labelSeparation"),method:d,order:"datum."+Zq}:void 0,xW({type:hW,role:nU,style:Jq,key:Xq,from:r,encode:p,overlap:d},n)}function DW(e,t,n,r,i){const o=mW(e,t),a=n.entries,s=!(!a||!a.interactive),l=a?a.name:void 0,u=o("clipHeight"),c=o("symbolOffset"),f={data:"value"},d=`(${i}) ? datum.${Gq} : datum.${iW}`,h=u?RI(u):{field:iW},p=`datum.${Zq}`,m=`max(1, ${i})`;let g,y,v,b,x;h.mult=.5,g={enter:y={opacity:sW,x:{signal:d,mult:.5,offset:c},y:h},update:v={opacity:lW,x:y.x,y:y.y},exit:{opacity:sW}};let w=null,k=null;e.fill||(w=t.symbolBaseFillColor,k=t.symbolBaseStrokeColor),BI(g,{fill:o("symbolFillColor",w),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",k),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")}),oW.forEach((t=>{e[t]&&(v[t]=y[t]={scale:e[t],field:Xq})}));const _=xW({type:dW,role:rU,key:Xq,from:f,clip:!!u||void 0,encode:g},n.symbols),O=RI(c);O.offset=o("labelOffset"),g={enter:y={opacity:sW,x:{signal:d,offset:O},y:h},update:v={opacity:lW,text:{field:Hq},x:y.x,y:y.y},exit:{opacity:sW}},BI(g,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});const E=xW({type:hW,role:nU,style:Jq,key:Xq,from:f,encode:g},n.labels);return g={enter:{noBound:{value:!u},width:sW,height:u?RI(u):sW,opacity:sW},exit:{opacity:sW},update:v={opacity:lW,row:{signal:null},column:{signal:null}}},o.isVertical(!0)?(b=`ceil(item.mark.items.length / ${m})`,v.row.signal=`${p}%${b}`,v.column.signal=`floor(${p} / ${b})`,x={field:["row",p]}):(v.row.signal=`floor(${p} / ${m})`,v.column.signal=`${p} % ${m}`,x={field:p}),v.column.signal=`(${i})?${v.column.signal}:${p}`,pW({role:ZI,from:r={facet:{data:r,name:"value",groupby:Zq}},encode:II(g,a,aW),marks:[_,E],name:l,interactive:s,sort:x})}const jW='item.orient === "left"',NW='item.orient === "right"',SW=`(${jW} || ${NW})`,AW=`datum.vgrad && ${SW}`,$W=yW('"top"','"bottom"','"middle"'),CW=`datum.vgrad && ${NW} ? (${yW('"right"','"left"','"center"')}) : (${SW} && !(datum.vgrad && ${jW})) ? "left" : ${vW}`,MW=`item._anchor || (${SW} ? "middle" : "start")`,PW=`${AW} ? (${jW} ? -90 : 90) : 0`,FW=`${SW} ? (datum.vgrad ? (${NW} ? "bottom" : "top") : ${$W}) : "top"`;function TW(e,t){let n;return _a(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+zW(e.path)+")":e.sphere&&(n="geoShape("+zW(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function zW(e){return _a(e)&&e.signal?e.signal:js(e)}function RW(e){const t=e.role||"";return t.indexOf("axis")&&t.indexOf("legend")&&t.indexOf("title")?e.type===uW?ZI:t||qI:t}function LW(e){return{marktype:e.type,name:e.name||void 0,role:e.role||RW(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function BW(e,t){return e&&e.signal?t.signalRef(e.signal):!1!==e}function IW(e,t){const n=Xh(e.type);n||aa("Unrecognized transform type: "+js(e.type));const r=_U(n.type.toLowerCase(),null,UW(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function UW(e,t,n){const r={},i=e.params.length;for(let o=0;o<i;++o){const i=e.params[o];r[i.name]=qW(i,t,n)}return r}function qW(e,t,n){const r=e.type,i=t[e.name];return"index"===r?function(e,t,n){bs(t.from)||aa('Lookup "from" parameter must be a string literal.');return n.getData(t.from).lookupRef(n,t.key)}(0,t,n):void 0!==i?"param"===r?function(e,t,n){const r=t[e.name];return e.array?(ka(r)||aa("Expected an array of sub-parameters. Instead: "+js(r)),r.map((t=>ZW(e,t,n)))):ZW(e,r,n)}(e,t,n):"projection"===r?n.projectionRef(t[e.name]):e.array&&!MU(i)?i.map((t=>WW(e,t,n))):WW(e,i,n):void(e.required&&aa("Missing required "+js(t.type)+" parameter: "+js(e.name)))}function WW(e,t,n){const r=e.type;if(MU(t))return YW(r)?aa("Expression references can not be signals."):XW(r)?n.fieldRef(t):JW(r)?n.compareRef(t):n.signalRef(t.signal);{const i=e.expr||XW(r);return i&&HW(t)?n.exprRef(t.expr,t.as):i&&GW(t)?DU(t.field,t.as):YW(r)?uB(t,n):VW(r)?EU(n.getData(t).values):XW(r)?DU(t):JW(r)?n.compareRef(t):t}}function ZW(e,t,n){const r=e.params.length;let i;for(let a=0;a<r;++a){i=e.params[a];for(const e in i.key)if(i.key[e]!==t[e]){i=null;break}if(i)break}i||aa("Unsupported parameter: "+js(t));const o=is(UW(i,t,n),i.key);return EU(n.add(cq(o)))}const HW=e=>e&&e.expr,GW=e=>e&&e.field,VW=e=>"data"===e,YW=e=>"expr"===e,XW=e=>"field"===e,JW=e=>"compare"===e;function QW(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:EU(t.getData(e.data).output)}function KW(e,t,n,r,i){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=i,this.index={}}function eZ(e){return bs(e)?e:null}function tZ(e,t,n){const r=AU(n.op,n.field);let i;if(t.ops){for(let o=0,a=t.as.length;o<a;++o)if(t.as[o]===r)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((i=n.op.signal)?e.signalRef(i):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(r))}function nZ(e,t,n,r,i,o,a){const s=t[n]||(t[n]={}),l=function(e){return _a(e)?(e.order===SU?"-":"+")+AU(e.op,e.field):""}(o);let u,c,f=eZ(i);if(null!=f&&(e=t.scope,f+=l?"|"+l:"",u=s[f]),!u){const n=o?{field:jU,pulse:t.countsRef(e,i,o)}:{field:e.fieldRef(i),pulse:EU(t.output)};l&&(n.sort=e.sortRef(o)),c=e.add(_U(r,void 0,n)),a&&(t.index[i]=c),u=EU(c),null!=f&&(s[f]=u)}return u}function rZ(e,t,n){const r=e.remove,i=e.insert,o=e.toggle,a=e.modify,s=e.values,l=t.add(OU()),u=uB("if("+e.trigger+',modify("'+n+'",'+[i,r,o,a,s].map((e=>null==e?"null":e)).join(",")+"),0)",t);l.update=u.$expr,l.params=u.$params}function iZ(e,t){const n=RW(e),r=e.type===uW,i=e.from&&e.from.facet,o=e.overlap;let a,s,l,u,c,f,d,h=e.layout||n===ZI||n===WI;const p=n===qI||h||i,m=function(e,t,n){let r,i,o,a,s;return e?(r=e.facet)&&(t||aa("Only group marks can be faceted."),null!=r.field?a=s=QW(r,n):(e.data?s=EU(n.getData(e.data).aggregate):(o=IW(is({type:"aggregate",groupby:Ga(r.groupby)},r.aggregate),n),o.params.key=n.keyRef(r.groupby),o.params.pulse=QW(r,n),a=s=EU(n.add(o))),i=n.keyRef(r.groupby,!0))):a=EU(n.add(XU(null,[{}]))),a||(a=QW(e,n)),{key:i,pulse:a,parent:s}}(e.from,r,t);s=t.add(QU({key:m.key||(e.key?DU(e.key):void 0),pulse:m.pulse,clean:!r}));const g=EU(s);s=l=t.add(XU({pulse:g})),s=t.add(aq({markdef:LW(e),interactive:BW(e.interactive,t),clip:TW(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:EU(s)}));const y=EU(s);s=u=t.add(KU(mU(e.encode,e.type,n,e.style,t,{mod:!1,pulse:y}))),s.params.parent=t.encode(),e.transform&&e.transform.forEach((e=>{const n=IW(e,t),r=n.metadata;(r.generates||r.changes)&&aa("Mark transforms should not generate new data."),r.nomod||(u.params.mod=!0),n.params.pulse=EU(s),t.add(s=n)})),e.sort&&(s=t.add(vq({sort:t.compareRef(e.sort),pulse:EU(s)})));const v=EU(s);(i||h)&&(h=t.add(bq({layout:t.objectProperty(e.layout),legends:t.legends,mark:y,pulse:v})),f=EU(h));const b=t.add(YU({mark:y,pulse:f||v}));d=EU(b),r&&(p&&(a=t.operators,a.pop(),h&&a.pop()),t.pushState(v,f||d,g),i?function(e,t,n){const r=e.from.facet,i=r.name,o=QW(r,t);let a;r.name||aa("Facet must have a name: "+js(r)),r.data||aa("Facet must reference a data set: "+js(r)),r.field?a=t.add(fq({field:t.fieldRef(r.field),pulse:o})):r.groupby?a=t.add(tq({key:t.keyRef(r.groupby),group:EU(t.proxy(n.parent)),pulse:o})):aa("Facet must specify groupby or field: "+js(r));const s=t.fork(),l=s.add(XU()),u=s.add(yq({pulse:EU(l)}));s.addData(i,new KW(s,l,l,u)),s.addSignal("parent",null),a.params.subflow={$subflow:s.parse(e).toRuntime()}}(e,t,m):p?function(e,t,n){const r=t.add(fq({pulse:n.pulse})),i=t.fork();i.add(yq()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(e).toRuntime()}}(e,t,m):t.parse(e),t.popState(),p&&(h&&a.push(h),a.push(b))),o&&(d=function(e,t,n){const r=e.method,i=e.bound,o=e.separation,a={separation:MU(o)?n.signalRef(o.signal):o,method:MU(r)?n.signalRef(r.signal):r,pulse:t};e.order&&(a.sort=n.compareRef({field:e.order}));if(i){const e=i.tolerance;a.boundTolerance=MU(e)?n.signalRef(e.signal):+e,a.boundScale=n.scaleRef(i.scale),a.boundOrient=i.orient}return EU(n.add(uq(a)))}(o,d,t));const x=t.add(mq({pulse:d})),w=t.add(yq({pulse:EU(x)},void 0,t.parent()));null!=e.name&&(c=e.name,t.addData(c,new KW(t,l,x,w)),e.on&&e.on.forEach((e=>{(e.insert||e.remove||e.toggle)&&aa("Marks only support modify triggers."),rZ(e,t,c)})))}function oZ(e,t){const n=t.config.legend,r=e.encode||{},i=mW(e,n),o=r.legend||{},a=o.name||void 0,s=o.interactive,l=o.style,u={};let c,f,d,h=0;oW.forEach((t=>e[t]?(u[t]=e[t],h=h||e[t]):0)),h||aa("Missing valid scale for legend.");const p=function(e,t){let n=e.type||tW;e.type||1!==function(e){return oW.reduce(((t,n)=>t+(e[n]?1:0)),0)}(e)||!e.fill&&!e.stroke||(n=Xx(t)?nW:Qx(t)?rW:tW);return n!==nW?n:Qx(t)?rW:nW}(e,t.scaleType(h)),m={title:null!=e.title,scales:u,type:p,vgrad:"symbol"!==p&&i.isVertical()},g=EU(t.add(XU(null,[m]))),y=EU(t.add(iq(f={type:p,scale:t.scaleRef(h),count:t.objectProperty(i("tickCount")),limit:t.property(i("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return p===nW?(d=[wW(e,h,n,r.gradient),EW(e,n,r.labels,y)],f.count=f.count||t.signalRef(`max(2,2*floor((${TU(i.gradientLength())})/100))`)):p===rW?d=[kW(e,h,n,r.gradient,y),EW(e,n,r.labels,y)]:(c=function(e,t){const n=mW(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}(e,n),d=[DW(e,n,r,y,TU(c.columns))],f.size=function(e,t,n){const r=TU(sZ("size",e,n)),i=TU(sZ("strokeWidth",e,n)),o=TU(function(e,t,n){return gW("fontSize",e)||function(e,t,n){const r=t.config.style[n];return r&&r[e]}("fontSize",t,n)}(n[1].encode,t,Jq));return uB(`max(ceil(sqrt(${r})+${i}),${o})`,t)}(e,t,d[0].marks)),d=[pW({role:eU,from:g,encode:{enter:{x:{value:0},y:{value:0}}},marks:d,layout:c,interactive:s})],m.title&&d.push(function(e,t,n,r){const i=mW(e,t),o={enter:{opacity:sW},update:{opacity:lW,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:sW}};return BI(o,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:MW},angle:{signal:PW},align:{signal:CW},baseline:{signal:FW},text:e.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),xW({type:hW,role:iU,style:Qq,from:r,encode:o},n)}(e,n,r.title,g)),iZ(pW({role:QI,from:g,encode:II(aZ(i,e,n),o,aW),marks:d,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:a,interactive:s,style:l}),t)}function aZ(e,t,n){const r={enter:{},update:{}};return BI(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function sZ(e,t,n){return t[e]?`scale("${t[e]}",datum)`:gW(e,n[0].encode)}KW.fromEntries=function(e,t){const n=t.length,r=t[n-1],i=t[n-2];let o=t[0],a=null,s=1;for(o&&"load"===o.type&&(o=t[1]),e.add(t[0]);s<n;++s)t[s].params.pulse=EU(t[s-1]),e.add(t[s]),"aggregate"===t[s].type&&(a=t[s]);return new KW(e,o,i,r,a)},KW.prototype={countsRef(e,t,n){const r=this,i=r.counts||(r.counts={}),o=eZ(t);let a,s,l;return null!=o&&(e=r.scope,a=i[o]),a?n&&n.field&&tZ(e,a.agg.params,n):(l={groupby:e.fieldRef(t,"key"),pulse:EU(r.output)},n&&n.field&&tZ(e,l,n),s=e.add(GU(l)),a=e.add(XU({pulse:EU(s)})),a={agg:s,ref:EU(a)},null!=o&&(i[o]=a)),a.ref},tuplesRef(){return EU(this.values)},extentRef(e,t){return nZ(e,this,"extent","extent",t,!1)},domainRef(e,t){return nZ(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return nZ(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return nZ(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return nZ(e,this,"indata","tupleindex",t,!0,!0)}};const lZ=`item.orient==="${Rq}"?-90:item.orient==="${Lq}"?90:0`;function uZ(e,t){const n=mW(e=bs(e)?{text:e}:e,t.config.title),r=e.encode||{},i=r.group||{},o=i.name||void 0,a=i.interactive,s=i.style,l=[],u=EU(t.add(XU(null,[{}])));return l.push(function(e,t,n,r){const i={value:0},o=e.text,a={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return BI(a,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),xW({type:hW,role:aU,style:Kq,from:r,encode:a},n)}(e,n,function(e){const t=e.encode;return t&&t.title||is({name:e.name,interactive:e.interactive,style:e.style},t)}(e),u)),e.subtitle&&l.push(function(e,t,n,r){const i={value:0},o=e.subtitle,a={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return BI(a,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),xW({type:hW,role:sU,style:eW,from:r,encode:a},n)}(e,n,r.subtitle,u)),iZ(pW({role:oU,from:u,encode:cZ(n,i),marks:l,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:a,style:s}),t)}function cZ(e,t){const n={enter:{},update:{}};return BI(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:vW},angle:{signal:lZ},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),II(n,t,aW)}function fZ(e,t){const n=[];e.transform&&e.transform.forEach((e=>{n.push(IW(e,t))})),e.on&&e.on.forEach((n=>{rZ(n,t,e.name)})),t.addDataPipeline(e.name,function(e,t,n){const r=[];let i,o,a,s,l,u=null,c=!1,f=!1;e.values?MU(e.values)||PU(e.format)?(r.push(hZ(t,e)),r.push(u=dZ())):r.push(u=dZ({$ingest:e.values,$format:e.format})):e.url?PU(e.url)||PU(e.format)?(r.push(hZ(t,e)),r.push(u=dZ())):r.push(u=dZ({$request:e.url,$format:e.format})):e.source&&(u=i=Ga(e.source).map((e=>EU(t.getData(e).output))),r.push(null));for(o=0,a=n.length;o<a;++o)s=n[o],l=s.metadata,u||l.source||r.push(u=dZ()),r.push(s),l.generates&&(f=!0),l.modifies&&!f&&(c=!0),l.source?u=s:l.changes&&(u=null);i&&(a=i.length-1,r[0]=pq({derive:c,pulse:a?i:i[0]}),(c||a)&&r.splice(1,0,dZ()));u||r.push(dZ());return r.push(yq({})),r}(e,t,n))}function dZ(e){const t=XU({},e);return t.metadata={source:!0},t}function hZ(e,t){return oq({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const pZ=e=>e===Bq||e===zq,mZ=(e,t,n)=>MU(e)?kZ(e.signal,t,n):e===Rq||e===zq?t:n,gZ=(e,t,n)=>MU(e)?xZ(e.signal,t,n):pZ(e)?t:n,yZ=(e,t,n)=>MU(e)?wZ(e.signal,t,n):pZ(e)?n:t,vZ=(e,t,n)=>MU(e)?_Z(e.signal,t,n):e===zq?{value:t}:{value:n},bZ=(e,t,n)=>MU(e)?OZ(e.signal,t,n):e===Lq?{value:t}:{value:n},xZ=(e,t,n)=>EZ(`${e} === '${zq}' || ${e} === '${Bq}'`,t,n),wZ=(e,t,n)=>EZ(`${e} !== '${zq}' && ${e} !== '${Bq}'`,t,n),kZ=(e,t,n)=>jZ(`${e} === '${Rq}' || ${e} === '${zq}'`,t,n),_Z=(e,t,n)=>jZ(`${e} === '${zq}'`,t,n),OZ=(e,t,n)=>jZ(`${e} === '${Lq}'`,t,n),EZ=(e,t,n)=>(t=null!=t?RI(t):t,n=null!=n?RI(n):n,DZ(t)&&DZ(n)?{signal:`${e} ? (${t=t?t.signal||js(t.value):null}) : (${n=n?n.signal||js(n.value):null})`}:[is({test:e},t)].concat(n||[])),DZ=e=>null==e||1===Object.keys(e).length,jZ=(e,t,n)=>({signal:`${e} ? (${SZ(t)}) : (${SZ(n)})`}),NZ=(e,t,n,r,i)=>({signal:(null!=r?`${e} === '${Rq}' ? (${SZ(r)}) : `:"")+(null!=n?`${e} === '${Bq}' ? (${SZ(n)}) : `:"")+(null!=i?`${e} === '${Lq}' ? (${SZ(i)}) : `:"")+(null!=t?`${e} === '${zq}' ? (${SZ(t)}) : `:"")+"(null)"}),SZ=e=>MU(e)?e.signal:null==e?null:js(e),AZ=(e,t)=>0===t?0:MU(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},$Z=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function CZ(e,t,n,r){let i;if(t&&ls(t,e))return t[e];if(ls(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=e[5].toLowerCase()+e.slice(6)}return r[Qq][i]}if(e.startsWith("label")){switch(e){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=e[5].toLowerCase()+e.slice(6)}return r[Jq][i]}return null}function MZ(e){const t={};for(const n of e)if(n)for(const e in n)t[e]=1;return Object.keys(t)}function PZ(e,t){return{scale:e.scale,range:t}}function FZ(e,t,n,r,i){const o=mW(e,t),a=e.orient,s=e.gridScale,l=mZ(a,1,-1),u=function(e,t){if(1===t);else if(_a(e)){let n=e=is({},e);for(;null!=n.mult;){if(!_a(n.mult))return n.mult=MU(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n=n.mult=is({},n.mult)}n.mult=t}else e=MU(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);return e}(e.offset,l);let c,f,d;const h={enter:c={opacity:sW},update:d={opacity:lW},exit:f={opacity:sW}};BI(h,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});const p={scale:e.scale,field:Xq,band:i.band,extra:i.extra,offset:i.offset,round:o("tickRound")},m=gZ(a,{signal:"height"},{signal:"width"}),g=s?{scale:s,range:0,mult:l,offset:u}:{value:0,offset:u},y=s?{scale:s,range:1,mult:l,offset:u}:is(m,{mult:l,offset:u});return c.x=d.x=gZ(a,p,g),c.y=d.y=yZ(a,p,g),c.x2=d.x2=yZ(a,y),c.y2=d.y2=gZ(a,y),f.x=gZ(a,p),f.y=yZ(a,p),xW({type:fW,role:VI,key:Xq,from:r,encode:h},n)}function TZ(e,t,n,r,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function zZ(e,t,n,r){const i=mW(e,t),o=e.orient,a=mZ(o,-1,1);let s,l;const u={enter:s={opacity:sW,anchor:RI(i("titleAnchor",null)),align:{signal:vW}},update:l=is({},s,{opacity:lW,text:RI(e.title)}),exit:{opacity:sW}},c={signal:`lerp(range("${e.scale}"), ${yW(0,1,.5)})`};return l.x=gZ(o,c),l.y=yZ(o,c),s.angle=gZ(o,sW,AZ(a,90)),s.baseline=gZ(o,vZ(o,Bq,zq),{value:Bq}),l.angle=s.angle,l.baseline=s.baseline,BI(u,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),function(e,t,n,r){const i=(e,t)=>null!=e?(n.update[t]=$Z(RI(e),n.update[t]),!1):!UI(t,r),o=i(e("titleX"),"x"),a=i(e("titleY"),"y");n.enter.auto=a===o?RI(a):gZ(t,RI(a),RI(o))}(i,o,u,n),u.update.align=$Z(u.update.align,s.align),u.update.angle=$Z(u.update.angle,s.angle),u.update.baseline=$Z(u.update.baseline,s.baseline),xW({type:hW,role:JI,style:Qq,from:r,encode:u},n)}function RZ(e,t){const n=function(e,t){var n,r,i,o=t.config,a=o.style,s=o.axis,l="band"===t.scaleType(e.scale)&&o.axisBand,u=e.orient;if(MU(u)){const e=MZ([o.axisX,o.axisY]),t=MZ([o.axisTop,o.axisBottom,o.axisLeft,o.axisRight]);for(i of(n={},e))n[i]=gZ(u,CZ(i,o.axisX,s,a),CZ(i,o.axisY,s,a));for(i of(r={},t))r[i]=NZ(u.signal,CZ(i,o.axisTop,s,a),CZ(i,o.axisBottom,s,a),CZ(i,o.axisLeft,s,a),CZ(i,o.axisRight,s,a))}else n=u===zq||u===Bq?o.axisX:o.axisY,r=o["axis"+u[0].toUpperCase()+u.slice(1)];return n||r||l?is({},s,n,r,l):s}(e,t),r=e.encode||{},i=r.axis||{},o=i.name||void 0,a=i.interactive,s=i.style,l=mW(e,n),u=function(e){const t=e("tickBand");let n,r,i=e("tickOffset");return t?t.signal?(n={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},r={signal:`(${t.signal}) === 'extent'`},_a(i)||(i={signal:`(${t.signal}) === 'extent' ? 0 : ${i}`})):"extent"===t?(n=1,r=!0,i=0):(n=.5,r=!1):(n=e("bandPosition"),r=e("tickExtra")),{extra:r,band:n,offset:i}}(l),c={scale:e.scale,ticks:!!l("ticks"),labels:!!l("labels"),grid:!!l("grid"),domain:!!l("domain"),title:null!=e.title},f=EU(t.add(XU({},[c]))),d=EU(t.add(VU({scale:t.scaleRef(e.scale),extra:t.property(u.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let p;return c.grid&&h.push(FZ(e,n,r.grid,d,u)),c.ticks&&(p=l("tickSize"),h.push(function(e,t,n,r,i,o){const a=mW(e,t),s=e.orient,l=mZ(s,-1,1);let u,c,f;const d={enter:u={opacity:sW},update:f={opacity:lW},exit:c={opacity:sW}};BI(d,{stroke:a("tickColor"),strokeCap:a("tickCap"),strokeDash:a("tickDash"),strokeDashOffset:a("tickDashOffset"),strokeOpacity:a("tickOpacity"),strokeWidth:a("tickWidth")});const h=RI(i);h.mult=l;const p={scale:e.scale,field:Xq,band:o.band,extra:o.extra,offset:o.offset,round:a("tickRound")};return f.y=u.y=gZ(s,sW,p),f.y2=u.y2=gZ(s,h),c.x=gZ(s,p),f.x=u.x=yZ(s,sW,p),f.x2=u.x2=yZ(s,h),c.y=yZ(s,p),xW({type:fW,role:XI,key:Xq,from:r,encode:d},n)}(e,n,r.ticks,d,p,u))),c.labels&&(p=c.ticks?p:0,h.push(function(e,t,n,r,i,o){const a=mW(e,t),s=e.orient,l=e.scale,u=mZ(s,-1,1),c=TU(a("labelFlush")),f=TU(a("labelFlushOffset")),d=a("labelAlign"),h=a("labelBaseline");let p,m=0===c||!!c;const g=RI(i);g.mult=u,g.offset=RI(a("labelPadding")||0),g.offset.mult=u;const y={scale:l,field:Xq,band:.5,offset:bW(o.offset,a("labelOffset"))},v=gZ(s,m?TZ(l,c,'"left"','"right"','"center"'):{value:"center"},bZ(s,"left","right")),b=gZ(s,vZ(s,"bottom","top"),m?TZ(l,c,'"top"','"bottom"','"middle"'):{value:"middle"}),x=TZ(l,c,`-(${f})`,f,0);m=m&&f;const w={opacity:sW,x:gZ(s,y,g),y:yZ(s,y,g)},k={enter:w,update:p={opacity:lW,text:{field:Hq},x:w.x,y:w.y,align:v,baseline:b},exit:{opacity:sW,x:w.x,y:w.y}};BI(k,{dx:!d&&m?gZ(s,x):null,dy:!h&&m?yZ(s,x):null}),BI(k,{angle:a("labelAngle"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontWeight:a("labelFontWeight"),fontStyle:a("labelFontStyle"),limit:a("labelLimit"),lineHeight:a("labelLineHeight")},{align:d,baseline:h});const _=a("labelBound");let O=a("labelOverlap");return O=O||_?{separation:a("labelSeparation"),method:O,order:"datum.index",bound:_?{scale:l,orient:s,tolerance:_}:null}:void 0,p.align!==v&&(p.align=$Z(p.align,v)),p.baseline!==b&&(p.baseline=$Z(p.baseline,b)),xW({type:hW,role:YI,style:Jq,key:Xq,from:r,encode:k,overlap:O},n)}(e,n,r.labels,d,p,u))),c.domain&&h.push(function(e,t,n,r){const i=mW(e,t),o=e.orient;let a,s;const l={enter:a={opacity:sW},update:s={opacity:lW},exit:{opacity:sW}};BI(l,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const u=PZ(e,0),c=PZ(e,1);return a.x=s.x=gZ(o,u,sW),a.x2=s.x2=gZ(o,c),a.y=s.y=yZ(o,u,sW),a.y2=s.y2=yZ(o,c),xW({type:fW,role:GI,from:r,encode:l},n)}(e,n,r.domain,f)),c.title&&h.push(zZ(e,n,r.title,f)),iZ(pW({role:HI,from:f,encode:II(LZ(l,e),i,aW),marks:h,aria:l("aria"),description:l("description"),zindex:l("zindex"),name:o,interactive:a,style:s}),t)}function LZ(e,t){const n={enter:{},update:{}};return BI(n,{orient:e("orient"),offset:e("offset")||0,position:FU(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function BZ(e,t,n){const r=Ga(e.signals),i=Ga(e.scales);return n||r.forEach((e=>wU(e,t))),Ga(e.projections).forEach((e=>function(e,t){const n=t.config.projection||{},r={};for(const i in e)"name"!==i&&(r[i]=Tq(e[i],i,t));for(const i in n)null==r[i]&&(r[i]=Tq(n[i],i,t));t.addProjection(e.name,r)}(e,t))),i.forEach((e=>function(e,t){const n=e.type||"linear";Vx(n)||aa("Unrecognized scale type: "+js(n)),t.addScale(e.name,{type:n,domain:void 0})}(e,t))),Ga(e.data).forEach((e=>fZ(e,t))),i.forEach((e=>_q(e,t))),(n||r).forEach((e=>function(e,t){const n=t.getSignal(e.name);let r=e.update;e.init&&(r?aa("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=uB(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach((e=>WU(e,t,n.id)))}(e,t))),Ga(e.axes).forEach((e=>RZ(e,t))),Ga(e.marks).forEach((e=>iZ(e,t))),Ga(e.legends).forEach((e=>oZ(e,t))),e.title&&uZ(e.title,t),t.parseLambdas(),t}const IZ=e=>II({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function UZ(e,t){const n=t.config,r=EU(t.root=t.add(OU())),i=function(e,t){const n=n=>FU(e[n],t[n]),r=[qZ("background",n("background")),qZ("autosize",PI(n("autosize"))),qZ("padding",zI(n("padding"))),qZ("width",n("width")||0),qZ("height",n("height")||0)],i=r.reduce(((e,t)=>(e[t.name]=t,e)),{}),o={};return Ga(e.signals).forEach((e=>{ls(i,e.name)?e=is(i[e.name],e):r.push(e),o[e.name]=e})),Ga(t.signals).forEach((e=>{ls(o,e.name)||ls(i,e.name)||r.push(e)})),r}(e,n);i.forEach((e=>wU(e,t))),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const o=t.add(XU()),a=t.add(KU(mU(IZ(e.encode),uW,WI,e.style,t,{pulse:EU(o)}))),s=t.add(bq({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:EU(a)}));t.operators.pop(),t.pushState(EU(a),EU(s),null),BZ(e,t,i),t.operators.push(s);let l=t.add(YU({mark:r,pulse:EU(s)}));return l=t.add(mq({pulse:EU(l)})),l=t.add(yq({pulse:EU(l)})),t.addData("root",new KW(t,o,o,l)),t}function qZ(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function WZ(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function ZZ(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}function HZ(e){return(ka(e)?GZ:VZ)(e)}function GZ(e){const t=e.length;let n="[";for(let r=0;r<t;++r){const t=e[r];n+=(r>0?",":"")+(_a(t)?t.signal||HZ(t):js(t))}return n+"]"}function VZ(e){let t,n,r="{",i=0;for(t in e)n=e[t],r+=(++i>1?",":"")+js(t)+":"+(_a(n)?n.signal||HZ(n):js(n));return r+"}"}WZ.prototype=ZZ.prototype={parse(e){return BZ(e,this)},fork(){return new ZZ(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach((t=>{t.$ref=e.id})),e.refs=null),e},proxy(e){const t=e instanceof kU?EU(e):e;return this.add(hq({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;for(e in this.root&&(this.root.root=!0),this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(e,t,n){let r,i;e&&(r=e.data||(e.data={}),i=r[t]||(r[t]=[]),i.push(n))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const r in t.index)n(t.index[r],e,"index:"+r)}return this},pushState(e,t,n){this._encode.push(EU(this.add(yq({pulse:e})))),this._parent.push(t),this._lookup.push(n?EU(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return Na(this._parent)},encode(){return Na(this._encode)},lookup(){return Na(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(bs(e))return DU(e,t);e.signal||aa("Unsupported field reference: "+js(e));const n=e.signal;let r=this.field[n];if(!r){const e={name:this.signalRef(n)};t&&(e.as=t),this.field[n]=r=EU(this.add(nq(e)))}return r},compareRef(e){let t=!1;const n=e=>MU(e)?(t=!0,this.signalRef(e.signal)):function(e){return e&&e.expr}(e)?(t=!0,this.exprRef(e.expr)):e,r=Ga(e.field).map(n),i=Ga(e.order).map(n);return t?EU(this.add(JU({fields:r,orders:i}))):NU(r,i)},keyRef(e,t){let n=!1;const r=this.signals;return e=Ga(e).map((e=>MU(e)?(n=!0,EU(r[e.signal])):e)),n?EU(this.add(rq({fields:e,flat:t}))):function(e,t){const n={$key:e};return t&&(n.$flat=!0),n}(e,t)},sortRef(e){if(!e)return e;const t=AU(e.op,e.field),n=e.order||"ascending";return n.signal?EU(this.add(JU({fields:t,orders:this.signalRef(n.signal)}))):NU(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal(e){return ls(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&aa("Duplicate signal name: "+js(e));const n=t instanceof kU?t:this.add(OU(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||aa("Unrecognized signal name: "+js(e)),this.signals[e]},signalRef(e){return this.signals[e]?EU(this.signals[e]):(ls(this.lambdas,e)||(this.lambdas[e]=this.add(OU(null))),EU(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const n=e[t],r=uB(n,this),i=this.lambdas[n];i.params=r.$params,i.update=r.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return e&&_a(e)?this.signalRef(e.signal||HZ(e)):e},exprRef(e,t){const n={expr:uB(e,this)};return t&&(n.expr.$name=t),EU(this.add(eq(n)))},addBinding(e,t){this.bindings||aa("Nested signals do not support binding: "+js(e)),this.bindings.push(is({signal:e},t))},addScaleProj(e,t){ls(this.scales,e)&&aa("Duplicate scale or projection name: "+js(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,gq(t))},addProjection(e,t){this.addScaleProj(e,dq(t))},getScale(e){return this.scales[e]||aa("Unrecognized scale name: "+js(e)),this.scales[e]},scaleRef(e){return EU(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return ls(this.data,e)&&aa("Duplicate data set name: "+js(e)),this.data[e]=t},getData(e){return this.data[e]||aa("Undefined data set name: "+js(e)),this.data[e]},addDataPipeline(e,t){return ls(this.data,e)&&aa("Duplicate data set name: "+js(e)),this.addData(e,KW.fromEntries(this,t))}};is(Yh,gg,zj,mN,fM,hP,nT,CF,sT,UT,rz,dz);var YZ=Object.freeze({__proto__:null,Bounds:Fk,CanvasHandler:dE,CanvasRenderer:yE,DATE:Wu,DAY:Zu,DAYOFYEAR:Hu,Dataflow:Hh,Debug:xa,Error:ya,EventStream:$h,Gradient:Lw,GroupItem:zk,HOURS:Gu,Handler:VO,Info:ba,Item:Tk,MILLISECONDS:Xu,MINUTES:Vu,MONTH:Uu,Marks:CO,MultiPulse:Ih,None:ga,Operator:Nh,Parameters:Eh,Pulse:zh,QUARTER:Iu,RenderType:sD,Renderer:XO,ResourceLoader:Rk,SECONDS:Yu,SVGHandler:bE,SVGRenderer:WE,SVGStringRenderer:iD,Scenegraph:BO,TIME_UNITS:Ju,Transform:Vh,View:dI,WEEK:qu,Warn:va,YEAR:Bu,accessor:ea,accessorFields:na,accessorName:ta,array:Ga,ascending:Qa,bandwidthNRD:tp,bin:np,bootstrapCI:ip,boundClip:mD,boundContext:o_,boundItem:MO,boundMark:FO,boundStroke:Ik,changeset:_h,clampRange:Va,codegenExpression:nL,compare:Ja,constant:ns,cumulativeLogNormal:yp,cumulativeNormal:fp,cumulativeUniform:_p,dayofyear:ic,debounce:rs,defaultLocale:Td,definition:Xh,densityLogNormal:gp,densityNormal:cp,densityUniform:kp,domChild:WO,domClear:ZO,domCreate:UO,domFind:qO,dotbin:op,error:aa,expressionFunction:lB,extend:is,extent:os,extentIndex:as,falsy:pa,fastmap:cs,field:la,flush:fs,font:OO,fontFamily:_O,fontSize:vO,format:oh,formatLocale:Nd,formats:ah,hasOwnProperty:ls,id:ua,identity:ca,inferType:Qd,inferTypes:Kd,ingest:yh,inherits:ds,inrange:hs,interpolate:sw,interpolateColors:iw,interpolateRange:rw,intersect:cD,intersectBoxLine:g_,intersectPath:d_,intersectPoint:h_,intersectRule:m_,isArray:ka,isBoolean:ps,isDate:ms,isFunction:Ya,isIterable:gs,isNumber:ys,isObject:_a,isRegExp:vs,isString:bs,isTuple:ph,key:xs,lerp:ws,lineHeight:bO,loader:uh,locale:Fd,logger:wa,lruCache:ks,markup:TE,merge:_s,mergeConfig:Ea,multiLineOffset:wO,one:da,pad:Es,panLinear:Ta,panLog:za,panPow:Ra,panSymlog:La,parse:function(e,t,n){return _a(e)||aa("Input Vega specification must be an object."),t=Ea(function(){const e="sans-serif",t="#4c78a8",n="#000",r="#888",i="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:t},area:{fill:t},image:null,line:{stroke:t,strokeWidth:2},path:{stroke:t},rect:{fill:t},rule:{stroke:n},shape:{stroke:t},symbol:{fill:t,size:64},text:{fill:n,font:e,fontSize:11},trail:{fill:t,size:2},style:{"guide-label":{fill:n,font:e,fontSize:10},"guide-title":{fill:n,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:n,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:n,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:i},view:{fill:"transparent"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:r,grid:!1,gridWidth:1,gridColor:i,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:r,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:i,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:r,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}(),t,e.config),UZ(e,new WZ(t,n)).toRuntime()},parseExpression:KR,parseSelector:AI,path:Tg,pathCurves:Iw,pathEqual:vD,pathParse:Gw,pathRectangle:yk,pathRender:ik,pathSymbols:lk,pathTrail:vk,peek:Na,point:GO,projection:MC,quantileLogNormal:vp,quantileNormal:dp,quantileUniform:Op,quantiles:Kh,quantizeInterpolator:ow,quarter:Za,quartiles:ep,get random(){return rp},randomInteger:function(e,t){let n,r,i;null==t&&(t=e,e=0);const o={min(e){return arguments.length?(n=e||0,i=r-n,o):n},max(e){return arguments.length?(r=e||0,i=r-n,o):r},sample:()=>n+Math.floor(i*rp()),pdf:e=>e===Math.floor(e)&&e>=n&&e<r?1/i:0,cdf(e){const t=Math.floor(e);return t<n?0:t>=r?1:(t-n+1)/i},icdf:e=>e>=0&&e<=1?n-1+Math.floor(e*i):NaN};return o.min(e).max(t)},randomKDE:pp,randomLCG:function(e){return function(){return(e=(1103515245*e+12345)%2147483647)/2147483647}},randomLogNormal:bp,randomMixture:xp,randomNormal:hp,randomUniform:Ep,read:lh,regressionConstant:Dp,regressionExp:Mp,regressionLinear:$p,regressionLoess:Rp,regressionLog:Cp,regressionPoly:Tp,regressionPow:Pp,regressionQuad:Fp,renderModule:uD,repeat:Os,resetDefaultLocale:function(){return Dd(),$d(),Td()},resetSVGClipId:Mk,resetSVGDefIds:function(){Mk(),Pw=0},responseType:sh,runtimeContext:vB,sampleCurve:Up,sampleLogNormal:mp,sampleNormal:up,sampleUniform:wp,scale:Gx,sceneEqual:yD,sceneFromJSON:RO,scenePickVisit:j_,sceneToJSON:zO,sceneVisit:D_,sceneZOrder:E_,scheme:fw,serializeXML:zE,setRandom:function(e){rp=e},span:Ds,splitAccessPath:sa,stringValue:js,textMetrics:dO,timeBin:Vc,timeFloor:xc,timeFormatLocale:Md,timeInterval:Dc,timeOffset:Sc,timeSequence:Cc,timeUnitSpecifier:tc,timeUnits:Ku,toBoolean:Ns,toDate:As,toNumber:Sa,toSet:Cs,toString:$s,transform:Jh,transforms:Yh,truncate:Ms,truthy:ha,tupleid:mh,typeParsers:Yd,utcFloor:_c,utcInterval:jc,utcOffset:Ac,utcSequence:Mc,utcdayofyear:cc,utcquarter:Ha,utcweek:fc,version:"5.25.0",visitArray:Ps,week:oc,writeConfig:Da,zero:fa,zoomLinear:Ia,zoomLog:Ua,zoomPow:qa,zoomSymlog:Wa});var XZ={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},JZ={"*":(e,t)=>e*t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,">":(e,t)=>e>t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"&":(e,t)=>e&t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t},QZ={"+":e=>+e,"-":e=>-e,"~":e=>~e,"!":e=>!e};const KZ=Array.prototype.slice,eH=(e,t,n)=>{const r=n?n(t[0]):t[0];return r[e].apply(r,KZ.call(t,1))};var tH={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),now:Date.now,utc:Date.UTC,datetime:(e,t,n,r,i,o,a)=>new Date(e,t||0,null!=n?n:1,r||0,i||0,o||0,a||0),date:e=>new Date(e).getDate(),day:e=>new Date(e).getDay(),year:e=>new Date(e).getFullYear(),month:e=>new Date(e).getMonth(),hours:e=>new Date(e).getHours(),minutes:e=>new Date(e).getMinutes(),seconds:e=>new Date(e).getSeconds(),milliseconds:e=>new Date(e).getMilliseconds(),time:e=>new Date(e).getTime(),timezoneoffset:e=>new Date(e).getTimezoneOffset(),utcdate:e=>new Date(e).getUTCDate(),utcday:e=>new Date(e).getUTCDay(),utcyear:e=>new Date(e).getUTCFullYear(),utcmonth:e=>new Date(e).getUTCMonth(),utchours:e=>new Date(e).getUTCHours(),utcminutes:e=>new Date(e).getUTCMinutes(),utcseconds:e=>new Date(e).getUTCSeconds(),utcmilliseconds:e=>new Date(e).getUTCMilliseconds(),length:e=>e.length,join:function(){return eH("join",arguments)},indexof:function(){return eH("indexOf",arguments)},lastindexof:function(){return eH("lastIndexOf",arguments)},slice:function(){return eH("slice",arguments)},reverse:e=>e.slice().reverse(),parseFloat:parseFloat,parseInt:parseInt,upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),substring:function(){return eH("substring",arguments,String)},split:function(){return eH("split",arguments,String)},replace:function(){return eH("replace",arguments,String)},trim:e=>String(e).trim(),regexp:RegExp,test:(e,t)=>RegExp(e).test(t)};const nH=["view","item","group","xy","x","y"],rH=new Set([Function,eval,setTimeout,setInterval]);"function"==typeof setImmediate&&rH.add(setImmediate);const iH={Literal:(e,t)=>t.value,Identifier:(e,t)=>{const n=t.name;return e.memberDepth>0?n:"datum"===n?e.datum:"event"===n?e.event:"item"===n?e.item:XZ[n]||e.params["$"+n]},MemberExpression:(e,t)=>{const n=!t.computed,r=e(t.object);n&&(e.memberDepth+=1);const i=e(t.property);if(n&&(e.memberDepth-=1),!rH.has(r[i]))return r[i];console.error(`Prevented interpretation of member "${i}" which could lead to insecure code execution`)},CallExpression:(e,t)=>{const n=t.arguments;let r=t.callee.name;return r.startsWith("_")&&(r=r.slice(1)),"if"===r?e(n[0])?e(n[1]):e(n[2]):(e.fn[r]||tH[r]).apply(e.fn,n.map(e))},ArrayExpression:(e,t)=>t.elements.map(e),BinaryExpression:(e,t)=>JZ[t.operator](e(t.left),e(t.right)),UnaryExpression:(e,t)=>QZ[t.operator](e(t.argument)),ConditionalExpression:(e,t)=>e(t.test)?e(t.consequent):e(t.alternate),LogicalExpression:(e,t)=>"&&"===t.operator?e(t.left)&&e(t.right):e(t.left)||e(t.right),ObjectExpression:(e,t)=>t.properties.reduce(((t,n)=>{e.memberDepth+=1;const r=e(n.key);return e.memberDepth-=1,rH.has(e(n.value))?console.error(`Prevented interpretation of property "${r}" which could lead to insecure code execution`):t[r]=e(n.value),t}),{})};function oH(e,t,n,r,i,o){const a=e=>iH[e.type](a,e);return a.memberDepth=0,a.fn=Object.create(t),a.params=n,a.datum=r,a.event=i,a.item=o,nH.forEach((e=>a.fn[e]=function(){return i.vega[e](...arguments)})),a(e)}var aH={operator(e,t){const n=t.ast,r=e.functions;return e=>oH(n,r,e)},parameter(e,t){const n=t.ast,r=e.functions;return(e,t)=>oH(n,r,t,e)},event(e,t){const n=t.ast,r=e.functions;return e=>oH(n,r,void 0,void 0,e)},handler(e,t){const n=t.ast,r=e.functions;return(e,t)=>{const i=t.item&&t.item.datum;return oH(n,r,e,i,t)}},encode(e,t){const{marktype:n,channels:r}=t,i=e.functions,o="group"===n||"image"===n||"rect"===n;return(e,t)=>{const a=e.datum;let s,l=0;for(const n in r)s=oH(r[n].ast,i,t,a,void 0,e),e[n]!==s&&(e[n]=s,l=1);return"rule"!==n&&function(e,t,n){let r;t.x2&&(t.x?(n&&e.x>e.x2&&(r=e.x,e.x=e.x2,e.x2=r),e.width=e.x2-e.x):e.x=e.x2-(e.width||0)),t.xc&&(e.x=e.xc-(e.width||0)/2),t.y2&&(t.y?(n&&e.y>e.y2&&(r=e.y,e.y=e.y2,e.y2=r),e.height=e.y2-e.y):e.y=e.y2-(e.height||0)),t.yc&&(e.y=e.yc-(e.height||0)/2)}(e,r,o),l}}},sH="5.14.1",lH={exports:{}};!function(e){var t=function(){function e(e,t){return null!=t&&e instanceof t}var t,n,r;try{t=Map}catch(s){t=function(){}}try{n=Set}catch(s){n=function(){}}try{r=Promise}catch(s){r=function(){}}function i(o,s,l,u,c){"object"==typeof s&&(l=s.depth,u=s.prototype,c=s.includeNonEnumerable,s=s.circular);var f=[],d=[],h="undefined"!=typeof Buffer;return void 0===s&&(s=!0),void 0===l&&(l=1/0),function o(l,p){if(null===l)return null;if(0===p)return l;var m,g;if("object"!=typeof l)return l;if(e(l,t))m=new t;else if(e(l,n))m=new n;else if(e(l,r))m=new r((function(e,t){l.then((function(t){e(o(t,p-1))}),(function(e){t(o(e,p-1))}))}));else if(i.__isArray(l))m=[];else if(i.__isRegExp(l))m=new RegExp(l.source,a(l)),l.lastIndex&&(m.lastIndex=l.lastIndex);else if(i.__isDate(l))m=new Date(l.getTime());else{if(h&&Buffer.isBuffer(l))return m=Buffer.allocUnsafe?Buffer.allocUnsafe(l.length):new Buffer(l.length),l.copy(m),m;e(l,Error)?m=Object.create(l):void 0===u?(g=Object.getPrototypeOf(l),m=Object.create(g)):(m=Object.create(u),g=u)}if(s){var y=f.indexOf(l);if(-1!=y)return d[y];f.push(l),d.push(m)}for(var v in e(l,t)&&l.forEach((function(e,t){var n=o(t,p-1),r=o(e,p-1);m.set(n,r)})),e(l,n)&&l.forEach((function(e){var t=o(e,p-1);m.add(t)})),l){var b;g&&(b=Object.getOwnPropertyDescriptor(g,v)),b&&null==b.set||(m[v]=o(l[v],p-1))}if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(l);for(v=0;v<x.length;v++){var w=x[v];(!(_=Object.getOwnPropertyDescriptor(l,w))||_.enumerable||c)&&(m[w]=o(l[w],p-1),_.enumerable||Object.defineProperty(m,w,{enumerable:!1}))}}if(c){var k=Object.getOwnPropertyNames(l);for(v=0;v<k.length;v++){var _,O=k[v];(_=Object.getOwnPropertyDescriptor(l,O))&&_.enumerable||(m[O]=o(l[O],p-1),Object.defineProperty(m,O,{enumerable:!1}))}}return m}(o,l)}function o(e){return Object.prototype.toString.call(e)}function a(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}return i.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},i.__objToStr=o,i.__isDate=function(e){return"object"==typeof e&&"[object Date]"===o(e)},i.__isArray=function(e){return"object"==typeof e&&"[object Array]"===o(e)},i.__isRegExp=function(e){return"object"==typeof e&&"[object RegExp]"===o(e)},i.__getRegExpFlags=a,i}();e.exports&&(e.exports=t)}(lH);var uH=fo(lH.exports),cH=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var r,i,o;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(i=r;0!=i--;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(o=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=r;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;0!=i--;){var a=o[i];if(!e(t[a],n[a]))return!1}return!0}return t!=t&&n!=n},fH=fo(cH),dH=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var n,r="boolean"==typeof t.cycles&&t.cycles,i=t.cmp&&(n=t.cmp,function(e){return function(t,r){var i={key:t,value:e[t]},o={key:r,value:e[r]};return n(i,o)}}),o=[];return function e(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);var n,a;if(Array.isArray(t)){for(a="[",n=0;n<t.length;n++)n&&(a+=","),a+=e(t[n])||"null";return a+"]"}if(null===t)return"null";if(-1!==o.indexOf(t)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var s=o.push(t)-1,l=Object.keys(t).sort(i&&i(t));for(a="",n=0;n<l.length;n++){var u=l[n],c=e(t[u]);c&&(a&&(a+=","),a+=JSON.stringify(u)+":"+c)}return o.splice(s,1),"{"+a+"}"}}(e)},hH=fo(dH);function pH(e){return!!e.or}function mH(e){return!!e.and}function gH(e){return!!e.not}function yH(e,t){if(gH(e))yH(e.not,t);else if(mH(e))for(const n of e.and)yH(n,t);else if(pH(e))for(const n of e.or)yH(n,t);else t(e)}function vH(e,t){return gH(e)?{not:vH(e.not,t)}:mH(e)?{and:e.and.map((e=>vH(e,t)))}:pH(e)?{or:e.or.map((e=>vH(e,t)))}:t(e)}const bH=fH,xH=uH;function wH(e){throw new Error(e)}function kH(e,t){const n={};for(const r of t)ls(e,r)&&(n[r]=e[r]);return n}function _H(e,t){const n={...e};for(const r of t)delete n[r];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map((e=>hH(e))).join(",")})`};const OH=hH;function EH(e){if(ys(e))return e;const t=bs(e)?e:hH(e);if(t.length<250)return t;let n=0;for(let r=0;r<t.length;r++){n=(n<<5)-n+t.charCodeAt(r),n&=n}return n}function DH(e){return!1===e||null===e}function jH(e,t){return e.includes(t)}function NH(e,t){let n=0;for(const[r,i]of e.entries())if(t(i,r,n++))return!0;return!1}function SH(e,t){let n=0;for(const[r,i]of e.entries())if(!t(i,r,n++))return!1;return!0}function AH(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(const i of n)$H(e,i??{});return e}function $H(e,t){for(const n of RH(t))Da(e,n,t[n],!0)}function CH(e,t){const n=[],r={};let i;for(const o of e)i=t(o),i in r||(r[i]=1,n.push(o));return n}function MH(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function PH(e,t){for(const n of e)if(t.has(n))return!0;return!1}function FH(e){const t=new Set;for(const n of e){const e=sa(n).map(((e,t)=>0===t?e:`[${e}]`)),r=e.map(((t,n)=>e.slice(0,n+1).join("")));for(const n of r)t.add(n)}return t}function TH(e,t){return void 0===e||void 0===t||PH(FH(e),FH(t))}function zH(e){return 0===RH(e).length}const RH=Object.keys,LH=Object.values,BH=Object.entries;function IH(e){return!0===e||!1===e}function UH(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function qH(e,t){return gH(e)?`!(${qH(e.not,t)})`:mH(e)?`(${e.and.map((e=>qH(e,t))).join(") && (")})`:pH(e)?`(${e.or.map((e=>qH(e,t))).join(") || (")})`:t(e)}function WH(e,t){if(0===t.length)return!0;const n=t.shift();return n in e&&WH(e[n],t)&&delete e[n],zH(e)}function ZH(e){return e.charAt(0).toUpperCase()+e.substr(1)}function HH(e,t){void 0===t&&(t="datum");const n=sa(e),r=[];for(let i=1;i<=n.length;i++){const e=`[${n.slice(0,i).map(js).join("][")}]`;r.push(`${t}${e}`)}return r.join(" && ")}function GH(e,t){return void 0===t&&(t="datum"),`${t}[${js(sa(e).join("."))}]`}function VH(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function YH(e){return`${sa(e).map(VH).join("\\.")}`}function XH(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function JH(e){return`${sa(e).join(".")}`}function QH(e){return e?sa(e).length:0}function KH(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const r of t)if(void 0!==r)return r}let eG=42;function tG(e){const t=++eG;return e?String(e)+t:t}function nG(e){return rG(e)?e:`__${e}`}function rG(e){return e.startsWith("__")}function iG(e){if(void 0!==e)return(e%360+360)%360}function oG(e){return!!ys(e)||!isNaN(e)&&!isNaN(parseFloat(e))}const aG="row",sG="column",lG="facet",uG="x",cG="y",fG="x2",dG="y2",hG="xOffset",pG="yOffset",mG="radius",gG="radius2",yG="theta",vG="theta2",bG="latitude",xG="longitude",wG="latitude2",kG="longitude2",_G="color",OG="fill",EG="stroke",DG="shape",jG="size",NG="angle",SG="opacity",AG="fillOpacity",$G="strokeOpacity",CG="strokeWidth",MG="strokeDash",PG="text",FG="order",TG="detail",zG="key",RG="tooltip",LG="href",BG="url",IG="description",UG={theta:1,theta2:1,radius:1,radius2:1};function qG(e){return e in UG}const WG={longitude:1,longitude2:1,latitude:1,latitude2:1};function ZG(e){switch(e){case bG:return"y";case wG:return"y2";case xG:return"x";case kG:return"x2"}}function HG(e){return e in WG}const GG=RH(WG),VG={x:1,y:1,x2:1,y2:1,...UG,...WG,xOffset:1,yOffset:1,color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1};function YG(e){return e===_G||e===OG||e===EG}const XG={row:1,column:1,facet:1},JG=RH(XG),QG={...VG,...XG},KG=RH(QG),{order:eV,detail:tV,tooltip:nV,...rV}=QG,{row:iV,column:oV,facet:aV,...sV}=rV;function lV(e){return!!QG[e]}const uV=[fG,dG,wG,kG,vG,gG];function cV(e){return fV(e)!==e}function fV(e){switch(e){case fG:return uG;case dG:return cG;case wG:return bG;case kG:return xG;case vG:return yG;case gG:return mG}return e}function dV(e){if(qG(e))switch(e){case yG:return"startAngle";case vG:return"endAngle";case mG:return"outerRadius";case gG:return"innerRadius"}return e}function hV(e){switch(e){case uG:return fG;case cG:return dG;case bG:return wG;case xG:return kG;case yG:return vG;case mG:return gG}}function pV(e){switch(e){case uG:case fG:return"width";case cG:case dG:return"height"}}function mV(e){switch(e){case uG:return"xOffset";case cG:return"yOffset";case fG:return"x2Offset";case dG:return"y2Offset";case yG:return"thetaOffset";case mG:return"radiusOffset";case vG:return"theta2Offset";case gG:return"radius2Offset"}}function gV(e){switch(e){case uG:return"xOffset";case cG:return"yOffset"}}function yV(e){switch(e){case"xOffset":return"x";case"yOffset":return"y"}}const vV=RH(VG),{x:bV,y:xV,x2:wV,y2:kV,xOffset:_V,yOffset:OV,latitude:EV,longitude:DV,latitude2:jV,longitude2:NV,theta:SV,theta2:AV,radius:$V,radius2:CV,...MV}=VG,PV=RH(MV),FV={x:1,y:1},TV=RH(FV);function zV(e){return e in FV}const RV={theta:1,radius:1},LV=RH(RV);function BV(e){return"width"===e?uG:cG}const IV={xOffset:1,yOffset:1};function UV(e){return e in IV}const{text:qV,tooltip:WV,href:ZV,url:HV,description:GV,detail:VV,key:YV,order:XV,...JV}=MV,QV=RH(JV);const KV={...FV,...RV,...IV,...JV},eY=RH(KV);function tY(e){return!!KV[e]}function nY(e,t){return function(e){switch(e){case _G:case OG:case EG:case IG:case TG:case zG:case RG:case LG:case FG:case SG:case AG:case $G:case CG:case lG:case aG:case sG:return rY;case uG:case cG:case hG:case pG:case bG:case xG:return oY;case fG:case dG:case wG:case kG:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case jG:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case MG:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case DG:return{point:"always",geoshape:"always"};case PG:return{text:"always"};case NG:return{point:"always",square:"always",text:"always"};case BG:return{image:"always"};case yG:case mG:return{text:"always",arc:"always"};case vG:case gG:return{arc:"always"}}}(e)[t]}const rY={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:iY,...oY}=rY;function aY(e){switch(e){case uG:case cG:case yG:case mG:case hG:case pG:case jG:case NG:case CG:case SG:case AG:case $G:case fG:case dG:case vG:case gG:return;case lG:case aG:case sG:case DG:case MG:case PG:case RG:case LG:case BG:case IG:return"discrete";case _G:case OG:case EG:return"flexible";case bG:case xG:case wG:case kG:case TG:case zG:case FG:return}}const sY={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},lY={count:1,min:1,max:1};function uY(e){return!!e&&!!e.argmin}function cY(e){return!!e&&!!e.argmax}function fY(e){return bs(e)&&!!sY[e]}const dY=new Set(["count","valid","missing","distinct"]);function hY(e){return bs(e)&&dY.has(e)}const pY=new Set(["count","sum","distinct","valid","missing"]),mY=new Set(["mean","average","median","q1","q3","min","max"]);function gY(e){return ps(e)&&(e=jK(e,void 0)),"bin"+RH(e).map((t=>xY(e[t])?UH(`_${t}_${BH(e[t])}`):UH(`_${t}_${e[t]}`))).join("")}function yY(e){return!0===e||bY(e)&&!e.binned}function vY(e){return"binned"===e||bY(e)&&!0===e.binned}function bY(e){return _a(e)}function xY(e){return e?.param}function wY(e){switch(e){case aG:case sG:case jG:case _G:case OG:case EG:case CG:case SG:case AG:case $G:case DG:return 6;case MG:return 4;default:return 10}}function kY(e){return!!e?.expr}function _Y(e){const t=RH(e||{}),n={};for(const r of t)n[r]=MY(e[r]);return n}function OY(e){const{anchor:t,frame:n,offset:r,orient:i,angle:o,limit:a,color:s,subtitleColor:l,subtitleFont:u,subtitleFontSize:c,subtitleFontStyle:f,subtitleFontWeight:d,subtitleLineHeight:h,subtitlePadding:p,...m}=e,g={...t?{anchor:t}:{},...n?{frame:n}:{},...r?{offset:r}:{},...i?{orient:i}:{},...void 0!==o?{angle:o}:{},...void 0!==a?{limit:a}:{}},y={...l?{subtitleColor:l}:{},...u?{subtitleFont:u}:{},...c?{subtitleFontSize:c}:{},...f?{subtitleFontStyle:f}:{},...d?{subtitleFontWeight:d}:{},...h?{subtitleLineHeight:h}:{},...p?{subtitlePadding:p}:{}};return{titleMarkConfig:{...m,...s?{fill:s}:{}},subtitleMarkConfig:kH(e,["align","baseline","dx","dy","limit"]),nonMarkTitleProperties:g,subtitle:y}}function EY(e){return bs(e)||ka(e)&&bs(e[0])}function DY(e){return!!e?.signal}function jY(e){return!!e.step}function NY(e){return!ka(e)&&("field"in e&&"data"in e)}const SY=RH({aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1}),AY={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},$Y=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function CY(e){const t=ka(e.condition)?e.condition.map(PY):PY(e.condition);return{...MY(e),condition:t}}function MY(e){if(kY(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function PY(e){if(kY(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function FY(e){if(kY(e)){const{expr:t,...n}=e;return{signal:t,...n}}return DY(e)?e:void 0!==e?{value:e}:void 0}function TY(e){return DY(e)?e.signal:js(e)}function zY(e){return DY(e)?e.signal:js(e.value)}function RY(e){return DY(e)?e.signal:null==e?null:js(e)}function LY(e,t,n){for(const r of n){const n=UY(r,t.markDef,t.config);void 0!==n&&(e[r]=FY(n))}return e}function BY(e){return[].concat(e.type,e.style??[])}function IY(e,t,n,r){void 0===r&&(r={});const{vgChannel:i,ignoreVgConfig:o}=r;return i&&void 0!==t[i]?t[i]:void 0!==t[e]?t[e]:!o||i&&i!==e?UY(e,t,n,r):void 0}function UY(e,t,n,r){let{vgChannel:i}=void 0===r?{}:r;return KH(i?qY(e,t,n.style):void 0,qY(e,t,n.style),i?n[t.type][i]:void 0,n[t.type][e],i?n.mark[i]:n.mark[e])}function qY(e,t,n){return WY(e,BY(t),n)}function WY(e,t,n){let r;t=Ga(t);for(const i of t){const t=n[i];t&&void 0!==t[e]&&(r=t[e])}return r}function ZY(e,t){return Ga(e).reduce(((e,n)=>(e.field.push(hK(n,t)),e.order.push(n.sort??"ascending"),e)),{field:[],order:[]})}function HY(e,t){const n=[...e];return t.forEach((e=>{for(const t of n)if(bH(t,e))return;n.push(e)})),n}function GY(e,t){return bH(e,t)||!t?e:e?[...Ga(e),...Ga(t)].join(", "):t}function VY(e,t){const n=e.value,r=t.value;if(null==n||null===r)return{explicit:e.explicit,value:null};if((EY(n)||DY(n))&&(EY(r)||DY(r)))return{explicit:e.explicit,value:GY(n,r)};if(EY(n)||DY(n))return{explicit:e.explicit,value:n};if(EY(r)||DY(r))return{explicit:e.explicit,value:r};if(!(EY(n)||DY(n)||EY(r)||DY(r)))return{explicit:e.explicit,value:HY(n,r)};throw new Error("It should never reach here")}function YY(e){return`Invalid specification ${OH(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const XY='Autosize "fit" only works for single views and layered views.';function JY(e){return`${"width"==e?"Width":"Height"} "container" only works for single views and layered views.`}function QY(e){return`${"width"==e?"Width":"Height"} "container" only works well with autosize "fit" or "fit-${"width"==e?"x":"y"}".`}function KY(e){return e?`Dropping "fit-${e}" because spec has discrete ${pV(e)}.`:'Dropping "fit" because spec has discrete size.'}function eX(e){return`Unknown field for ${e}. Cannot calculate view size.`}function tX(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function nX(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function rX(e){return`Selection not supported for ${e} yet.`}const iX="The same selection must be used to override scale domains in a layered view.";function oX(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}function aX(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}function sX(e){return`Ignoring an invalid transform: ${OH(e)}.`}function lX(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function uX(e){return`${e}Offset dropped because ${e} is continuous`}function cX(e){return`There is no ${e} encoding. Replacing ${e}Offset encoding as ${e}.`}function fX(e){return`Invalid field type "${e}".`}function dX(e,t){const{fill:n,stroke:r}=t;return`Dropping color ${e} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function hX(e,t){return`Dropping ${OH(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}function pX(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function mX(e){return`${e} encoding has no scale, so specified scale is ignored.`}function gX(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function yX(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function vX(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${"ordinal"===t?"order":"magnitude"}.`}function bX(e){return`Using unaggregated domain with raw field has no effect (${OH(e)}).`}function xX(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function wX(e){return`Unaggregated domain is currently unsupported for log scale (${OH(e)}).`}function kX(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function _X(e){return`The step for "${e}" is dropped because the ${"width"===e?"x":"y"} is continuous.`}const OX="Domains that should be unioned has conflicting sort properties. Sort will be set to true.";function EX(e,t){return`Invalid ${e}: ${OH(t)}.`}function DX(e){return`1D error band does not support ${e}.`}function jX(e){return`Channel ${e} is required for "binned" bin.`}const NX=wa(va);let SX=NX;function AX(){SX.warn(...arguments)}function $X(e){if(e&&_a(e))for(const t of LX)if(t in e)return!0;return!1}const CX=["january","february","march","april","may","june","july","august","september","october","november","december"],MX=CX.map((e=>e.substr(0,3))),PX=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],FX=PX.map((e=>e.substr(0,3)));function TX(e,t){const n=[];if(t&&void 0!==e.day&&RH(e).length>1&&(AX(function(e){return`Dropping day from datetime ${OH(e)} as day cannot be combined with other units.`}(e)),delete(e=xH(e)).day),void 0!==e.year?n.push(e.year):n.push(2012),void 0!==e.month){const r=t?function(e){if(oG(e)&&(e=+e),ys(e))return e-1;{const t=e.toLowerCase(),n=CX.indexOf(t);if(-1!==n)return n;const r=t.substr(0,3),i=MX.indexOf(r);if(-1!==i)return i;throw new Error(EX("month",e))}}(e.month):e.month;n.push(r)}else if(void 0!==e.quarter){const r=t?function(e){if(oG(e)&&(e=+e),ys(e))return e>4&&AX(EX("quarter",e)),e-1;throw new Error(EX("quarter",e))}(e.quarter):e.quarter;n.push(ys(r)?3*r:`${r}*3`)}else n.push(0);if(void 0!==e.date)n.push(e.date);else if(void 0!==e.day){const r=t?function(e){if(oG(e)&&(e=+e),ys(e))return e%7;{const t=e.toLowerCase(),n=PX.indexOf(t);if(-1!==n)return n;const r=t.substr(0,3),i=FX.indexOf(r);if(-1!==i)return i;throw new Error(EX("day",e))}}(e.day):e.day;n.push(ys(r)?r+1:`${r}+1`)}else n.push(1);for(const r of["hours","minutes","seconds","milliseconds"]){const t=e[r];n.push(void 0===t?0:t)}return n}function zX(e){const t=TX(e,!0).join(", ");return e.utc?`utc(${t})`:`datetime(${t})`}const RX={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},LX=RH(RX);function BX(e){return _a(e)?e.binned:IX(e)}function IX(e){return e&&e.startsWith("binned")}function UX(e){return e.startsWith("utc")}const qX={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function WX(e){return LX.filter((t=>HX(e,t)))}function ZX(e){const t=WX(e);return t[t.length-1]}function HX(e,t){const n=e.indexOf(t);return!(n<0)&&(!(n>0&&"seconds"===t&&"i"===e.charAt(n-1))&&(!(e.length>n+3&&"day"===t&&"o"===e.charAt(n+3))&&!(n>0&&"year"===t&&"f"===e.charAt(n-1))))}function GX(e,t,n){let{end:r}=void 0===n?{end:!1}:n;const i=HH(t),o=UX(e)?"utc":"";let a;const s={};for(const u of LX)HX(e,u)&&(s[u]="quarter"===(l=u)?`(${o}quarter(${i})-1)`:`${o}${l}(${i})`,a=u);var l;return r&&(s[a]+="+1"),function(e){const t=TX(e,!1).join(", ");return e.utc?`utc(${t})`:`datetime(${t})`}(s)}function VX(e){if(!e)return;const t=WX(e);return`timeUnitSpecifier(${OH(t)}, ${OH(qX)})`}function YX(e){if(!e)return;let t;return bs(e)?t=IX(e)?{unit:e.substring(6),binned:!0}:{unit:e}:_a(e)&&(t={...e,...e.unit?{unit:e.unit}:{}}),UX(t.unit)&&(t.utc=!0,t.unit=function(e){return e.substring(3)}(t.unit)),t}function XX(e,t){void 0===t&&(t=e=>e);const n=YX(e),r=ZX(n.unit);if(r&&"day"!==r){const e={year:2001,month:1,date:1,hours:0,minutes:0,seconds:0,milliseconds:0},{step:i,part:o}=QX(r,n.step);return`${t(zX({...e,[o]:+e[o]+i}))} - ${t(zX(e))}`}}const JX={year:1,month:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1};function QX(e,t){if(void 0===t&&(t=1),function(e){return!!JX[e]}(e))return{part:e,step:t};switch(e){case"day":case"dayofyear":return{part:"date",step:t};case"quarter":return{part:"month",step:3*t};case"week":return{part:"date",step:7*t}}}function KX(e){return!!e?.field&&void 0!==e.equal}function eJ(e){return!!e?.field&&void 0!==e.lt}function tJ(e){return!!e?.field&&void 0!==e.lte}function nJ(e){return!!e?.field&&void 0!==e.gt}function rJ(e){return!!e?.field&&void 0!==e.gte}function iJ(e){if(e?.field){if(ka(e.range)&&2===e.range.length)return!0;if(DY(e.range))return!0}return!1}function oJ(e){return!!e?.field&&(ka(e.oneOf)||ka(e.in))}function aJ(e){return oJ(e)||KX(e)||iJ(e)||eJ(e)||nJ(e)||tJ(e)||rJ(e)}function sJ(e,t){return AK(e,{timeUnit:t,wrapTime:!0})}function lJ(e,t){void 0===t&&(t=!0);const{field:n}=e,r=YX(e.timeUnit),{unit:i,binned:o}=r||{},a=hK(e,{expr:"datum"}),s=i?`time(${o?a:GX(i,n)})`:a;if(KX(e))return`${s}===${sJ(e.equal,i)}`;if(eJ(e)){return`${s}<${sJ(e.lt,i)}`}if(nJ(e)){return`${s}>${sJ(e.gt,i)}`}if(tJ(e)){return`${s}<=${sJ(e.lte,i)}`}if(rJ(e)){return`${s}>=${sJ(e.gte,i)}`}if(oJ(e))return`indexof([${function(e,t){return e.map((e=>sJ(e,t)))}(e.oneOf,i).join(",")}], ${s}) !== -1`;if(function(e){return!!e?.field&&void 0!==e.valid}(e))return uJ(s,e.valid);if(iJ(e)){const{range:n}=e,r=DY(n)?{signal:`${n.signal}[0]`}:n[0],o=DY(n)?{signal:`${n.signal}[1]`}:n[1];if(null!==r&&null!==o&&t)return"inrange("+s+", ["+sJ(r,i)+", "+sJ(o,i)+"])";const a=[];return null!==r&&a.push(`${s} >= ${sJ(r,i)}`),null!==o&&a.push(`${s} <= ${sJ(o,i)}`),a.length>0?a.join(" && "):"true"}throw new Error(`Invalid field predicate: ${OH(e)}`)}function uJ(e,t){return void 0===t&&(t=!0),t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function cJ(e){return aJ(e)&&e.timeUnit?{...e,timeUnit:YX(e.timeUnit)}:e}function fJ(e){return"quantitative"===e||"temporal"===e}function dJ(e){return"ordinal"===e||"nominal"===e}const hJ="quantitative",pJ="ordinal",mJ="temporal",gJ="nominal",yJ="geojson";const vJ={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},bJ={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function xJ(e,t){const n=bJ[e],r=bJ[t];return n===r||"ordinal-position"===n&&"time"===r||"ordinal-position"===r&&"time"===n}const wJ={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function kJ(e){return wJ[e]}const _J=new Set(["linear","log","pow","sqrt","symlog"]),OJ=new Set([..._J,"time","utc"]);function EJ(e){return _J.has(e)}const DJ=new Set(["quantile","quantize","threshold"]),jJ=new Set([...OJ,...DJ,"sequential","identity"]),NJ=new Set(["ordinal","bin-ordinal","point","band"]);function SJ(e){return NJ.has(e)}function AJ(e){return jJ.has(e)}function $J(e){return OJ.has(e)}function CJ(e){return DJ.has(e)}function MJ(e){return e?.param}const{type:PJ,domain:FJ,range:TJ,rangeMax:zJ,rangeMin:RJ,scheme:LJ,...BJ}={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,domainRaw:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},IJ=RH(BJ);function UJ(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return $J(e)||"band"===e||"point"===e;case"padding":case"rangeMin":case"rangeMax":return $J(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return"band"===e;case"domainMax":case"domainMid":case"domainMin":case"domainRaw":case"clamp":return $J(e);case"nice":return $J(e)||"quantize"===e||"threshold"===e;case"exponent":return"pow"===e;case"base":return"log"===e;case"constant":return"symlog"===e;case"zero":return AJ(e)&&!jH(["log","time","utc","threshold","quantile"],e)}}function qJ(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return YG(e)?void 0:`Cannot use the scale property "${t}" with non-color channel.`;case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"domainRaw":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}const WJ={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},ZJ=WJ.arc,HJ=WJ.area,GJ=WJ.bar,VJ=WJ.image,YJ=WJ.line,XJ=WJ.point,JJ=WJ.rect,QJ=WJ.rule,KJ=WJ.text,eQ=WJ.tick,tQ=WJ.trail,nQ=WJ.circle,rQ=WJ.square,iQ=WJ.geoshape;function oQ(e){return["line","area","trail"].includes(e)}function aQ(e){return["rect","bar","image","arc"].includes(e)}const sQ=new Set(RH(WJ));function lQ(e){return e.type}const uQ=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit","fill","fillOpacity"],cQ=RH({color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1}),fQ=RH({mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1});function dQ(e){return e&&null!=e.band}const hQ={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},pQ={binSpacing:1,continuousBandSize:5,minBandSize:.25,timeUnitBandPosition:.5},mQ={binSpacing:0,continuousBandSize:5,minBandSize:.25,timeUnitBandPosition:.5};function gQ(e){const{channel:t,channelDef:n,markDef:r,scale:i,config:o}=e,a=wQ(e);return KQ(n)&&!hY(n.aggregate)&&i&&$J(i.get("type"))?function(e){let{fieldDef:t,channel:n,markDef:r,ref:i,config:o}=e;if(oQ(r.type))return i;const a=IY("invalid",r,o);if(null===a)return[yQ(t,n),i];return i}({fieldDef:n,channel:t,markDef:r,ref:a,config:o}):a}function yQ(e,t){return{test:vQ(e,!0),..."y"===fV(t)?{field:{group:"height"}}:{value:0}}}function vQ(e,t){return void 0===t&&(t=!0),uJ(bs(e)?e:hK(e,{expr:"datum"}),!t)}function bQ(e,t,n,r){const i={};if(t&&(i.scale=t),tK(e)){const{datum:t}=e;$X(t)?i.signal=zX(t):DY(t)?i.signal=t.signal:kY(t)?i.signal=t.expr:i.value=t}else i.field=hK(e,n);if(r){const{offset:e,band:t}=r;e&&(i.offset=e),t&&(i.band=t)}return i}function xQ(e){let{scaleName:t,fieldOrDatumDef:n,fieldOrDatumDef2:r,offset:i,startSuffix:o,bandPosition:a=.5}=e;const s=0<a&&a<1?"datum":void 0,l=hK(n,{expr:s,suffix:o}),u=void 0!==r?hK(r,{expr:s}):hK(n,{suffix:"end",expr:s}),c={};if(0===a||1===a){c.scale=t;const e=0===a?l:u;c.field=e}else{const e=DY(a)?`${a.signal} * ${l} + (1-${a.signal}) * ${u}`:`${a} * ${l} + ${1-a} * ${u}`;c.signal=`scale("${t}", ${e})`}return i&&(c.offset=i),c}function wQ(e){let{channel:t,channelDef:n,channel2Def:r,markDef:i,config:o,scaleName:a,scale:s,stack:l,offset:u,defaultRef:c,bandPosition:f}=e;if(n){if(oK(n)){const e=s?.get("type");if(aK(n)){f??(f=HQ({fieldDef:n,fieldDef2:r,markDef:i,config:o}));const{bin:s,timeUnit:c,type:d}=n;if(yY(s)||f&&c&&d===mJ)return l?.impute?bQ(n,a,{binSuffix:"mid"},{offset:u}):f&&!SJ(e)?xQ({scaleName:a,fieldOrDatumDef:n,bandPosition:f,offset:u}):bQ(n,a,CK(n,t)?{binSuffix:"range"}:{},{offset:u});if(vY(s)){if(KQ(r))return xQ({scaleName:a,fieldOrDatumDef:n,fieldOrDatumDef2:r,bandPosition:f,offset:u});AX(jX(t===uG?fG:dG))}}return bQ(n,a,SJ(e)?{binSuffix:"range"}:{},{offset:u,band:"band"===e?f??n.bandPosition??.5:void 0})}if(sK(n)){const e=u?{offset:u}:{};return{...kQ(t,n.value),...e}}}return Ya(c)&&(c=c()),c?{...c,...u?{offset:u}:{}}:c}function kQ(e,t){return jH(["x","x2"],e)&&"width"===t?{field:{group:"width"}}:jH(["y","y2"],e)&&"height"===t?{field:{group:"height"}}:FY(t)}function _Q(e){return e&&"number"!==e&&"time"!==e}function OQ(e,t,n){return`${e}(${t}${n?`, ${OH(n)}`:""})`}const EQ=" \u2013 ";function DQ(e){let{fieldOrDatumDef:t,format:n,formatType:r,expr:i,normalizeStack:o,config:a}=e;if(_Q(r))return NQ({fieldOrDatumDef:t,format:n,formatType:r,expr:i,config:a});const s=jQ(t,i,o),l=eK(t);if(void 0===n&&void 0===r&&a.customFormatTypes){if("quantitative"===l){if(o&&a.normalizedNumberFormatType)return NQ({fieldOrDatumDef:t,format:a.normalizedNumberFormat,formatType:a.normalizedNumberFormatType,expr:i,config:a});if(a.numberFormatType)return NQ({fieldOrDatumDef:t,format:a.numberFormat,formatType:a.numberFormatType,expr:i,config:a})}if("temporal"===l&&a.timeFormatType&&KQ(t)&&void 0===t.timeUnit)return NQ({fieldOrDatumDef:t,format:a.timeFormat,formatType:a.timeFormatType,expr:i,config:a})}if(SK(t)){const e=function(e){let{field:t,timeUnit:n,format:r,formatType:i,rawTimeFormat:o,isUTCScale:a}=e;return!n||r?!n&&i?`${i}(${t}, '${r}')`:(r=bs(r)?r:o,`${a?"utc":"time"}Format(${t}, '${r}')`):function(e,t,n){if(!e)return;const r=VX(e);return`${n||UX(e)?"utc":"time"}Format(${t}, ${r})`}(n,t,a)}({field:s,timeUnit:KQ(t)?YX(t.timeUnit)?.unit:void 0,format:n,formatType:a.timeFormatType,rawTimeFormat:a.timeFormat,isUTCScale:lK(t)&&t.scale?.type===vJ.UTC});return e?{signal:e}:void 0}if(n=$Q({type:l,specifiedFormat:n,config:a,normalizeStack:o}),KQ(t)&&yY(t.bin)){return{signal:PQ(s,hK(t,{expr:i,binSuffix:"end"}),n,r,a)}}return n||"quantitative"===eK(t)?{signal:`${CQ(s,n)}`}:{signal:`isValid(${s}) ? ${s} : ""+${s}`}}function jQ(e,t,n){return KQ(e)?n?`${hK(e,{expr:t,suffix:"end"})}-${hK(e,{expr:t,suffix:"start"})}`:hK(e,{expr:t}):function(e){const{datum:t}=e;return $X(t)?zX(t):`${OH(t)}`}(e)}function NQ(e){let{fieldOrDatumDef:t,format:n,formatType:r,expr:i,normalizeStack:o,config:a,field:s}=e;if(s??(s=jQ(t,i,o)),"datum.value"!==s&&KQ(t)&&yY(t.bin)){return{signal:PQ(s,hK(t,{expr:i,binSuffix:"end"}),n,r,a)}}return{signal:OQ(r,s,n)}}function SQ(e,t,n,r,i,o){if(!bs(r)||!_Q(r)){if(void 0===n&&void 0===r&&i.customFormatTypes&&"quantitative"===eK(e)){if(i.normalizedNumberFormatType&&uK(e)&&"normalize"===e.stack)return;if(i.numberFormatType)return}if(uK(e)&&"normalize"===e.stack&&i.normalizedNumberFormat)return $Q({type:"quantitative",config:i,normalizeStack:!0});if(SK(e)){const t=KQ(e)?YX(e.timeUnit)?.unit:void 0;if(void 0===t&&i.customFormatTypes&&i.timeFormatType)return;return function(e){let{specifiedFormat:t,timeUnit:n,config:r,omitTimeFormatConfig:i}=e;if(t)return t;if(n)return{signal:VX(n)};return i?void 0:r.timeFormat}({specifiedFormat:n,timeUnit:t,config:i,omitTimeFormatConfig:o})}return $Q({type:t,specifiedFormat:n,config:i})}}function AQ(e,t,n){return e&&(DY(e)||"number"===e||"time"===e)?e:SK(t)&&"time"!==n&&"utc"!==n?KQ(t)&&YX(t?.timeUnit)?.utc?"utc":"time":void 0}function $Q(e){let{type:t,specifiedFormat:n,config:r,normalizeStack:i}=e;return bs(n)?n:t===hJ?i?r.normalizedNumberFormat:r.numberFormat:void 0}function CQ(e,t){return`format(${e}, "${t||""}")`}function MQ(e,t,n,r){return _Q(n)?OQ(n,e,t):CQ(e,(bs(t)?t:void 0)??r.numberFormat)}function PQ(e,t,n,r,i){if(void 0===n&&void 0===r&&i.customFormatTypes&&i.numberFormatType)return PQ(e,t,i.numberFormat,i.numberFormatType,i);const o=MQ(e,n,r,i),a=MQ(t,n,r,i);return`${uJ(e,!1)} ? "null" : ${o} + "${EQ}" + ${a}`}const FQ="min",TQ={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function zQ(e){return e in TQ}function RQ(e){return!!e?.encoding}function LQ(e){return e&&("count"===e.op||!!e.field)}function BQ(e){return e&&ka(e)}function IQ(e){return"row"in e||"column"in e}function UQ(e){return!!e&&"header"in e}function qQ(e){return"facet"in e}function WQ(e){const{field:t,timeUnit:n,bin:r,aggregate:i}=e;return{...n?{timeUnit:n}:{},...r?{bin:r}:{},...i?{aggregate:i}:{},field:t}}function ZQ(e){return"sort"in e}function HQ(e){let{fieldDef:t,fieldDef2:n,markDef:r,config:i}=e;if(oK(t)&&void 0!==t.bandPosition)return t.bandPosition;if(KQ(t)){const{timeUnit:e,bin:o}=t;if(e&&!n)return aQ(r.type)?0:UY("timeUnitBandPosition",r,i);if(yY(o))return.5}}function GQ(e){let{channel:t,fieldDef:n,fieldDef2:r,markDef:i,config:o,scaleType:a,useVlSizeChannel:s}=e;const l=pV(t),u=IY(s?"size":l,i,o,{vgChannel:l});if(void 0!==u)return u;if(KQ(n)){const{timeUnit:e,bin:t}=n;if(e&&!r)return{band:UY("timeUnitBandSize",i,o)};if(yY(t)&&!SJ(a))return{band:1}}return aQ(i.type)?a?SJ(a)?o[i.type]?.discreteBandSize||{band:1}:o[i.type]?.continuousBandSize:o[i.type]?.discreteBandSize:void 0}function VQ(e,t,n,r){return!!(yY(e.bin)||e.timeUnit&&aK(e)&&"temporal"===e.type)&&void 0!==HQ({fieldDef:e,fieldDef2:t,markDef:n,config:r})}function YQ(e){return e&&!!e.sort&&!e.field}function XQ(e){return e&&"condition"in e}function JQ(e){const t=e?.condition;return!!t&&!ka(t)&&KQ(t)}function QQ(e){const t=e?.condition;return!!t&&!ka(t)&&oK(t)}function KQ(e){return e&&(!!e.field||"count"===e.aggregate)}function eK(e){return e?.type}function tK(e){return e&&"datum"in e}function nK(e){return aK(e)&&!pK(e)||iK(e)}function rK(e){return aK(e)&&"quantitative"===e.type&&!e.bin||iK(e)}function iK(e){return tK(e)&&ys(e.datum)}function oK(e){return KQ(e)||tK(e)}function aK(e){return e&&("field"in e||"count"===e.aggregate)&&"type"in e}function sK(e){return e&&"value"in e&&"value"in e}function lK(e){return e&&("scale"in e||"sort"in e)}function uK(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function cK(e){return e&&"legend"in e}function fK(e){return e&&("format"in e||"formatType"in e)}function dK(e){return _H(e,["legend","axis","header","scale"])}function hK(e,t){void 0===t&&(t={});let n=e.field;const r=t.prefix;let i=t.suffix,o="";if(function(e){return"count"===e.aggregate}(e))n=nG("count");else{let r;if(!t.nofn)if(function(e){return"op"in e}(e))r=e.op;else{const{bin:a,aggregate:s,timeUnit:l}=e;yY(a)?(r=gY(a),i=(t.binSuffix??"")+(t.suffix??"")):s?cY(s)?(o=`["${n}"]`,n=`argmax_${s.argmax}`):uY(s)?(o=`["${n}"]`,n=`argmin_${s.argmin}`):r=String(s):l&&!BX(l)&&(r=function(e){const{utc:t,...n}=YX(e);return n.unit?(t?"utc":"")+RH(n).map((e=>UH(`${"unit"===e?"":`_${e}_`}${n[e]}`))).join(""):(t?"utc":"")+"timeunit"+RH(n).map((e=>UH(`_${e}_${n[e]}`))).join("")}(l),i=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+(t.suffix??""))}r&&(n=n?`${r}_${n}`:r)}return i&&(n=`${n}_${i}`),r&&(n=`${r}_${n}`),t.forAs?JH(n):t.expr?GH(n,t.expr)+o:YH(n)+o}function pK(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return KQ(e)&&!!e.bin;case"temporal":return!1}throw new Error(fX(e.type))}const mK=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return function(e){const{aggregate:t,bin:n,timeUnit:r,field:i}=e;if(cY(t))return`${i} for argmax(${t.argmax})`;if(uY(t))return`${i} for argmin(${t.argmin})`;const o=r&&!BX(r)?YX(r):void 0,a=t||o?.unit||o?.maxbins&&"timeunit"||yY(n)&&"bin";return a?`${a.toUpperCase()}(${i})`:i}(e);default:return function(e,t){const{field:n,bin:r,timeUnit:i,aggregate:o}=e;if("count"===o)return t.countTitle;if(yY(r))return`${n} (binned)`;if(i&&!BX(i)){const e=YX(i)?.unit;if(e)return`${n} (${WX(e).join("-")})`}else if(o)return cY(o)?`${n} for max ${o.argmax}`:uY(o)?`${n} for min ${o.argmin}`:`${ZH(o)} of ${n}`;return n}(e,t)}};let gK=mK;function yK(e){gK=e}function vK(e,t,n){let{allowDisabling:r,includeDefault:i=!0}=n;const o=bK(e)?.title;if(!KQ(e))return o??e.title;const a=e,s=i?xK(a,t):void 0;return r?KH(o,a.title,s):o??a.title??s}function bK(e){return uK(e)&&e.axis?e.axis:cK(e)&&e.legend?e.legend:UQ(e)&&e.header?e.header:void 0}function xK(e,t){return gK(e,t)}function wK(e){if(fK(e)){const{format:t,formatType:n}=e;return{format:t,formatType:n}}{const t=bK(e)??{},{format:n,formatType:r}=t;return{format:n,formatType:r}}}function kK(e){return KQ(e)?e:JQ(e)?e.condition:void 0}function _K(e){return oK(e)?e:QQ(e)?e.condition:void 0}function OK(e,t,n,r){if(void 0===r&&(r={}),bs(e)||ys(e)||ps(e)){return AX(function(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${OH(n)}}.`}(t,bs(e)?"string":ys(e)?"number":"boolean",e)),{value:e}}return oK(e)?EK(e,t,n,r):QQ(e)?{...e,condition:EK(e.condition,t,n,r)}:e}function EK(e,t,n,r){if(fK(e)){const{format:i,formatType:o,...a}=e;if(_Q(o)&&!n.customFormatTypes)return AX(lX(t)),EK(a,t,n,r)}else{const i=uK(e)?"axis":cK(e)?"legend":UQ(e)?"header":null;if(i&&e[i]){const{format:o,formatType:a,...s}=e[i];if(_Q(a)&&!n.customFormatTypes)return AX(lX(t)),EK({...e,[i]:s},t,n,r)}}return KQ(e)?DK(e,t,r):function(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=ys(n)?"quantitative":bs(n)?"nominal":$X(n)?"temporal":void 0,{...e,type:t}}(e)}function DK(e,t,n){let{compositeMark:r=!1}=void 0===n?{}:n;const{aggregate:i,timeUnit:o,bin:a,field:s}=e,l={...e};if(r||!i||fY(i)||cY(i)||uY(i)||(AX(function(e){return`Invalid aggregation operator "${e}".`}(i)),delete l.aggregate),o&&(l.timeUnit=YX(o)),s&&(l.field=`${s}`),yY(a)&&(l.bin=jK(a,t)),vY(a)&&!zV(t)&&AX(function(e){return`Channel ${e} should not be used with "binned" bin.`}(t)),aK(l)){const{type:e}=l,t=function(e){if(e)switch(e=e.toLowerCase()){case"q":case hJ:return"quantitative";case"t":case mJ:return"temporal";case"o":case pJ:return"ordinal";case"n":case gJ:return"nominal";case yJ:return"geojson"}}(e);e!==t&&(l.type=t),"quantitative"!==e&&hY(i)&&(AX(function(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}(e,i)),l.type="quantitative")}else if(!cV(t)){const e=function(e,t){switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(ZQ(e)&&ka(e.sort))return"ordinal";const{aggregate:n,bin:r,timeUnit:i}=e;if(i)return"temporal";if(r||n&&!cY(n)&&!uY(n))return"quantitative";if(lK(e)&&e.scale?.type)switch(bJ[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}(l,t);l.type=e}if(aK(l)){const{compatible:e,warning:n}=function(e,t){const n=e.type;if("geojson"===n&&"shape"!==t)return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case aG:case sG:case lG:return pK(e)?NK:{compatible:!1,warning:gX(t)};case uG:case cG:case hG:case pG:case _G:case OG:case EG:case PG:case TG:case zG:case RG:case LG:case BG:case NG:case yG:case mG:case IG:return NK;case xG:case kG:case bG:case wG:return n!==hJ?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:NK;case SG:case AG:case $G:case CG:case jG:case vG:case gG:case fG:case dG:return"nominal"!==n||e.sort?NK:{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`};case DG:case MG:return pK(e)||function(e){return lK(e)&&CJ(e.scale?.type)}(e)?NK:{compatible:!1,warning:yX(t)};case FG:return"nominal"!==e.type||"sort"in e?NK:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}(l,t)||{};!1===e&&AX(n)}if(ZQ(l)&&bs(l.sort)){const{sort:e}=l;if(zQ(e))return{...l,sort:{encoding:e}};const t=e.substr(1);if("-"===e.charAt(0)&&zQ(t))return{...l,sort:{encoding:t,order:"descending"}}}if(UQ(l)){const{header:e}=l;if(e){const{orient:t,...n}=e;if(t)return{...l,header:{...n,labelOrient:e.labelOrient||t,titleOrient:e.titleOrient||t}}}}return l}function jK(e,t){return ps(e)?{maxbins:wY(t)}:"binned"===e?{binned:!0}:e.maxbins||e.step?e:{...e,maxbins:wY(t)}}const NK={compatible:!0};function SK(e){const{formatType:t}=wK(e);return"time"===t||!t&&function(e){return e&&("temporal"===e.type||KQ(e)&&!!e.timeUnit)}(e)}function AK(e,t){let{timeUnit:n,type:r,wrapTime:i,undefinedIfExprNotRequired:o}=t;const a=n&&YX(n)?.unit;let s,l=a||"temporal"===r;return kY(e)?s=e.expr:DY(e)?s=e.signal:$X(e)?(l=!0,s=zX(e)):(bs(e)||ys(e))&&l&&(s=`datetime(${OH(e)})`,function(e){return!!RX[e]}(a)&&(ys(e)&&e<1e4||bs(e)&&isNaN(Date.parse(e)))&&(s=zX({[a]:e}))),s?i&&l?`time(${s})`:s:o?void 0:OH(e)}function $K(e,t){const{type:n}=e;return t.map((t=>{const r=AK(t,{timeUnit:KQ(e)&&!BX(e.timeUnit)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return void 0!==r?{signal:r}:t}))}function CK(e,t){return yY(e.bin)?tY(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const MK={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function PK(e){return e?.condition}const FK=["domain","grid","labels","ticks","title"],TK={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},zK={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},RK={...zK,style:1,labelExpr:1,encoding:1};function LK(e){return!!RK[e]}const BK=RH({axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1});function IK(e){return"mark"in e}class UK{constructor(e,t){this.name=e,this.run=t}hasMatchingType(e){return!!IK(e)&&function(e){return lQ(e)?e.type:e}(e.mark)===this.name}}function qK(e,t){const n=e&&e[t];return!!n&&(ka(n)?NH(n,(e=>!!e.field)):KQ(n)||JQ(n))}function WK(e,t){const n=e&&e[t];return!!n&&(ka(n)?NH(n,(e=>!!e.field)):KQ(n)||tK(n)||QQ(n))}function ZK(e,t){if(zV(t)){const n=e[t];if((KQ(n)||tK(n))&&(dJ(n.type)||KQ(n)&&n.timeUnit)){return WK(e,gV(t))}}return!1}function HK(e){return NH(KG,(t=>{if(qK(e,t)){const n=e[t];if(ka(n))return NH(n,(e=>!!e.aggregate));{const e=kK(n);return e&&!!e.aggregate}}return!1}))}function GK(e,t){const n=[],r=[],i=[],o=[],a={};return XK(e,((s,l)=>{if(KQ(s)){const{field:u,aggregate:c,bin:f,timeUnit:d,...h}=s;if(c||d||f){const e=bK(s),p=e?.title;let m=hK(s,{forAs:!0});const g={...p?[]:{title:vK(s,t,{allowDisabling:!0})},...h,field:m};if(c){let e;if(cY(c)?(e="argmax",m=hK({op:"argmax",field:c.argmax},{forAs:!0}),g.field=`${m}.${u}`):uY(c)?(e="argmin",m=hK({op:"argmin",field:c.argmin},{forAs:!0}),g.field=`${m}.${u}`):"boxplot"!==c&&"errorbar"!==c&&"errorband"!==c&&(e=c),e){const t={op:e,as:m};u&&(t.field=u),o.push(t)}}else if(n.push(m),aK(s)&&yY(f)){if(r.push({bin:f,field:u,as:m}),n.push(hK(s,{binSuffix:"end"})),CK(s,l)&&n.push(hK(s,{binSuffix:"range"})),zV(l)){const e={field:`${m}_end`};a[`${l}2`]=e}g.bin="binned",cV(l)||(g.type=hJ)}else if(d&&!BX(d)){i.push({timeUnit:d,field:u,as:m});const e=aK(s)&&s.type!==mJ&&"time";e&&(l===PG||l===RG?g.formatType=e:!function(e){return!!MV[e]}(l)?zV(l)&&(g.axis={formatType:e,...g.axis}):g.legend={formatType:e,...g.legend})}a[l]=g}else n.push(u),a[l]=e[l]}else a[l]=e[l]})),{bins:r,timeUnits:i,aggregate:o,groupby:n,encoding:a}}function VK(e,t,n){const r=nY(t,n);if(!r)return!1;if("binned"===r){const n=e[t===fG?uG:cG];return!!(KQ(n)&&KQ(e[t])&&vY(n.bin))}return!0}function YK(e,t){const n={};for(const r of RH(e)){const i=OK(e[r],r,t,{compositeMark:!0});n[r]=i}return n}function XK(e,t,n){if(e)for(const r of RH(e)){const i=e[r];if(ka(i))for(const e of i)t.call(n,e,r);else t.call(n,i,r)}}function JK(e,t){return RH(t).reduce(((n,r)=>{switch(r){case uG:case cG:case LG:case IG:case BG:case fG:case dG:case hG:case pG:case yG:case vG:case mG:case gG:case bG:case xG:case wG:case kG:case PG:case DG:case NG:case RG:return n;case FG:if("line"===e||"trail"===e)return n;case TG:case zG:{const e=t[r];if(ka(e)||KQ(e))for(const t of Ga(e))t.aggregate||n.push(hK(t,{}));return n}case jG:if("trail"===e)return n;case _G:case OG:case EG:case SG:case AG:case $G:case MG:case CG:{const e=kK(t[r]);return e&&!e.aggregate&&n.push(hK(e,{})),n}}}),[])}function QK(e,t,n,r){if(void 0===r&&(r=!0),"tooltip"in n)return{tooltip:n.tooltip};const i=e.map((e=>{let{fieldPrefix:n,titlePrefix:i}=e;const o=r?` of ${KK(t)}`:"";return{field:n+t.field,type:t.type,title:DY(i)?{signal:`${i}"${escape(o)}"`}:i+o}})),o=function(e){const t=[];for(const n of RH(e))if(qK(e,n)){const r=Ga(e[n]);for(const e of r)KQ(e)?t.push(e):JQ(e)&&t.push(e.condition)}return t}(n).map(dK);return{tooltip:[...i,...CH(o,EH)]}}function KK(e){const{title:t,field:n}=e;return KH(t,n)}function e0(e,t,n,r,i){const{scale:o,axis:a}=n;return s=>{let{partName:l,mark:u,positionPrefix:c,endPositionPrefix:f,extraEncoding:d={}}=s;const h=KK(n);return t0(e,l,i,{mark:u,encoding:{[t]:{field:`${c}_${n.field}`,type:n.type,...void 0!==h?{title:h}:{},...void 0!==o?{scale:o}:{},...void 0!==a?{axis:a}:{}},...bs(f)?{[`${t}2`]:{field:`${f}_${n.field}`}}:{},...r,...d}})}}function t0(e,t,n,r){const{clip:i,color:o,opacity:a}=e,s=e.type;return e[t]||void 0===e[t]&&n[t]?[{...r,mark:{...n[t],...i?{clip:i}:{},...o?{color:o}:{},...a?{opacity:a}:{},...lQ(r.mark)?r.mark:{type:r.mark},style:`${s}-${String(t)}`,...ps(e[t])?{}:e[t]}}]:[]}function n0(e,t,n){const{encoding:r}=e,i="vertical"===t?"y":"x",o=r[i],a=r[`${i}2`],s=r[`${i}Error`],l=r[`${i}Error2`];return{continuousAxisChannelDef:r0(o,n),continuousAxisChannelDef2:r0(a,n),continuousAxisChannelDefError:r0(s,n),continuousAxisChannelDefError2:r0(l,n),continuousAxis:i}}function r0(e,t){if(e?.aggregate){const{aggregate:n,...r}=e;return n!==t&&AX(function(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}(n,t)),r}return e}function i0(e,t){const{mark:n,encoding:r}=e,{x:i,y:o}=r;if(lQ(n)&&n.orient)return n.orient;if(nK(i)){if(nK(o)){const e=KQ(i)&&i.aggregate,n=KQ(o)&&o.aggregate;if(e||n!==t){if(n||e!==t){if(e===t&&n===t)throw new Error("Both x and y cannot have aggregate");return SK(o)&&!SK(i)?"horizontal":"vertical"}return"horizontal"}return"vertical"}return"horizontal"}if(nK(o))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}const o0="boxplot",a0=new UK(o0,l0);function s0(e){return ys(e)?"tukey":e}function l0(e,t){let{config:n}=t;e={...e,encoding:YK(e.encoding,n)};const{mark:r,encoding:i,params:o,projection:a,...s}=e,l=lQ(r)?r:{type:r};o&&AX(rX("boxplot"));const u=l.extent??n.boxplot.extent,c=IY("size",l,n),f=l.invalid,d=s0(u),{bins:h,timeUnits:p,transform:m,continuousAxisChannelDef:g,continuousAxis:y,groupby:v,aggregate:b,encodingWithoutContinuousAxis:x,ticksOrient:w,boxOrient:k,customTooltipWithoutAggregatedField:_}=function(e,t,n){const r=i0(e,o0),{continuousAxisChannelDef:i,continuousAxis:o}=n0(e,r,o0),a=i.field,s=s0(t),l=[...u0(a),{op:"median",field:a,as:`mid_box_${a}`},{op:"min",field:a,as:("min-max"===s?"lower_whisker_":"min_")+a},{op:"max",field:a,as:("min-max"===s?"upper_whisker_":"max_")+a}],u="min-max"===s||"tukey"===s?[]:[{calculate:`datum["upper_box_${a}"] - datum["lower_box_${a}"]`,as:`iqr_${a}`},{calculate:`min(datum["upper_box_${a}"] + datum["iqr_${a}"] * ${t}, datum["max_${a}"])`,as:`upper_whisker_${a}`},{calculate:`max(datum["lower_box_${a}"] - datum["iqr_${a}"] * ${t}, datum["min_${a}"])`,as:`lower_whisker_${a}`}],{[o]:c,...f}=e.encoding,{customTooltipWithoutAggregatedField:d,filteredEncoding:h}=function(e){const{tooltip:t,...n}=e;if(!t)return{filteredEncoding:n};let r,i;if(ka(t)){for(const e of t)e.aggregate?(r||(r=[]),r.push(e)):(i||(i=[]),i.push(e));r&&(n.tooltip=r)}else t.aggregate?n.tooltip=t:i=t;return ka(i)&&1===i.length&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}(f),{bins:p,timeUnits:m,aggregate:g,groupby:y,encoding:v}=GK(h,n),b="vertical"===r?"horizontal":"vertical",x=r,w=[...p,...m,{aggregate:[...g,...l],groupby:y},...u];return{bins:p,timeUnits:m,transform:w,groupby:y,aggregate:g,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:v,ticksOrient:b,boxOrient:x,customTooltipWithoutAggregatedField:d}}(e,u,n),{color:O,size:E,...D}=x,j=e=>e0(l,y,g,e,n.boxplot),N=j(D),S=j(x),A=j({...D,...E?{size:E}:{}}),$=QK([{fieldPrefix:"min-max"===d?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===d?"lower_whisker_":"min_",titlePrefix:"Min"}],g,x),C={type:"tick",color:"black",opacity:1,orient:w,invalid:f,aria:!1},M="min-max"===d?$:QK([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],g,x),P=[...N({partName:"rule",mark:{type:"rule",invalid:f,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:M}),...N({partName:"rule",mark:{type:"rule",invalid:f,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:M}),...N({partName:"ticks",mark:C,positionPrefix:"lower_whisker",extraEncoding:M}),...N({partName:"ticks",mark:C,positionPrefix:"upper_whisker",extraEncoding:M})],F=[..."tukey"!==d?P:[],...S({partName:"box",mark:{type:"bar",...c?{size:c}:{},orient:k,invalid:f,ariaRoleDescription:"box"},positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:$}),...A({partName:"median",mark:{type:"tick",invalid:f,..._a(n.boxplot.median)&&n.boxplot.median.color?{color:n.boxplot.median.color}:{},...c?{size:c}:{},orient:w,aria:!1},positionPrefix:"mid_box",extraEncoding:$})];if("min-max"===d)return{...s,transform:(s.transform??[]).concat(m),layer:F};const T=`datum["lower_box_${g.field}"]`,z=`datum["upper_box_${g.field}"]`,R=`(${z} - ${T})`,L=`${T} - ${u} * ${R}`,B=`${z} + ${u} * ${R}`,I=`datum["${g.field}"]`,U={joinaggregate:u0(g.field),groupby:v},q={transform:[{filter:`(${L} <= ${I}) && (${I} <= ${B})`},{aggregate:[{op:"min",field:g.field,as:`lower_whisker_${g.field}`},{op:"max",field:g.field,as:`upper_whisker_${g.field}`},{op:"min",field:`lower_box_${g.field}`,as:`lower_box_${g.field}`},{op:"max",field:`upper_box_${g.field}`,as:`upper_box_${g.field}`},...b],groupby:v}],layer:P},{tooltip:W,...Z}=D,{scale:H,axis:G}=g,V=KK(g),Y=_H(G,["title"]),X=t0(l,"outliers",n.boxplot,{transform:[{filter:`(${I} < ${L}) || (${I} > ${B})`}],mark:"point",encoding:{[y]:{field:g.field,type:g.type,...void 0!==V?{title:V}:{},...void 0!==H?{scale:H}:{},...zH(Y)?{}:{axis:Y}},...Z,...O?{color:O}:{},..._?{tooltip:_}:{}}})[0];let J;const Q=[...h,...p,U];return X?J={transform:Q,layer:[X,q]}:(J=q,J.transform.unshift(...Q)),{...s,layer:[J,{transform:m,layer:F}]}}function u0(e){return[{op:"q1",field:e,as:`lower_box_${e}`},{op:"q3",field:e,as:`upper_box_${e}`}]}const c0="errorbar",f0=new UK(c0,d0);function d0(e,t){let{config:n}=t;e={...e,encoding:YK(e.encoding,n)};const{transform:r,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:a,ticksOrient:s,markDef:l,outerSpec:u,tooltipEncoding:c}=p0(e,c0,n);delete a.size;const f=e0(l,o,i,a,n.errorbar),d=l.thickness,h=l.size,p={type:"tick",orient:s,aria:!1,...void 0!==d?{thickness:d}:{},...void 0!==h?{size:h}:{}},m=[...f({partName:"ticks",mark:p,positionPrefix:"lower",extraEncoding:c}),...f({partName:"ticks",mark:p,positionPrefix:"upper",extraEncoding:c}),...f({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar",...void 0!==d?{size:d}:{}},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:c})];return{...u,transform:r,...m.length>1?{layer:m}:{...m[0]}}}function h0(e,t){const{encoding:n}=e;if(function(e){return(oK(e.x)||oK(e.y))&&!oK(e.x2)&&!oK(e.y2)&&!oK(e.xError)&&!oK(e.xError2)&&!oK(e.yError)&&!oK(e.yError2)}(n))return{orient:i0(e,t),inputType:"raw"};const r=function(e){return oK(e.x2)||oK(e.y2)}(n),i=function(e){return oK(e.xError)||oK(e.xError2)||oK(e.yError)||oK(e.yError2)}(n),o=n.x,a=n.y;if(r){if(i)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const e=n.x2,r=n.y2;if(oK(e)&&oK(r))throw new Error(`${t} cannot have both x2 and y2`);if(oK(e)){if(nK(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}if(oK(r)){if(nK(a))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}{const e=n.xError,r=n.xError2,i=n.yError,s=n.yError2;if(oK(r)&&!oK(e))throw new Error(`${t} cannot have xError2 without xError`);if(oK(s)&&!oK(i))throw new Error(`${t} cannot have yError2 without yError`);if(oK(e)&&oK(i))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(oK(e)){if(nK(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(oK(i)){if(nK(a))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function p0(e,t,n){const{mark:r,encoding:i,params:o,projection:a,...s}=e,l=lQ(r)?r:{type:r};o&&AX(rX(t));const{orient:u,inputType:c}=h0(e,t),{continuousAxisChannelDef:f,continuousAxisChannelDef2:d,continuousAxisChannelDefError:h,continuousAxisChannelDefError2:p,continuousAxis:m}=n0(e,u,t),{errorBarSpecificAggregate:g,postAggregateCalculates:y,tooltipSummary:v,tooltipTitleWithFieldName:b}=function(e,t,n,r,i,o,a,s){let l=[],u=[];const c=t.field;let f,d=!1;if("raw"===o){const t=e.center?e.center:e.extent?"iqr"===e.extent?"median":"mean":s.errorbar.center,n=e.extent?e.extent:"mean"===t?"stderr":"iqr";if("median"===t!=("iqr"===n)&&AX(function(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}(t,n,a)),"stderr"===n||"stdev"===n)l=[{op:n,field:c,as:`extent_${c}`},{op:t,field:c,as:`center_${c}`}],u=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:`upper_${c}`},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:`lower_${c}`}],f=[{fieldPrefix:"center_",titlePrefix:ZH(t)},{fieldPrefix:"upper_",titlePrefix:m0(t,n,"+")},{fieldPrefix:"lower_",titlePrefix:m0(t,n,"-")}],d=!0;else{let e,t,r;"ci"===n?(e="mean",t="ci0",r="ci1"):(e="median",t="q1",r="q3"),l=[{op:t,field:c,as:`lower_${c}`},{op:r,field:c,as:`upper_${c}`},{op:e,field:c,as:`center_${c}`}],f=[{fieldPrefix:"upper_",titlePrefix:vK({field:c,aggregate:r,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:vK({field:c,aggregate:t,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:vK({field:c,aggregate:e,type:"quantitative"},s,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&AX(function(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}(e.center,e.extent)),"aggregated-upper-lower"===o?(f=[],u=[{calculate:`datum["${n.field}"]`,as:`upper_${c}`},{calculate:`datum["${c}"]`,as:`lower_${c}`}]):"aggregated-error"===o&&(f=[{fieldPrefix:"",titlePrefix:c}],u=[{calculate:`datum["${c}"] + datum["${r.field}"]`,as:`upper_${c}`}],i?u.push({calculate:`datum["${c}"] + datum["${i.field}"]`,as:`lower_${c}`}):u.push({calculate:`datum["${c}"] - datum["${r.field}"]`,as:`lower_${c}`}));for(const e of u)f.push({fieldPrefix:e.as.substring(0,6),titlePrefix:XH(XH(e.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:u,errorBarSpecificAggregate:l,tooltipSummary:f,tooltipTitleWithFieldName:d}}(l,f,d,h,p,c,t,n),{[m]:x,["x"===m?"x2":"y2"]:w,["x"===m?"xError":"yError"]:k,["x"===m?"xError2":"yError2"]:_,...O}=i,{bins:E,timeUnits:D,aggregate:j,groupby:N,encoding:S}=GK(O,n),A=[...j,...g],$="raw"!==c?[]:N,C=QK(v,f,S,b);return{transform:[...s.transform??[],...E,...D,...0===A.length?[]:[{aggregate:A,groupby:$}],...y],groupby:$,continuousAxisChannelDef:f,continuousAxis:m,encodingWithoutContinuousAxis:S,ticksOrient:"vertical"===u?"horizontal":"vertical",markDef:l,outerSpec:s,tooltipEncoding:C}}function m0(e,t,n){return`${ZH(e)} ${n} ${t}`}const g0="errorband",y0=new UK(g0,v0);function v0(e,t){let{config:n}=t;e={...e,encoding:YK(e.encoding,n)};const{transform:r,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:a,markDef:s,outerSpec:l,tooltipEncoding:u}=p0(e,g0,n),c=s,f=e0(c,o,i,a,n.errorband),d=void 0!==e.encoding.x&&void 0!==e.encoding.y;let h={type:d?"area":"rect"},p={type:d?"line":"rule"};const m={...c.interpolate?{interpolate:c.interpolate}:{},...c.tension&&c.interpolate?{tension:c.tension}:{}};return d?(h={...h,...m,ariaRoleDescription:"errorband"},p={...p,...m,aria:!1}):c.interpolate?AX(DX("interpolate")):c.tension&&AX(DX("tension")),{...l,transform:r,layer:[...f({partName:"band",mark:h,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...f({partName:"borders",mark:p,positionPrefix:"lower",extraEncoding:u}),...f({partName:"borders",mark:p,positionPrefix:"upper",extraEncoding:u})]}}const b0={};function x0(e,t,n){const r=new UK(e,t);b0[e]={normalizer:r,parts:n}}x0(o0,l0,["box","median","outliers","rule","ticks"]),x0(c0,d0,["ticks","rule"]),x0(g0,v0,["band","borders"]);const w0=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],k0={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},_0={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},O0=RH(k0),E0=RH(_0),D0=RH({header:1,headerRow:1,headerColumn:1,headerFacet:1}),j0=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],N0="_vgsid_",S0={point:{on:"click",fields:[N0],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function A0(e){return"legend"===e||!!e?.legend}function $0(e){return A0(e)&&_a(e)}function C0(e){return!!e?.select}function M0(e){const t=[];for(const n of e||[]){if(C0(n))continue;const{expr:e,bind:r,...i}=n;if(r&&e){const n={...i,bind:r,init:e};t.push(n)}else{const n={...i,...e?{update:e}:{},...r?{bind:r}:{}};t.push(n)}}return t}function P0(e){return"concat"in e}function F0(e){return"vconcat"in e}function T0(e){return"hconcat"in e}function z0(e){let{step:t,offsetIsDiscrete:n}=e;return n?t.for??"offset":"position"}function R0(e){return _a(e)&&void 0!==e.step}function L0(e){return e.view||e.width||e.height}const B0=RH({align:1,bounds:1,center:1,columns:1,spacing:1});function I0(e,t){return e[t]??e["width"===t?"continuousWidth":"continuousHeight"]}function U0(e,t){const n=q0(e,t);return R0(n)?n.step:W0}function q0(e,t){return KH(e[t]??e["width"===t?"discreteWidth":"discreteHeight"],{step:e.step})}const W0=20,Z0={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:W0},mark:{color:"#4c78a8",invalid:"filter",timeUnitBandSize:1},arc:{},area:{},bar:pQ,circle:{},geoshape:{},image:{},line:{},point:{},rect:mQ,rule:{color:"black"},square:{},text:{color:"black"},tick:{thickness:1},trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:{pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4,zero:!0},projection:{},legend:{gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:S0,style:{},title:{},facet:{spacing:20},concat:{spacing:20},normalizedNumberFormat:".0%"},H0=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],G0={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},V0={blue:H0[0],orange:H0[1],red:H0[2],teal:H0[3],green:H0[4],yellow:H0[5],purple:H0[6],pink:H0[7],brown:H0[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function Y0(e){const t=RH(e||{}),n={};for(const r of t){const t=e[r];n[r]=PK(t)?CY(t):MY(t)}return n}const X0=[...fQ,...BK,...D0,"background","padding","legend","lineBreak","scale","style","title","view"];function J0(e){void 0===e&&(e={});const{color:t,font:n,fontSize:r,selection:i,...o}=e,a=Ea({},xH(Z0),n?function(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}(n):{},t?function(e){return void 0===e&&(e={}),{signals:[{name:"color",value:_a(e)?{...V0,...e}:V0}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}(t):{},r?function(e){return{signals:[{name:"fontSize",value:_a(e)?{...G0,...e}:G0}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}(r):{},o||{});i&&Da(a,"selection",i,!0);const s=_H(a,X0);for(const l of["background","lineBreak","padding"])a[l]&&(s[l]=MY(a[l]));for(const l of fQ)a[l]&&(s[l]=_Y(a[l]));for(const l of BK)a[l]&&(s[l]=Y0(a[l]));for(const l of D0)a[l]&&(s[l]=_Y(a[l]));return a.legend&&(s.legend=_Y(a.legend)),a.scale&&(s.scale=_Y(a.scale)),a.style&&(s.style=function(e){const t=RH(e),n={};for(const r of t)n[r]=Y0(e[r]);return n}(a.style)),a.title&&(s.title=_Y(a.title)),a.view&&(s.view=_Y(a.view)),s}const Q0=new Set(["view",...sQ]),K0=["color","fontSize","background","padding","facet","concat","numberFormat","numberFormatType","normalizedNumberFormat","normalizedNumberFormatType","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],e1={view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"],area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],line:["point"],tick:["bandSize","thickness"]};function t1(e){e=xH(e);for(const t of K0)delete e[t];if(e.axis)for(const t in e.axis)PK(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of w0)delete e.legend[t];if(e.mark){for(const t of cQ)delete e.mark[t];e.mark.tooltip&&_a(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(M0(e.params)),delete e.params);for(const t of Q0){for(const r of cQ)delete e[t][r];const n=e1[t];if(n)for(const r of n)delete e[t][r];n1(e,t)}for(const t of RH(b0))delete e[t];!function(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:r}=OY(e.title);zH(t)||(e.style["group-title"]={...e.style["group-title"],...t});zH(n)||(e.style["group-subtitle"]={...e.style["group-subtitle"],...n});zH(r)?delete e.title:e.title=r}(e);for(const t in e)_a(e[t])&&zH(e[t])&&delete e[t];return zH(e)?void 0:e}function n1(e,t,n,r){"view"===t&&(n="cell");const i={...r?e[t][r]:e[t],...e.style[n??t]};zH(i)||(e.style[n??t]=i),r||delete e[t]}function r1(e){return"layer"in e}class i1{map(e,t){return qQ(e)?this.mapFacet(e,t):function(e){return"repeat"in e}(e)?this.mapRepeat(e,t):T0(e)?this.mapHConcat(e,t):F0(e)?this.mapVConcat(e,t):P0(e)?this.mapConcat(e,t):this.mapLayerOrUnit(e,t)}mapLayerOrUnit(e,t){if(r1(e))return this.mapLayer(e,t);if(IK(e))return this.mapUnit(e,t);throw new Error(YY(e))}mapLayer(e,t){return{...e,layer:e.layer.map((e=>this.mapLayerOrUnit(e,t)))}}mapHConcat(e,t){return{...e,hconcat:e.hconcat.map((e=>this.map(e,t)))}}mapVConcat(e,t){return{...e,vconcat:e.vconcat.map((e=>this.map(e,t)))}}mapConcat(e,t){const{concat:n,...r}=e;return{...r,concat:n.map((e=>this.map(e,t)))}}mapFacet(e,t){return{...e,spec:this.map(e.spec,t)}}mapRepeat(e,t){return{...e,spec:this.map(e.spec,t)}}}const o1={zero:1,center:1,normalize:1};const a1=new Set([ZJ,GJ,HJ,QJ,XJ,nQ,rQ,YJ,KJ,eQ]),s1=new Set([GJ,HJ,ZJ]);function l1(e){return KQ(e)&&"quantitative"===eK(e)&&!e.bin}function u1(e,t,n){let{orient:r,type:i}=n;const o="x"===t?"y":"radius",a="x"===t,s=e[t],l=e[o];if(KQ(s)&&KQ(l))if(l1(s)&&l1(l)){if(s.stack)return t;if(l.stack)return o;const e=KQ(s)&&!!s.aggregate;if(e!==(KQ(l)&&!!l.aggregate))return e?t:o;if(a&&["bar","area"].includes(i)){if("vertical"===r)return o;if("horizontal"===r)return t}}else{if(l1(s))return t;if(l1(l))return o}else{if(l1(s))return t;if(l1(l))return o}}function c1(e,t){const n=lQ(e)?e:{type:e},r=n.type;if(!a1.has(r))return null;const i=u1(t,"x",n)||u1(t,"theta",n);if(!i)return null;const o=t[i],a=KQ(o)?hK(o,{}):void 0,s=function(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}(i),l=[],u=new Set;if(t[s]){const e=t[s],n=KQ(e)?hK(e,{}):void 0;n&&n!==a&&(l.push(s),u.add(n));const r="x"===s?"xOffset":"yOffset",i=t[r],o=KQ(i)?hK(i,{}):void 0;o&&o!==a&&(l.push(r),u.add(o))}const c=PV.reduce(((e,n)=>{if("tooltip"!==n&&qK(t,n)){const r=t[n];for(const t of Ga(r)){const r=kK(t);if(r.aggregate)continue;const i=hK(r,{});i&&u.has(i)||e.push({channel:n,fieldDef:r})}}return e}),[]);let f;return void 0!==o.stack?f=ps(o.stack)?o.stack?"zero":null:o.stack:s1.has(r)&&(f="zero"),f&&f in o1?HK(t)&&0===c.length?null:o?.scale?.type&&o?.scale?.type!==vJ.LINEAR?(o?.stack&&AX(function(e){return`Cannot stack non-linear scale (${e}).`}(o.scale.type)),null):oK(t[hV(i)])?(void 0!==o.stack&&AX(`Cannot stack "${d=i}" if there is already "${d}2".`),null):(KQ(o)&&o.aggregate&&!pY.has(o.aggregate)&&AX(`Stacking is applied even though the aggregate function is non-summative ("${o.aggregate}").`),{groupbyChannels:l,groupbyFields:u,fieldChannel:i,impute:null!==o.impute&&oQ(r),stackBy:c,offset:f}):null;var d}function f1(e,t,n){const r=_Y(e),i=IY("orient",r,n);if(r.orient=function(e,t,n){switch(e){case XJ:case nQ:case rQ:case KJ:case JJ:case VJ:return}const{x:r,y:i,x2:o,y2:a}=t;switch(e){case GJ:if(KQ(r)&&(vY(r.bin)||KQ(i)&&i.aggregate&&!r.aggregate))return"vertical";if(KQ(i)&&(vY(i.bin)||KQ(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(a||o){if(n)return n;if(!o)return(KQ(r)&&r.type===hJ&&!yY(r.bin)||iK(r))&&KQ(i)&&vY(i.bin)?"horizontal":"vertical";if(!a)return(KQ(i)&&i.type===hJ&&!yY(i.bin)||iK(i))&&KQ(r)&&vY(r.bin)?"vertical":"horizontal"}case QJ:if(o&&(!KQ(r)||!vY(r.bin))&&a&&(!KQ(i)||!vY(i.bin)))return;case HJ:if(a)return KQ(i)&&vY(i.bin)?"horizontal":"vertical";if(o)return KQ(r)&&vY(r.bin)?"vertical":"horizontal";if(e===QJ){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case YJ:case eQ:{const t=rK(r),o=rK(i);if(n)return n;if(t&&!o)return"tick"!==e?"horizontal":"vertical";if(!t&&o)return"tick"!==e?"vertical":"horizontal";if(t&&o)return"vertical";{const e=aK(r)&&r.type===mJ,t=aK(i)&&i.type===mJ;if(e&&!t)return"vertical";if(!e&&t)return"horizontal"}return}}return"vertical"}(r.type,t,i),void 0!==i&&i!==r.orient&&AX(`Specified orient "${r.orient}" overridden with "${i}".`),"bar"===r.type&&r.orient){const e=IY("cornerRadiusEnd",r,n);if(void 0!==e){const n="horizontal"===r.orient&&t.x2||"vertical"===r.orient&&t.y2?["cornerRadius"]:hQ[r.orient];for(const t of n)r[t]=e;void 0!==r.cornerRadiusEnd&&delete r.cornerRadiusEnd}}void 0===IY("opacity",r,n)&&(r.opacity=function(e,t){if(jH([XJ,eQ,nQ,rQ],e)&&!HK(t))return.7;return}(r.type,t));return void 0===IY("cursor",r,n)&&(r.cursor=function(e,t,n){if(t.href||e.href||IY("href",e,n))return"pointer";return e.cursor}(r,t,n)),r}function d1(e){const{point:t,line:n,...r}=e;return RH(r).length>1?r:r.type}function h1(e){for(const t of["line","area","rule","trail"])e[t]&&(e={...e,[t]:_H(e[t],["point","line"])});return e}function p1(e,t,n){return void 0===t&&(t={}),"transparent"===e.point?{opacity:0}:e.point?_a(e.point)?e.point:{}:void 0!==e.point?null:t.point||n.shape?_a(t.point)?t.point:{}:void 0}function m1(e,t){return void 0===t&&(t={}),e.line?!0===e.line?{}:e.line:void 0!==e.line?null:t.line?!0===t.line?{}:t.line:void 0}class g1{constructor(){this.name="path-overlay"}hasMatchingType(e,t){if(IK(e)){const{mark:n,encoding:r}=e,i=lQ(n)?n:{type:n};switch(i.type){case"line":case"rule":case"trail":return!!p1(i,t[i.type],r);case"area":return!!p1(i,t[i.type],r)||!!m1(i,t[i.type])}}return!1}run(e,t,n){const{config:r}=t,{params:i,projection:o,mark:a,name:s,encoding:l,...u}=e,c=YK(l,r),f=lQ(a)?a:{type:a},d=p1(f,r[f.type],c),h="area"===f.type&&m1(f,r[f.type]),p=[{name:s,...i?{params:i}:{},mark:d1({..."area"===f.type&&void 0===f.opacity&&void 0===f.fillOpacity?{opacity:.7}:{},...f}),encoding:_H(c,["shape"])}],m=c1(f1(f,c,r),c);let g=c;if(m){const{fieldChannel:e,offset:t}=m;g={...c,[e]:{...c[e],...t?{stack:t}:{}}}}return g=_H(g,["y2","x2"]),h&&p.push({...o?{projection:o}:{},mark:{type:"line",...kH(f,["clip","interpolate","tension","tooltip"]),...h},encoding:g}),d&&p.push({...o?{projection:o}:{},mark:{type:"point",opacity:1,filled:!0,...kH(f,["clip","tooltip"]),...d},encoding:g}),n({...u,layer:p},{...t,config:h1(r)})}}function y1(e,t){return t?IQ(e)?_1(e,t):x1(e,t):e}function v1(e,t){return t?_1(e,t):e}function b1(e,t,n){const r=t[e];return function(e){return e&&!bs(e)&&"repeat"in e}(r)?r.repeat in n?{...t,[e]:n[r.repeat]}:void AX(function(e){return`Unknown repeated value "${e}".`}(r.repeat)):t}function x1(e,t){if(void 0!==(e=b1("field",e,t))){if(null===e)return null;if(ZQ(e)&&LQ(e.sort)){const n=b1("field",e.sort,t);e={...e,...n?{sort:n}:{}}}return e}}function w1(e,t){if(KQ(e))return x1(e,t);{const n=b1("datum",e,t);return n===e||n.type||(n.type="nominal"),n}}function k1(e,t){if(!oK(e)){if(QQ(e)){const n=w1(e.condition,t);if(n)return{...e,condition:n};{const{condition:t,...n}=e;return n}}return e}{const n=w1(e,t);if(n)return n;if(XQ(e))return{condition:e.condition}}}function _1(e,t){const n={};for(const r in e)if(ls(e,r)){const i=e[r];if(ka(i))n[r]=i.map((e=>k1(e,t))).filter((e=>e));else{const e=k1(i,t);void 0!==e&&(n[r]=e)}}return n}class O1{constructor(){this.name="RuleForRangedLine"}hasMatchingType(e){if(IK(e)){const{encoding:t,mark:n}=e;if("line"===n||lQ(n)&&"line"===n.type)for(const e of uV){const n=t[fV(e)];if(t[e]&&(KQ(n)&&!vY(n.bin)||tK(n)))return!0}}return!1}run(e,t,n){const{encoding:r,mark:i}=e;var o,a;return AX((o=!!r.x2,a=!!r.y2,`Line mark is for continuous lines and thus cannot be used with ${o&&a?"x2 and y2":o?"x2":"y2"}. We will use the rule mark (line segments) instead.`)),n({...e,mark:_a(i)?{...i,type:"rule"}:"rule"},t)}}function E1(e){let{parentEncoding:t,encoding:n={},layer:r}=e,i={};if(t){const e=new Set([...RH(t),...RH(n)]);for(const o of e){const e=n[o],a=t[o];if(oK(e)){const t={...a,...e};i[o]=t}else QQ(e)?i[o]={...e,condition:{...a,...e.condition}}:e||null===e?i[o]=e:(r||sK(a)||DY(a)||oK(a)||ka(a))&&(i[o]=a)}}else i=n;return!i||zH(i)?void 0:i}function D1(e){const{parentProjection:t,projection:n}=e;return t&&n&&AX(function(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${OH(t)} is overridden by a child projection ${OH(n)}.`}({parentProjection:t,projection:n})),n??t}function j1(e){return"filter"in e}function N1(e){return void 0!==e?.stop}function S1(e){return"lookup"in e}function A1(e){return"pivot"in e}function $1(e){return"density"in e}function C1(e){return"quantile"in e}function M1(e){return"regression"in e}function P1(e){return"loess"in e}function F1(e){return"sample"in e}function T1(e){return"window"in e}function z1(e){return"joinaggregate"in e}function R1(e){return"flatten"in e}function L1(e){return"calculate"in e}function B1(e){return"bin"in e}function I1(e){return"impute"in e}function U1(e){return"timeUnit"in e}function q1(e){return"aggregate"in e}function W1(e){return"stack"in e}function Z1(e){return"fold"in e}function H1(e){return"extent"in e&&!("density"in e)}function G1(e,t){const{transform:n,...r}=e;if(n){const e=n.map((e=>{if(j1(e))return{filter:X1(e,t)};if(B1(e)&&bY(e.bin))return{...e,bin:Y1(e.bin)};if(S1(e)){const{selection:t,...n}=e.from;return t?{...e,from:{param:t,...n}}:e}return e}));return{...r,transform:e}}return e}function V1(e,t){const n=xH(e);if(KQ(n)&&bY(n.bin)&&(n.bin=Y1(n.bin)),lK(n)&&n.scale?.domain?.selection){const{selection:e,...t}=n.scale.domain;n.scale.domain={...t,...e?{param:e}:{}}}if(XQ(n))if(ka(n.condition))n.condition=n.condition.map((e=>{const{selection:n,param:r,test:i,...o}=e;return r?e:{...o,test:X1(e,t)}}));else{const{selection:e,param:r,test:i,...o}=V1(n.condition,t);n.condition=r?n.condition:{...o,test:X1(n.condition,t)}}return n}function Y1(e){const t=e.extent;if(t?.selection){const{selection:n,...r}=t;return{...e,extent:{...r,param:n}}}return e}function X1(e,t){const n=e=>vH(e,(e=>{var n;const r={param:e,empty:t.emptySelections[e]??!0};return(n=t.selectionPredicates)[e]??(n[e]=[]),t.selectionPredicates[e].push(r),r}));return e.selection?n(e.selection):vH(e.test||e.filter,(e=>e.selection?n(e.selection):e))}class J1 extends i1{map(e,t){const n=t.selections??[];if(e.params&&!IK(e)){const t=[];for(const r of e.params)C0(r)?n.push(r):t.push(r);e.params=t}return t.selections=n,super.map(e,t)}mapUnit(e,t){const n=t.selections;if(!n||!n.length)return e;const r=(t.path??[]).concat(e.name),i=[];for(const o of n)if(o.views&&o.views.length)for(const t of o.views)(bs(t)&&(t===e.name||r.includes(t))||ka(t)&&t.map((e=>r.indexOf(e))).every(((e,t,n)=>-1!==e&&(0===t||e>n[t-1]))))&&i.push(o);else i.push(o);return i.length&&(e.params=i),e}}for(const Hee of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const e=J1.prototype[Hee];J1.prototype[Hee]=function(t,n){return e.call(this,t,Q1(t,n))}}function Q1(e,t){return e.name?{...t,path:(t.path??[]).concat(e.name)}:t}function K1(e,t){void 0===t&&(t=J0(e.config));const n=function(e,t){void 0===t&&(t={});const n={config:t};return n2.map(e2.map(t2.map(e,n),n),n)}(e,t),{width:r,height:i}=e,o=function(e,t,n){let{width:r,height:i}=t;const o=IK(e)||r1(e),a={};o?"container"==r&&"container"==i?(a.type="fit",a.contains="padding"):"container"==r?(a.type="fit-x",a.contains="padding"):"container"==i&&(a.type="fit-y",a.contains="padding"):("container"==r&&(AX(JY("width")),r=void 0),"container"==i&&(AX(JY("height")),i=void 0));const s={type:"pad",...a,...n?r2(n.autosize):{},...r2(e.autosize)};"fit"!==s.type||o||(AX(XY),s.type="pad");"container"==r&&"fit"!=s.type&&"fit-x"!=s.type&&AX(QY("width"));"container"==i&&"fit"!=s.type&&"fit-y"!=s.type&&AX(QY("height"));if(bH(s,{type:"pad"}))return;return s}(n,{width:r,height:i,autosize:e.autosize},t);return{...n,...o?{autosize:o}:{}}}const e2=new class extends i1{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[a0,f0,y0,new g1,new O1]}map(e,t){if(IK(e)){const n=qK(e.encoding,aG),r=qK(e.encoding,sG),i=qK(e.encoding,lG);if(n||r||i)return this.mapFacetedUnit(e,t)}return super.map(e,t)}mapUnit(e,t){const{parentEncoding:n,parentProjection:r}=t,i=v1(e.encoding,t.repeater),o={...e,...e.name?{name:[t.repeaterPrefix,e.name].filter((e=>e)).join("_")}:{},...i?{encoding:i}:{}};if(n||r)return this.mapUnitWithParentEncodingOrProjection(o,t);const a=this.mapLayerOrUnit.bind(this);for(const s of this.nonFacetUnitNormalizers)if(s.hasMatchingType(o,t.config))return s.run(o,t,a);return o}mapRepeat(e,t){return function(e){return!ka(e.repeat)&&e.repeat.layer}(e)?this.mapLayerRepeat(e,t):this.mapNonLayerRepeat(e,t)}mapLayerRepeat(e,t){const{repeat:n,spec:r,...i}=e,{row:o,column:a,layer:s}=n,{repeater:l={},repeaterPrefix:u=""}=t;return o||a?this.mapRepeat({...e,repeat:{...o?{row:o}:{},...a?{column:a}:{}},spec:{repeat:{layer:s},spec:r}},t):{...i,layer:s.map((e=>{const n={...l,layer:e},i=`${(r.name?`${r.name}_`:"")+u}child__layer_${UH(e)}`,o=this.mapLayerOrUnit(r,{...t,repeater:n,repeaterPrefix:i});return o.name=i,o}))}}mapNonLayerRepeat(e,t){const{repeat:n,spec:r,data:i,...o}=e;!ka(n)&&e.columns&&(e=_H(e,["columns"]),AX(oX("repeat")));const a=[],{repeater:s={},repeaterPrefix:l=""}=t,u=!ka(n)&&n.row||[s?s.row:null],c=!ka(n)&&n.column||[s?s.column:null],f=ka(n)&&n||[s?s.repeat:null];for(const h of f)for(const e of u)for(const i of c){const o={repeat:h,row:e,column:i,layer:s.layer},u=(r.name?`${r.name}_`:"")+l+"child__"+(ka(n)?`${UH(h)}`:(n.row?`row_${UH(e)}`:"")+(n.column?`column_${UH(i)}`:"")),c=this.map(r,{...t,repeater:o,repeaterPrefix:u});c.name=u,a.push(_H(c,["data"]))}const d=ka(n)?e.columns:n.column?n.column.length:1;return{data:r.data??i,align:"all",...o,columns:d,concat:a}}mapFacet(e,t){const{facet:n}=e;return IQ(n)&&e.columns&&(e=_H(e,["columns"]),AX(oX("facet"))),super.mapFacet(e,t)}mapUnitWithParentEncodingOrProjection(e,t){const{encoding:n,projection:r}=e,{parentEncoding:i,parentProjection:o,config:a}=t,s=D1({parentProjection:o,projection:r}),l=E1({parentEncoding:i,encoding:v1(n,t.repeater)});return this.mapUnit({...e,...s?{projection:s}:{},...l?{encoding:l}:{}},{config:a})}mapFacetedUnit(e,t){const{row:n,column:r,facet:i,...o}=e.encoding,{mark:a,width:s,projection:l,height:u,view:c,params:f,encoding:d,...h}=e,{facetMapping:p,layout:m}=this.getFacetMappingAndLayout({row:n,column:r,facet:i},t),g=v1(o,t.repeater);return this.mapFacet({...h,...m,facet:p,spec:{...s?{width:s}:{},...u?{height:u}:{},...c?{view:c}:{},...l?{projection:l}:{},mark:a,encoding:g,...f?{params:f}:{}}},t)}getFacetMappingAndLayout(e,t){const{row:n,column:r,facet:i}=e;if(n||r){i&&AX(`Facet encoding dropped as ${(o=[...n?[aG]:[],...r?[sG]:[]]).join(" and ")} ${o.length>1?"are":"is"} also specified.`);const t={},a={};for(const n of[aG,sG]){const r=e[n];if(r){const{align:e,center:i,spacing:o,columns:s,...l}=r;t[n]=l;for(const t of["align","center","spacing"])void 0!==r[t]&&(a[t]??(a[t]={}),a[t][n]=r[t])}}return{facetMapping:t,layout:a}}{const{align:e,center:n,spacing:r,columns:o,...a}=i;return{facetMapping:y1(a,t.repeater),layout:{...e?{align:e}:{},...n?{center:n}:{},...r?{spacing:r}:{},...o?{columns:o}:{}}}}var o}mapLayer(e,t){let{parentEncoding:n,parentProjection:r,...i}=t;const{encoding:o,projection:a,...s}=e,l={...i,parentEncoding:E1({parentEncoding:n,encoding:o,layer:!0}),parentProjection:D1({parentProjection:r,projection:a})};return super.mapLayer({...s,...e.name?{name:[l.repeaterPrefix,e.name].filter((e=>e)).join("_")}:{}},l)}},t2=new class extends i1{map(e,t){return t.emptySelections??(t.emptySelections={}),t.selectionPredicates??(t.selectionPredicates={}),e=G1(e,t),super.map(e,t)}mapLayerOrUnit(e,t){if((e=G1(e,t)).encoding){const n={};for(const[r,i]of BH(e.encoding))n[r]=V1(i,t);e={...e,encoding:n}}return super.mapLayerOrUnit(e,t)}mapUnit(e,t){const{selection:n,...r}=e;return n?{...r,params:BH(n).map((e=>{let[n,r]=e;const{init:i,bind:o,empty:a,...s}=r;"single"===s.type?(s.type="point",s.toggle=!1):"multi"===s.type&&(s.type="point"),t.emptySelections[n]="none"!==a;for(const l of LH(t.selectionPredicates[n]??{}))l.empty="none"!==a;return{name:n,value:i,select:s,bind:o}}))}:e}},n2=new J1;function r2(e){return bs(e)?{type:e}:e??{}}const i2=["background","padding"];function o2(e,t){const n={};for(const r of i2)e&&void 0!==e[r]&&(n[r]=MY(e[r]));return t&&(n.params=e.params),n}class a2{constructor(e,t){void 0===e&&(e={}),void 0===t&&(t={}),this.explicit=e,this.implicit=t}clone(){return new a2(xH(this.explicit),xH(this.implicit))}combine(){return{...this.explicit,...this.implicit}}get(e){return KH(this.explicit[e],this.implicit[e])}getWithExplicit(e){return void 0!==this.explicit[e]?{explicit:!0,value:this.explicit[e]}:void 0!==this.implicit[e]?{explicit:!1,value:this.implicit[e]}:{explicit:!1,value:void 0}}setWithExplicit(e,t){let{value:n,explicit:r}=t;void 0!==n&&this.set(e,n,r)}set(e,t,n){return delete this[n?"implicit":"explicit"][e],this[n?"explicit":"implicit"][e]=t,this}copyKeyFromSplit(e,t){let{explicit:n,implicit:r}=t;void 0!==n[e]?this.set(e,n[e],!0):void 0!==r[e]&&this.set(e,r[e],!1)}copyKeyFromObject(e,t){void 0!==t[e]&&this.set(e,t[e],!0)}copyAll(e){for(const t of RH(e.combine())){const n=e.getWithExplicit(t);this.setWithExplicit(t,n)}}}function s2(e){return{explicit:!0,value:e}}function l2(e){return{explicit:!1,value:e}}function u2(e){return(t,n,r,i)=>{const o=e(t.value,n.value);return o>0?t:o<0?n:c2(t,n,r,i)}}function c2(e,t,n,r){return e.explicit&&t.explicit&&AX(function(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${OH(n)} and ${OH(r)}). Using ${OH(n)}.`}(n,r,e.value,t.value)),e}function f2(e,t,n,r,i){return void 0===i&&(i=c2),void 0===e||void 0===e.value?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:bH(e.value,t.value)?e:i(e,t,n,r)}class d2 extends a2{constructor(e,t,n){void 0===e&&(e={}),void 0===t&&(t={}),void 0===n&&(n=!1),super(e,t),this.explicit=e,this.implicit=t,this.parseNothing=n}clone(){const e=super.clone();return e.parseNothing=this.parseNothing,e}}function h2(e){return"url"in e}function p2(e){return"values"in e}function m2(e){return"name"in e&&!h2(e)&&!p2(e)&&!g2(e)}function g2(e){return e&&(y2(e)||v2(e)||b2(e))}function y2(e){return"sequence"in e}function v2(e){return"sphere"in e}function b2(e){return"graticule"in e}var x2;function w2(e){const{signals:t,hasLegend:n,index:r,...i}=e;return i.field=YH(i.field),i}function k2(e,t,n){if(void 0===t&&(t=!0),void 0===n&&(n=ca),ka(e)){const r=e.map((e=>k2(e,t,n)));return t?`[${r.join(", ")}]`:r}return $X(e)?n(t?zX(e):function(e){const t=TX(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}(e)):t?n(OH(e)):e}function _2(e,t){for(const n of LH(e.component.selection??{})){const r=n.name;let i=`${r}${z3}, ${"global"===n.resolve?"true":`{unit: ${I3(e)}}`}`;for(const o of B3)o.defined(n)&&(o.signals&&(t=o.signals(e,n,t)),o.modifyExpr&&(i=o.modifyExpr(e,n,i)));t.push({name:r+R3,on:[{events:{signal:n.name+z3},update:`modify(${js(n.name+T3)}, ${i})`}]})}return D2(t)}function O2(e,t){if(e.component.selection&&RH(e.component.selection).length){const n=js(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:AI("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return D2(t)}function E2(e,t){for(const n of LH(e.component.selection??{}))for(const r of B3)r.defined(n)&&r.marks&&(t=r.marks(e,n,t));return t}function D2(e){return e.map((e=>(e.on&&!e.on.length&&delete e.on,e)))}!function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup"}(x2||(x2={}));class j2{constructor(e,t){this.debugName=t,this._children=[],this._parent=null,e&&(this.parent=e)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(e){this._parent=e,e&&e.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(e,t){this._children.includes(e)?AX("Attempt to add the same child twice."):void 0!==t?this._children.splice(t,0,e):this._children.push(e)}removeChild(e){const t=this._children.indexOf(e);return this._children.splice(t,1),t}remove(){let e=this._parent.removeChild(this);for(const t of this._children)t._parent=this._parent,this._parent.addChild(t,e++)}insertAsParentOf(e){const t=e.parent;t.removeChild(this),this.parent=t,e.parent=this}swapWithParent(){const e=this._parent,t=e.parent;for(const r of this._children)r.parent=e;this._children=[],e.removeChild(this);const n=e.parent.removeChild(e);this._parent=t,t.addChild(this,n),e.parent=this}}class N2 extends j2{clone(){const e=new this.constructor;return e.debugName=`clone_${this.debugName}`,e._source=this._source,e._name=`clone_${this._name}`,e.type=this.type,e.refCounts=this.refCounts,e.refCounts[e._name]=0,e}constructor(e,t,n,r){super(e,t),this.type=n,this.refCounts=r,this._source=this._name=t,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}dependentFields(){return new Set}producedFields(){return new Set}hash(){return void 0===this._hash&&(this._hash=`Output ${tG()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(e){this._source=e}}function S2(e){return void 0!==e.as}function A2(e){return`${e}_end`}class $2 extends j2{clone(){return new $2(null,xH(this.formula))}constructor(e,t){super(e),this.formula=t}static makeFromEncoding(e,t){const n=t.reduceFieldDef(((e,n)=>{const{field:r,timeUnit:i}=n;if(i){let o;if(BX(i)){if(O4(t)){const{mark:e}=t;(aQ(e)||n.bandPosition)&&(o={timeUnit:YX(i),field:r})}}else o={as:hK(n,{forAs:!0}),field:r,timeUnit:i};o&&(e[EH(o)]=o)}return e}),{});return zH(n)?null:new $2(e,n)}static makeFromTransform(e,t){const{timeUnit:n,...r}={...t},i={...r,timeUnit:YX(n)};return new $2(e,{[EH(i)]:i})}merge(e){this.formula={...this.formula};for(const t in e.formula)this.formula[t]||(this.formula[t]=e.formula[t]);for(const t of e.children)e.removeChild(t),t.parent=this;e.remove()}removeFormulas(e){const t={};for(const[n,r]of BH(this.formula)){const i=S2(r)?r.as:`${r.field}_end`;e.has(i)||(t[n]=r)}this.formula=t}producedFields(){return new Set(LH(this.formula).map((e=>S2(e)?e.as:A2(e.field))))}dependentFields(){return new Set(LH(this.formula).map((e=>e.field)))}hash(){return`TimeUnit ${EH(this.formula)}`}assemble(){const e=[];for(const t of LH(this.formula))if(S2(t)){const{field:n,as:r,timeUnit:i}=t,{unit:o,utc:a,...s}=YX(i);e.push({field:YH(n),type:"timeunit",...o?{units:WX(o)}:{},...a?{timezone:"utc"}:{},...s,as:[r,`${r}_end`]})}else if(t){const{field:n,timeUnit:r}=t,i=ZX(r?.unit),{part:o,step:a}=QX(i,r.step);e.push({type:"formula",expr:`timeOffset('${o}', datum['${n}'], ${a})`,as:A2(n)})}return e}}const C2="_tuple_fields";class M2{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.items=t,this.hasChannel={},this.hasField={},this.hasSelectionId=!1}}const P2={defined:()=>!0,parse:(e,t,n)=>{const r=t.name,i=t.project??(t.project=new M2),o={},a={},s=new Set,l=(e,t)=>{const n="visual"===t?e.channel:e.field;let i=UH(`${r}_${n}`);for(let o=1;s.has(i);o++)i=UH(`${r}_${n}_${o}`);return s.add(i),{[t]:i}},u=t.type,c=e.config.selection[u],f=void 0!==n.value?Ga(n.value):null;let{fields:d,encodings:h}=_a(n.select)?n.select:{};if(!d&&!h&&f)for(const p of f)if(_a(p))for(const e of RH(p))sV[e]?(h||(h=[])).push(e):"interval"===u?(AX('Interval selections should be initialized using "x", "y", "longitude", or "latitude" keys.'),h=c.encodings):(d??(d=[])).push(e);d||h||(h=c.encodings,"fields"in c&&(d=c.fields));for(const p of h??[]){const t=e.fieldDef(p);if(t){let n=t.field;if(t.aggregate){AX(nX(p,t.aggregate));continue}if(!n){AX(tX(p));continue}if(t.timeUnit&&!BX(t.timeUnit)){n=e.vgField(p);const r={timeUnit:t.timeUnit,as:n,field:t.field};a[EH(r)]=r}if(!o[n]){const r={field:n,channel:p,type:"interval"===u&&tY(p)&&AJ(e.getScaleComponent(p).get("type"))?"R":t.bin?"R-RE":"E",index:i.items.length};r.signals={...l(r,"data"),...l(r,"visual")},i.items.push(o[n]=r),i.hasField[n]=o[n],i.hasSelectionId=i.hasSelectionId||n===N0,HG(p)?(r.geoChannel=p,r.channel=ZG(p),i.hasChannel[r.channel]=o[n]):i.hasChannel[p]=o[n]}}else AX(tX(p))}for(const p of d??[]){if(i.hasField[p])continue;const e={type:"E",field:p,index:i.items.length};e.signals={...l(e,"data")},i.items.push(e),i.hasField[p]=e,i.hasSelectionId=i.hasSelectionId||p===N0}f&&(t.init=f.map((e=>i.items.map((t=>_a(e)?void 0!==e[t.geoChannel||t.channel]?e[t.geoChannel||t.channel]:e[t.field]:e))))),zH(a)||(i.timeUnit=new $2(null,a))},signals:(e,t,n)=>{const r=t.name+C2;return n.filter((e=>e.name===r)).length>0||t.project.hasSelectionId?n:n.concat({name:r,value:t.project.items.map(w2)})}},F2={defined:e=>"interval"===e.type&&"global"===e.resolve&&e.bind&&"scales"===e.bind,parse:(e,t)=>{const n=t.scales=[];for(const r of t.project.items){const i=r.channel;if(!tY(i))continue;const o=e.getScaleComponent(i),a=o?o.get("type"):void 0;o&&AJ(a)?(o.set("selectionExtent",{param:t.name,field:r.field},!0),n.push(r)):AX("Scale bindings are currently only supported for scales with unbinned, continuous domains.")}},topLevelSignals:(e,t,n)=>{const r=t.scales.filter((e=>0===n.filter((t=>t.name===e.signals.data)).length));if(!e.parent||z2(e)||0===r.length)return n;const i=n.filter((e=>e.name===t.name))[0];let o=i.update;if(o.indexOf(L3)>=0)i.update=`{${r.map((e=>`${js(YH(e.field))}: ${e.signals.data}`)).join(", ")}}`;else{for(const e of r){const t=`${js(YH(e.field))}: ${e.signals.data}`;o.includes(t)||(o=`${o.substring(0,o.length-1)}, ${t}}`)}i.update=o}return n.concat(r.map((e=>({name:e.signals.data}))))},signals:(e,t,n)=>{if(e.parent&&!z2(e))for(const r of t.scales){const e=n.filter((e=>e.name===r.signals.data))[0];e.push="outer",delete e.value,delete e.update}return n}};function T2(e,t){return`domain(${js(e.scaleName(t))})`}function z2(e){return e.parent&&j4(e.parent)&&(!e.parent.parent??z2(e.parent.parent))}const R2="_brush",L2="_scale_trigger",B2="geo_interval_init_tick",I2="_init",U2={defined:e=>"interval"===e.type,parse:(e,t,n)=>{var r;if(e.hasProjection){const e={..._a(n.select)?n.select:{}};e.fields=[N0],e.encodings||(e.encodings=n.value?RH(n.value):[xG,bG]),n.select={type:"interval",...e}}if(t.translate&&!F2.defined(t)){const e=`!event.item || event.item.mark.name !== ${js(t.name+R2)}`;for(const n of t.events){if(!n.between){AX(`${n} is not an ordered event stream for interval selections.`);continue}const t=Ga((r=n.between[0]).filter??(r.filter=[]));t.indexOf(e)<0&&t.push(e)}}},signals:(e,t,n)=>{const r=t.name,i=r+z3,o=LH(t.project.hasChannel).filter((e=>e.channel===uG||e.channel===cG)),a=t.init?t.init[0]:null;if(n.push(...o.reduce(((n,r)=>n.concat(function(e,t,n,r){const i=!e.hasProjection,o=n.channel,a=n.signals.visual,s=js(i?e.scaleName(o):e.projectionName()),l=e=>`scale(${s}, ${e})`,u=e.getSizeSignalRef(o===uG?"width":"height").signal,c=`${o}(unit)`,f=t.events.reduce(((e,t)=>[...e,{events:t.between[0],update:`[${c}, ${c}]`},{events:t,update:`[${a}[0], clamp(${c}, 0, ${u})]`}]),[]);if(i){const i=n.signals.data,u=F2.defined(t),c=e.getScaleComponent(o),d=c?c.get("type"):void 0,h=r?{init:k2(r,!0,l)}:{value:[]};return f.push({events:{signal:t.name+L2},update:AJ(d)?`[${l(`${i}[0]`)}, ${l(`${i}[1]`)}]`:"[0, 0]"}),u?[{name:i,on:[]}]:[{name:a,...h,on:f},{name:i,...r?{init:k2(r)}:{},on:[{events:{signal:a},update:`${a}[0] === ${a}[1] ? null : invert(${s}, ${a})`}]}]}{const e=o===uG?0:1,n=t.name+I2;return[{name:a,...r?{init:`[${n}[0][${e}], ${n}[1][${e}]]`}:{value:[]},on:f}]}}(e,t,r,a&&a[r.index]))),[])),e.hasProjection){const s=js(e.projectionName()),l=e.projectionName()+"_center",{x:u,y:c}=t.project.hasChannel,f=u&&u.signals.visual,d=c&&c.signals.visual,h=u?a&&a[u.index]:`${l}[0]`,p=c?a&&a[c.index]:`${l}[1]`,m=t=>e.getSizeSignalRef(t).signal,g=`[[${f?f+"[0]":"0"}, ${d?d+"[0]":"0"}],[${f?f+"[1]":m("width")}, ${d?d+"[1]":m("height")}]]`;if(a&&(n.unshift({name:r+I2,init:`[scale(${s}, [${u?h[0]:h}, ${c?p[0]:p}]), scale(${s}, [${u?h[1]:h}, ${c?p[1]:p}])]`}),!u||!c)){n.find((e=>e.name===l))||n.unshift({name:l,update:`invert(${s}, [${m("width")}/2, ${m("height")}/2])`})}const y=`vlSelectionTuples(${`intersect(${g}, {markname: ${js(e.getName("marks"))}}, unit.mark)`}, ${`{unit: ${I3(e)}}`})`,v=o.map((e=>e.signals.visual));return n.concat({name:i,on:[{events:[...v.length?[{signal:v.join(" || ")}]:[],...a?[{signal:B2}]:[]],update:y}]})}{if(!F2.defined(t)){const t=r+L2,i=o.map((t=>{const n=t.channel,{data:r,visual:i}=t.signals,o=js(e.scaleName(n)),a=AJ(e.getScaleComponent(n).get("type"))?"+":"";return`(!isArray(${r}) || (${a}invert(${o}, ${i})[0] === ${a}${r}[0] && ${a}invert(${o}, ${i})[1] === ${a}${r}[1]))`}));i.length&&n.push({name:t,value:{},on:[{events:o.map((t=>({scale:e.scaleName(t.channel)}))),update:i.join(" && ")+` ? ${t} : {}`}]})}const s=o.map((e=>e.signals.data)),l=`unit: ${I3(e)}, fields: ${r+C2}, values`;return n.concat({name:i,...a?{init:`{${l}: ${k2(a)}}`}:{},...s.length?{on:[{events:[{signal:s.join(" || ")}],update:`${s.join(" && ")} ? {${l}: [${s}]} : null`}]}:{}})}},topLevelSignals:(e,t,n)=>{if(O4(e)&&e.hasProjection&&t.init){n.filter((e=>e.name===B2)).length||n.unshift({name:B2,value:null,on:[{events:"timer{1}",update:`${B2} === null ? {} : ${B2}`}]})}return n},marks:(e,t,n)=>{const r=t.name,{x:i,y:o}=t.project.hasChannel,a=i?.signals.visual,s=o?.signals.visual,l=`data(${js(t.name+T3)})`;if(F2.defined(t)||!i&&!o)return n;const u={x:void 0!==i?{signal:`${a}[0]`}:{value:0},y:void 0!==o?{signal:`${s}[0]`}:{value:0},x2:void 0!==i?{signal:`${a}[1]`}:{field:{group:"width"}},y2:void 0!==o?{signal:`${s}[1]`}:{field:{group:"height"}}};if("global"===t.resolve)for(const m of RH(u))u[m]=[{test:`${l}.length && ${l}[0].unit === ${I3(e)}`,...u[m]},{value:0}];const{fill:c,fillOpacity:f,cursor:d,...h}=t.mark,p=RH(h).reduce(((e,t)=>(e[t]=[{test:[void 0!==i&&`${a}[0] !== ${a}[1]`,void 0!==o&&`${s}[0] !== ${s}[1]`].filter((e=>e)).join(" && "),value:h[t]},{value:null}],e)),{});return[{name:`${r+R2}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:c},fillOpacity:{value:f}},update:u}},...n,{name:r+R2,type:"rect",clip:!0,encode:{enter:{...d?{cursor:{value:d}}:{},fill:{value:"transparent"}},update:{...u,...p}}}]}};const q2={defined:e=>"point"===e.type,signals:(e,t,n)=>{const r=t.name,i=r+C2,o=t.project,a="(item().isVoronoi ? datum.datum : datum)",s=LH(e.component.selection??{}).reduce(((e,t)=>"interval"===t.type?e.concat(t.name+R2):e),[]).map((e=>`indexof(item().mark.name, '${e}') < 0`)).join(" && "),l="datum && item().mark.marktype !== 'group' && indexof(item().mark.role, 'legend') < 0"+(s?` && ${s}`:"");let u=`unit: ${I3(e)}, `;if(t.project.hasSelectionId)u+=`${N0}: ${a}[${js(N0)}]`;else{u+=`fields: ${i}, values: [${o.items.map((t=>{const n=e.fieldDef(t.channel);return n?.bin?`[${a}[${js(e.vgField(t.channel,{}))}], ${a}[${js(e.vgField(t.channel,{binSuffix:"end"}))}]]`:`${a}[${js(t.field)}]`})).join(", ")}]`}const c=t.events;return n.concat([{name:r+z3,on:c?[{events:c,update:`${l} ? {${u}} : null`,force:!0}]:[]}])}};function W2(e,t,n,r){const i=XQ(t)&&t.condition,o=r(t);if(i){const t=Ga(i).map((t=>{const n=r(t);if(function(e){return e.param}(t)){const{param:r,empty:i}=t;return{test:V3(e,{param:r,empty:i}),...n}}return{test:X3(e,t.test),...n}}));return{[n]:[...t,...void 0!==o?[o]:[]]}}return void 0!==o?{[n]:o}:{}}function Z2(e,t){void 0===t&&(t="text");const n=e.encoding[t];return W2(e,n,t,(t=>H2(t,e.config)))}function H2(e,t,n){if(void 0===n&&(n="datum"),e){if(sK(e))return FY(e.value);if(oK(e)){const{format:r,formatType:i}=wK(e);return DQ({fieldOrDatumDef:e,format:r,formatType:i,expr:n,config:t})}}}function G2(e,t){void 0===t&&(t={});const{encoding:n,markDef:r,config:i,stack:o}=e,a=n.tooltip;if(ka(a))return{tooltip:Y2({tooltip:a},o,i,t)};{const s=t.reactiveGeom?"datum.datum":"datum";return W2(e,a,"tooltip",(e=>{const a=H2(e,i,s);if(a)return a;if(null===e)return;let l=IY("tooltip",r,i);return!0===l&&(l={content:"encoding"}),bs(l)?{value:l}:_a(l)?DY(l)?l:"encoding"===l.content?Y2(n,o,i,t):{signal:s}:void 0}))}}function V2(e,t,n,r){let{reactiveGeom:i}=void 0===r?{}:r;const o={...n,...n.tooltipFormat},a={},s=i?"datum.datum":"datum",l=[];function u(n,r){const i=fV(r),u=aK(n)?n:{...n,type:e[i].type},c=Ga(u.title||xK(u,o)).join(", ").replaceAll(/"/g,'\\"');let f;if(zV(r)){const t="x"===r?"x2":"y2",n=kK(e[t]);if(vY(u.bin)&&n){const e=hK(u,{expr:s}),r=hK(n,{expr:s}),{format:i,formatType:l}=wK(u);f=PQ(e,r,i,l,o),a[t]=!0}}if((zV(r)||r===yG||r===mG)&&t&&t.fieldChannel===r&&"normalize"===t.offset){const{format:e,formatType:t}=wK(u);f=DQ({fieldOrDatumDef:u,format:e,formatType:t,expr:s,config:o,normalizeStack:!0}).signal}f??(f=H2(u,o,s).signal),l.push({channel:r,key:c,value:f})}XK(e,((e,t)=>{KQ(e)?u(e,t):JQ(e)&&u(e.condition,t)}));const c={};for(const{channel:f,key:d,value:h}of l)a[f]||c[d]||(c[d]=h);return c}function Y2(e,t,n,r){let{reactiveGeom:i}=void 0===r?{}:r;const o=V2(e,t,n,{reactiveGeom:i}),a=BH(o).map((e=>{let[t,n]=e;return`"${t}": ${n}`}));return a.length>0?{signal:`{${a.join(", ")}}`}:void 0}function X2(e){const{markDef:t,config:n}=e,r=IY("aria",t,n);return!1===r?{}:{...r?{aria:r}:{},...J2(e),...Q2(e)}}function J2(e){const{mark:t,markDef:n,config:r}=e;if(!1===r.aria)return{};const i=IY("ariaRoleDescription",n,r);return null!=i?{ariaRoleDescription:{value:i}}:t in AY?{}:{ariaRoleDescription:{value:t}}}function Q2(e){const{encoding:t,markDef:n,config:r,stack:i}=e,o=t.description;if(o)return W2(e,o,"description",(t=>H2(t,e.config)));const a=IY("description",n,r);if(null!=a)return{description:FY(a)};if(!1===r.aria)return{};const s=V2(t,i,r);return zH(s)?void 0:{description:{signal:BH(s).map(((e,t)=>{let[n,r]=e;return`"${t>0?"; ":""}${n}: " + (${r})`})).join(" + ")}}}function K2(e,t,n){void 0===n&&(n={});const{markDef:r,encoding:i,config:o}=t,{vgChannel:a}=n;let{defaultRef:s,defaultValue:l}=n;void 0===s&&(l??(l=IY(e,r,o,{vgChannel:a,ignoreVgConfig:!0})),void 0!==l&&(s=FY(l)));const u=i[e];return W2(t,u,a??e,(n=>wQ({channel:e,channelDef:n,markDef:r,config:o,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:s})))}function e3(e,t){void 0===t&&(t={filled:void 0});const{markDef:n,encoding:r,config:i}=e,{type:o}=n,a=t.filled??IY("filled",n,i),s=jH(["bar","point","circle","square","geoshape"],o)?"transparent":void 0,l=IY(!0===a?"color":void 0,n,i,{vgChannel:"fill"})??i.mark[!0===a&&"color"]??s,u=IY(!1===a?"color":void 0,n,i,{vgChannel:"stroke"})??i.mark[!1===a&&"color"],c=a?"fill":"stroke",f={...l?{fill:FY(l)}:{},...u?{stroke:FY(u)}:{}};return n.color&&(a?n.fill:n.stroke)&&AX(dX("property",{fill:"fill"in n,stroke:"stroke"in n})),{...f,...K2("color",e,{vgChannel:c,defaultValue:a?l:u}),...K2("fill",e,{defaultValue:r.fill?l:void 0}),...K2("stroke",e,{defaultValue:r.stroke?u:void 0})}}function t3(e){const{encoding:t,mark:n}=e,r=t.order;return!oQ(n)&&sK(r)?W2(e,r,"zindex",(e=>FY(e.value))):{}}function n3(e){let{channel:t,markDef:n,encoding:r={},model:i,bandPosition:o}=e;const a=`${t}Offset`,s=n[a],l=r[a];if(("xOffset"===a||"yOffset"===a)&&l){return{offsetType:"encoding",offset:wQ({channel:a,channelDef:l,markDef:n,config:i?.config,scaleName:i.scaleName(a),scale:i.getScaleComponent(a),stack:null,defaultRef:FY(s),bandPosition:o})}}const u=n[a];return u?{offsetType:"visual",offset:u}:{}}function r3(e,t,n){let{defaultPos:r,vgChannel:i}=n;const{encoding:o,markDef:a,config:s,stack:l}=t,u=o[e],c=o[hV(e)],f=t.scaleName(e),d=t.getScaleComponent(e),{offset:h,offsetType:p}=n3({channel:e,markDef:a,encoding:o,model:t,bandPosition:.5}),m=i3({model:t,defaultPos:r,channel:e,scaleName:f,scale:d}),g=!u&&zV(e)&&(o.latitude||o.longitude)?{field:t.getName(e)}:function(e){const{channel:t,channelDef:n,scaleName:r,stack:i,offset:o,markDef:a}=e;if(oK(n)&&i&&t===i.fieldChannel){if(KQ(n)){let e=n.bandPosition;if(void 0!==e||"text"!==a.type||"radius"!==t&&"theta"!==t||(e=.5),void 0!==e)return xQ({scaleName:r,fieldOrDatumDef:n,startSuffix:"start",bandPosition:e,offset:o})}return bQ(n,r,{suffix:"end"},{offset:o})}return gQ(e)}({channel:e,channelDef:u,channel2Def:c,markDef:a,config:s,scaleName:f,scale:d,stack:l,offset:h,defaultRef:m,bandPosition:"encoding"===p?0:void 0});return g?{[i||e]:g}:void 0}function i3(e){let{model:t,defaultPos:n,channel:r,scaleName:i,scale:o}=e;const{markDef:a,config:s}=t;return()=>{const e=fV(r),l=dV(r),u=IY(r,a,s,{vgChannel:l});if(void 0!==u)return kQ(r,u);switch(n){case"zeroOrMin":case"zeroOrMax":if(i){const e=o.get("type");if(jH([vJ.LOG,vJ.TIME,vJ.UTC],e));else if(o.domainDefinitelyIncludesZero())return{scale:i,value:0}}if("zeroOrMin"===n)return"y"===e?{field:{group:"height"}}:{value:0};switch(e){case"radius":return{signal:`min(${t.width.signal},${t.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":return{...t[pV(r)],mult:.5}}}}const o3={left:"x",center:"xc",right:"x2"},a3={top:"y",middle:"yc",bottom:"y2"};function s3(e,t,n,r){if(void 0===r&&(r="middle"),"radius"===e||"theta"===e)return dV(e);const i="x"===e?"align":"baseline",o=IY(i,t,n);let a;return DY(o)?(AX(function(e){return`The ${e} for range marks cannot be an expression`}(i)),a=void 0):a=o,"x"===e?o3[a||("top"===r?"left":"center")]:a3[a||r]}function l3(e,t,n){let{defaultPos:r,defaultPos2:i,range:o}=n;return o?u3(e,t,{defaultPos:r,defaultPos2:i}):r3(e,t,{defaultPos:r})}function u3(e,t,n){let{defaultPos:r,defaultPos2:i}=n;const{markDef:o,config:a}=t,s=hV(e),l=pV(e),u=function(e,t,n){const{encoding:r,mark:i,markDef:o,stack:a,config:s}=e,l=fV(n),u=pV(n),c=dV(n),f=r[l],d=e.scaleName(l),h=e.getScaleComponent(l),{offset:p}=n3(n in r||n in o?{channel:n,markDef:o,encoding:r,model:e}:{channel:l,markDef:o,encoding:r,model:e});if(!f&&("x2"===n||"y2"===n)&&(r.latitude||r.longitude)){const t=pV(n),r=e.markDef[t];return null!=r?{[t]:{value:r}}:{[c]:{field:e.getName(n)}}}const m=function(e){let{channel:t,channelDef:n,channel2Def:r,markDef:i,config:o,scaleName:a,scale:s,stack:l,offset:u,defaultRef:c}=e;if(oK(n)&&l&&t.charAt(0)===l.fieldChannel.charAt(0))return bQ(n,a,{suffix:"start"},{offset:u});return gQ({channel:t,channelDef:r,scaleName:a,scale:s,stack:l,markDef:i,config:o,offset:u,defaultRef:c})}({channel:n,channelDef:f,channel2Def:r[n],markDef:o,config:s,scaleName:d,scale:h,stack:a,offset:p,defaultRef:void 0});if(void 0!==m)return{[c]:m};return c3(n,o)||c3(n,{[n]:qY(n,o,s.style),[u]:qY(u,o,s.style)})||c3(n,s[i])||c3(n,s.mark)||{[c]:i3({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}(t,i,s);return{...r3(e,t,{defaultPos:r,vgChannel:u[l]?s3(e,o,a):dV(e)}),...u}}function c3(e,t){const n=pV(e),r=dV(e);if(void 0!==t[r])return{[r]:kQ(e,t[r])};if(void 0!==t[e])return{[r]:kQ(e,t[e])};if(t[n]){const r=t[n];if(!dQ(r))return{[n]:kQ(e,r)};AX(function(e){return`Position range does not support relative band size for ${e}.`}(n))}}function f3(e,t){const{config:n,encoding:r,markDef:i}=e,o=i.type,a=hV(t),s=pV(t),l=r[t],u=r[a],c=e.getScaleComponent(t),f=c?c.get("type"):void 0,d=i.orient,h=r[s]??r.size??IY("size",i,n,{vgChannel:s}),p=mV(t),m="bar"===o&&("x"===t?"vertical"===d:"horizontal"===d);return!KQ(l)||!(yY(l.bin)||vY(l.bin)||l.timeUnit&&!u)||h&&!dQ(h)||r[p]||SJ(f)?(oK(l)&&SJ(f)||m)&&!u?function(e,t,n){const{markDef:r,encoding:i,config:o,stack:a}=n,s=r.orient,l=n.scaleName(t),u=n.getScaleComponent(t),c=pV(t),f=hV(t),d=mV(t),h=n.scaleName(d),p=n.getScaleComponent(gV(t)),m="horizontal"===s&&"y"===t||"vertical"===s&&"x"===t;let g;(i.size||r.size)&&(m?g=K2("size",n,{vgChannel:c,defaultRef:FY(r.size)}):AX(function(e){return`Cannot apply size to non-oriented mark "${e}".`}(r.type)));const y=!!g,v=GQ({channel:t,fieldDef:e,markDef:r,config:o,scaleType:u?.get("type"),useVlSizeChannel:m});g=g||{[c]:d3(c,h||l,p||u,o,v,!!e,r.type)};const b="band"===u?.get("type")&&dQ(v)&&!y?"top":"middle",x=s3(t,r,o,b),w="xc"===x||"yc"===x,{offset:k,offsetType:_}=n3({channel:t,markDef:r,encoding:i,model:n,bandPosition:w?.5:0}),O=gQ({channel:t,channelDef:e,markDef:r,config:o,scaleName:l,scale:u,stack:a,offset:k,defaultRef:i3({model:n,defaultPos:"mid",channel:t,scaleName:l,scale:u}),bandPosition:w?"encoding"===_?0:.5:DY(v)?{signal:`(1-${v})/2`}:dQ(v)?(1-v.band)/2:0});if(c)return{[x]:O,...g};{const e=dV(f),t=g[c],n=k?{...t,offset:k}:t;return{[x]:O,[e]:ka(O)?[O[0],{...O[1],offset:n}]:{...O,offset:n}}}}(l,t,e):u3(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"}):function(e){let{fieldDef:t,fieldDef2:n,channel:r,model:i}=e;const{config:o,markDef:a,encoding:s}=i,l=i.getScaleComponent(r),u=i.scaleName(r),c=l?l.get("type"):void 0,f=l.get("reverse"),d=GQ({channel:r,fieldDef:t,markDef:a,config:o,scaleType:c}),h=i.component.axes[r]?.[0],p=h?.get("translate")??.5,m=zV(r)?IY("binSpacing",a,o)??0:0,g=hV(r),y=dV(r),v=dV(g),b=UY("minBandSize",a,o),{offset:x}=n3({channel:r,markDef:a,encoding:s,model:i,bandPosition:0}),{offset:w}=n3({channel:g,markDef:a,encoding:s,model:i,bandPosition:0}),k=function(e){let{scaleName:t,fieldDef:n}=e;const r=hK(n,{expr:"datum"});return`abs(scale("${t}", ${hK(n,{expr:"datum",suffix:"end"})}) - scale("${t}", ${r}))`}({fieldDef:t,scaleName:u}),_=h3(r,m,f,p,x,b,k),O=h3(g,m,f,p,w??x,b,k),E=DY(d)?{signal:`(1-${d.signal})/2`}:dQ(d)?(1-d.band)/2:.5;if(yY(t.bin)||t.timeUnit)return{[v]:p3({fieldDef:t,scaleName:u,bandPosition:E,offset:O}),[y]:p3({fieldDef:t,scaleName:u,bandPosition:DY(E)?{signal:`1-${E.signal}`}:1-E,offset:_})};if(vY(t.bin)){const e=bQ(t,u,{},{offset:O});if(KQ(n))return{[v]:e,[y]:bQ(n,u,{},{offset:_})};if(bY(t.bin)&&t.bin.step)return{[v]:e,[y]:{signal:`scale("${u}", ${hK(t,{expr:"datum"})} + ${t.bin.step})`,offset:_}}}return void AX(jX(g))}({fieldDef:l,fieldDef2:u,channel:t,model:e})}function d3(e,t,n,r,i,o,a){if(dQ(i)){if(!n)return{mult:i.band,field:{group:e}};{const e=n.get("type");if("band"===e){let e=`bandwidth('${t}')`;1!==i.band&&(e=`${i.band} * ${e}`);const n=UY("minBandSize",{type:a},r);return{signal:n?`max(${RY(n)}, ${e})`:e}}1!==i.band&&(AX(function(e){return`Cannot use the relative band size with ${e} scale.`}(e)),i=void 0)}}else{if(DY(i))return i;if(i)return{value:i}}if(n){const e=n.get("range");if(jY(e)&&ys(e.step))return{value:e.step-2}}if(!o){const{bandPaddingInner:t,barBandPaddingInner:n,rectBandPaddingInner:i}=r.scale,o=KH(t,"bar"===a?n:i);if(DY(o))return{signal:`(1 - (${o.signal})) * ${e}`};if(ys(o))return{signal:`${1-o} * ${e}`}}return{value:U0(r.view,e)-2}}function h3(e,t,n,r,i,o,a){if(qG(e))return 0;const s="x"===e||"y2"===e,l=s?-t/2:t/2;if(DY(n)||DY(i)||DY(r)||o){const e=RY(n),t=RY(i),u=RY(r),c=RY(o),f=o?`(${a} < ${c} ? ${s?"":"-"}0.5 * (${c} - (${a})) : ${l})`:l;return{signal:(u?`${u} + `:"")+(e?`(${e} ? -1 : 1) * `:"")+(t?`(${t} + ${f})`:f)}}return i=i||0,r+(n?-i-l:+i+l)}function p3(e){let{fieldDef:t,scaleName:n,bandPosition:r,offset:i}=e;return xQ({scaleName:n,fieldOrDatumDef:t,bandPosition:r,offset:i})}const m3=new Set(["aria","width","height"]);function g3(e,t){const{fill:n,stroke:r}="include"===t.color?e3(e):{};return{...v3(e.markDef,t),...y3(e,"fill",n),...y3(e,"stroke",r),...K2("opacity",e),...K2("fillOpacity",e),...K2("strokeOpacity",e),...K2("strokeWidth",e),...K2("strokeDash",e),...t3(e),...G2(e),...Z2(e,"href"),...X2(e)}}function y3(e,t,n){const{config:r,mark:i,markDef:o}=e;if("hide"===IY("invalid",o,r)&&n&&!oQ(i)){const r=function(e,t){let{invalid:n=!1,channels:r}=t;const i=r.reduce(((t,n)=>{const r=e.getScaleComponent(n);if(r){const i=r.get("type"),o=e.vgField(n,{expr:"datum"});o&&AJ(i)&&(t[o]=!0)}return t}),{}),o=RH(i);if(o.length>0){const e=n?"||":"&&";return o.map((e=>vQ(e,n))).join(` ${e} `)}return}(e,{invalid:!0,channels:eY});if(r)return{[t]:[{test:r,value:null},...Ga(n)]}}return n?{[t]:n}:{}}function v3(e,t){return SY.reduce(((n,r)=>(m3.has(r)||void 0===e[r]||"ignore"===t[r]||(n[r]=FY(e[r])),n)),{})}function b3(e){const{config:t,markDef:n}=e;if(IY("invalid",n,t)){const t=function(e,t){let{invalid:n=!1,channels:r}=t;const i=r.reduce(((t,n)=>{const r=e.getScaleComponent(n);if(r){const i=r.get("type"),o=e.vgField(n,{expr:"datum",binSuffix:e.stack?.impute?"mid":void 0});o&&AJ(i)&&(t[o]=!0)}return t}),{}),o=RH(i);if(o.length>0){const e=n?"||":"&&";return o.map((e=>vQ(e,n))).join(` ${e} `)}return}(e,{channels:TV});if(t)return{defined:{signal:t}}}return{}}function x3(e,t){if(void 0!==t)return{[e]:FY(t)}}const w3="voronoi",k3={defined:e=>"point"===e.type&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(w3)},marks:(e,t,n)=>{const{x:r,y:i}=t.project.hasChannel,o=e.mark;if(oQ(o))return AX(`The "nearest" transform is not supported for ${o} marks.`),n;const a={name:e.getName(w3),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0},...G2(e,{reactiveGeom:!0})}},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let s=0,l=!1;return n.forEach(((t,n)=>{const r=t.name??"";r===e.component.mark[0].name?s=n:r.indexOf(w3)>=0&&(l=!0)})),l||n.splice(s+1,0,a),n}},_3={defined:e=>"point"===e.type&&"global"===e.resolve&&e.bind&&"scales"!==e.bind&&!A0(e.bind),parse:(e,t,n)=>q3(t,n),topLevelSignals:(e,t,n)=>{const r=t.name,i=t.project,o=t.bind,a=t.init&&t.init[0],s=k3.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach(((e,i)=>{const l=UH(`${r}_${e.field}`);n.filter((e=>e.name===l)).length||n.unshift({name:l,...a?{init:k2(a[i])}:{value:null},on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${s}[${js(e.field)}] : null`}]:[],bind:o[e.field]??o[e.channel]??o})})),n},signals:(e,t,n)=>{const r=t.name,i=t.project,o=n.filter((e=>e.name===r+z3))[0],a=r+C2,s=i.items.map((e=>UH(`${r}_${e.field}`))),l=s.map((e=>`${e} !== null`)).join(" && ");return s.length&&(o.update=`${l} ? {fields: ${a}, values: [${s.join(", ")}]} : null`),delete o.value,delete o.on,n}},O3="_toggle",E3={defined:e=>"point"===e.type&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+O3,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+z3,r=t.name+O3;return`${r} ? null : ${n}, `+("global"===t.resolve?`${r} ? null : true, `:`${r} ? null : {unit: ${I3(e)}}, `)+`${r} ? ${n} : null`}},D3={defined:e=>void 0!==e.clear&&!1!==e.clear,parse:(e,t)=>{t.clear&&(t.clear=bs(t.clear)?AI(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(_3.defined(t))for(const r of t.project.items){const e=n.findIndex((e=>e.name===UH(`${t.name}_${r.field}`)));-1!==e&&n[e].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function r(e,r){-1!==e&&n[e].on&&n[e].on.push({events:t.clear,update:r})}if("interval"===t.type)for(const i of t.project.items){const e=n.findIndex((e=>e.name===i.signals.visual));if(r(e,"[0, 0]"),-1===e){r(n.findIndex((e=>e.name===i.signals.data)),"null")}}else{let e=n.findIndex((e=>e.name===t.name+z3));r(e,"null"),E3.defined(t)&&(e=n.findIndex((e=>e.name===t.name+O3)),r(e,"false"))}return n}},j3={defined:e=>{const t="global"===e.resolve&&e.bind&&A0(e.bind),n=1===e.project.items.length&&e.project.items[0].field!==N0;return t&&!n&&AX("Legend bindings are only supported for selections over an individual field or encoding channel."),t&&n},parse:(e,t,n)=>{const r=xH(n);if(r.select=bs(r.select)?{type:r.select,toggle:t.toggle}:{...r.select,toggle:t.toggle},q3(t,r),_a(n.select)&&(n.select.on||n.select.clear)){const e='event.item && indexof(event.item.mark.role, "legend") < 0';for(const n of t.events)n.filter=Ga(n.filter??[]),n.filter.includes(e)||n.filter.push(e)}const i=$0(t.bind)?t.bind.legend:"click",o=bs(i)?AI(i,"view"):Ga(i);t.bind={legend:{merge:o}}},topLevelSignals:(e,t,n)=>{const r=t.name,i=$0(t.bind)&&t.bind.legend,o=e=>t=>{const n=xH(t);return n.markname=e,n};for(const a of t.project.items){if(!a.hasLegend)continue;const e=`${UH(a.field)}_legend`,s=`${r}_${e}`;if(0===n.filter((e=>e.name===s)).length){const r=i.merge.map(o(`${e}_symbols`)).concat(i.merge.map(o(`${e}_labels`))).concat(i.merge.map(o(`${e}_entries`)));n.unshift({name:s,...t.init?{}:{value:null},on:[{events:r,update:"isDefined(datum.value) ? datum.value : item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:`!event.item || !datum ? null : ${s}`,force:!0}]})}}return n},signals:(e,t,n)=>{const r=t.name,i=t.project,o=n.find((e=>e.name===r+z3)),a=r+C2,s=i.items.filter((e=>e.hasLegend)).map((e=>UH(`${r}_${UH(e.field)}_legend`))),l=`${s.map((e=>`${e} !== null`)).join(" && ")} ? {fields: ${a}, values: [${s.join(", ")}]} : null`;t.events&&s.length>0?o.on.push({events:s.map((e=>({signal:e}))),update:l}):s.length>0&&(o.update=l,delete o.value,delete o.on);const u=n.find((e=>e.name===r+O3)),c=$0(t.bind)&&t.bind.legend;return u&&(t.events?u.on.push({...u.on[0],events:c}):u.on[0].events=c),n}};const N3="_translate_anchor",S3="_translate_delta",A3={defined:e=>"interval"===e.type&&e.translate,signals:(e,t,n)=>{const r=t.name,i=F2.defined(t),o=r+N3,{x:a,y:s}=t.project.hasChannel;let l=AI(t.translate,"scope");return i||(l=l.map((e=>(e.between[0].markname=r+R2,e)))),n.push({name:o,value:{},on:[{events:l.map((e=>e.between[0])),update:"{x: x(unit), y: y(unit)"+(void 0!==a?`, extent_x: ${i?T2(e,uG):`slice(${a.signals.visual})`}`:"")+(void 0!==s?`, extent_y: ${i?T2(e,cG):`slice(${s.signals.visual})`}`:"")+"}"}]},{name:r+S3,value:{},on:[{events:l,update:`{x: ${o}.x - x(unit), y: ${o}.y - y(unit)}`}]}),void 0!==a&&$3(e,t,a,"width",n),void 0!==s&&$3(e,t,s,"height",n),n}};function $3(e,t,n,r,i){const o=t.name,a=o+N3,s=o+S3,l=n.channel,u=F2.defined(t),c=i.filter((e=>e.name===n.signals[u?"data":"visual"]))[0],f=e.getSizeSignalRef(r).signal,d=e.getScaleComponent(l),h=d&&d.get("type"),p=d&&d.get("reverse"),m=`${a}.extent_${l}`,g=`${u&&d?"log"===h?"panLog":"symlog"===h?"panSymlog":"pow"===h?"panPow":"panLinear":"panLinear"}(${m}, ${`${u?l===uG?p?"":"-":p?"-":"":""}${s}.${l} / ${u?`${f}`:`span(${m})`}`}${u?"pow"===h?`, ${d.get("exponent")??1}`:"symlog"===h?`, ${d.get("constant")??1}`:"":""})`;c.on.push({events:{signal:s},update:u?g:`clampRange(${g}, 0, ${f})`})}const C3="_zoom_anchor",M3="_zoom_delta",P3={defined:e=>"interval"===e.type&&e.zoom,signals:(e,t,n)=>{const r=t.name,i=F2.defined(t),o=r+M3,{x:a,y:s}=t.project.hasChannel,l=js(e.scaleName(uG)),u=js(e.scaleName(cG));let c=AI(t.zoom,"scope");return i||(c=c.map((e=>(e.markname=r+R2,e)))),n.push({name:r+C3,on:[{events:c,update:i?"{"+[l?`x: invert(${l}, x(unit))`:"",u?`y: invert(${u}, y(unit))`:""].filter((e=>e)).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:o,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==a&&F3(e,t,a,"width",n),void 0!==s&&F3(e,t,s,"height",n),n}};function F3(e,t,n,r,i){const o=t.name,a=n.channel,s=F2.defined(t),l=i.filter((e=>e.name===n.signals[s?"data":"visual"]))[0],u=e.getSizeSignalRef(r).signal,c=e.getScaleComponent(a),f=c&&c.get("type"),d=s?T2(e,a):l.name,h=o+M3,p=`${s&&c?"log"===f?"zoomLog":"symlog"===f?"zoomSymlog":"pow"===f?"zoomPow":"zoomLinear":"zoomLinear"}(${d}, ${`${o}${C3}.${a}`}, ${h}${s?"pow"===f?`, ${c.get("exponent")??1}`:"symlog"===f?`, ${c.get("constant")??1}`:"":""})`;l.on.push({events:{signal:h},update:s?p:`clampRange(${p}, 0, ${u})`})}const T3="_store",z3="_tuple",R3="_modify",L3="vlSelectionResolve",B3=[q2,U2,P2,E3,_3,F2,j3,D3,A3,P3,k3];function I3(e,t){let{escape:n}=void 0===t?{escape:!0}:t,r=n?js(e.name):e.name;const i=function(e){let t=e.parent;for(;t&&!E4(t);)t=t.parent;return t}(e);if(i){const{facet:e}=i;for(const t of JG)e[t]&&(r+=` + '__facet_${t}_' + (facet[${js(i.vgField(t))}])`)}return r}function U3(e){return LH(e.component.selection??{}).reduce(((e,t)=>e||t.project.hasSelectionId),!1)}function q3(e,t){!bs(t.select)&&t.select.on||delete e.events,!bs(t.select)&&t.select.clear||delete e.clear,!bs(t.select)&&t.select.toggle||delete e.toggle}function W3(e){const t=[];return"Identifier"===e.type?[e.name]:"Literal"===e.type?[e.value]:("MemberExpression"===e.type&&(t.push(...W3(e.object)),t.push(...W3(e.property))),t)}function Z3(e){return"MemberExpression"===e.object.type?Z3(e.object):"datum"===e.object.name}function H3(e){const t=KR(e),n=new Set;return t.visit((e=>{"MemberExpression"===e.type&&Z3(e)&&n.add(W3(e).slice(1).join("."))})),n}class G3 extends j2{clone(){return new G3(null,this.model,xH(this.filter))}constructor(e,t,n){super(e),this.model=t,this.filter=n,this.expr=X3(this.model,this.filter,this),this._dependentFields=H3(this.expr)}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function V3(e,t,n,r){void 0===r&&(r="datum");const i=bs(t)?t:t.param,o=UH(i),a=js(o+T3);let s;try{s=e.getSelectionComponent(o,i)}catch(S9){return`!!${o}`}if(s.project.timeUnit){const t=n??e.component.data.raw,r=s.project.timeUnit.clone();t.parent?r.insertAsParentOf(t):t.parent=r}const l=`${s.project.hasSelectionId?"vlSelectionIdTest(":"vlSelectionTest("}${a}, ${r}${"global"===s.resolve?")":`, ${js(s.resolve)})`}`,u=`length(data(${a}))`;return!1===t.empty?`${u} && ${l}`:`!${u} || ${l}`}function Y3(e,t,n){const r=UH(t),i=n.encoding;let o,a=n.field;try{o=e.getSelectionComponent(r,t)}catch(S9){return r}if(i||a){if(i&&!a){const e=o.project.items.filter((e=>e.channel===i));!e.length||e.length>1?(a=o.project.items[0].field,AX((e.length?"Multiple ":"No ")+`matching ${js(i)} encoding found for selection ${js(n.param)}. `+`Using "field": ${js(a)}.`)):a=e[0].field}}else a=o.project.items[0].field,o.project.items.length>1&&AX(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${js(a)}.`);return`${o.name}[${js(YH(a))}]`}function X3(e,t,n){return qH(t,(t=>bs(t)?t:function(e){return e?.param}(t)?V3(e,t,n):lJ(t)))}function J3(e,t,n,r){var i,o;e.encode??(e.encode={}),(i=e.encode)[t]??(i[t]={}),(o=e.encode[t]).update??(o.update={}),e.encode[t].update[n]=r}function Q3(e,t,n,r){void 0===r&&(r={header:!1});const{disable:i,orient:o,scale:a,labelExpr:s,title:l,zindex:u,...c}=e.combine();if(!i){for(const e in c){const n=TK[e],r=c[e];if(n&&n!==t&&"both"!==n)delete c[e];else if(PK(r)){const{condition:t,...n}=r,i=Ga(t),o=MK[e];if(o){const{vgProp:t,part:r}=o,a=[...i.map((e=>{const{test:t,...n}=e;return{test:X3(null,t),...n}})),n];J3(c,r,t,a),delete c[e]}else if(null===o){const t={signal:i.map((e=>{const{test:t,...n}=e;return`${X3(null,t)} ? ${zY(n)} : `})).join("")+zY(n)};c[e]=t}}else if(DY(r)){const t=MK[e];if(t){const{vgProp:n,part:i}=t;J3(c,i,n,r),delete c[e]}}jH(["labelAlign","labelBaseline"],e)&&null===c[e]&&delete c[e]}if("grid"===t){if(!c.grid)return;if(c.encode){const{grid:e}=c.encode;c.encode={...e?{grid:e}:{}},zH(c.encode)&&delete c.encode}return{scale:a,orient:o,...c,domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:KH(u,0)}}{if(!r.header&&e.mainExtracted)return;if(void 0!==s){let e=s;c.encode?.labels?.update&&DY(c.encode.labels.update.text)&&(e=XH(s,"datum.label",c.encode.labels.update.text.signal)),J3(c,"labels","text",{signal:e})}if(null===c.labelAlign&&delete c.labelAlign,c.encode){for(const t of FK)e.hasAxisPart(t)||delete c.encode[t];zH(c.encode)&&delete c.encode}const t=function(e,t){if(e)return ka(e)&&!EY(e)?e.map((e=>xK(e,t))).join(", "):e}(l,n);return{scale:a,orient:o,grid:!1,...t?{title:t}:{},...c,...!1===n.aria?{aria:!1}:{},zindex:KH(u,0)}}}}function K3(e){const{axes:t}=e.component,n=[];for(const r of TV)if(t[r])for(const i of t[r])if(!i.get("disable")&&!i.get("gridScale")){const t="x"===r?"height":"width",i=e.getSizeSignalRef(t).signal;t!==i&&n.push({name:t,update:i})}return n}function e5(e,t,n,r){return Object.assign.apply(null,[{},...e.map((e=>{if("axisOrient"===e){const e="x"===n?"bottom":"left",i=t["x"===n?"axisBottom":"axisLeft"]||{},o=t["x"===n?"axisTop":"axisRight"]||{},a=new Set([...RH(i),...RH(o)]),s={};for(const t of a.values())s[t]={signal:`${r.signal} === "${e}" ? ${RY(i[t])} : ${RY(o[t])}`};return s}return t[e]}))])}function t5(e,t){const n=[{}];for(const r of e){let e=t[r]?.style;if(e){e=Ga(e);for(const r of e)n.push(t.style[r])}}return Object.assign.apply(null,n)}function n5(e,t,n,r){void 0===r&&(r={});const i=WY(e,n,t);if(void 0!==i)return{configFrom:"style",configValue:i};for(const o of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(void 0!==r[o]?.[e])return{configFrom:o,configValue:r[o][e]};return{}}const r5={scale:e=>{let{model:t,channel:n}=e;return t.scaleName(n)},format:e=>{let{format:t}=e;return t},formatType:e=>{let{formatType:t}=e;return t},grid:e=>{let{fieldOrDatumDef:t,axis:n,scaleType:r}=e;return n.grid??function(e,t){return!SJ(e)&&KQ(t)&&!yY(t?.bin)&&!vY(t?.bin)}(r,t)},gridScale:e=>{let{model:t,channel:n}=e;return function(e,t){const n="x"===t?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n);return}(t,n)},labelAlign:e=>{let{axis:t,labelAngle:n,orient:r,channel:i}=e;return t.labelAlign||a5(n,r,i)},labelAngle:e=>{let{labelAngle:t}=e;return t},labelBaseline:e=>{let{axis:t,labelAngle:n,orient:r,channel:i}=e;return t.labelBaseline||o5(n,r,i)},labelFlush:e=>{let{axis:t,fieldOrDatumDef:n,channel:r}=e;return t.labelFlush??function(e,t){if("x"===t&&jH(["quantitative","temporal"],e))return!0;return}(n.type,r)},labelOverlap:e=>{let{axis:t,fieldOrDatumDef:n,scaleType:r}=e;return t.labelOverlap??function(e,t,n,r){if(n&&!_a(r)||"nominal"!==e&&"ordinal"!==e)return"log"!==t&&"symlog"!==t||"greedy";return}(n.type,r,KQ(n)&&!!n.timeUnit,KQ(n)?n.sort:void 0)},orient:e=>{let{orient:t}=e;return t},tickCount:e=>{let{channel:t,model:n,axis:r,fieldOrDatumDef:i,scaleType:o}=e;const a="x"===t?"width":"y"===t?"height":void 0,s=a?n.getSizeSignalRef(a):void 0;return r.tickCount??function(e){let{fieldOrDatumDef:t,scaleType:n,size:r,values:i}=e;if(!i&&!SJ(n)&&"log"!==n){if(KQ(t)){if(yY(t.bin))return{signal:`ceil(${r.signal}/10)`};if(t.timeUnit&&jH(["month","hours","day","quarter"],YX(t.timeUnit)?.unit))return}return{signal:`ceil(${r.signal}/40)`}}return}({fieldOrDatumDef:i,scaleType:o,size:s,values:r.values})},tickMinStep:function(e){let{format:t,fieldOrDatumDef:n}=e;if("d"===t)return 1;if(KQ(n)){const{timeUnit:e}=n;if(e){const t=XX(e);if(t)return{signal:t}}}return},title:e=>{let{axis:t,model:n,channel:r}=e;if(void 0!==t.title)return t.title;const i=s5(n,r);if(void 0!==i)return i;const o=n.typedFieldDef(r),a="x"===r?"x2":"y2",s=n.fieldDef(a);return HY(o?[WQ(o)]:[],KQ(s)?[WQ(s)]:[])},values:e=>{let{axis:t,fieldOrDatumDef:n}=e;return function(e,t){const n=e.values;if(ka(n))return $K(t,n);if(DY(n))return n;return}(t,n)},zindex:e=>{let{axis:t,fieldOrDatumDef:n,mark:r}=e;return t.zindex??function(e,t){if("rect"===e&&pK(t))return 1;return 0}(r,n)}};function i5(e){return`(((${e.signal} % 360) + 360) % 360)`}function o5(e,t,n,r){if(void 0!==e){if("x"===n){if(DY(e)){const n=i5(e);return{signal:`(45 < ${n} && ${n} < 135) || (225 < ${n} && ${n} < 315) ? "middle" :(${n} <= 45 || 315 <= ${n}) === ${DY(t)?`(${t.signal} === "top")`:"top"===t} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(DY(t)){const n=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${n} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==("top"===t)?"bottom":"top"}if(DY(e)){const n=i5(e);return{signal:`${n} <= 45 || 315 <= ${n} || (135 <= ${n} && ${n} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${n} && ${n} <= 135) === ${DY(t)?`(${t.signal} === "left")`:"left"===t} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(DY(t)){const n=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${n} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==("left"===t)?"top":"bottom"}}function a5(e,t,n){if(void 0===e)return;const r="x"===n,i=r?0:90,o=r?"bottom":"left";if(DY(e)){const n=i5(e);return{signal:`(${i?`(${n} + 90)`:n} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${n} && ${n} < ${180+i}) === ${DY(t)?`(${t.signal} === "${o}")`:t===o} ? "left" : "right"`}}if((e+i)%180==0)return r?null:"center";if(DY(t)){const n=i<e&&e<180+i?"===":"!==";return{signal:`${`${t.signal} ${n} "${o}"`} ? "left" : "right"`}}return(i<e&&e<180+i)==(t===o)?"left":"right"}function s5(e,t){const n="x"===t?"x2":"y2",r=e.fieldDef(t),i=e.fieldDef(n),o=r?r.title:void 0,a=i?i.title:void 0;return o&&a?GY(o,a):o||(a||(void 0!==o?o:void 0!==a?a:void 0))}class l5 extends j2{clone(){return new l5(null,xH(this.transform))}constructor(e,t){super(e),this.transform=t,this._dependentFields=H3(this.transform.calculate)}static parseAllForSortIndex(e,t){return t.forEachFieldDef(((t,n)=>{if(lK(t)&&BQ(t.sort)){const{field:r,timeUnit:i}=t,o=t.sort,a=o.map(((e,t)=>`${lJ({field:r,timeUnit:i,equal:e})} ? ${t} : `)).join("")+o.length;e=new l5(e,{calculate:a,as:u5(t,n,{forAs:!0})})}})),e}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${EH(this.transform)}`}}function u5(e,t,n){return hK(e,{prefix:t,suffix:"sort_index",...n??{}})}function c5(e,t){return jH(["top","bottom"],t)?"column":jH(["left","right"],t)||"row"===e?"row":"column"}function f5(e,t,n,r){const i="row"===r?n.headerRow:"column"===r?n.headerColumn:n.headerFacet;return KH((t||{})[e],i[e],n.header[e])}function d5(e,t,n,r){const i={};for(const o of e){const e=f5(o,t||{},n,r);void 0!==e&&(i[o]=e)}return i}const h5=["row","column"],p5=["header","footer"];function m5(e,t){const n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:o,titleAngle:a,titleOrient:s}=d5(["titleAnchor","titleAngle","titleOrient"],i.header,r,t),l=c5(t,s),u=iG(a);return{name:`${t}-title`,type:"group",role:`${l}-title`,title:{text:n,..."row"===t?{orient:"left"}:{},style:"guide-title",...y5(u,l),...g5(l,u,o),...O5(r,i,t,O0,k0)}}}function g5(e,t,n){switch(void 0===n&&(n="middle"),n){case"start":return{align:"left"};case"end":return{align:"right"}}const r=a5(t,"row"===e?"left":"top","row"===e?"y":"x");return r?{align:r}:{}}function y5(e,t){const n=o5(e,"row"===t?"left":"top","row"===t?"y":"x",!0);return n?{baseline:n}:{}}function v5(e,t){const n=e.component.layoutHeaders[t],r=[];for(const i of p5)if(n[i])for(const o of n[i]){const a=w5(e,t,i,n,o);null!=a&&r.push(a)}return r}function b5(e,t){const{sort:n}=e;return LQ(n)?{field:hK(n,{expr:"datum"}),order:n.order??"ascending"}:ka(n)?{field:u5(e,t,{expr:"datum"}),order:"ascending"}:{field:hK(e,{expr:"datum"}),order:n??"ascending"}}function x5(e,t,n){const{format:r,formatType:i,labelAngle:o,labelAnchor:a,labelOrient:s,labelExpr:l}=d5(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),u=DQ({fieldOrDatumDef:e,format:r,formatType:i,expr:"parent",config:n}).signal,c=c5(t,s);return{text:{signal:l?XH(XH(l,"datum.label",u),"datum.value",hK(e,{expr:"parent"})):u},..."row"===t?{orient:"left"}:{},style:"guide-label",frame:"group",...y5(o,c),...g5(c,o,a),...O5(n,e,t,E0,_0)}}function w5(e,t,n,r,i){if(i){let o=null;const{facetFieldDef:a}=r,s=e.config?e.config:void 0;if(a&&i.labels){const{labelOrient:e}=d5(["labelOrient"],a.header,s,t);("row"===t&&!jH(["top","bottom"],e)||"column"===t&&!jH(["left","right"],e))&&(o=x5(a,t,s))}const l=E4(e)&&!IQ(e.facet),u=i.axes,c=u?.length>0;if(o||c){const s="row"===t?"height":"width";return{name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`,...r.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:b5(a,t)}:{},...c&&l?{from:{data:e.getName(`facet_domain_${t}`)}}:{},...o?{title:o}:{},...i.sizeSignal?{encode:{update:{[s]:i.sizeSignal}}}:{},...c?{axes:u}:{}}}}return null}const k5={column:{start:0,end:1},row:{start:1,end:0}};function _5(e,t){return k5[t][e]}function O5(e,t,n,r,i){const o={};for(const a of r){if(!i[a])continue;const r=f5(a,t?.header,e,n);void 0!==r&&(o[i[a]]=r)}return o}function E5(e){return[...D5(e,"width"),...D5(e,"height"),...D5(e,"childWidth"),...D5(e,"childHeight")]}function D5(e,t){const n="width"===t?"x":"y",r=e.component.layoutSize.get(t);if(!r||"merged"===r)return[];const i=e.getSizeSignalRef(t).signal;if("step"===r){const t=e.getScaleComponent(n);if(t){const r=t.get("type"),o=t.get("range");if(SJ(r)&&jY(o)){const r=e.scaleName(n);if(E4(e.parent)){if("independent"===e.parent.component.resolve.scale[n])return[j5(r,o)]}return[j5(r,o),{name:i,update:N5(r,t,`domain('${r}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}if("container"==r){const t=i.endsWith("width"),n=t?"containerSize()[0]":"containerSize()[1]",r=`isFinite(${n}) ? ${n} : ${I0(e.config.view,t?"width":"height")}`;return[{name:i,init:r,on:[{update:r,events:"window:resize"}]}]}return[{name:i,value:r}]}function j5(e,t){const n=`${e}_step`;return DY(t.step)?{name:n,update:t.step.signal}:{name:n,value:t.step}}function N5(e,t,n){const r=t.get("type"),i=t.get("padding"),o=KH(t.get("paddingOuter"),i);let a=t.get("paddingInner");return a="band"===r?void 0!==a?a:i:1,`bandspace(${n}, ${RY(a)}, ${RY(o)}) * ${e}_step`}function S5(e){return"childWidth"===e?"width":"childHeight"===e?"height":e}function A5(e,t){return RH(e).reduce(((n,r)=>{const i=e[r];return{...n,...W2(t,i,r,(e=>FY(e.value)))}}),{})}function $5(e,t){if(E4(t))return"theta"===e?"independent":"shared";if(j4(t))return"shared";if(D4(t))return zV(e)||"theta"===e||"radius"===e?"independent":"shared";throw new Error("invalid model type for resolve")}function C5(e,t){const n=e.scale[t],r=zV(t)?"axis":"legend";return"independent"===n?("shared"===e[r][t]&&AX(function(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}(t)),"independent"):e[r][t]||"shared"}const M5=RH({aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1,disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1});class P5 extends a2{}const F5={symbols:function(e,t){let{fieldOrDatumDef:n,model:r,channel:i,legendCmpt:o,legendType:a}=t;if("symbol"!==a)return;const{markDef:s,encoding:l,config:u,mark:c}=r,f=s.filled&&"trail"!==c;let d={...LY({},r,uQ),...e3(r,{filled:f})};const h=o.get("symbolOpacity")??u.legend.symbolOpacity,p=o.get("symbolFillColor")??u.legend.symbolFillColor,m=o.get("symbolStrokeColor")??u.legend.symbolStrokeColor,g=void 0===h?T5(l.opacity)??s.opacity:void 0;if(d.fill)if("fill"===i||f&&i===_G)delete d.fill;else if(d.fill.field)p?delete d.fill:(d.fill=FY(u.legend.symbolBaseFillColor??"black"),d.fillOpacity=FY(g??1));else if(ka(d.fill)){const e=z5(l.fill??l.color)??s.fill??(f&&s.color);e&&(d.fill=FY(e))}if(d.stroke)if("stroke"===i||!f&&i===_G)delete d.stroke;else if(d.stroke.field||m)delete d.stroke;else if(ka(d.stroke)){const e=KH(z5(l.stroke||l.color),s.stroke,f?s.color:void 0);e&&(d.stroke={value:e})}if(i!==SG){const e=KQ(n)&&L5(r,o,n);e?d.opacity=[{test:e,...FY(g??1)},FY(u.legend.unselectedOpacity)]:g&&(d.opacity=FY(g))}return d={...d,...e},zH(d)?void 0:d},gradient:function(e,t){let{model:n,legendType:r,legendCmpt:i}=t;if("gradient"!==r)return;const{config:o,markDef:a,encoding:s}=n;let l={};const u=void 0===(i.get("gradientOpacity")??o.legend.gradientOpacity)?T5(s.opacity)||a.opacity:void 0;u&&(l.opacity=FY(u));return l={...l,...e},zH(l)?void 0:l},labels:function(e,t){let{fieldOrDatumDef:n,model:r,channel:i,legendCmpt:o}=t;const a=r.legend(i)||{},s=r.config,l=KQ(n)?L5(r,o,n):void 0,u=l?[{test:l,value:1},{value:s.legend.unselectedOpacity}]:void 0,{format:c,formatType:f}=a;let d;_Q(f)?d=NQ({fieldOrDatumDef:n,field:"datum.value",format:c,formatType:f,config:s}):void 0===c&&void 0===f&&s.customFormatTypes&&("quantitative"===n.type&&s.numberFormatType?d=NQ({fieldOrDatumDef:n,field:"datum.value",format:s.numberFormat,formatType:s.numberFormatType,config:s}):"temporal"===n.type&&s.timeFormatType&&KQ(n)&&void 0===n.timeUnit&&(d=NQ({fieldOrDatumDef:n,field:"datum.value",format:s.timeFormat,formatType:s.timeFormatType,config:s})));const h={...u?{opacity:u}:{},...d?{text:d}:{},...e};return zH(h)?void 0:h},entries:function(e,t){let{legendCmpt:n}=t;const r=n.get("selections");return r?.length?{...e,fill:{value:"transparent"}}:e}};function T5(e){return R5(e,((e,t)=>Math.max(e,t.value)))}function z5(e){return R5(e,((e,t)=>KH(e,t.value)))}function R5(e,t){return function(e){const t=e?.condition;return!!t&&(ka(t)||sK(t))}(e)?Ga(e.condition).reduce(t,e.value):sK(e)?e.value:void 0}function L5(e,t,n){const r=t.get("selections");if(!r?.length)return;const i=js(n.field);return r.map((e=>`(!length(data(${js(UH(e)+T3)})) || (${e}[${i}] && indexof(${e}[${i}], datum.value) >= 0))`)).join(" || ")}const B5={direction:e=>{let{direction:t}=e;return t},format:e=>{let{fieldOrDatumDef:t,legend:n,config:r}=e;const{format:i,formatType:o}=n;return SQ(t,t.type,i,o,r,!1)},formatType:e=>{let{legend:t,fieldOrDatumDef:n,scaleType:r}=e;const{formatType:i}=t;return AQ(i,n,r)},gradientLength:e=>{const{legend:t,legendConfig:n}=e;return t.gradientLength??n.gradientLength??function(e){let{legendConfig:t,model:n,direction:r,orient:i,scaleType:o}=e;const{gradientHorizontalMaxLength:a,gradientHorizontalMinLength:s,gradientVerticalMaxLength:l,gradientVerticalMinLength:u}=t;if($J(o))return"horizontal"===r?"top"===i||"bottom"===i?q5(n,"width",s,a):s:q5(n,"height",u,l);return}(e)},labelOverlap:e=>{let{legend:t,legendConfig:n,scaleType:r}=e;return t.labelOverlap??n.labelOverlap??function(e){if(jH(["quantile","threshold","log","symlog"],e))return"greedy";return}(r)},symbolType:e=>{let{legend:t,markDef:n,channel:r,encoding:i}=e;return t.symbolType??function(e,t,n,r){if("shape"!==t){const e=z5(n)??r;if(e)return e}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}(n.type,r,i.shape,n.shape)},title:e=>{let{fieldOrDatumDef:t,config:n}=e;return vK(t,n,{allowDisabling:!0})},type:e=>{let{legendType:t,scaleType:n,channel:r}=e;if(YG(r)&&$J(n)){if("gradient"===t)return}else if("symbol"===t)return;return t},values:e=>{let{fieldOrDatumDef:t,legend:n}=e;return function(e,t){const n=e.values;if(ka(n))return $K(t,n);if(DY(n))return n;return}(n,t)}};function I5(e){const{legend:t}=e;return KH(t.type,function(e){let{channel:t,timeUnit:n,scaleType:r}=e;if(YG(t)){if(jH(["quarter","month","day"],n))return"symbol";if($J(r))return"gradient"}return"symbol"}(e))}function U5(e){let{legendConfig:t,legendType:n,orient:r,legend:i}=e;return i.direction??t[n?"gradientDirection":"symbolDirection"]??function(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===t?"horizontal":void 0}}(r,n)}function q5(e,t,n,r){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${r})`}}function W5(e){const t=O4(e)?function(e){const{encoding:t}=e,n={};for(const r of[_G,...j0]){const i=_K(t[r]);i&&e.getScaleComponent(r)&&(r===DG&&KQ(i)&&i.type===yJ||(n[r]=H5(e,r)))}return n}(e):function(e){const{legends:t,resolve:n}=e.component;for(const r of e.children){W5(r);for(const i of RH(r.component.legends))n.legend[i]=C5(e.component.resolve,i),"shared"===n.legend[i]&&(t[i]=G5(t[i],r.component.legends[i]),t[i]||(n.legend[i]="independent",delete t[i]))}for(const r of RH(t))for(const t of e.children)t.component.legends[r]&&"shared"===n.legend[r]&&delete t.component.legends[r];return t}(e);return e.component.legends=t,t}function Z5(e,t,n,r){switch(t){case"disable":return void 0!==n;case"values":return!!n?.values;case"title":if("title"===t&&e===r?.title)return!0}return e===(n||{})[t]}function H5(e,t){let n=e.legend(t);const{markDef:r,encoding:i,config:o}=e,a=o.legend,s=new P5({},function(e,t){const n=e.scaleName(t);if("trail"===e.mark){if("color"===t)return{stroke:n};if("size"===t)return{strokeWidth:n}}return"color"===t?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}(e,t));!function(e,t,n){const r=e.fieldDef(t)?.field;for(const i of LH(e.component.selection??{})){const e=i.project.hasField[r]??i.project.hasChannel[t];if(e&&j3.defined(i)){const t=n.get("selections")??[];t.push(i.name),n.set("selections",t,!1),e.hasLegend=!0}}}(e,t,s);const l=void 0!==n?!n:a.disable;if(s.set("disable",l,void 0!==n),l)return s;n=n||{};const u=e.getScaleComponent(t).get("type"),c=_K(i[t]),f=KQ(c)?YX(c.timeUnit)?.unit:void 0,d=n.orient||o.legend.orient||"right",h=I5({legend:n,channel:t,timeUnit:f,scaleType:u}),p={legend:n,channel:t,model:e,markDef:r,encoding:i,fieldOrDatumDef:c,legendConfig:a,config:o,scaleType:u,orient:d,legendType:h,direction:U5({legend:n,legendType:h,orient:d,legendConfig:a})};for(const b of M5){if("gradient"===h&&b.startsWith("symbol")||"symbol"===h&&b.startsWith("gradient"))continue;const r=b in B5?B5[b](p):n[b];if(void 0!==r){const i=Z5(r,b,n,e.fieldDef(t));(i||void 0===o.legend[b])&&s.set(b,r,i)}}const m=n?.encoding??{},g=s.get("selections"),y={},v={fieldOrDatumDef:c,model:e,channel:t,legendCmpt:s,legendType:h};for(const b of["labels","legend","title","symbols","gradient","entries"]){const t=A5(m[b]??{},e),n=b in F5?F5[b](t,v):t;void 0===n||zH(n)||(y[b]={...g?.length&&KQ(c)?{name:`${UH(c.field)}_legend_${b}`}:{},...g?.length?{interactive:!!g}:{},update:n})}return zH(y)||s.set("encode",y,!!n?.encoding),s}function G5(e,t){if(!e)return t.clone();const n=e.getWithExplicit("orient"),r=t.getWithExplicit("orient");if(n.explicit&&r.explicit&&n.value!==r.value)return;let i=!1;for(const o of M5){const n=f2(e.getWithExplicit(o),t.getWithExplicit(o),o,"legend",((e,t)=>{switch(o){case"symbolType":return V5(e,t);case"title":return VY(e,t);case"type":return i=!0,l2("symbol")}return c2(e,t,o,"legend")}));e.setWithExplicit(o,n)}return i&&(e.implicit?.encode?.gradient&&WH(e.implicit,["encode","gradient"]),e.explicit?.encode?.gradient&&WH(e.explicit,["encode","gradient"])),e}function V5(e,t){return"circle"===t.value?t:e}function Y5(e){const t=e.component.legends,n={};for(const i of RH(t)){const r=e.getScaleComponent(i),o=OH(r.get("domains"));if(n[o])for(const e of n[o]){G5(e,t[i])||n[o].push(t[i])}else n[o]=[t[i].clone()]}const r=LH(n).flat().map((t=>function(e,t){const{disable:n,labelExpr:r,selections:i,...o}=e.combine();if(n)return;!1===t.aria&&null==o.aria&&(o.aria=!1);if(o.encode?.symbols){const e=o.encode.symbols.update;!e.fill||"transparent"===e.fill.value||e.stroke||o.stroke||(e.stroke={value:"transparent"});for(const t of j0)o[t]&&delete e[t]}o.title||delete o.title;if(void 0!==r){let e=r;o.encode?.labels?.update&&DY(o.encode.labels.update.text)&&(e=XH(r,"datum.label",o.encode.labels.update.text.signal)),function(e,t,n,r){var i,o;e.encode??(e.encode={}),(i=e.encode)[t]??(i[t]={}),(o=e.encode[t]).update??(o.update={}),e.encode[t].update[n]=r}(o,"labels","text",{signal:e})}return o}(t,e.config))).filter((e=>void 0!==e));return r}function X5(e){return j4(e)||D4(e)?function(e){return e.children.reduce(((e,t)=>e.concat(t.assembleProjections())),J5(e))}(e):J5(e)}function J5(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:r}=n;if(t.data){const i={signal:`[${t.size.map((e=>e.signal)).join(", ")}]`},o=t.data.reduce(((t,n)=>{const r=DY(n)?n.signal:`data('${e.lookupDataSource(n)}')`;return jH(t,r)||t.push(r),t}),[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[{name:r,size:i,fit:{signal:o.length>1?`[${o.join(", ")}]`:o[0]},...n}]}return[{name:r,translate:{signal:"[width / 2, height / 2]"},...n}]}const Q5=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class K5 extends a2{constructor(e,t,n,r){super({...t},{name:e}),this.specifiedProjection=t,this.size=n,this.data=r,this.merged=!1}get isFit(){return!!this.data}}function e6(e){e.component.projection=O4(e)?function(e){if(e.hasProjection){const t=_Y(e.specifiedProjection),n=!(t&&(null!=t.scale||null!=t.translate)),r=n?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,i=n?function(e){const t=[],{encoding:n}=e;for(const r of[[xG,bG],[kG,wG]])(_K(n[r[0]])||_K(n[r[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});e.channelHasField(DG)&&e.typedFieldDef(DG).type===yJ&&t.push({signal:e.getName(`geojson_${t.length}`)});0===t.length&&t.push(e.requestDataName(x2.Main));return t}(e):void 0,o=new K5(e.projectionName(!0),{..._Y(e.config.projection)??{},...t??{}},r,i);return o.get("type")||o.set("type","equalEarth",!1),o}return}(e):function(e){if(0===e.children.length)return;let t;for(const r of e.children)e6(r);const n=SH(e.children,(e=>{const n=e.component.projection;if(n){if(t){const e=function(e,t){const n=SH(Q5,(n=>!ls(e.explicit,n)&&!ls(t.explicit,n)||!!(ls(e.explicit,n)&&ls(t.explicit,n)&&bH(e.get(n),t.get(n))))),r=bH(e.size,t.size);if(r){if(n)return e;if(bH(e.explicit,{}))return t;if(bH(t.explicit,{}))return e}return null}(t,n);return e&&(t=e),!!e}return t=n,!0}return!0}));if(t&&n){const n=e.projectionName(!0),r=new K5(n,t.specifiedProjection,t.size,xH(t.data));for(const t of e.children){const e=t.component.projection;e&&(e.isFit&&r.data.push(...t.component.projection.data),t.renameProjection(e.get("name"),n),e.merged=!0)}return r}return}(e)}function t6(e,t,n,r){if(CK(t,n)){const i=O4(e)?e.axis(n)??e.legend(n)??{}:{},o=hK(t,{expr:"datum"}),a=hK(t,{expr:"datum",binSuffix:"end"});return{formulaAs:hK(t,{binSuffix:"range",forAs:!0}),formula:PQ(o,a,i.format,i.formatType,r)}}return{}}function n6(e,t){return`${gY(e)}_${t}`}function r6(e,t,n){const r=n6(jK(n,void 0)??{},t);return e.getName(`${r}_bins`)}function i6(e,t,n){let r,i;r=function(e){return"as"in e}(e)?bs(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:[hK(e,{forAs:!0}),hK(e,{binSuffix:"end",forAs:!0})];const o={...jK(t,void 0)},a=n6(o,e.field),{signal:s,extentSignal:l}=function(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}(n,a);if(xY(o.extent)){const e=o.extent;i=Y3(n,e.param,e),delete o.extent}return{key:a,binComponent:{bin:o,field:e.field,as:[r],...s?{signal:s}:{},...l?{extentSignal:l}:{},...i?{span:i}:{}}}}class o6 extends j2{clone(){return new o6(null,xH(this.bins))}constructor(e,t){super(e),this.bins=t}static makeFromEncoding(e,t){const n=t.reduceFieldDef(((e,n,r)=>{if(aK(n)&&yY(n.bin)){const{key:i,binComponent:o}=i6(n,n.bin,t);e[i]={...o,...e[i],...t6(t,n,r,t.config)}}return e}),{});return zH(n)?null:new o6(e,n)}static makeFromTransform(e,t,n){const{key:r,binComponent:i}=i6(t,t.bin,n);return new o6(e,{[r]:i})}merge(e,t){for(const n of RH(e.bins))n in this.bins?(t(e.bins[n].signal,this.bins[n].signal),this.bins[n].as=CH([...this.bins[n].as,...e.bins[n].as],EH)):this.bins[n]=e.bins[n];for(const n of e.children)e.removeChild(n),n.parent=this;e.remove()}producedFields(){return new Set(LH(this.bins).map((e=>e.as)).flat(2))}dependentFields(){return new Set(LH(this.bins).map((e=>e.field)))}hash(){return`Bin ${EH(this.bins)}`}assemble(){return LH(this.bins).flatMap((e=>{const t=[],[n,...r]=e.as,{extent:i,...o}=e.bin,a={type:"bin",field:YH(e.field),as:n,signal:e.signal,...xY(i)?{extent:null}:{extent:i},...e.span?{span:{signal:`span(${e.span})`}}:{},...o};!i&&e.extentSignal&&(t.push({type:"extent",field:YH(e.field),signal:e.extentSignal}),a.extent={signal:e.extentSignal}),t.push(a);for(const s of r)for(let e=0;e<2;e++)t.push({type:"formula",expr:hK({field:n[e]},{expr:"datum"}),as:s[e]});return e.formula&&t.push({type:"formula",expr:e.formula,as:e.formulaAs}),t}))}}function a6(e,t,n,r){const i=O4(r)?r.encoding[hV(t)]:void 0;if(aK(n)&&O4(r)&&VQ(n,i,r.markDef,r.config))e.add(hK(n,{})),e.add(hK(n,{suffix:"end"})),n.bin&&CK(n,t)&&e.add(hK(n,{binSuffix:"range"}));else if(HG(t)){const n=ZG(t);e.add(r.getName(n))}else e.add(hK(n));return lK(n)&&function(e){return _a(e)&&"field"in e}(n.scale?.range)&&e.add(n.scale.range.field),e}class s6 extends j2{clone(){return new s6(null,new Set(this.dimensions),xH(this.measures))}constructor(e,t,n){super(e),this.dimensions=t,this.measures=n}get groupBy(){return this.dimensions}static makeFromEncoding(e,t){let n=!1;t.forEachFieldDef((e=>{e.aggregate&&(n=!0)}));const r={},i=new Set;return n?(t.forEachFieldDef(((e,n)=>{const{aggregate:o,field:a}=e;if(o)if("count"===o)r["*"]??(r["*"]={}),r["*"].count=new Set([hK(e,{forAs:!0})]);else{if(uY(o)||cY(o)){const e=uY(o)?"argmin":"argmax",t=o[e];r[t]??(r[t]={}),r[t][e]=new Set([hK({op:e,field:t},{forAs:!0})])}else r[a]??(r[a]={}),r[a][o]=new Set([hK(e,{forAs:!0})]);tY(n)&&"unaggregated"===t.scaleDomain(n)&&(r[a]??(r[a]={}),r[a].min=new Set([hK({field:a,aggregate:"min"},{forAs:!0})]),r[a].max=new Set([hK({field:a,aggregate:"max"},{forAs:!0})]))}else a6(i,n,e,t)})),i.size+RH(r).length===0?null:new s6(e,i,r)):null}static makeFromTransform(e,t){const n=new Set,r={};for(const i of t.aggregate){const{op:e,field:t,as:n}=i;e&&("count"===e?(r["*"]??(r["*"]={}),r["*"].count=new Set([n||hK(i,{forAs:!0})])):(r[t]??(r[t]={}),r[t][e]=new Set([n||hK(i,{forAs:!0})])))}for(const i of t.groupby??[])n.add(i);return n.size+RH(r).length===0?null:new s6(e,n,r)}merge(e){return MH(this.dimensions,e.dimensions)?(function(e,t){for(const n of RH(t)){const r=t[n];for(const t of RH(r))n in e?e[n][t]=new Set([...e[n][t]??[],...r[t]]):e[n]={[t]:r[t]}}}(this.measures,e.measures),!0):(function(){SX.debug(...arguments)}("different dimensions, cannot merge"),!1)}addDimensions(e){e.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...RH(this.measures)])}producedFields(){const e=new Set;for(const t of RH(this.measures))for(const n of RH(this.measures[t])){const r=this.measures[t][n];0===r.size?e.add(`${n}_${t}`):r.forEach(e.add,e)}return e}hash(){return`Aggregate ${EH({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const e=[],t=[],n=[];for(const r of RH(this.measures))for(const i of RH(this.measures[r]))for(const o of this.measures[r][i])n.push(o),e.push(i),t.push("*"===r?null:YH(r));return{type:"aggregate",groupby:[...this.dimensions].map(YH),ops:e,fields:t,as:n}}}class l6 extends j2{constructor(e,t,n,r){super(e),this.model=t,this.name=n,this.data=r;for(const i of JG){const e=t.facet[i];if(e){const{bin:n,sort:r}=e;this[i]={name:t.getName(`${i}_domain`),fields:[hK(e),...yY(n)?[hK(e,{binSuffix:"end"})]:[]],...LQ(r)?{sortField:r}:ka(r)?{sortIndexField:u5(e,i)}:{}}}}this.childModel=t.child}hash(){let e="Facet";for(const t of JG)this[t]&&(e+=` ${t.charAt(0)}:${EH(this[t])}`);return e}get fields(){const e=[];for(const t of JG)this[t]?.fields&&e.push(...this[t].fields);return e}dependentFields(){const e=new Set(this.fields);for(const t of JG)this[t]&&(this[t].sortField&&e.add(this[t].sortField.field),this[t].sortIndexField&&e.add(this[t].sortIndexField));return e}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const e={};for(const t of TV){const n=this.childModel.component.scales[t];if(n&&!n.merged){const r=n.get("type"),i=n.get("range");if(SJ(r)&&jY(i)){const n=t4(n4(this.childModel,t));n?e[t]=n:AX(eX(t))}}}return e}assembleRowColumnHeaderData(e,t,n){const r={row:"y",column:"x",facet:void 0}[e],i=[],o=[],a=[];r&&n&&n[r]&&(t?(i.push(`distinct_${n[r]}`),o.push("max")):(i.push(n[r]),o.push("distinct")),a.push(`distinct_${n[r]}`));const{sortField:s,sortIndexField:l}=this[e];if(s){const{op:e=FQ,field:t}=s;i.push(t),o.push(e),a.push(hK(s,{forAs:!0}))}else l&&(i.push(l),o.push("max"),a.push(l));return{name:this[e].name,source:t??this.data,transform:[{type:"aggregate",groupby:this[e].fields,...i.length?{fields:i,ops:o,as:a}:{}}]}}assembleFacetHeaderData(e){const{columns:t}=this.model.layout,{layoutHeaders:n}=this.model.component,r=[],i={};for(const s of h5){for(const e of p5){const t=(n[s]&&n[s][e])??[];for(const e of t)if(e.axes?.length>0){i[s]=!0;break}}if(i[s]){const e=`length(data("${this.facet.name}"))`,n="row"===s?t?{signal:`ceil(${e} / ${t})`}:1:t?{signal:`min(${e}, ${t})`}:{signal:e};r.push({name:`${this.facet.name}_${s}`,transform:[{type:"sequence",start:0,stop:n}]})}}const{row:o,column:a}=i;return(o||a)&&r.unshift(this.assembleRowColumnHeaderData("facet",null,e)),r}assemble(){const e=[];let t=null;const n=this.getChildIndependentFieldsWithStep(),{column:r,row:i,facet:o}=this;if(r&&i&&(n.x||n.y)){t=`cross_${this.column.name}_${this.row.name}`;const r=[].concat(n.x??[],n.y??[]),i=r.map((()=>"distinct"));e.push({name:t,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:r,ops:i}]})}for(const a of[sG,aG])this[a]&&e.push(this.assembleRowColumnHeaderData(a,t,n));if(o){const t=this.assembleFacetHeaderData(n);t&&e.push(...t)}return e}}function u6(e){return e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e}function c6(e){const t={};return yH(e.filter,(e=>{if(aJ(e)){let n=null;KX(e)?n=MY(e.equal):tJ(e)?n=MY(e.lte):eJ(e)?n=MY(e.lt):nJ(e)?n=MY(e.gt):rJ(e)?n=MY(e.gte):iJ(e)?n=e.range[0]:oJ(e)&&(n=(e.oneOf??e.in)[0]),n&&($X(n)?t[e.field]="date":ys(n)?t[e.field]="number":bs(n)&&(t[e.field]="string")),e.timeUnit&&(t[e.field]="date")}})),t}function f6(e){const t={};function n(e){var n;SK(e)?t[e.field]="date":"quantitative"===e.type&&(bs(n=e.aggregate)&&jH(["min","max"],n))?t[e.field]="number":QH(e.field)>1?e.field in t||(t[e.field]="flatten"):lK(e)&&LQ(e.sort)&&QH(e.sort.field)>1&&(e.sort.field in t||(t[e.sort.field]="flatten"))}if((O4(e)||E4(e))&&e.forEachFieldDef(((t,r)=>{if(aK(t))n(t);else{const i=fV(r),o=e.fieldDef(i);n({...t,type:o.type})}})),O4(e)){const{mark:n,markDef:r,encoding:i}=e;if(oQ(n)&&!e.encoding.order){const e=i["horizontal"===r.orient?"y":"x"];KQ(e)&&"quantitative"===e.type&&!(e.field in t)&&(t[e.field]="number")}}return t}class d6 extends j2{clone(){return new d6(null,xH(this._parse))}constructor(e,t){super(e),this._parse=t}hash(){return`Parse ${EH(this._parse)}`}static makeExplicit(e,t,n){let r={};const i=t.data;return!g2(i)&&i?.format?.parse&&(r=i.format.parse),this.makeWithAncestors(e,r,{},n)}static makeWithAncestors(e,t,n,r){for(const a of RH(n)){const e=r.getWithExplicit(a);void 0!==e.value&&(e.explicit||e.value===n[a]||"derived"===e.value||"flatten"===n[a]?delete n[a]:AX(aX(a,n[a],e.value)))}for(const a of RH(t)){const e=r.get(a);void 0!==e&&(e===t[a]?delete t[a]:AX(aX(a,t[a],e)))}const i=new a2(t,n);r.copyAll(i);const o={};for(const a of RH(i.combine())){const e=i.get(a);null!==e&&(o[a]=e)}return 0===RH(o).length||r.parseNothing?null:new d6(e,o)}get parse(){return this._parse}merge(e){this._parse={...this._parse,...e.parse},e.remove()}assembleFormatParse(){const e={};for(const t of RH(this._parse)){const n=this._parse[t];1===QH(t)&&(e[t]=n)}return e}producedFields(){return new Set(RH(this._parse))}dependentFields(){return new Set(RH(this._parse))}assembleTransforms(e){return void 0===e&&(e=!1),RH(this._parse).filter((t=>!e||QH(t)>1)).map((e=>{const t=function(e,t){const n=HH(e);if("number"===t)return`toNumber(${n})`;if("boolean"===t)return`toBoolean(${n})`;if("string"===t)return`toString(${n})`;if("date"===t)return`toDate(${n})`;if("flatten"===t)return n;if(t.startsWith("date:"))return`timeParse(${n},'${u6(t.slice(5,t.length))}')`;if(t.startsWith("utc:"))return`utcParse(${n},'${u6(t.slice(4,t.length))}')`;return AX(`Unrecognized parse "${t}".`),null}(e,this._parse[e]);if(!t)return null;return{type:"formula",expr:t,as:JH(e)}})).filter((e=>null!==e))}}class h6 extends j2{clone(){return new h6(null)}constructor(e){super(e)}dependentFields(){return new Set}producedFields(){return new Set([N0])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:N0}}}class p6 extends j2{clone(){return new p6(null,this.params)}constructor(e,t){super(e),this.params=t}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${EH(this.params)}`}assemble(){return{type:"graticule",...!0===this.params?{}:this.params}}}class m6 extends j2{clone(){return new m6(null,this.params)}constructor(e,t){super(e),this.params=t}dependentFields(){return new Set}producedFields(){return new Set([this.params.as??"data"])}hash(){return`Hash ${EH(this.params)}`}assemble(){return{type:"sequence",...this.params}}}class g6 extends j2{constructor(e){let t;if(super(null),e??(e={name:"source"}),g2(e)||(t=e.format?{..._H(e.format,["parse"])}:{}),p2(e))this._data={values:e.values};else if(h2(e)){if(this._data={url:e.url},!t.type){let n=/(?:\.([^.]+))?$/.exec(e.url)[1];jH(["json","csv","tsv","dsv","topojson"],n)||(n="json"),t.type=n}}else v2(e)?this._data={values:[{type:"Sphere"}]}:(m2(e)||g2(e))&&(this._data={});this._generator=g2(e),e.name&&(this._name=e.name),t&&!zH(t)&&(this._data.format=t)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(e){this._name=e}set parent(e){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return{name:this._name,...this._data,transform:[]}}}var y6,v6=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},b6=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};function x6(e){return e instanceof g6||e instanceof p6||e instanceof m6}class w6{constructor(){y6.set(this,void 0),v6(this,y6,!1,"f")}setModified(){v6(this,y6,!0,"f")}get modifiedFlag(){return b6(this,y6,"f")}}y6=new WeakMap;class k6 extends w6{getNodeDepths(e,t,n){n.set(e,t);for(const r of e.children)this.getNodeDepths(r,t+1,n);return n}optimize(e){const t=[...this.getNodeDepths(e,0,new Map).entries()].sort(((e,t)=>t[1]-e[1]));for(const n of t)this.run(n[0]);return this.modifiedFlag}}class _6 extends w6{optimize(e){this.run(e);for(const t of e.children)this.optimize(t);return this.modifiedFlag}}class O6 extends _6{mergeNodes(e,t){const n=t.shift();for(const r of t)e.removeChild(r),r.parent=n,r.remove()}run(e){const t=e.children.map((e=>e.hash())),n={};for(let r=0;r<t.length;r++)void 0===n[t[r]]?n[t[r]]=[e.children[r]]:n[t[r]].push(e.children[r]);for(const r of RH(n))n[r].length>1&&(this.setModified(),this.mergeNodes(e,n[r]))}}class E6 extends _6{constructor(e){super(),this.requiresSelectionId=e&&U3(e)}run(e){e instanceof h6&&(this.requiresSelectionId&&(x6(e.parent)||e.parent instanceof s6||e.parent instanceof d6)||(this.setModified(),e.remove()))}}class D6 extends w6{optimize(e){return this.run(e,new Set),this.modifiedFlag}run(e,t){let n=new Set;e instanceof $2&&(n=e.producedFields(),PH(n,t)&&(this.setModified(),e.removeFormulas(t),0===e.producedFields.length&&e.remove()));for(const r of e.children)this.run(r,new Set([...t,...n]))}}class j6 extends _6{constructor(){super()}run(e){e instanceof N2&&!e.isRequired()&&(this.setModified(),e.remove())}}class N6 extends k6{run(e){if(!(x6(e)||e.numChildren()>1))for(const t of e.children)if(t instanceof d6)if(e instanceof d6)this.setModified(),e.merge(t);else{if(TH(e.producedFields(),t.dependentFields()))continue;this.setModified(),t.swapWithParent()}}}class S6 extends k6{run(e){const t=[...e.children],n=e.children.filter((e=>e instanceof d6));if(e.numChildren()>1&&n.length>=1){const r={},i=new Set;for(const e of n){const t=e.parse;for(const e of RH(t))e in r?r[e]!==t[e]&&i.add(e):r[e]=t[e]}for(const e of i)delete r[e];if(!zH(r)){this.setModified();const n=new d6(e,r);for(const i of t){if(i instanceof d6)for(const e of RH(r))delete i.parse[e];e.removeChild(i),i.parent=n,i instanceof d6&&0===RH(i.parse).length&&i.remove()}}}}}class A6 extends k6{run(e){e instanceof N2||e.numChildren()>0||e instanceof l6||e instanceof g6||(this.setModified(),e.remove())}}class $6 extends k6{run(e){const t=e.children.filter((e=>e instanceof $2)),n=t.pop();for(const r of t)this.setModified(),n.merge(r)}}class C6 extends k6{run(e){const t=e.children.filter((e=>e instanceof s6)),n={};for(const r of t){const e=EH(r.groupBy);e in n||(n[e]=[]),n[e].push(r)}for(const r of RH(n)){const t=n[r];if(t.length>1){const n=t.pop();for(const r of t)n.merge(r)&&(e.removeChild(r),r.parent=n,r.remove(),this.setModified())}}}}class M6 extends k6{constructor(e){super(),this.model=e}run(e){const t=!(x6(e)||e instanceof G3||e instanceof d6||e instanceof h6),n=[],r=[];for(const i of e.children)i instanceof o6&&(t&&!TH(e.producedFields(),i.dependentFields())?n.push(i):r.push(i));if(n.length>0){const t=n.pop();for(const e of n)t.merge(e,this.model.renameSignal.bind(this.model));this.setModified(),e instanceof o6?e.merge(t,this.model.renameSignal.bind(this.model)):t.swapWithParent()}if(r.length>1){const e=r.pop();for(const t of r)e.merge(t,this.model.renameSignal.bind(this.model));this.setModified()}}}class P6 extends k6{run(e){const t=[...e.children];if(!NH(t,(e=>e instanceof N2))||e.numChildren()<=1)return;const n=[];let r;for(const i of t)if(i instanceof N2){let t=i;for(;1===t.numChildren();){const[e]=t.children;if(!(e instanceof N2))break;t=e}n.push(...t.children),r?(e.removeChild(i),i.parent=r.parent,r.parent.removeChild(r),r.parent=t,this.setModified()):r=t}else n.push(i);if(n.length){this.setModified();for(const e of n)e.parent.removeChild(e),e.parent=r}}}class F6 extends j2{clone(){return new F6(null,xH(this.transform))}constructor(e,t){super(e),this.transform=t}addDimensions(e){this.transform.groupby=CH(this.transform.groupby.concat(e),(e=>e))}dependentFields(){const e=new Set;return this.transform.groupby&&this.transform.groupby.forEach(e.add,e),this.transform.joinaggregate.map((e=>e.field)).filter((e=>void 0!==e)).forEach(e.add,e),e}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(e){return e.as??hK(e)}hash(){return`JoinAggregateTransform ${EH(this.transform)}`}assemble(){const e=[],t=[],n=[];for(const i of this.transform.joinaggregate)t.push(i.op),n.push(this.getDefaultName(i)),e.push(void 0===i.field?null:i.field);const r=this.transform.groupby;return{type:"joinaggregate",as:n,ops:t,fields:e,...void 0!==r?{groupby:r}:{}}}}class T6 extends j2{clone(){return new T6(null,xH(this._stack))}constructor(e,t){super(e),this._stack=t}static makeFromTransform(e,t){const{stack:n,groupby:r,as:i,offset:o="zero"}=t,a=[],s=[];if(void 0!==t.sort)for(const c of t.sort)a.push(c.field),s.push(KH(c.order,"ascending"));const l={field:a,order:s};let u;return u=function(e){return ka(e)&&e.every((e=>bs(e)))&&e.length>1}(i)?i:bs(i)?[i,`${i}_end`]:[`${t.stack}_start`,`${t.stack}_end`],new T6(e,{dimensionFieldDefs:[],stackField:n,groupby:r,offset:o,sort:l,facetby:[],as:u})}static makeFromEncoding(e,t){const n=t.stack,{encoding:r}=t;if(!n)return null;const{groupbyChannels:i,fieldChannel:o,offset:a,impute:s}=n,l=i.map((e=>kK(r[e]))).filter((e=>!!e)),u=function(e){return e.stack.stackBy.reduce(((e,t)=>{const n=hK(t.fieldDef);return n&&e.push(n),e}),[])}(t),c=t.encoding.order;let f;if(ka(c)||KQ(c))f=ZY(c);else{const e=YQ(c)?c.sort:"y"===o?"descending":"ascending";f=u.reduce(((t,n)=>(t.field.push(n),t.order.push(e),t)),{field:[],order:[]})}return new T6(e,{dimensionFieldDefs:l,stackField:t.vgField(o),facetby:[],stackby:u,sort:f,offset:a,impute:s,as:[t.vgField(o,{suffix:"start",forAs:!0}),t.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(e){this._stack.facetby.push(...e)}dependentFields(){const e=new Set;return e.add(this._stack.stackField),this.getGroupbyFields().forEach(e.add,e),this._stack.facetby.forEach(e.add,e),this._stack.sort.field.forEach(e.add,e),e}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${EH(this._stack)}`}getGroupbyFields(){const{dimensionFieldDefs:e,impute:t,groupby:n}=this._stack;return e.length>0?e.map((e=>e.bin?t?[hK(e,{binSuffix:"mid"})]:[hK(e,{}),hK(e,{binSuffix:"end"})]:[hK(e)])).flat():n??[]}assemble(){const e=[],{facetby:t,dimensionFieldDefs:n,stackField:r,stackby:i,sort:o,offset:a,impute:s,as:l}=this._stack;if(s)for(const u of n){const{bandPosition:n=.5,bin:o}=u;if(o){const t=hK(u,{expr:"datum"}),r=hK(u,{expr:"datum",binSuffix:"end"});e.push({type:"formula",expr:`${n}*${t}+${1-n}*${r}`,as:hK(u,{binSuffix:"mid",forAs:!0})})}e.push({type:"impute",field:r,groupby:[...i,...t],key:hK(u,{binSuffix:"mid"}),method:"value",value:0})}return e.push({type:"stack",groupby:[...this.getGroupbyFields(),...t],field:r,sort:o,as:l,offset:a}),e}}class z6 extends j2{clone(){return new z6(null,xH(this.transform))}constructor(e,t){super(e),this.transform=t}addDimensions(e){this.transform.groupby=CH(this.transform.groupby.concat(e),(e=>e))}dependentFields(){const e=new Set;return(this.transform.groupby??[]).forEach(e.add,e),(this.transform.sort??[]).forEach((t=>e.add(t.field))),this.transform.window.map((e=>e.field)).filter((e=>void 0!==e)).forEach(e.add,e),e}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(e){return e.as??hK(e)}hash(){return`WindowTransform ${EH(this.transform)}`}assemble(){const e=[],t=[],n=[],r=[];for(const c of this.transform.window)t.push(c.op),n.push(this.getDefaultName(c)),r.push(void 0===c.param?null:c.param),e.push(void 0===c.field?null:c.field);const i=this.transform.frame,o=this.transform.groupby;if(i&&null===i[0]&&null===i[1]&&t.every((e=>fY(e))))return{type:"joinaggregate",as:n,ops:t,fields:e,...void 0!==o?{groupby:o}:{}};const a=[],s=[];if(void 0!==this.transform.sort)for(const c of this.transform.sort)a.push(c.field),s.push(c.order??"ascending");const l={field:a,order:s},u=this.transform.ignorePeers;return{type:"window",params:r,as:n,ops:t,fields:e,sort:l,...void 0!==u?{ignorePeers:u}:{},...void 0!==o?{groupby:o}:{},...void 0!==i?{frame:i}:{}}}}function R6(e){if(e instanceof l6)if(1!==e.numChildren()||e.children[0]instanceof N2){const n=e.model.component.data.main;L6(n);const r=(t=e,function e(n){if(!(n instanceof l6)){const r=n.clone();if(r instanceof N2){const e=B6+r.getSource();r.setSource(e),t.model.component.data.outputNodes[e]=r}else(r instanceof s6||r instanceof T6||r instanceof z6||r instanceof F6)&&r.addDimensions(t.fields);for(const t of n.children.flatMap(e))t.parent=r;return[r]}return n.children.flatMap(e)}),i=e.children.map(r).flat();for(const e of i)e.parent=n}else{const t=e.children[0];(t instanceof s6||t instanceof T6||t instanceof z6||t instanceof F6)&&t.addDimensions(e.fields),t.swapWithParent(),R6(e)}else e.children.map(R6);var t}function L6(e){if(e instanceof N2&&e.type===x2.Main&&1===e.numChildren()){const t=e.children[0];t instanceof l6||(t.swapWithParent(),L6(e))}}const B6="scale_",I6=5;function U6(e){for(const t of e){for(const e of t.children)if(e.parent!==t)return!1;if(!U6(t.children))return!1}return!0}function q6(e,t){let n=!1;for(const r of t)n=e.optimize(r)||n;return n}function W6(e,t,n){let r=e.sources,i=!1;return i=q6(new j6,r)||i,i=q6(new E6(t),r)||i,r=r.filter((e=>e.numChildren()>0)),i=q6(new A6,r)||i,r=r.filter((e=>e.numChildren()>0)),n||(i=q6(new N6,r)||i,i=q6(new M6(t),r)||i,i=q6(new D6,r)||i,i=q6(new S6,r)||i,i=q6(new C6,r)||i,i=q6(new $6,r)||i,i=q6(new O6,r)||i,i=q6(new P6,r)||i),e.sources=r,i}class Z6{constructor(e){Object.defineProperty(this,"signal",{enumerable:!0,get:e})}static fromName(e,t){return new Z6((()=>e(t)))}}function H6(e){O4(e)?function(e){const t=e.component.scales;for(const n of RH(t)){const r=G6(e,n);if(t[n].setWithExplicit("domains",r),J6(e,n),e.component.data.isFaceted){let t=e;for(;!E4(t)&&t.parent;)t=t.parent;if("shared"===t.component.resolve.scale[n])for(const e of r.value)NY(e)&&(e.data=B6+e.data.replace(B6,""))}}}(e):function(e){for(const n of e.children)H6(n);const t=e.component.scales;for(const n of RH(t)){let r,i=null;for(const t of e.children){const e=t.component.scales[n];if(e){r=void 0===r?e.getWithExplicit("domains"):f2(r,e.getWithExplicit("domains"),"domains","scale",K6);const t=e.get("selectionExtent");i&&t&&i.param!==t.param&&AX(iX),i=t}}t[n].setWithExplicit("domains",r),i&&t[n].set("selectionExtent",i,!0)}}(e)}function G6(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:r}=e,i=function(e,t,n,r){if("unaggregated"===e){const{valid:e,reason:r}=Q6(t,n);if(!e)return void AX(r)}else if(void 0===e&&r.useUnaggregatedDomain){const{valid:e}=Q6(t,n);if(e)return"unaggregated"}return e}(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return i!==e.scaleDomain(t)&&(e.specifiedScales[t]={...e.specifiedScales[t],domain:i}),"x"===t&&_K(r.x2)?_K(r.x)?f2(Y6(n,i,e,"x"),Y6(n,i,e,"x2"),"domain","scale",K6):Y6(n,i,e,"x2"):"y"===t&&_K(r.y2)?_K(r.y)?f2(Y6(n,i,e,"y"),Y6(n,i,e,"y2"),"domain","scale",K6):Y6(n,i,e,"y2"):Y6(n,i,e,t)}function V6(e,t,n){const r=YX(n)?.unit;return"temporal"===t||r?function(e,t,n){return e.map((e=>({signal:`{data: ${AK(e,{timeUnit:n,type:t})}}`})))}(e,t,r):[e]}function Y6(e,t,n,r){const{encoding:i}=n,o=_K(i[r]),{type:a}=o,s=o.timeUnit;if(function(e){return e?.unionWith}(t)){const i=Y6(e,void 0,n,r);return s2([...V6(t.unionWith,a,s),...i.value])}if(DY(t))return s2([t]);if(t&&"unaggregated"!==t&&!MJ(t))return s2(V6(t,a,s));const l=n.stack;if(l&&r===l.fieldChannel){if("normalize"===l.offset)return l2([[0,1]]);const e=n.requestDataName(x2.Main);return l2([{data:e,field:n.vgField(r,{suffix:"start"})},{data:e,field:n.vgField(r,{suffix:"end"})}])}const u=tY(r)&&KQ(o)?function(e,t,n){if(!SJ(n))return;const r=e.fieldDef(t),i=r.sort;if(BQ(i))return{op:"min",field:u5(r,t),order:"ascending"};const{stack:o}=e,a=o?new Set([...o.groupbyFields,...o.stackBy.map((e=>e.fieldDef.field))]):void 0;if(LQ(i)){return X6(i,o&&!a.has(i.field))}if(RQ(i)){const{encoding:t,order:n}=i,r=e.fieldDef(t),{aggregate:s,field:l}=r,u=o&&!a.has(l);if(uY(s)||cY(s))return X6({field:hK(r),order:n},u);if(fY(s)||!s)return X6({op:s,field:l,order:n},u)}else{if("descending"===i)return{op:"min",field:e.vgField(t),order:"descending"};if(jH(["ascending",void 0],i))return!0}return}(n,r,e):void 0;if(tK(o)){return l2(V6([o.datum],a,s))}const c=o;if("unaggregated"===t){const e=n.requestDataName(x2.Main),{field:t}=o;return l2([{data:e,field:hK({field:t,aggregate:"min"})},{data:e,field:hK({field:t,aggregate:"max"})}])}if(yY(c.bin)){if(SJ(e))return l2("bin-ordinal"===e?[]:[{data:IH(u)?n.requestDataName(x2.Main):n.requestDataName(x2.Raw),field:n.vgField(r,CK(c,r)?{binSuffix:"range"}:{}),sort:!0!==u&&_a(u)?u:{field:n.vgField(r,{}),op:"min"}}]);{const{bin:e}=c;if(yY(e)){const t=r6(n,c.field,e);return l2([new Z6((()=>{const e=n.getSignalName(t);return`[${e}.start, ${e}.stop]`}))])}return l2([{data:n.requestDataName(x2.Main),field:n.vgField(r,{})}])}}if(c.timeUnit&&jH(["time","utc"],e)&&VQ(c,O4(n)?n.encoding[hV(r)]:void 0,n.markDef,n.config)){const e=n.requestDataName(x2.Main);return l2([{data:e,field:n.vgField(r)},{data:e,field:n.vgField(r,{suffix:"end"})}])}return l2(u?[{data:IH(u)?n.requestDataName(x2.Main):n.requestDataName(x2.Raw),field:n.vgField(r),sort:u}]:[{data:n.requestDataName(x2.Main),field:n.vgField(r)}])}function X6(e,t){const{op:n,field:r,order:i}=e;return{op:n??(t?"sum":FQ),...r?{field:YH(r)}:{},...i?{order:i}:{}}}function J6(e,t){const n=e.component.scales[t],r=e.specifiedScales[t].domain,i=e.fieldDef(t)?.bin,o=MJ(r)&&r,a=bY(i)&&xY(i.extent)&&i.extent;(o||a)&&n.set("selectionExtent",o??a,!0)}function Q6(e,t){const{aggregate:n,type:r}=e;return n?bs(n)&&!mY.has(n)?{valid:!1,reason:xX(n)}:"quantitative"===r&&"log"===t?{valid:!1,reason:wX(e)}:{valid:!0}:{valid:!1,reason:bX(e)}}function K6(e,t,n,r){return e.explicit&&t.explicit&&AX(function(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${OH(n)} and ${OH(r)}). Using the union of the two domains.`}(n,r,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function e4(e){const t=CH(e.map((e=>{if(NY(e)){const{sort:t,...n}=e;return n}return e})),EH),n=CH(e.map((e=>{if(NY(e)){const t=e.sort;return void 0===t||IH(t)||("op"in t&&"count"===t.op&&delete t.field,"ascending"===t.order&&delete t.order),t}})).filter((e=>void 0!==e)),EH);if(0===t.length)return;if(1===t.length){const t=e[0];if(NY(t)&&n.length>0){let e=n[0];if(n.length>1){AX(OX);const t=n.filter((e=>_a(e)&&"op"in e&&"min"!==e.op));e=!n.every((e=>_a(e)&&"op"in e))||1!==t.length||t[0]}else if(_a(e)&&"field"in e){const n=e.field;t.field===n&&(e=!e.order||{order:e.order})}return{...t,sort:e}}return t}const r=CH(n.map((e=>IH(e)||!("op"in e)||bs(e.op)&&e.op in lY?e:(AX(function(e){return`Dropping sort property ${OH(e)} as unioned domains only support boolean or op "count", "min", and "max".`}(e)),!0))),EH);let i;1===r.length?i=r[0]:r.length>1&&(AX(OX),i=!0);const o=CH(e.map((e=>NY(e)?e.data:null)),(e=>e));if(1===o.length&&null!==o[0]){return{data:o[0],fields:t.map((e=>e.field)),...i?{sort:i}:{}}}return{fields:t,...i?{sort:i}:{}}}function t4(e){if(NY(e)&&bs(e.field))return e.field;if(function(e){return!ka(e)&&"fields"in e&&!("data"in e)}(e)){let t;for(const n of e.fields)if(NY(n)&&bs(n.field))if(t){if(t!==n.field)return AX("Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect."),t}else t=n.field;return AX("Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect."),t}if(function(e){return!ka(e)&&"fields"in e&&"data"in e}(e)){AX("Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.");const t=e.fields[0];return bs(t)?t:void 0}}function n4(e,t){const n=e.component.scales[t].get("domains").map((t=>(NY(t)&&(t.data=e.lookupDataSource(t.data)),t)));return e4(n)}function r4(e){return j4(e)||D4(e)?e.children.reduce(((e,t)=>e.concat(r4(t))),i4(e)):i4(e)}function i4(e){return RH(e.component.scales).reduce(((t,n)=>{const r=e.component.scales[n];if(r.merged)return t;const i=r.combine(),{name:o,type:a,selectionExtent:s,domains:l,range:u,reverse:c,...f}=i,d=function(e,t,n,r){if(zV(n)){if(jY(e))return{step:{signal:`${t}_step`}}}else if(_a(e)&&NY(e))return{...e,data:r.lookupDataSource(e.data)};return e}(i.range,o,n,e),h=n4(e,n),p=s?function(e,t,n,r){const i=Y3(e,t.param,t);return{signal:AJ(n.get("type"))&&ka(r)&&r[0]>r[1]?`isValid(${i}) && reverse(${i})`:i}}(e,s,r,h):null;return t.push({name:o,type:a,...h?{domain:h}:{},...p?{domainRaw:p}:{},range:d,...void 0!==c?{reverse:c}:{},...f}),t}),[])}class o4 extends a2{constructor(e,t){super({},{name:e}),this.merged=!1,this.setWithExplicit("type",t)}domainDefinitelyIncludesZero(){return!1!==this.get("zero")||NH(this.get("domains"),(e=>ka(e)&&2===e.length&&e[0]<=0&&e[1]>=0))}}const a4=["range","scheme"];function s4(e,t){const n=e.fieldDef(t);if(n?.bin){const{bin:r,field:i}=n,o=pV(t),a=e.getName(o);if(_a(r)&&r.binned&&void 0!==r.step)return new Z6((()=>{const n=e.scaleName(t),i=`(domain("${n}")[1] - domain("${n}")[0]) / ${r.step}`;return`${e.getSignalName(a)} / (${i})`}));if(yY(r)){const t=r6(e,i,r);return new Z6((()=>{const n=e.getSignalName(t),r=`(${n}.stop - ${n}.start) / ${n}.step`;return`${e.getSignalName(a)} / (${r})`}))}}}function l4(e,t){const n=t.specifiedScales[e],{size:r}=t,i=t.getScaleComponent(e).get("type");for(const c of a4)if(void 0!==n[c]){const r=UJ(i,c),o=qJ(e,c);if(r)if(o)AX(o);else switch(c){case"range":{const r=n.range;if(ka(r)){if(zV(e))return s2(r.map((e=>{if("width"===e||"height"===e){const n=t.getName(e),r=t.getSignalName.bind(t);return Z6.fromName(r,n)}return e})))}else if(_a(r))return s2({data:t.requestDataName(x2.Main),field:r.field,sort:{op:"min",field:t.vgField(e)}});return s2(r)}case"scheme":return s2(u4(n[c]))}else AX(kX(i,c,e))}const o=e===uG||"xOffset"===e?"width":"height",a=r[o];if(R0(a))if(zV(e))if(SJ(i)){const n=c4(a,t,e);if(n)return s2({step:n})}else AX(_X(o));else if(UV(e)){const n=e===hG?"x":"y";if("band"===t.getScaleComponent(n).get("type")){const e=f4(a,i);if(e)return s2(e)}}const{rangeMin:s,rangeMax:l}=n,u=function(e,t){const{size:n,config:r,mark:i,encoding:o}=t,a=t.getSignalName.bind(t),{type:s}=_K(o[e]),l=t.getScaleComponent(e),u=l.get("type"),{domain:c,domainMid:f}=t.specifiedScales[e];switch(e){case uG:case cG:{if(jH(["point","band"],u)){const i=d4(e,n,r.view);if(R0(i)){return{step:c4(i,t,e)}}}const i=pV(e),o=t.getName(i);return e===cG&&AJ(u)?[Z6.fromName(a,o),0]:[0,Z6.fromName(a,o)]}case hG:case pG:return function(e,t,n){const r=e===hG?"x":"y",i=t.getScaleComponent(r),o=i.get("type"),a=t.scaleName(r);if("band"===o){const e=d4(r,t.size,t.config.view);if(R0(e)){const t=f4(e,n);if(t)return t}return[0,{signal:`bandwidth('${a}')`}]}{const n=t.encoding[r];if(KQ(n)&&n.timeUnit){const e=XX(n.timeUnit,(e=>`scale('${a}', ${e})`)),r=t.config.scale.bandWithNestedOffsetPaddingInner;if(r){return[{signal:`${DY(r)?`${r.signal}/2`:""+r/2} * (${e})`},{signal:`${DY(r)?`(1 - ${r.signal}/2)`:""+(1-r/2)} * (${e})`}]}return[0,{signal:e}]}return wH(`Cannot use ${e} scale if ${r} scale is not discrete.`)}}(e,t,u);case jG:{const o=h4(i,t.component.scales[e].get("zero"),r),a=function(e,t,n,r){const i={x:s4(n,"x"),y:s4(n,"y")};switch(e){case"bar":case"tick":{if(void 0!==r.scale.maxBandSize)return r.scale.maxBandSize;const e=m4(t,i,r.view);return ys(e)?e-1:new Z6((()=>`${e.signal} - 1`))}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const e=m4(t,i,r.view);return ys(e)?Math.pow(p4*e,2):new Z6((()=>`pow(${p4} * ${e.signal}, 2)`))}}throw new Error(pX("size",e))}(i,n,t,r);return CJ(u)?function(e,t,n){const r=()=>{const r=RY(t),i=RY(e),o=`(${r} - ${i}) / (${n} - 1)`;return`sequence(${i}, ${r} + ${o}, ${o})`};return DY(t)?new Z6(r):{signal:r()}}(o,a,function(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return void 0!==n&&ka(n)?n.length+1:(AX(function(e){return`Domain for ${e} is required for threshold scale.`}(r)),3)}}(u,r,c,e)):[o,a]}case yG:return[0,2*Math.PI];case NG:return[0,360];case mG:return[0,new Z6((()=>`min(${t.getSignalName("width")},${t.getSignalName("height")})/2`))];case CG:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case MG:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case DG:return"symbol";case _G:case OG:case EG:return"ordinal"===u?"nominal"===s?"category":"ordinal":void 0!==f?"diverging":"rect"===i||"geoshape"===i?"heatmap":"ramp";case SG:case AG:case $G:return[r.scale.minOpacity,r.scale.maxOpacity]}}(e,t);return(void 0!==s||void 0!==l)&&UJ(i,"rangeMin")&&ka(u)&&2===u.length?s2([s??u[0],l??u[1]]):l2(u)}function u4(e){return function(e){return!bs(e)&&!!e.name}(e)?{scheme:e.name,..._H(e,["name"])}:{scheme:e}}function c4(e,t,n){const{encoding:r}=t,i=t.getScaleComponent(n),o=gV(n),a=r[o];if("offset"===z0({step:e,offsetIsDiscrete:oK(a)&&dJ(a.type)})&&WK(r,o)){const n=t.getScaleComponent(o);let r=`domain('${t.scaleName(o)}').length`;if("band"===n.get("type")){r=`bandspace(${r}, ${n.get("paddingInner")??n.get("padding")??0}, ${n.get("paddingOuter")??n.get("padding")??0})`}const a=i.get("paddingInner")??i.get("padding");return{signal:`${e.step} * ${r} / (1-${TY(a)})`}}return e.step}function f4(e,t){if("offset"===z0({step:e,offsetIsDiscrete:SJ(t)}))return{step:e.step}}function d4(e,t,n){const r=e===uG?"width":"height",i=t[r];return i||q0(n,r)}function h4(e,t,n){if(t)return DY(t)?{signal:`${t.signal} ? 0 : ${h4(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(pX("size",e))}const p4=.95;function m4(e,t,n){const r=R0(e.width)?e.width.step:U0(n,"width"),i=R0(e.height)?e.height.step:U0(n,"height");return t.x||t.y?new Z6((()=>`min(${[t.x?t.x.signal:r,t.y?t.y.signal:i].join(", ")})`)):Math.min(r,i)}function g4(e,t){O4(e)?function(e,t){const n=e.component.scales,{config:r,encoding:i,markDef:o,specifiedScales:a}=e;for(const s of RH(n)){const l=a[s],u=n[s],c=e.getScaleComponent(s),f=_K(i[s]),d=l[t],h=c.get("type"),p=c.get("padding"),m=c.get("paddingInner"),g=UJ(h,t),y=qJ(s,t);if(void 0!==d&&(g?y&&AX(y):AX(kX(h,t,s))),g&&void 0===y)if(void 0!==d){const e=f.timeUnit,n=f.type;switch(t){case"domainMax":case"domainMin":$X(l[t])||"temporal"===n||e?u.set(t,{signal:AK(l[t],{type:n,timeUnit:e})},!0):u.set(t,l[t],!0);break;default:u.copyKeyFromObject(t,l)}}else{const n=t in y4?y4[t]({model:e,channel:s,fieldOrDatumDef:f,scaleType:h,scalePadding:p,scalePaddingInner:m,domain:l.domain,domainMin:l.domainMin,domainMax:l.domainMax,markDef:o,config:r,hasNestedOffsetScale:ZK(i,s),hasSecondaryRangeChannel:!!i[hV(s)]}):r.scale[t];void 0!==n&&u.set(t,n,!1)}}}(e,t):b4(e,t)}const y4={bins:e=>{let{model:t,fieldOrDatumDef:n}=e;return KQ(n)?function(e,t){const n=t.bin;if(yY(n)){const r=r6(e,t.field,n);return new Z6((()=>e.getSignalName(r)))}if(vY(n)&&bY(n)&&void 0!==n.step)return{step:n.step};return}(t,n):void 0},interpolate:e=>{let{channel:t,fieldOrDatumDef:n}=e;return function(e,t){if(jH([_G,OG,EG],e)&&"nominal"!==t)return"hcl";return}(t,n.type)},nice:e=>{let{scaleType:t,channel:n,domain:r,domainMin:i,domainMax:o,fieldOrDatumDef:a}=e;return function(e,t,n,r,i,o){if(kK(o)?.bin||ka(n)||null!=i||null!=r||jH([vJ.TIME,vJ.UTC],e))return;return!!zV(t)||void 0}(t,n,r,i,o,a)},padding:e=>{let{channel:t,scaleType:n,fieldOrDatumDef:r,markDef:i,config:o}=e;return function(e,t,n,r,i,o){if(zV(e)){if($J(t)){if(void 0!==n.continuousPadding)return n.continuousPadding;const{type:t,orient:a}=i;if("bar"===t&&(!KQ(r)||!r.bin&&!r.timeUnit)&&("vertical"===a&&"x"===e||"horizontal"===a&&"y"===e))return o.continuousBandSize}if(t===vJ.POINT)return n.pointPadding}return}(t,n,o.scale,r,i,o.bar)},paddingInner:e=>{let{scalePadding:t,channel:n,markDef:r,scaleType:i,config:o,hasNestedOffsetScale:a}=e;return function(e,t,n,r,i,o){void 0===o&&(o=!1);if(void 0!==e)return;if(zV(t)){const{bandPaddingInner:e,barBandPaddingInner:t,rectBandPaddingInner:r,bandWithNestedOffsetPaddingInner:a}=i;return o?a:KH(e,"bar"===n?t:r)}if(UV(t)&&r===vJ.BAND)return i.offsetBandPaddingInner;return}(t,n,r.type,i,o.scale,a)},paddingOuter:e=>{let{scalePadding:t,channel:n,scaleType:r,scalePaddingInner:i,config:o,hasNestedOffsetScale:a}=e;return function(e,t,n,r,i,o){void 0===o&&(o=!1);if(void 0!==e)return;if(zV(t)){const{bandPaddingOuter:e,bandWithNestedOffsetPaddingOuter:t}=i;if(o)return t;if(n===vJ.BAND)return KH(e,DY(r)?{signal:`${r.signal}/2`}:r/2)}else if(UV(t)){if(n===vJ.POINT)return.5;if(n===vJ.BAND)return i.offsetBandPaddingOuter}return}(t,n,r,i,o.scale,a)},reverse:e=>{let{fieldOrDatumDef:t,scaleType:n,channel:r,config:i}=e;return function(e,t,n,r){if("x"===n&&void 0!==r.xReverse)return AJ(e)&&"descending"===t?DY(r.xReverse)?{signal:`!${r.xReverse.signal}`}:!r.xReverse:r.xReverse;if(AJ(e)&&"descending"===t)return!0;return}(n,KQ(t)?t.sort:void 0,r,i.scale)},zero:e=>{let{channel:t,fieldOrDatumDef:n,domain:r,markDef:i,scaleType:o,config:a,hasSecondaryRangeChannel:s}=e;return function(e,t,n,r,i,o,a){if(n&&"unaggregated"!==n&&AJ(i)){if(ka(n)){const e=n[0],t=n[n.length-1];if(e<=0&&t>=0)return!0}return!1}if("size"===e&&"quantitative"===t.type&&!CJ(i))return!0;if((!KQ(t)||!t.bin)&&jH([...TV,...LV],e)){const{orient:t,type:n}=r;return(!jH(["bar","area","line","trail"],n)||!("horizontal"===t&&"y"===e||"vertical"===t&&"x"===e))&&(!(!jH(["bar","area"],n)||a)||o?.zero)}return!1}(t,n,r,i,o,a.scale,s)}};function v4(e){O4(e)?function(e){const t=e.component.scales;for(const n of eY){const r=t[n];if(!r)continue;const i=l4(n,e);r.setWithExplicit("range",i)}}(e):b4(e,"range")}function b4(e,t){const n=e.component.scales;for(const r of e.children)"range"===t?v4(r):g4(r,t);for(const r of RH(n)){let i;for(const n of e.children){const e=n.component.scales[r];if(e){i=f2(i,e.getWithExplicit(t),t,"scale",u2(((e,n)=>"range"===t&&e.step&&n.step?e.step-n.step:0)))}}n[r].setWithExplicit(t,i)}}function x4(e,t,n,r,i){void 0===i&&(i=!1);const o=function(e,t,n,r){switch(t.type){case"nominal":case"ordinal":if(YG(e)||"discrete"===aY(e))return"shape"===e&&"ordinal"===t.type&&AX(vX(e,"ordinal")),"ordinal";if(zV(e)||UV(e)){if(jH(["rect","bar","image","rule"],n.type))return"band";if(r)return"band"}else if("arc"===n.type&&e in RV)return"band";return dQ(n[pV(e)])||uK(t)&&t.axis?.tickBand?"band":"point";case"temporal":return YG(e)?"time":"discrete"===aY(e)?(AX(vX(e,"temporal")),"ordinal"):KQ(t)&&t.timeUnit&&YX(t.timeUnit).utc?"utc":"time";case"quantitative":return YG(e)?KQ(t)&&yY(t.bin)?"bin-ordinal":"linear":"discrete"===aY(e)?(AX(vX(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(fX(t.type))}(t,n,r,i),{type:a}=e;return tY(t)?void 0!==a?function(e,t,n){if(void 0===n&&(n=!1),!tY(e))return!1;switch(e){case uG:case cG:case hG:case pG:case yG:case mG:return!!$J(t)||"band"===t||"point"===t&&!n;case jG:case CG:case SG:case AG:case $G:case NG:return $J(t)||CJ(t)||jH(["band","point","ordinal"],t);case _G:case OG:case EG:return"band"!==t;case MG:case DG:return"ordinal"===t||CJ(t)}}(t,a)?KQ(n)&&(s=a,l=n.type,!(jH([pJ,gJ],l)?void 0===s||SJ(s):l===mJ?jH([vJ.TIME,vJ.UTC,void 0],s):l!==hJ||EJ(s)||CJ(s)||void 0===s))?(AX(function(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}(a,o)),o):a:(AX(function(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}(t,a,o)),o):o:null;var s,l}function w4(e){O4(e)?e.component.scales=function(e){const{encoding:t,mark:n,markDef:r}=e,i={};for(const o of eY){const a=_K(t[o]);if(a&&n===iQ&&o===DG&&a.type===yJ)continue;let s=a&&a.scale;if(UV(o)){if(!ZK(t,yV(o))){s&&AX(mX(o));continue}}if(a&&null!==s&&!1!==s){s??(s={});const n=x4(s,o,a,r,ZK(t,o));i[o]=new o4(e.scaleName(`${o}`,!0),{value:n,explicit:s.type===n})}}return i}(e):e.component.scales=function(e){var t;const n=e.component.scales={},r={},i=e.component.resolve;for(const o of e.children){w4(o);for(const n of RH(o.component.scales))if((t=i.scale)[n]??(t[n]=$5(n,e)),"shared"===i.scale[n]){const e=r[n],t=o.component.scales[n].getWithExplicit("type");e?xJ(e.value,t.value)?r[n]=f2(e,t,"type","scale",k4):(i.scale[n]="independent",delete r[n]):r[n]=t}}for(const o of RH(r)){const t=e.scaleName(o,!0),i=r[o];n[o]=new o4(t,i);for(const n of e.children){const e=n.component.scales[o];e&&(n.renameScale(e.get("name"),t),e.merged=!0)}}return n}(e)}const k4=u2(((e,t)=>kJ(e)-kJ(t)));class _4{constructor(){this.nameMap={}}rename(e,t){this.nameMap[e]=t}has(e){return void 0!==this.nameMap[e]}get(e){for(;this.nameMap[e]&&e!==this.nameMap[e];)e=this.nameMap[e];return e}}function O4(e){return"unit"===e?.type}function E4(e){return"facet"===e?.type}function D4(e){return"concat"===e?.type}function j4(e){return"layer"===e?.type}class N4{constructor(e,t,n,r,i,o,a){this.type=t,this.parent=n,this.config=i,this.correctDataNames=e=>(e.from?.data&&(e.from.data=this.lookupDataSource(e.from.data)),e.from?.facet?.data&&(e.from.facet.data=this.lookupDataSource(e.from.facet.data)),e),this.parent=n,this.config=i,this.view=_Y(a),this.name=e.name??r,this.title=EY(e.title)?{text:e.title}:e.title?_Y(e.title):void 0,this.scaleNameMap=n?n.scaleNameMap:new _4,this.projectionNameMap=n?n.projectionNameMap:new _4,this.signalNameMap=n?n.signalNameMap:new _4,this.data=e.data,this.description=e.description,this.transforms=function(e){return e.map((e=>j1(e)?{filter:vH(e.filter,cJ)}:e))}(e.transform??[]),this.layout="layer"===t||"unit"===t?{}:function(e,t,n){const r=n[t],i={},{spacing:o,columns:a}=r;void 0!==o&&(i.spacing=o),void 0!==a&&(qQ(e)&&!IQ(e.facet)||P0(e))&&(i.columns=a),F0(e)&&(i.columns=1);for(const s of B0)if(void 0!==e[s])if("spacing"===s){const t=e[s];i[s]=ys(t)?t:{row:t.row??o,column:t.column??o}}else i[s]=e[s];return i}(e,t,i),this.component={data:{sources:n?n.component.data.sources:[],outputNodes:n?n.component.data.outputNodes:{},outputNodeRefCounts:n?n.component.data.outputNodeRefCounts:{},isFaceted:qQ(e)||n?.component.data.isFaceted&&void 0===e.data},layoutSize:new a2,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:{scale:{},axis:{},legend:{},...o?xH(o):{}},selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){!function(e,t){let{ignoreRange:n}=void 0===t?{}:t;w4(e),H6(e);for(const r of IJ)g4(e,r);n||v4(e)}(this)}parseProjection(){e6(this)}renameTopLevelLayoutSizeSignal(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height")}parseLegends(){W5(this)}assembleEncodeFromView(e){const{style:t,...n}=e,r={};for(const i of RH(n)){const e=n[i];void 0!==e&&(r[i]=FY(e))}return r}assembleGroupEncodeEntry(e){let t={};return this.view&&(t=this.assembleEncodeFromView(this.view)),e||(this.description&&(t.description=FY(this.description)),"unit"!==this.type&&"layer"!==this.type)?zH(t)?void 0:t:{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height"),...t??{}}}assembleLayout(){if(!this.layout)return;const{spacing:e,...t}=this.layout,{component:n,config:r}=this,i=function(e,t){const n={};for(const r of JG){const i=e[r];if(i?.facetFieldDef){const{titleAnchor:e,titleOrient:o}=d5(["titleAnchor","titleOrient"],i.facetFieldDef.header,t,r),a=c5(r,o),s=_5(e,a);void 0!==s&&(n[a]=s)}}return zH(n)?void 0:n}(n.layoutHeaders,r);return{padding:e,...this.assembleDefaultLayout(),...t,...i?{titleBand:i}:{}}}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:e}=this.component;let t=[];for(const n of JG)e[n].title&&t.push(m5(this,n));for(const n of h5)t=t.concat(v5(this,n));return t}assembleAxes(){return function(e,t){const{x:n=[],y:r=[]}=e;return[...n.map((e=>Q3(e,"grid",t))),...r.map((e=>Q3(e,"grid",t))),...n.map((e=>Q3(e,"main",t))),...r.map((e=>Q3(e,"main",t)))].filter((e=>e))}(this.component.axes,this.config)}assembleLegends(){return Y5(this)}assembleProjections(){return X5(this)}assembleTitle(){const{encoding:e,...t}=this.title??{},n={...OY(this.config.title).nonMarkTitleProperties,...t,...e?{encode:{update:e}}:{}};if(n.text)return jH(["unit","layer"],this.type)?jH(["middle",void 0],n.anchor)&&(n.frame??(n.frame="group")):n.anchor??(n.anchor="start"),zH(n)?void 0:n}assembleGroup(e){void 0===e&&(e=[]);const t={};(e=e.concat(this.assembleSignals())).length>0&&(t.signals=e);const n=this.assembleLayout();n&&(t.layout=n),t.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||E4(this.parent)?r4(this):[];r.length>0&&(t.scales=r);const i=this.assembleAxes();i.length>0&&(t.axes=i);const o=this.assembleLegends();return o.length>0&&(t.legends=o),t}getName(e){return UH((this.name?`${this.name}_`:"")+e)}getDataName(e){return this.getName(x2[e].toLowerCase())}requestDataName(e){const t=this.getDataName(e),n=this.component.data.outputNodeRefCounts;return n[t]=(n[t]||0)+1,t}getSizeSignalRef(e){if(E4(this.parent)){const t=BV(S5(e)),n=this.component.scales[t];if(n&&!n.merged){const e=n.get("type"),r=n.get("range");if(SJ(e)&&jY(r)){const e=n.get("name"),r=t4(n4(this,t));if(r){return{signal:N5(e,n,hK({aggregate:"distinct",field:r},{expr:"datum"}))}}return AX(eX(t)),null}}}return{signal:this.signalNameMap.get(this.getName(e))}}lookupDataSource(e){const t=this.component.data.outputNodes[e];return t?t.getSource():e}getSignalName(e){return this.signalNameMap.get(e)}renameSignal(e,t){this.signalNameMap.rename(e,t)}renameScale(e,t){this.scaleNameMap.rename(e,t)}renameProjection(e,t){this.projectionNameMap.rename(e,t)}scaleName(e,t){return t?this.getName(e):lV(e)&&tY(e)&&this.component.scales[e]||this.scaleNameMap.has(this.getName(e))?this.scaleNameMap.get(this.getName(e)):void 0}projectionName(e){return e?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}getScaleComponent(e){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const t=this.component.scales[e];return t&&!t.merged?t:this.parent?this.parent.getScaleComponent(e):void 0}getSelectionComponent(e,t){let n=this.component.selection[e];if(!n&&this.parent&&(n=this.parent.getSelectionComponent(e,t)),!n)throw new Error(function(e){return`Cannot find a selection named "${e}".`}(t));return n}hasAxisOrientSignalRef(){return this.component.axes.x?.some((e=>e.hasOrientSignalRef()))||this.component.axes.y?.some((e=>e.hasOrientSignalRef()))}}class S4 extends N4{vgField(e,t){void 0===t&&(t={});const n=this.fieldDef(e);if(n)return hK(n,t)}reduceFieldDef(e,t){return function(e,t,n,r){return e?RH(e).reduce(((n,i)=>{const o=e[i];return ka(o)?o.reduce(((e,n)=>t.call(r,e,n,i)),n):t.call(r,n,o,i)}),n):n}(this.getMapping(),((t,n,r)=>{const i=kK(n);return i?e(t,i,r):t}),t)}forEachFieldDef(e,t){XK(this.getMapping(),((t,n)=>{const r=kK(t);r&&e(r,n)}),t)}}class A4 extends j2{clone(){return new A4(null,xH(this.transform))}constructor(e,t){super(e),this.transform=t,this.transform=xH(t);const n=this.transform.as??[void 0,void 0];this.transform.as=[n[0]??"value",n[1]??"density"],t.groupby&&null==t.minsteps&&null==t.maxsteps&&null==t.steps&&(this.transform.steps=200)}dependentFields(){return new Set([this.transform.density,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${EH(this.transform)}`}assemble(){const{density:e,...t}=this.transform;return{type:"kde",field:e,...t}}}class $4 extends j2{clone(){return new $4(null,xH(this.transform))}constructor(e,t){super(e),this.transform=t,this.transform=xH(t)}dependentFields(){return new Set([this.transform.extent])}producedFields(){return new Set([])}hash(){return`ExtentTransform ${EH(this.transform)}`}assemble(){const{extent:e,param:t}=this.transform;return{type:"extent",field:e,signal:t}}}class C4 extends j2{clone(){return new C4(null,{...this.filter})}constructor(e,t){super(e),this.filter=t}static make(e,t){const{config:n,mark:r,markDef:i}=t;if("filter"!==IY("invalid",i,n))return null;const o=t.reduceFieldDef(((e,n,i)=>{const o=tY(i)&&t.getScaleComponent(i);if(o){AJ(o.get("type"))&&"count"!==n.aggregate&&!oQ(r)&&(e[n.field]=n)}return e}),{});return RH(o).length?new C4(e,o):null}dependentFields(){return new Set(RH(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${EH(this.filter)}`}assemble(){const e=RH(this.filter).reduce(((e,t)=>{const n=this.filter[t],r=hK(n,{expr:"datum"});return null!==n&&("temporal"===n.type?e.push(`(isDate(${r}) || (isValid(${r}) && isFinite(+${r})))`):"quantitative"===n.type&&(e.push(`isValid(${r})`),e.push(`isFinite(+${r})`))),e}),[]);return e.length>0?{type:"filter",expr:e.join(" && ")}:null}}class M4 extends j2{clone(){return new M4(this.parent,xH(this.transform))}constructor(e,t){super(e),this.transform=t,this.transform=xH(t);const{flatten:n,as:r=[]}=this.transform;this.transform.as=n.map(((e,t)=>r[t]??e))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${EH(this.transform)}`}assemble(){const{flatten:e,as:t}=this.transform;return{type:"flatten",fields:e,as:t}}}class P4 extends j2{clone(){return new P4(null,xH(this.transform))}constructor(e,t){super(e),this.transform=t,this.transform=xH(t);const n=this.transform.as??[void 0,void 0];this.transform.as=[n[0]??"key",n[1]??"value"]}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${EH(this.transform)}`}assemble(){const{fold:e,as:t}=this.transform;return{type:"fold",fields:e,as:t}}}class F4 extends j2{clone(){return new F4(null,xH(this.fields),this.geojson,this.signal)}static parseAll(e,t){if(t.component.projection&&!t.component.projection.isFit)return e;let n=0;for(const r of[[xG,bG],[kG,wG]]){const i=r.map((e=>{const n=_K(t.encoding[e]);return KQ(n)?n.field:tK(n)?{expr:`${n.datum}`}:sK(n)?{expr:`${n.value}`}:void 0}));(i[0]||i[1])&&(e=new F4(e,i,null,t.getName("geojson_"+n++)))}if(t.channelHasField(DG)){const r=t.typedFieldDef(DG);r.type===yJ&&(e=new F4(e,null,r.field,t.getName("geojson_"+n++)))}return e}constructor(e,t,n,r){super(e),this.fields=t,this.geojson=n,this.signal=r}dependentFields(){const e=(this.fields??[]).filter(bs);return new Set([...this.geojson?[this.geojson]:[],...e])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${EH(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],{type:"geojson",...this.fields?{fields:this.fields}:{},...this.geojson?{geojson:this.geojson}:{},signal:this.signal}]}}class T4 extends j2{clone(){return new T4(null,this.projection,xH(this.fields),xH(this.as))}constructor(e,t,n,r){super(e),this.projection=t,this.fields=n,this.as=r}static parseAll(e,t){if(!t.projectionName())return e;for(const n of[[xG,bG],[kG,wG]]){const r=n.map((e=>{const n=_K(t.encoding[e]);return KQ(n)?n.field:tK(n)?{expr:`${n.datum}`}:sK(n)?{expr:`${n.value}`}:void 0})),i=n[0]===kG?"2":"";(r[0]||r[1])&&(e=new T4(e,t.projectionName(),r,[t.getName(`x${i}`),t.getName(`y${i}`)]))}return e}dependentFields(){return new Set(this.fields.filter(bs))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${EH(this.fields)} ${EH(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class z4 extends j2{clone(){return new z4(null,xH(this.transform))}constructor(e,t){super(e),this.transform=t}dependentFields(){return new Set([this.transform.impute,this.transform.key,...this.transform.groupby??[]])}producedFields(){return new Set([this.transform.impute])}processSequence(e){const{start:t=0,stop:n,step:r}=e;return{signal:`sequence(${[t,n,...r?[r]:[]].join(",")})`}}static makeFromTransform(e,t){return new z4(e,t)}static makeFromEncoding(e,t){const n=t.encoding,r=n.x,i=n.y;if(KQ(r)&&KQ(i)){const o=r.impute?r:i.impute?i:void 0;if(void 0===o)return;const a=r.impute?i:i.impute?r:void 0,{method:s,value:l,frame:u,keyvals:c}=o.impute,f=JK(t.mark,n);return new z4(e,{impute:o.field,key:a.field,...s?{method:s}:{},...void 0!==l?{value:l}:{},...u?{frame:u}:{},...void 0!==c?{keyvals:c}:{},...f.length?{groupby:f}:{}})}return null}hash(){return`Impute ${EH(this.transform)}`}assemble(){const{impute:e,key:t,keyvals:n,method:r,groupby:i,value:o,frame:a=[null,null]}=this.transform,s={type:"impute",field:e,key:t,...n?{keyvals:N1(n)?this.processSequence(n):n}:{},method:"value",...i?{groupby:i}:{},value:r&&"value"!==r?null:o};if(r&&"value"!==r){return[s,{type:"window",as:[`imputed_${e}_value`],ops:[r],fields:[e],frame:a,ignorePeers:!1,...i?{groupby:i}:{}},{type:"formula",expr:`datum.${e} === null ? datum.imputed_${e}_value : datum.${e}`,as:e}]}return[s]}}class R4 extends j2{clone(){return new R4(null,xH(this.transform))}constructor(e,t){super(e),this.transform=t,this.transform=xH(t);const n=this.transform.as??[void 0,void 0];this.transform.as=[n[0]??t.on,n[1]??t.loess]}dependentFields(){return new Set([this.transform.loess,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${EH(this.transform)}`}assemble(){const{loess:e,on:t,...n}=this.transform;return{type:"loess",x:t,y:e,...n}}}class L4 extends j2{clone(){return new L4(null,xH(this.transform),this.secondary)}constructor(e,t,n){super(e),this.transform=t,this.secondary=n}static make(e,t,n,r){const i=t.component.data.sources,{from:o}=n;let a=null;if(function(e){return"data"in e}(o)){let e=e9(o.data,i);e||(e=new g6(o.data),i.push(e));const n=t.getName(`lookup_${r}`);a=new N2(e,n,x2.Lookup,t.component.data.outputNodeRefCounts),t.component.data.outputNodes[n]=a}else if(function(e){return"param"in e}(o)){const e=o.param;let r;n={as:e,...n};try{r=t.getSelectionComponent(UH(e),e)}catch(S9){throw new Error(function(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}(e))}if(a=r.materialized,!a)throw new Error(function(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}(e))}return new L4(e,n,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?Ga(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${EH({transform:this.transform,secondary:this.secondary})}`}assemble(){let e;if(this.transform.from.fields)e={values:this.transform.from.fields,...this.transform.as?{as:Ga(this.transform.as)}:{}};else{let t=this.transform.as;bs(t)||(AX('If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.'),t="_lookup"),e={as:[t]}}return{type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup],...e,...this.transform.default?{default:this.transform.default}:{}}}}class B4 extends j2{clone(){return new B4(null,xH(this.transform))}constructor(e,t){super(e),this.transform=t,this.transform=xH(t);const n=this.transform.as??[void 0,void 0];this.transform.as=[n[0]??"prob",n[1]??"value"]}dependentFields(){return new Set([this.transform.quantile,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${EH(this.transform)}`}assemble(){const{quantile:e,...t}=this.transform;return{type:"quantile",field:e,...t}}}class I4 extends j2{clone(){return new I4(null,xH(this.transform))}constructor(e,t){super(e),this.transform=t,this.transform=xH(t);const n=this.transform.as??[void 0,void 0];this.transform.as=[n[0]??t.on,n[1]??t.regression]}dependentFields(){return new Set([this.transform.regression,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${EH(this.transform)}`}assemble(){const{regression:e,on:t,...n}=this.transform;return{type:"regression",x:t,y:e,...n}}}class U4 extends j2{clone(){return new U4(null,xH(this.transform))}constructor(e,t){super(e),this.transform=t}addDimensions(e){this.transform.groupby=CH((this.transform.groupby??[]).concat(e),(e=>e))}producedFields(){}dependentFields(){return new Set([this.transform.pivot,this.transform.value,...this.transform.groupby??[]])}hash(){return`PivotTransform ${EH(this.transform)}`}assemble(){const{pivot:e,value:t,groupby:n,limit:r,op:i}=this.transform;return{type:"pivot",field:e,value:t,...void 0!==r?{limit:r}:{},...void 0!==i?{op:i}:{},...void 0!==n?{groupby:n}:{}}}}class q4 extends j2{clone(){return new q4(null,xH(this.transform))}constructor(e,t){super(e),this.transform=t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${EH(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function W4(e){let t=0;return function n(r,i){if(r instanceof g6&&!r.isGenerator&&!h2(r.data)){e.push(i);i={name:null,source:i.name,transform:[]}}if(r instanceof d6&&(r.parent instanceof g6&&!i.source?(i.format={...i.format??{},parse:r.assembleFormatParse()},i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof l6)return i.name||(i.name="data_"+t++),!i.source||i.transform.length>0?(e.push(i),r.data=i.name):r.data=i.source,void e.push(...r.assemble());if((r instanceof p6||r instanceof m6||r instanceof C4||r instanceof G3||r instanceof l5||r instanceof T4||r instanceof s6||r instanceof L4||r instanceof z6||r instanceof F6||r instanceof P4||r instanceof M4||r instanceof A4||r instanceof R4||r instanceof B4||r instanceof I4||r instanceof h6||r instanceof q4||r instanceof U4||r instanceof $4)&&i.transform.push(r.assemble()),(r instanceof o6||r instanceof $2||r instanceof z4||r instanceof T6||r instanceof F4)&&i.transform.push(...r.assemble()),r instanceof N2)if(i.source&&0===i.transform.length)r.setSource(i.source);else if(r.parent instanceof N2)r.setSource(i.name);else if(i.name||(i.name="data_"+t++),r.setSource(i.name),1===r.numChildren()){e.push(i);i={name:null,source:i.name,transform:[]}}switch(r.numChildren()){case 0:r instanceof N2&&(!i.source||i.transform.length>0)&&e.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name="data_"+t++);let o=i.name;!i.source||i.transform.length>0?e.push(i):o=i.source;for(const e of r.children){n(e,{name:null,source:o,transform:[]})}break}}}}function Z4(e){return"top"===e||"left"===e||DY(e)?"header":"footer"}function H4(e,t){const{facet:n,config:r,child:i,component:o}=e;if(e.channelHasField(t)){const a=n[t],s=f5("title",null,r,t);let l=vK(a,r,{allowDisabling:!0,includeDefault:void 0===s||!!s});i.component.layoutHeaders[t].title&&(l=ka(l)?l.join(", "):l,l+=` / ${i.component.layoutHeaders[t].title}`,i.component.layoutHeaders[t].title=null);const u=f5("labelOrient",a.header,r,t),c=null!==a.header&&KH(a.header?.labels,r.header.labels,!0),f=jH(["bottom","right"],u)?"footer":"header";o.layoutHeaders[t]={title:null!==a.header?l:null,facetFieldDef:a,[f]:"facet"===t?[]:[G4(e,t,c)]}}}function G4(e,t,n){const r="row"===t?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function V4(e,t){const{child:n}=e;if(n.component.axes[t]){const{layoutHeaders:r,resolve:i}=e.component;if(i.axis[t]=C5(i,t),"shared"===i.axis[t]){const i="x"===t?"column":"row",o=r[i];for(const r of n.component.axes[t]){const t=Z4(r.get("orient"));o[t]??(o[t]=[G4(e,i,!1)]);const n=Q3(r,"main",e.config,{header:!0});n&&o[t][0].axes.push(n),r.mainExtracted=!0}}}}function Y4(e){for(const t of e.children)t.parseLayoutSize()}function X4(e,t){const n=S5(t),r=BV(n),i=e.component.resolve,o=e.component.layoutSize;let a;for(const s of e.children){const t=s.component.layoutSize.getWithExplicit(n),o=i.scale[r]??$5(r,e);if("independent"===o&&"step"===t.value){a=void 0;break}if(a){if("independent"===o&&a.value!==t.value){a=void 0;break}a=f2(a,t,n,"")}else a=t}if(a){for(const r of e.children)e.renameSignal(r.getName(n),e.getName(t)),r.component.layoutSize.set(n,"merged",!1);o.setWithExplicit(t,a)}else o.setWithExplicit(t,{explicit:!1,value:void 0})}function J4(e,t){const n="width"===t?"x":"y",r=e.config,i=e.getScaleComponent(n);if(i){const e=i.get("type"),n=i.get("range");if(SJ(e)){const e=q0(r.view,t);return jY(n)||R0(e)?"step":e}return I0(r.view,t)}if(e.hasProjection||"arc"===e.mark)return I0(r.view,t);{const e=q0(r.view,t);return R0(e)?e.step:e}}function Q4(e,t,n){return hK(t,{suffix:`by_${hK(e)}`,...n??{}})}class K4 extends S4{constructor(e,t,n,r){super(e,"facet",t,n,r,e.resolve),this.child=D9(e.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(e.facet)}initFacet(e){if(!IQ(e))return{facet:this.initFacetFieldDef(e,"facet")};const t=RH(e),n={};for(const r of t){if(![aG,sG].includes(r)){AX(pX(r,"facet"));break}const t=e[r];if(void 0===t.field){AX(hX(t,r));break}n[r]=this.initFacetFieldDef(t,r)}return n}initFacetFieldDef(e,t){const n=DK(e,t);return n.header?n.header=_Y(n.header):null===n.header&&(n.header=null),n}channelHasField(e){return!!this.facet[e]}fieldDef(e){return this.facet[e]}parseData(){this.component.data=t9(this),this.child.parseData()}parseLayoutSize(){Y4(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),function(e){for(const t of JG)H4(e,t);V4(e,"x"),V4(e,"y")}(this)}assembleSelectionTopLevelSignals(e){return this.child.assembleSelectionTopLevelSignals(e)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(e){return this.child.assembleSelectionData(e)}getHeaderLayoutMixins(){const e={};for(const t of JG)for(const n of p5){const r=this.component.layoutHeaders[t],i=r[n],{facetFieldDef:o}=r;if(o){const n=f5("titleOrient",o.header,this.config,t);if(["right","bottom"].includes(n)){const r=c5(t,n);e.titleAnchor??(e.titleAnchor={}),e.titleAnchor[r]="end"}}if(i?.[0]){const i="row"===t?"height":"width",o="header"===n?"headerBand":"footerBand";"facet"===t||this.child.component.layoutSize.get(i)||(e[o]??(e[o]={}),e[o][t]=.5),r.title&&(e.offset??(e.offset={}),e.offset["row"===t?"rowTitle":"columnTitle"]=10)}}return e}assembleDefaultLayout(){const{column:e,row:t}=this.facet,n=e?this.columnDistinctSignal():t?1:void 0;let r="all";return(t||"independent"!==this.component.resolve.scale.x)&&(e||"independent"!==this.component.resolve.scale.y)||(r="none"),{...this.getHeaderLayoutMixins(),...n?{columns:n}:{},bounds:"full",align:r}}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof K4)){return{signal:`length(data('${this.getName("column_domain")}'))`}}}assembleGroupStyle(){}assembleGroup(e){return this.parent&&this.parent instanceof K4?{...this.channelHasField("column")?{encode:{update:{columns:{field:hK(this.facet.column,{prefix:"distinct"})}}}}:{},...super.assembleGroup(e)}:super.assembleGroup(e)}getCardinalityAggregateForChild(){const e=[],t=[],n=[];if(this.child instanceof K4){if(this.child.channelHasField("column")){const r=hK(this.child.facet.column);e.push(r),t.push("distinct"),n.push(`distinct_${r}`)}}else for(const r of TV){const i=this.child.component.scales[r];if(i&&!i.merged){const o=i.get("type"),a=i.get("range");if(SJ(o)&&jY(a)){const i=t4(n4(this.child,r));i?(e.push(i),t.push("distinct"),n.push(`distinct_${i}`)):AX(eX(r))}}}return{fields:e,ops:t,as:n}}assembleFacet(){const{name:e,data:t}=this.component.data.facetRoot,{row:n,column:r}=this.facet,{fields:i,ops:o,as:a}=this.getCardinalityAggregateForChild(),s=[];for(const u of JG){const e=this.facet[u];if(e){s.push(hK(e));const{bin:t,sort:l}=e;if(yY(t)&&s.push(hK(e,{binSuffix:"end"})),LQ(l)){const{field:t,op:s=FQ}=l,u=Q4(e,l);n&&r?(i.push(u),o.push("max"),a.push(u)):(i.push(t),o.push(s),a.push(u))}else if(ka(l)){const t=u5(e,u);i.push(t),o.push("max"),a.push(t)}}}const l=!!n&&!!r;return{name:e,data:t,groupby:s,...l||i.length>0?{aggregate:{...l?{cross:l}:{},...i.length?{fields:i,ops:o,as:a}:{}}}:{}}}facetSortFields(e){const{facet:t}=this,n=t[e];return n?LQ(n.sort)?[Q4(n,n.sort,{expr:"datum"})]:ka(n.sort)?[u5(n,e,{expr:"datum"})]:[hK(n,{expr:"datum"})]:[]}facetSortOrder(e){const{facet:t}=this,n=t[e];if(n){const{sort:e}=n;return[(LQ(e)?e.order:!ka(e)&&e)||"ascending"]}return[]}assembleLabelTitle(){const{facet:e,config:t}=this;if(e.facet)return x5(e.facet,"facet",t);const n={row:["top","bottom"],column:["left","right"]};for(const r of h5)if(e[r]){const i=f5("labelOrient",e[r]?.header,t,r);if(n[r].includes(i))return x5(e[r],r,t)}}assembleMarks(){const{child:e}=this,t=function(e){const t=[],n=W4(t);for(const r of e.children)n(r,{source:e.name,name:null,transform:[]});return t}(this.component.data.facetRoot),n=e.assembleGroupEncodeEntry(!1),r=this.assembleLabelTitle()||e.assembleTitle(),i=e.assembleGroupStyle(),o={name:this.getName("cell"),type:"group",...r?{title:r}:{},...i?{style:i}:{},from:{facet:this.assembleFacet()},sort:{field:JG.map((e=>this.facetSortFields(e))).flat(),order:JG.map((e=>this.facetSortOrder(e))).flat()},...t.length>0?{data:t}:{},...n?{encode:{update:n}}:{},...e.assembleGroup(O2(this,[]))};return[o]}getMapping(){return this.facet}}function e9(e,t){for(const n of t){const t=n.data;if(e.name&&n.hasName()&&e.name!==n.dataName)continue;const r=e.format?.mesh,i=t.format?.feature;if(r&&i)continue;const o=e.format?.feature;if((o||i)&&o!==i)continue;const a=t.format?.mesh;if(!r&&!a||r===a)if(p2(e)&&p2(t)){if(bH(e.values,t.values))return n}else if(h2(e)&&h2(t)){if(e.url===t.url)return n}else if(m2(e)&&e.name===n.dataName)return n}return null}function t9(e){let t=function(e,t){if(e.data||!e.parent){if(null===e.data){const e=new g6({values:[]});return t.push(e),e}const n=e9(e.data,t);if(n)return g2(e.data)||(n.data.format=AH({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const n=new g6(e.data);return t.push(n),n}}return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}(e,e.component.data.sources);const{outputNodes:n,outputNodeRefCounts:r}=e.component.data,i=e.data,o=!(i&&(g2(i)||h2(i)||p2(i)))&&e.parent?e.parent.component.data.ancestorParse.clone():new d2;g2(i)?(y2(i)?t=new m6(t,i.sequence):b2(i)&&(t=new p6(t,i.graticule)),o.parseNothing=!0):null===i?.format?.parse&&(o.parseNothing=!0),t=d6.makeExplicit(t,e,o)??t,t=new h6(t);const a=e.parent&&j4(e.parent);(O4(e)||E4(e))&&a&&(t=o6.makeFromEncoding(t,e)??t),e.transforms.length>0&&(t=function(e,t,n){let r=0;for(const i of t.transforms){let o,a;if(L1(i))a=e=new l5(e,i),o="derived";else if(j1(i)){const r=c6(i);a=e=d6.makeWithAncestors(e,{},r,n)??e,e=new G3(e,t,i.filter)}else if(B1(i))a=e=o6.makeFromTransform(e,i,t),o="number";else if(U1(i))o="date",void 0===n.getWithExplicit(i.field).value&&(e=new d6(e,{[i.field]:o}),n.set(i.field,o,!1)),a=e=$2.makeFromTransform(e,i);else if(q1(i))a=e=s6.makeFromTransform(e,i),o="number",U3(t)&&(e=new h6(e));else if(S1(i))a=e=L4.make(e,t,i,r++),o="derived";else if(T1(i))a=e=new z6(e,i),o="number";else if(z1(i))a=e=new F6(e,i),o="number";else if(W1(i))a=e=T6.makeFromTransform(e,i),o="derived";else if(Z1(i))a=e=new P4(e,i),o="derived";else if(H1(i))a=e=new $4(e,i),o="derived";else if(R1(i))a=e=new M4(e,i),o="derived";else if(A1(i))a=e=new U4(e,i),o="derived";else if(F1(i))e=new q4(e,i);else if(I1(i))a=e=z4.makeFromTransform(e,i),o="derived";else if($1(i))a=e=new A4(e,i),o="derived";else if(C1(i))a=e=new B4(e,i),o="derived";else if(M1(i))a=e=new I4(e,i),o="derived";else{if(!P1(i)){AX(sX(i));continue}a=e=new R4(e,i),o="derived"}if(a&&void 0!==o)for(const e of a.producedFields()??[])n.set(e,o,!1)}return e}(t,e,o));const s=function(e){const t={};if(O4(e)&&e.component.selection)for(const n of RH(e.component.selection)){const r=e.component.selection[n];for(const e of r.project.items)!e.channel&&QH(e.field)>1&&(t[e.field]="flatten")}return t}(e),l=f6(e);t=d6.makeWithAncestors(t,{},{...s,...l},o)??t,O4(e)&&(t=F4.parseAll(t,e),t=T4.parseAll(t,e)),(O4(e)||E4(e))&&(a||(t=o6.makeFromEncoding(t,e)??t),t=$2.makeFromEncoding(t,e)??t,t=l5.parseAllForSortIndex(t,e));const u=e.getDataName(x2.Raw),c=new N2(t,u,x2.Raw,r);if(n[u]=c,t=c,O4(e)){const n=s6.makeFromEncoding(t,e);n&&(t=n,U3(e)&&(t=new h6(t))),t=z4.makeFromEncoding(t,e)??t,t=T6.makeFromEncoding(t,e)??t}O4(e)&&(t=C4.make(t,e)??t);const f=e.getDataName(x2.Main),d=new N2(t,f,x2.Main,r);n[f]=d,t=d,O4(e)&&function(e,t){for(const[n,r]of BH(e.component.selection??{})){const i=e.getName(`lookup_${n}`);e.component.data.outputNodes[i]=r.materialized=new N2(new G3(t,e,{param:n}),i,x2.Lookup,e.component.data.outputNodeRefCounts)}}(e,d);let h=null;if(E4(e)){const r=e.getName("facet");t=function(e,t){const{row:n,column:r}=t;if(n&&r){let t=null;for(const i of[n,r])if(LQ(i.sort)){const{field:n,op:r=FQ}=i.sort;e=t=new F6(e,{joinaggregate:[{op:r,field:n,as:Q4(i,i.sort,{forAs:!0})}],groupby:[hK(i)]})}return t}return null}(t,e.facet)??t,h=new l6(t,e,r,d.getSource()),n[r]=h}return{...e.component.data,outputNodes:n,outputNodeRefCounts:r,raw:c,main:d,facetRoot:h,ancestorParse:o}}class n9 extends N4{constructor(e,t,n,r){super(e,"concat",t,n,r,e.resolve),"shared"!==e.resolve?.axis?.x&&"shared"!==e.resolve?.axis?.y||AX("Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415)."),this.children=this.getChildren(e).map(((e,t)=>D9(e,this,this.getName(`concat_${t}`),void 0,r)))}parseData(){this.component.data=t9(this);for(const e of this.children)e.parseData()}parseSelections(){this.component.selection={};for(const e of this.children){e.parseSelections();for(const t of RH(e.component.selection))this.component.selection[t]=e.component.selection[t]}}parseMarkGroup(){for(const e of this.children)e.parseMarkGroup()}parseAxesAndHeaders(){for(const e of this.children)e.parseAxesAndHeaders()}getChildren(e){return F0(e)?e.vconcat:T0(e)?e.hconcat:e.concat}parseLayoutSize(){!function(e){Y4(e);const t=1===e.layout.columns?"width":"childWidth",n=void 0===e.layout.columns?"height":"childHeight";X4(e,t),X4(e,n)}(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(e){return this.children.reduce(((e,t)=>t.assembleSelectionTopLevelSignals(e)),e)}assembleSignals(){return this.children.forEach((e=>e.assembleSignals())),[]}assembleLayoutSignals(){const e=E5(this);for(const t of this.children)e.push(...t.assembleLayoutSignals());return e}assembleSelectionData(e){return this.children.reduce(((e,t)=>t.assembleSelectionData(e)),e)}assembleMarks(){return this.children.map((e=>{const t=e.assembleTitle(),n=e.assembleGroupStyle(),r=e.assembleGroupEncodeEntry(!1);return{type:"group",name:e.getName("group"),...t?{title:t}:{},...n?{style:n}:{},...r?{encode:{update:r}}:{},...e.assembleGroup()}}))}assembleGroupStyle(){}assembleDefaultLayout(){const e=this.layout.columns;return{...null!=e?{columns:e}:{},bounds:"full",align:"each"}}}const r9={disable:1,gridScale:1,scale:1,...zK,labelExpr:1,encode:1},i9=RH(r9);class o9 extends a2{constructor(e,t,n){void 0===e&&(e={}),void 0===t&&(t={}),void 0===n&&(n=!1),super(),this.explicit=e,this.implicit=t,this.mainExtracted=n}clone(){return new o9(xH(this.explicit),xH(this.implicit),this.mainExtracted)}hasAxisPart(e){return"axis"===e||("grid"===e||"title"===e?!!this.get(e):!(!1===(t=this.get(e))||null===t));var t}hasOrientSignalRef(){return DY(this.explicit.orient)}}const a9={bottom:"top",top:"bottom",left:"right",right:"left"};function s9(e,t){if(!e)return t.map((e=>e.clone()));{if(e.length!==t.length)return;const n=e.length;for(let r=0;r<n;r++){const n=e[r],i=t[r];if(!!n!=!!i)return;if(n&&i){const t=n.getWithExplicit("orient"),o=i.getWithExplicit("orient");if(t.explicit&&o.explicit&&t.value!==o.value)return;e[r]=l9(n,i)}}}return e}function l9(e,t){for(const n of i9){const r=f2(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",((e,t)=>{switch(n){case"title":return VY(e,t);case"gridScale":return{explicit:e.explicit,value:KH(e.value,t.value)}}return c2(e,t,n,"axis")}));e.setWithExplicit(n,r)}return e}function u9(e,t,n,r,i){if("disable"===t)return void 0!==n;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(DY(n.labelAngle)?n.labelAngle:iG(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===s5(r,i))return!0}return e===n[t]}const c9=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function f9(e,t){let n=t.axis(e);const r=new o9,i=_K(t.encoding[e]),{mark:o,config:a}=t,s=n?.orient||a["x"===e?"axisX":"axisY"]?.orient||a.axis?.orient||function(e){return"x"===e?"bottom":"left"}(e),l=t.getScaleComponent(e).get("type"),u=function(e,t,n,r){const i="band"===t?["axisDiscrete","axisBand"]:"point"===t?["axisDiscrete","axisPoint"]:EJ(t)?["axisQuantitative"]:"time"===t||"utc"===t?["axisTemporal"]:[],o="x"===e?"axisX":"axisY",a=DY(n)?"axisOrient":`axis${ZH(n)}`,s=[...i,...i.map((e=>o+e.substr(4)))],l=["axis",a,o];return{vlOnlyAxisConfig:e5(s,r,e,n),vgAxisConfig:e5(l,r,e,n),axisConfigStyle:t5([...l,...s],r)}}(e,l,s,t.config),c=void 0!==n?!n:n5("disable",a.style,n?.style,u).configValue;if(r.set("disable",c,void 0!==n),c)return r;n=n||{};const f=function(e,t,n,r,i){const o=t?.labelAngle;if(void 0!==o)return DY(o)?o:iG(o);{const{configValue:o}=n5("labelAngle",r,t?.style,i);return void 0!==o?iG(o):n!==uG||!jH([gJ,pJ],e.type)||KQ(e)&&e.timeUnit?void 0:270}}(i,n,e,a.style,u),d=AQ(n.formatType,i,l),h=SQ(i,i.type,n.format,n.formatType,a,!0),p={fieldOrDatumDef:i,axis:n,channel:e,model:t,scaleType:l,orient:s,labelAngle:f,format:h,formatType:d,mark:o,config:a};for(const y of i9){const i=y in r5?r5[y](p):LK(y)?n[y]:void 0,o=void 0!==i,s=u9(i,y,n,t,e);if(o&&s)r.set(y,i,s);else{const{configValue:e,configFrom:t}=LK(y)&&"values"!==y?n5(y,a.style,n.style,u):{},l=void 0!==e;o&&!l?r.set(y,i,s):("vgAxisConfig"!==t||c9.has(y)&&l||PK(e)||DY(e))&&r.set(y,e,!1)}}const m=n.encoding??{},g=FK.reduce(((n,i)=>{if(!r.hasAxisPart(i))return n;const o=A5(m[i]??{},t),a="labels"===i?function(e,t,n){const{encoding:r,config:i}=e,o=_K(r[t])??_K(r[hV(t)]),a=e.axis(t)||{},{format:s,formatType:l}=a;if(_Q(l))return{text:NQ({fieldOrDatumDef:o,field:"datum.value",format:s,formatType:l,config:i}),...n};if(void 0===s&&void 0===l&&i.customFormatTypes){if("quantitative"===eK(o)){if(uK(o)&&"normalize"===o.stack&&i.normalizedNumberFormatType)return{text:NQ({fieldOrDatumDef:o,field:"datum.value",format:i.normalizedNumberFormat,formatType:i.normalizedNumberFormatType,config:i}),...n};if(i.numberFormatType)return{text:NQ({fieldOrDatumDef:o,field:"datum.value",format:i.numberFormat,formatType:i.numberFormatType,config:i}),...n}}if("temporal"===eK(o)&&i.timeFormatType&&KQ(o)&&!o.timeUnit)return{text:NQ({fieldOrDatumDef:o,field:"datum.value",format:i.timeFormat,formatType:i.timeFormatType,config:i}),...n}}return n}(t,e,o):o;return void 0===a||zH(a)||(n[i]={update:a}),n}),{});return zH(g)||r.set("encode",g,!!n.encoding||void 0!==n.labelAngle),r}function d9(e,t){const{config:n}=e;return{...g3(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...r3("x",e,{defaultPos:"mid"}),...r3("y",e,{defaultPos:"mid"}),...K2("size",e),...K2("angle",e),...h9(e,n,t)}}function h9(e,t,n){return n?{shape:{value:n}}:K2("shape",e)}const p9={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return e.encoding.x||e.encoding.y||e.encoding.latitude||e.encoding.longitude?{...g3(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...l3("x",e,{defaultPos:"horizontal"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"vertical"!==n}),...l3("y",e,{defaultPos:"vertical"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"horizontal"!==n}),...K2("size",e,{vgChannel:"strokeWidth"})}:{}}};function m9(e,t,n){if(void 0===IY("align",e,n))return"center"}function g9(e,t,n){if(void 0===IY("baseline",e,n))return"middle"}const y9={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,r=n.orient,i="horizontal"===r?"width":"height",o="horizontal"===r?"height":"width";return{...g3(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...r3("x",e,{defaultPos:"mid",vgChannel:"xc"}),...r3("y",e,{defaultPos:"mid",vgChannel:"yc"}),...K2("size",e,{defaultValue:v9(e),vgChannel:i}),[o]:FY(IY("thickness",n,t))}}};function v9(e){const{config:t,markDef:n}=e,{orient:r}=n,i="horizontal"===r?"width":"height",o=e.getScaleComponent("horizontal"===r?"x":"y"),a=IY("size",n,t,{vgChannel:i})??t.tick.bandSize;if(void 0!==a)return a;{const e=o?o.get("range"):void 0;if(e&&jY(e)&&ys(e.step))return 3*e.step/4;return 3*U0(t.view,i)/4}}const b9={arc:{vgMark:"arc",encodeEntry:e=>({...g3(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...r3("x",e,{defaultPos:"mid"}),...r3("y",e,{defaultPos:"mid"}),...f3(e,"radius"),...f3(e,"theta")})},area:{vgMark:"area",encodeEntry:e=>({...g3(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"}),...l3("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"horizontal"===e.markDef.orient}),...l3("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"vertical"===e.markDef.orient}),...b3(e)})},bar:{vgMark:"rect",encodeEntry:e=>({...g3(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...f3(e,"x"),...f3(e,"y")})},circle:{vgMark:"symbol",encodeEntry:e=>d9(e,"circle")},geoshape:{vgMark:"shape",encodeEntry:e=>({...g3(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})}),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[{type:"geoshape",projection:e.projectionName(),...n&&KQ(n)&&n.type===yJ?{field:hK(n,{expr:"datum"})}:{}}]}},image:{vgMark:"image",encodeEntry:e=>({...g3(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"}),...f3(e,"x"),...f3(e,"y"),...Z2(e,"url")})},line:{vgMark:"line",encodeEntry:e=>({...g3(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...r3("x",e,{defaultPos:"mid"}),...r3("y",e,{defaultPos:"mid"}),...K2("size",e,{vgChannel:"strokeWidth"}),...b3(e)})},point:{vgMark:"symbol",encodeEntry:e=>d9(e)},rect:{vgMark:"rect",encodeEntry:e=>({...g3(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...f3(e,"x"),...f3(e,"y")})},rule:p9,square:{vgMark:"symbol",encodeEntry:e=>d9(e,"square")},text:{vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return{...g3(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"}),...r3("x",e,{defaultPos:"mid"}),...r3("y",e,{defaultPos:"mid"}),...Z2(e),...K2("size",e,{vgChannel:"fontSize"}),...K2("angle",e),...x3("align",m9(e.markDef,n,t)),...x3("baseline",g9(e.markDef,n,t)),...r3("radius",e,{defaultPos:null}),...r3("theta",e,{defaultPos:null})}}},tick:y9,trail:{vgMark:"trail",encodeEntry:e=>({...g3(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...r3("x",e,{defaultPos:"mid"}),...r3("y",e,{defaultPos:"mid"}),...K2("size",e),...b3(e)})}};function x9(e){if(jH([YJ,HJ,tQ],e.mark)){const t=JK(e.mark,e.encoding);if(t.length>0)return function(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:w9+e.requestDataName(x2.Main),data:e.requestDataName(x2.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:_9(e,{fromPrefix:w9})}]}(e,t)}else if(e.mark===GJ){const t=$Y.some((t=>IY(t,e.markDef,e.config)));if(e.stack&&!e.fieldDef("size")&&t)return function(e){const[t]=_9(e,{fromPrefix:k9}),n=e.scaleName(e.stack.fieldChannel),r=function(t){return void 0===t&&(t={}),e.vgField(e.stack.fieldChannel,t)},i=(e,t)=>`${e}(${[r({prefix:"min",suffix:"start",expr:t}),r({prefix:"max",suffix:"start",expr:t}),r({prefix:"min",suffix:"end",expr:t}),r({prefix:"max",suffix:"end",expr:t})].map((e=>`scale('${n}',${e})`)).join(",")})`;let o,a;"x"===e.stack.fieldChannel?(o={...kH(t.encode.update,["y","yc","y2","height",...$Y]),x:{signal:i("min","datum")},x2:{signal:i("max","datum")},clip:{value:!0}},a={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},t.encode.update={..._H(t.encode.update,["y","yc","y2"]),height:{field:{group:"height"}}}):(o={...kH(t.encode.update,["x","xc","x2","width"]),y:{signal:i("min","datum")},y2:{signal:i("max","datum")},clip:{value:!0}},a={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},t.encode.update={..._H(t.encode.update,["x","xc","x2"]),width:{field:{group:"width"}}});for(const l of $Y){const n=UY(l,e.markDef,e.config);t.encode.update[l]?(o[l]=t.encode.update[l],delete t.encode.update[l]):n&&(o[l]=FY(n)),n&&(t.encode.update[l]={value:0})}const s=[];if(e.stack.groupbyChannels?.length>0)for(const l of e.stack.groupbyChannels){const t=e.fieldDef(l),n=hK(t);n&&s.push(n),(t?.bin||t?.timeUnit)&&s.push(hK(t,{binSuffix:"end"}))}o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce(((n,r)=>{if(t.encode.update[r])return{...n,[r]:t.encode.update[r]};{const t=UY(r,e.markDef,e.config);return void 0!==t?{...n,[r]:FY(t)}:n}}),o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0});return[{type:"group",from:{facet:{data:e.requestDataName(x2.Main),name:k9+e.requestDataName(x2.Main),groupby:s,aggregate:{fields:[r({suffix:"start"}),r({suffix:"start"}),r({suffix:"end"}),r({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:a},marks:[t]}]}]}(e)}return _9(e)}const w9="faceted_path_";const k9="stack_group_";function _9(e,t){void 0===t&&(t={fromPrefix:""});const{mark:n,markDef:r,encoding:i,config:o}=e,a=KH(r.clip,function(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return!(!t?.get("selectionExtent")&&!n?.get("selectionExtent"))||void 0}(e),function(e){const t=e.component.projection;return!(!t||t.isFit)||void 0}(e)),s=BY(r),l=i.key,u=function(e){const{encoding:t,stack:n,mark:r,markDef:i,config:o}=e,a=t.order;if(!(!ka(a)&&sK(a)&&DH(a.value)||!a&&DH(IY("order",i,o)))){if((ka(a)||KQ(a))&&!n)return ZY(a,{expr:"datum"});if(oQ(r)){const n="horizontal"===i.orient?"y":"x",r=t[n];if(KQ(r)){const t=r.sort;return ka(t)?{field:hK(r,{prefix:n,suffix:"sort_index",expr:"datum"})}:LQ(t)?{field:hK({aggregate:HK(e.encoding)?t.op:void 0,field:t.field},{expr:"datum"})}:RQ(t)?{field:hK(e.fieldDef(t.encoding),{expr:"datum"}),order:t.order}:null===t?void 0:{field:hK(r,{binSuffix:e.stack?.impute?"mid":void 0,expr:"datum"})}}}}}(e),c=function(e){if(!e.component.selection)return null;const t=RH(e.component.selection).length;let n=t,r=e.parent;for(;r&&0===n;)n=RH(r.component.selection).length,r=r.parent;return n?{interactive:t>0||"geoshape"===e.mark||!!e.encoding.tooltip}:null}(e),f=IY("aria",r,o),d=b9[n].postEncodingTransform?b9[n].postEncodingTransform(e):null;return[{name:e.getName("marks"),type:b9[n].vgMark,...a?{clip:!0}:{},...s?{style:s}:{},...l?{key:l.field}:{},...u?{sort:u}:{},...c||{},...!1===f?{aria:f}:{},from:{data:t.fromPrefix+e.requestDataName(x2.Main)},encode:{update:b9[n].encodeEntry(e)},...d?{transform:d}:{}}]}class O9 extends S4{constructor(e,t,n,r,i){void 0===r&&(r={}),super(e,"unit",t,n,i,void 0,L0(e)?e.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const o=lQ(e.mark)?{...e.mark}:{type:e.mark},a=o.type;void 0===o.filled&&(o.filled=function(e,t,n){let{graticule:r}=n;if(r)return!1;const i=UY("filled",e,t),o=e.type;return KH(i,o!==XJ&&o!==YJ&&o!==QJ)}(o,i,{graticule:e.data&&b2(e.data)}));const s=this.encoding=function(e,t,n,r){const i={};for(const a of RH(e))lV(a)||AX(`${o=a}-encoding is dropped as ${o} is not a valid encoding channel.`);var o;for(let a of vV){if(!e[a])continue;const o=e[a];if(UV(a)){const e=yV(a),t=i[e];if(KQ(t)){if(fJ(t.type)&&KQ(o)&&!t.timeUnit){AX(uX(e));continue}}else a=e,AX(cX(e))}if("angle"!==a||"arc"!==t||e.theta||(AX("Arc marks uses theta channel rather than angle, replacing angle with theta."),a=yG),VK(e,a,t)){if(a===jG&&"line"===t){const t=kK(e[a]);if(t?.aggregate){AX("Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.");continue}}if(a===_G&&(n?"fill"in e:"stroke"in e))AX(dX("encoding",{fill:"fill"in e,stroke:"stroke"in e}));else if(a===TG||a===FG&&!ka(o)&&!sK(o)||a===RG&&ka(o)){if(o){if(a===FG){const t=e[a];if(YQ(t)){i[a]=t;continue}}i[a]=Ga(o).reduce(((e,t)=>(KQ(t)?e.push(DK(t,a)):AX(hX(t,a)),e)),[])}}else{if(a===RG&&null===o)i[a]=null;else if(!(KQ(o)||tK(o)||sK(o)||XQ(o)||DY(o))){AX(hX(o,a));continue}i[a]=OK(o,a,r)}}else AX(pX(a,t))}return i}(e.encoding||{},a,o.filled,i);this.markDef=f1(o,s,i),this.size=function(e){let{encoding:t,size:n}=e;for(const r of TV){const e=pV(r);R0(n[e])&&nK(t[r])&&(delete n[e],AX(_X(e)))}return n}({encoding:s,size:L0(e)?{...r,...e.width?{width:e.width}:{},...e.height?{height:e.height}:{}}:r}),this.stack=c1(this.markDef,s),this.specifiedScales=this.initScales(a,s),this.specifiedAxes=this.initAxes(s),this.specifiedLegends=this.initLegends(s),this.specifiedProjection=e.projection,this.selection=(e.params??[]).filter((e=>C0(e)))}get hasProjection(){const{encoding:e}=this,t=this.mark===iQ,n=e&&GG.some((t=>oK(e[t])));return t||n}scaleDomain(e){const t=this.specifiedScales[e];return t?t.domain:void 0}axis(e){return this.specifiedAxes[e]}legend(e){return this.specifiedLegends[e]}initScales(e,t){return eY.reduce(((e,n)=>{const r=_K(t[n]);return r&&(e[n]=this.initScale(r.scale??{})),e}),{})}initScale(e){const{domain:t,range:n}=e,r=_Y(e);return ka(t)&&(r.domain=t.map(MY)),ka(n)&&(r.range=n.map(MY)),r}initAxes(e){return TV.reduce(((t,n)=>{const r=e[n];if(oK(r)||n===uG&&oK(e.x2)||n===cG&&oK(e.y2)){const e=oK(r)?r.axis:void 0;t[n]=e?this.initAxis({...e}):e}return t}),{})}initAxis(e){const t=RH(e),n={};for(const r of t){const t=e[r];n[r]=PK(t)?CY(t):MY(t)}return n}initLegends(e){return QV.reduce(((t,n)=>{const r=_K(e[n]);if(r&&function(e){switch(e){case _G:case OG:case EG:case jG:case DG:case SG:case CG:case MG:return!0;case AG:case $G:case NG:return!1}}(n)){const e=r.legend;t[n]=e?_Y(e):e}return t}),{})}parseData(){this.component.data=t9(this)}parseLayoutSize(){!function(e){const{size:t,component:n}=e;for(const r of TV){const i=pV(r);if(t[i]){const e=t[i];n.layoutSize.set(i,R0(e)?"step":e,!0)}else{const t=J4(e,i);n.layoutSize.set(i,t,!1)}}}(this)}parseSelections(){this.component.selection=function(e,t){const n={},r=e.config.selection;if(!t||!t.length)return n;for(const i of t){const t=UH(i.name),o=i.select,a=bs(o)?o:o.type,s=_a(o)?xH(o):{type:a},l=r[a];for(const e in l)"fields"!==e&&"encodings"!==e&&("mark"===e&&(s[e]={...l[e],...s[e]}),void 0!==s[e]&&!0!==s[e]||(s[e]=xH(l[e]??s[e])));const u=n[t]={...s,name:t,type:a,init:i.value,bind:i.bind,events:bs(s.on)?AI(s.on,"scope"):Ga(xH(s.on))},c=xH(i);for(const n of B3)n.defined(u)&&n.parse&&n.parse(e,u,c)}return n}(this,this.selection)}parseMarkGroup(){this.component.mark=x9(this)}parseAxesAndHeaders(){var e;this.component.axes=(e=this,TV.reduce(((t,n)=>(e.component.scales[n]&&(t[n]=[f9(n,e)]),t)),{}))}assembleSelectionTopLevelSignals(e){return function(e,t){let n=!1;for(const r of LH(e.component.selection??{})){const i=r.name,o=js(i+T3);if(0===t.filter((e=>e.name===i)).length){const e="global"===r.resolve?"union":r.resolve,n="point"===r.type?", true, true)":")";t.push({name:r.name,update:`${L3}(${o}, ${js(e)}${n}`})}n=!0;for(const n of B3)n.defined(r)&&n.topLevelSignals&&(t=n.topLevelSignals(e,r,t))}n&&0===t.filter((e=>"unit"===e.name)).length&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]});return D2(t)}(this,e)}assembleSignals(){return[...K3(this),..._2(this,[])]}assembleSelectionData(e){return function(e,t){const n=[...t],r=I3(e,{escape:!1});for(const i of LH(e.component.selection??{})){const e={name:i.name+T3};if(i.project.hasSelectionId&&(e.transform=[{type:"collect",sort:{field:N0}}]),i.init){const t=i.project.items.map(w2);e.values=i.project.hasSelectionId?i.init.map((e=>({unit:r,[N0]:k2(e,!1)[0]}))):i.init.map((e=>({unit:r,fields:t,values:k2(e,!1)})))}n.filter((e=>e.name===i.name+T3)).length||n.push(e)}return n}(this,e)}assembleLayout(){return null}assembleLayoutSignals(){return E5(this)}assembleMarks(){let e=this.component.mark??[];return this.parent&&j4(this.parent)||(e=E2(this,e)),e.map(this.correctDataNames)}assembleGroupStyle(){const{style:e}=this.view||{};return void 0!==e?e:this.encoding.x||this.encoding.y?"cell":"view"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(e){return qK(this.encoding,e)}fieldDef(e){return kK(this.encoding[e])}typedFieldDef(e){const t=this.fieldDef(e);return aK(t)?t:null}}class E9 extends N4{constructor(e,t,n,r,i){super(e,"layer",t,n,i,e.resolve,e.view);const o={...r,...e.width?{width:e.width}:{},...e.height?{height:e.height}:{}};this.children=e.layer.map(((e,t)=>{if(r1(e))return new E9(e,this,this.getName(`layer_${t}`),o,i);if(IK(e))return new O9(e,this,this.getName(`layer_${t}`),o,i);throw new Error(YY(e))}))}parseData(){this.component.data=t9(this);for(const e of this.children)e.parseData()}parseLayoutSize(){var e;Y4(e=this),X4(e,"width"),X4(e,"height")}parseSelections(){this.component.selection={};for(const e of this.children){e.parseSelections();for(const t of RH(e.component.selection))this.component.selection[t]=e.component.selection[t]}}parseMarkGroup(){for(const e of this.children)e.parseMarkGroup()}parseAxesAndHeaders(){!function(e){const{axes:t,resolve:n}=e.component,r={top:0,bottom:0,right:0,left:0};for(const i of e.children){i.parseAxesAndHeaders();for(const r of RH(i.component.axes))n.axis[r]=C5(e.component.resolve,r),"shared"===n.axis[r]&&(t[r]=s9(t[r],i.component.axes[r]),t[r]||(n.axis[r]="independent",delete t[r]))}for(const i of TV){for(const o of e.children)if(o.component.axes[i]){if("independent"===n.axis[i]){t[i]=(t[i]??[]).concat(o.component.axes[i]);for(const e of o.component.axes[i]){const{value:t,explicit:n}=e.getWithExplicit("orient");if(!DY(t)){if(r[t]>0&&!n){const n=a9[t];r[t]>r[n]&&e.set("orient",n,!1)}r[t]++}}}delete o.component.axes[i]}if("independent"===n.axis[i]&&t[i]&&t[i].length>1)for(const[e,n]of(t[i]||[]).entries())e>0&&n.get("grid")&&!n.explicit.grid&&(n.implicit.grid=!1)}}(this)}assembleSelectionTopLevelSignals(e){return this.children.reduce(((e,t)=>t.assembleSelectionTopLevelSignals(e)),e)}assembleSignals(){return this.children.reduce(((e,t)=>e.concat(t.assembleSignals())),K3(this))}assembleLayoutSignals(){return this.children.reduce(((e,t)=>e.concat(t.assembleLayoutSignals())),E5(this))}assembleSelectionData(e){return this.children.reduce(((e,t)=>t.assembleSelectionData(e)),e)}assembleGroupStyle(){const e=new Set;for(const n of this.children)for(const t of Ga(n.assembleGroupStyle()))e.add(t);const t=Array.from(e);return t.length>1?t:1===t.length?t[0]:void 0}assembleTitle(){let e=super.assembleTitle();if(e)return e;for(const t of this.children)if(e=t.assembleTitle(),e)return e}assembleLayout(){return null}assembleMarks(){return function(e,t){for(const n of e.children)O4(n)&&(t=E2(n,t));return t}(this,this.children.flatMap((e=>e.assembleMarks())))}assembleLegends(){return this.children.reduce(((e,t)=>e.concat(t.assembleLegends())),Y5(this))}}function D9(e,t,n,r,i){if(qQ(e))return new K4(e,t,n,i);if(r1(e))return new E9(e,t,n,r,i);if(IK(e))return new O9(e,t,n,r,i);if(function(e){return F0(e)||T0(e)||P0(e)}(e))return new n9(e,t,n,i);throw new Error(YY(e))}const j9=sH;var N9=Object.freeze({__proto__:null,accessPathDepth:QH,accessPathWithDatum:HH,compile:function(e,t){var n;void 0===t&&(t={}),t.logger&&(n=t.logger,SX=n),t.fieldTitle&&yK(t.fieldTitle);try{const n=J0(Ea(t.config,e.config)),r=K1(e,n),i=D9(r,null,"",void 0,n);i.parse(),function(e,t){U6(e.sources);let n=0,r=0;for(let i=0;i<I6&&W6(e,t,!0);i++)n++;e.sources.map(R6);for(let i=0;i<I6&&W6(e,t,!1);i++)r++;U6(e.sources),Math.max(n,r)===I6&&AX(`Maximum optimization runs(${I6}) reached.`)}(i.component.data,i);const o=function(e,t,n,r){void 0===n&&(n={});const i=e.config?t1(e.config):void 0,o=[].concat(e.assembleSelectionData([]),function(e,t){const n=[],r=W4(n);let i=0;for(const a of e.sources){a.hasName()||(a.dataName="source_"+i++);const e=a.assemble();r(a,e)}for(const a of n)0===a.transform.length&&delete a.transform;let o=0;for(const[a,s]of n.entries())0!==(s.transform??[]).length||s.source||n.splice(o++,0,n.splice(a,1)[0]);for(const a of n)for(const t of a.transform??[])"lookup"===t.type&&(t.from=e.outputNodes[t.from].getSource());for(const a of n)a.name in t&&(a.values=t[a.name]);return n}(e.component.data,n)),a=e.assembleProjections(),s=e.assembleTitle(),l=e.assembleGroupStyle(),u=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();c=c.filter((e=>"width"!==e.name&&"height"!==e.name||void 0===e.value||(t[e.name]=+e.value,!1)));const{params:f,...d}=t;return{$schema:"https://vega.github.io/schema/vega/v5.json",...e.description?{description:e.description}:{},...d,...s?{title:s}:{},...l?{style:l}:{},...u?{encode:{update:u}}:{},data:o,...a.length>0?{projections:a}:{},...e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([]),...M0(f)]),...i?{config:i}:{},...r?{usermeta:r}:{}}}(i,function(e,t,n,r){const i=r.component.layoutSize.get("width"),o=r.component.layoutSize.get("height");void 0===t?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):bs(t)&&(t={type:t});if(i&&o&&(a=t.type,"fit"===a||"fit-x"===a||"fit-y"===a))if("step"===i&&"step"===o)AX(KY()),t.type="pad";else if("step"===i||"step"===o){const e="step"===i?"width":"height";AX(KY(BV(e)));const n="width"===e?"height":"width";t.type=function(e){return e?`fit-${BV(e)}`:"fit"}(n)}var a;return{...1===RH(t).length&&t.type?"pad"===t.type?{}:{autosize:t.type}:{autosize:t},...o2(n,!1),...o2(e,!0)}}(e,r.autosize,n,i),e.datasets,e.usermeta);return{spec:o,normalized:r}}finally{t.logger&&(SX=NX),t.fieldTitle&&yK(mK)}},contains:jH,deepEqual:bH,deleteNestedProperty:WH,duplicate:xH,entries:BH,every:SH,fieldIntersection:TH,flatAccessWithDatum:GH,getFirstDefined:KH,hasIntersection:PH,hash:EH,internalField:nG,isBoolean:IH,isEmpty:zH,isEqual:function(e,t){const n=RH(e),r=RH(t);if(n.length!==r.length)return!1;for(const i of n)if(e[i]!==t[i])return!1;return!0},isInternalField:rG,isNullOrFalse:DH,isNumeric:oG,keys:RH,logicalExpr:qH,mergeDeep:AH,never:wH,normalize:K1,normalizeAngle:iG,omit:_H,pick:kH,prefixGenerator:FH,removePathFromField:JH,replaceAll:XH,replacePathInField:YH,resetIdCounter:function(){eG=42},setEqual:MH,some:NH,stringify:OH,titleCase:ZH,unique:CH,uniqueId:tG,vals:LH,varName:UH,version:j9});function S9(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var A9="2.14.0";const $9="#fff",C9="#888",M9={background:"#333",view:{stroke:C9},title:{color:$9,subtitleColor:$9},style:{"guide-label":{fill:$9},"guide-title":{fill:$9}},axis:{domainColor:$9,gridColor:C9,tickColor:$9}},P9="#4572a7",F9={background:"#fff",arc:{fill:P9},area:{fill:P9},line:{stroke:P9,strokeWidth:2},path:{stroke:P9},rect:{fill:P9},shape:{stroke:P9},symbol:{fill:P9,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},T9="#30a2da",z9="#cbcbcb",R9="#f0f0f0",L9="#333",B9={arc:{fill:T9},area:{fill:T9},axis:{domainColor:z9,grid:!0,gridColor:z9,gridWidth:1,labelColor:"#999",labelFontSize:10,titleColor:"#333",tickColor:z9,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:R9,group:{fill:R9},legend:{labelColor:L9,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:L9,titleFontSize:14,titlePadding:10},line:{stroke:T9,strokeWidth:2},path:{stroke:T9,strokeWidth:.5},rect:{fill:T9},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:T9},bar:{binSpacing:2,fill:T9,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},I9="#000",U9={group:{fill:"#e5e5e5"},arc:{fill:I9},area:{fill:I9},line:{stroke:I9},path:{stroke:I9},rect:{fill:I9},shape:{stroke:I9},symbol:{fill:I9,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},q9="Benton Gothic, sans-serif",W9="#82c6df",Z9="Benton Gothic Bold, sans-serif",H9="normal",G9={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},V9={background:"#ffffff",title:{anchor:"start",color:"#000000",font:Z9,fontSize:22,fontWeight:"normal"},arc:{fill:W9},area:{fill:W9},line:{stroke:W9,strokeWidth:2},path:{stroke:W9},rect:{fill:W9},shape:{stroke:W9},symbol:{fill:W9,size:30},axis:{labelFont:q9,labelFontSize:11.5,labelFontWeight:"normal",titleFont:Z9,titleFontSize:13,titleFontWeight:H9},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:q9,labelFontSize:11.5,symbolType:"square",titleFont:Z9,titleFontSize:13,titleFontWeight:H9},range:{category:G9["category-6"],diverging:G9["fireandice-6"],heatmap:G9["fire-7"],ordinal:G9["fire-7"],ramp:G9["fire-7"]}},Y9="#ab5787",X9="#979797",J9={background:"#f9f9f9",arc:{fill:Y9},area:{fill:Y9},line:{stroke:Y9},path:{stroke:Y9},rect:{fill:Y9},shape:{stroke:Y9},symbol:{fill:Y9,size:30},axis:{domainColor:X9,domainWidth:.5,gridWidth:.2,labelColor:X9,tickColor:X9,tickWidth:.2,titleColor:X9},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},Q9="#3e5c69",K9={background:"#fff",arc:{fill:Q9},area:{fill:Q9},line:{stroke:Q9},path:{stroke:Q9},rect:{fill:Q9},shape:{stroke:Q9},symbol:{fill:Q9},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},e8="#1696d2",t8="#000000",n8="Lato",r8="Lato",i8={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},o8={background:"#FFFFFF",title:{anchor:"start",fontSize:18,font:n8},axisX:{domain:!0,domainColor:t8,domainWidth:1,grid:!1,labelFontSize:12,labelFont:r8,labelAngle:0,tickColor:t8,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:n8},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:"#DEDDDD",gridWidth:1,labelFontSize:12,labelFont:r8,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:n8,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:r8,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:n8,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:i8["six-groups-cat-1"],diverging:i8["diverging-colors"],heatmap:i8["diverging-colors"],ordinal:i8["six-groups-seq"],ramp:i8["shades-blue"]},area:{fill:e8},rect:{fill:e8},line:{color:e8,stroke:e8,strokeWidth:5},trail:{color:e8,stroke:e8,strokeWidth:0,size:1},path:{stroke:e8,strokeWidth:.5},point:{filled:!0},text:{font:"Lato",color:e8,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:e8,stroke:null}},arc:{fill:e8},shape:{stroke:e8},symbol:{fill:e8,size:30}},a8="#3366CC",s8="#ccc",l8="Arial, sans-serif",u8={arc:{fill:a8},area:{fill:a8},path:{stroke:a8},rect:{fill:a8},shape:{stroke:a8},symbol:{stroke:a8},circle:{fill:a8},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:l8,fontSize:12},"guide-title":{font:l8,fontSize:12},"group-title":{font:l8,fontSize:12}},title:{font:l8,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:s8,tickColor:s8,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},c8=e=>e*(1/3+1),f8=c8(9),d8=c8(10),h8=c8(12),p8="Segoe UI",m8="wf_standard-font, helvetica, arial, sans-serif",g8="#252423",y8="#605E5C",v8="transparent",b8="#118DFF",x8="#DEEFFF",w8=[x8,b8],k8={view:{stroke:v8},background:v8,font:p8,header:{titleFont:m8,titleFontSize:h8,titleColor:g8,labelFont:p8,labelFontSize:d8,labelColor:y8},axis:{ticks:!1,grid:!1,domain:!1,labelColor:y8,labelFontSize:f8,titleFont:m8,titleColor:g8,titleFontSize:h8,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:"#C8C6C4",gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:b8},line:{stroke:b8,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:p8,fontSize:f8,fill:y8},arc:{fill:b8},area:{fill:b8,line:!0,opacity:.6},path:{stroke:b8},rect:{fill:b8},point:{fill:b8,filled:!0,size:75},shape:{stroke:b8},symbol:{fill:b8,strokeWidth:1.5,size:50},legend:{titleFont:p8,titleFontWeight:"bold",titleColor:y8,labelFont:p8,labelFontSize:d8,labelColor:y8,symbolType:"circle",symbolSize:75},range:{category:[b8,"#12239E","#E66C37","#6B007B","#E044A7","#744EC2","#D9B300","#D64550"],diverging:w8,heatmap:w8,ordinal:[x8,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",b8]}},_8='IBM Plex Sans,system-ui,-apple-system,BlinkMacSystemFont,".sfnstext-regular",sans-serif',O8=["#8a3ffc","#33b1ff","#007d79","#ff7eb6","#fa4d56","#fff1f1","#6fdc8c","#4589ff","#d12771","#d2a106","#08bdba","#bae6ff","#ba4e00","#d4bbff"],E8=["#6929c4","#1192e8","#005d5d","#9f1853","#fa4d56","#570408","#198038","#002d9c","#ee538b","#b28600","#009d9a","#012749","#8a3800","#a56eff"];function D8(e){let{type:t,background:n}=e;const r="dark"===t?"#161616":"#ffffff",i="dark"===t?"#f4f4f4":"#161616",o="dark"===t?"#d4bbff":"#6929c4";return{background:n,arc:{fill:o},area:{fill:o},path:{stroke:o},rect:{fill:o},shape:{stroke:o},symbol:{stroke:o},circle:{fill:o},view:{fill:r,stroke:r},group:{fill:r},title:{color:i,anchor:"start",dy:-15,fontSize:16,font:_8,fontWeight:600},axis:{labelColor:i,labelFontSize:12,grid:!0,gridColor:"#525252",titleColor:i,labelAngle:0},style:{"guide-label":{font:_8,fill:i,fontWeight:400},"guide-title":{font:_8,fill:i,fontWeight:400}},range:{category:"dark"===t?O8:E8,diverging:["#750e13","#a2191f","#da1e28","#fa4d56","#ff8389","#ffb3b8","#ffd7d9","#fff1f1","#e5f6ff","#bae6ff","#82cfff","#33b1ff","#1192e8","#0072c3","#00539a","#003a6d"],heatmap:["#f6f2ff","#e8daff","#d4bbff","#be95ff","#a56eff","#8a3ffc","#6929c4","#491d8b","#31135e","#1c0f30"]}}}const j8=D8({type:"light",background:"#ffffff"}),N8=D8({type:"light",background:"#f4f4f4"}),S8=D8({type:"dark",background:"#262626"}),A8=D8({type:"dark",background:"#161616"}),$8=A9;var C8=Object.freeze({__proto__:null,carbong10:N8,carbong100:A8,carbong90:S8,carbonwhite:j8,dark:M9,excel:F9,fivethirtyeight:B9,ggplot2:U9,googlecharts:u8,latimes:V9,powerbi:k8,quartz:J9,urbaninstitute:o8,version:$8,vox:K9});function M8(e){return M8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M8(e)}function P8(e){var t=function(e,t){if("object"!==M8(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==M8(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===M8(t)?t:String(t)}function F8(e,t,n){return(t=P8(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T8(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const z8=["title","image"];function R8(e,t){return JSON.stringify(e,function(e){const t=[];return function(n,r){if("object"!=typeof r||null===r)return r;const i=t.indexOf(this)+1;return t.length=i,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}(t))}var L8="#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black;\n}\n#vg-tooltip-element.visible {\n  visibility: visible;\n}\n#vg-tooltip-element h2 {\n  margin-top: 0;\n  margin-bottom: 10px;\n  font-size: 13px;\n}\n#vg-tooltip-element table {\n  border-spacing: 0;\n}\n#vg-tooltip-element table tr {\n  border: none;\n}\n#vg-tooltip-element table tr td {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-top: 2px;\n  padding-bottom: 2px;\n}\n#vg-tooltip-element table tr td.key {\n  color: #808080;\n  max-width: 150px;\n  text-align: right;\n  padding-right: 4px;\n}\n#vg-tooltip-element table tr td.value {\n  display: block;\n  max-width: 300px;\n  max-height: 7em;\n  text-align: left;\n}\n#vg-tooltip-element.dark-theme {\n  background-color: rgba(32, 32, 32, 0.9);\n  border: 1px solid #f5f5f5;\n  color: white;\n}\n#vg-tooltip-element.dark-theme td.key {\n  color: #bfbfbf;\n}\n";const B8="vg-tooltip-element",I8={offsetX:10,offsetY:10,id:B8,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")},maxDepth:2,formatTooltip:function(e,t,n){if(ka(e))return`[${e.map((e=>t(bs(e)?e:R8(e,n)))).join(", ")}]`;if(_a(e)){let r="";const i=e,{title:o,image:a}=i,s=T8(i,z8);o&&(r+=`<h2>${t(o)}</h2>`),a&&(r+=`<img src="${t(a)}">`);const l=Object.keys(s);if(l.length>0){r+="<table>";for(const e of l){let i=s[e];void 0!==i&&(_a(i)&&(i=R8(i,n)),r+=`<tr><td class="key">${t(e)}:</td><td class="value">${t(i)}</td></tr>`)}r+="</table>"}return r||"{}"}return t(e)}};function U8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q8(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U8(Object(n),!0).forEach((function(t){F8(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U8(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class W8{constructor(e){this.options=q8(q8({},I8),e);const t=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const e=document.createElement("style");e.setAttribute("id",this.options.styleId),e.innerHTML=function(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return L8.toString().replace(B8,e)}(t);const n=document.head;n.childNodes.length>0?n.insertBefore(e,n.childNodes[0]):n.appendChild(e)}}tooltipHandler(e,t,n,r){if(this.el=document.getElementById(this.options.id),!this.el){this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip");(document.fullscreenElement??document.body).appendChild(this.el)}if(null==r||""===r)return void this.el.classList.remove("visible",`${this.options.theme}-theme`);this.el.innerHTML=this.options.formatTooltip(r,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:i,y:o}=function(e,t,n,r){let i=e.clientX+n;i+t.width>window.innerWidth&&(i=+e.clientX-n-t.width);let o=e.clientY+r;return o+t.height>window.innerHeight&&(o=+e.clientY-r-t.height),{x:i,y:o}}(t,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.style.top=`${o}px`,this.el.style.left=`${i}px`}}function Z8(e){return Z8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Z8(e)}function H8(e){var t=function(e,t){if("object"!==Z8(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Z8(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Z8(t)?t:String(t)}function G8(e,t,n){return(t=H8(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function V8(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Y8,X8;var J8=Q8;function Q8(e){var t=this;if(t instanceof Q8||(t=new Q8),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var n=0,r=arguments.length;n<r;n++)t.push(arguments[n]);return t}function K8(e,t,n){var r=t===e.head?new n7(n,null,t,e):new n7(n,t,t.next,e);return null===r.next&&(e.tail=r),null===r.prev&&(e.head=r),e.length++,r}function e7(e,t){e.tail=new n7(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function t7(e,t){e.head=new n7(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function n7(e,t,n,r){if(!(this instanceof n7))return new n7(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}Q8.Node=n7,Q8.create=Q8,Q8.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},Q8.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},Q8.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},Q8.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)e7(this,arguments[e]);return this.length},Q8.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)t7(this,arguments[e]);return this.length},Q8.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},Q8.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},Q8.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;null!==n;r++)e.call(t,n.value,r,this),n=n.next},Q8.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;null!==n;r--)e.call(t,n.value,r,this),n=n.prev},Q8.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},Q8.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},Q8.prototype.map=function(e,t){t=t||this;for(var n=new Q8,r=this.head;null!==r;)n.push(e.call(t,r.value,this)),r=r.next;return n},Q8.prototype.mapReverse=function(e,t){t=t||this;for(var n=new Q8,r=this.tail;null!==r;)n.push(e.call(t,r.value,this)),r=r.prev;return n},Q8.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var i=0;null!==r;i++)n=e(n,r.value,i),r=r.next;return n},Q8.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var i=this.length-1;null!==r;i--)n=e(n,r.value,i),r=r.prev;return n},Q8.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},Q8.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},Q8.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new Q8;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=0,i=this.head;null!==i&&r<e;r++)i=i.next;for(;null!==i&&r<t;r++,i=i.next)n.push(i.value);return n},Q8.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new Q8;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=this.length,i=this.tail;null!==i&&r>t;r--)i=i.prev;for(;null!==i&&r>e;r--,i=i.prev)n.push(i.value);return n},Q8.prototype.splice=function(e,t){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,r=this.head;null!==r&&n<e;n++)r=r.next;var i=[];for(n=0;r&&n<t;n++)i.push(r.value),r=this.removeNode(r);null===r&&(r=this.tail),r!==this.head&&r!==this.tail&&(r=r.prev);for(n=0;n<(arguments.length<=2?0:arguments.length-2);n++)r=K8(this,r,n+2<2||arguments.length<=n+2?void 0:arguments[n+2]);return i},Q8.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};try{(X8||(X8=1,Y8=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}),Y8)(Q8)}catch(Zee){}const r7=J8,i7=Symbol("max"),o7=Symbol("length"),a7=Symbol("lengthCalculator"),s7=Symbol("allowStale"),l7=Symbol("maxAge"),u7=Symbol("dispose"),c7=Symbol("noDisposeOnSet"),f7=Symbol("lruList"),d7=Symbol("cache"),h7=Symbol("updateAgeOnGet"),p7=()=>1;const m7=(e,t,n)=>{const r=e[d7].get(t);if(r){const t=r.value;if(g7(e,t)){if(v7(e,r),!e[s7])return}else n&&(e[h7]&&(r.value.now=Date.now()),e[f7].unshiftNode(r));return t.value}},g7=(e,t)=>{if(!t||!t.maxAge&&!e[l7])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[l7]&&n>e[l7]},y7=e=>{if(e[o7]>e[i7])for(let t=e[f7].tail;e[o7]>e[i7]&&null!==t;){const n=t.prev;v7(e,t),t=n}},v7=(e,t)=>{if(t){const n=t.value;e[u7]&&e[u7](n.key,n.value),e[o7]-=n.length,e[d7].delete(n.key),e[f7].removeNode(t)}};class b7{constructor(e,t,n,r,i){this.key=e,this.value=t,this.length=n,this.now=r,this.maxAge=i||0}}const x7=(e,t,n,r)=>{let i=n.value;g7(e,i)&&(v7(e,n),e[s7]||(i=void 0)),i&&t.call(r,i.value,i.key,e)};var w7=class{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[i7]=e.max||1/0;const t=e.length||p7;if(this[a7]="function"!=typeof t?p7:t,this[s7]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[l7]=e.maxAge||0,this[u7]=e.dispose,this[c7]=e.noDisposeOnSet||!1,this[h7]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[i7]=e||1/0,y7(this)}get max(){return this[i7]}set allowStale(e){this[s7]=!!e}get allowStale(){return this[s7]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[l7]=e,y7(this)}get maxAge(){return this[l7]}set lengthCalculator(e){"function"!=typeof e&&(e=p7),e!==this[a7]&&(this[a7]=e,this[o7]=0,this[f7].forEach((e=>{e.length=this[a7](e.value,e.key),this[o7]+=e.length}))),y7(this)}get lengthCalculator(){return this[a7]}get length(){return this[o7]}get itemCount(){return this[f7].length}rforEach(e,t){t=t||this;for(let n=this[f7].tail;null!==n;){const r=n.prev;x7(this,e,n,t),n=r}}forEach(e,t){t=t||this;for(let n=this[f7].head;null!==n;){const r=n.next;x7(this,e,n,t),n=r}}keys(){return this[f7].toArray().map((e=>e.key))}values(){return this[f7].toArray().map((e=>e.value))}reset(){this[u7]&&this[f7]&&this[f7].length&&this[f7].forEach((e=>this[u7](e.key,e.value))),this[d7]=new Map,this[f7]=new r7,this[o7]=0}dump(){return this[f7].map((e=>!g7(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)})).toArray().filter((e=>e))}dumpLru(){return this[f7]}set(e,t,n){if((n=n||this[l7])&&"number"!=typeof n)throw new TypeError("maxAge must be a number");const r=n?Date.now():0,i=this[a7](t,e);if(this[d7].has(e)){if(i>this[i7])return v7(this,this[d7].get(e)),!1;const o=this[d7].get(e).value;return this[u7]&&(this[c7]||this[u7](e,o.value)),o.now=r,o.maxAge=n,o.value=t,this[o7]+=i-o.length,o.length=i,this.get(e),y7(this),!0}const o=new b7(e,t,i,r,n);return o.length>this[i7]?(this[u7]&&this[u7](e,t),!1):(this[o7]+=o.length,this[f7].unshift(o),this[d7].set(e,this[f7].head),y7(this),!0)}has(e){if(!this[d7].has(e))return!1;const t=this[d7].get(e).value;return!g7(this,t)}get(e){return m7(this,e,!0)}peek(e){return m7(this,e,!1)}pop(){const e=this[f7].tail;return e?(v7(this,e),e.value):null}del(e){v7(this,this[d7].get(e))}load(e){this.reset();const t=Date.now();for(let n=e.length-1;n>=0;n--){const r=e[n],i=r.e||0;if(0===i)this.set(r.k,r.v);else{const e=i-t;e>0&&this.set(r.k,r.v,e)}}}prune(){this[d7].forEach(((e,t)=>m7(this,t,!1)))}};const k7=Object.freeze({loose:!0}),_7=Object.freeze({});var O7=e=>e?"object"!=typeof e?k7:e:_7,E7={exports:{}};var D7={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2};var j7="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return console.error("SEMVER",...t)}:()=>{};!function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:i}=D7,o=j7,a=(t=e.exports={}).re=[],s=t.safeRe=[],l=t.src=[],u=t.t={};let c=0;const f="[a-zA-Z0-9-]",d=[["\\s",1],["\\d",i],[f,r]],h=(e,t,n)=>{const r=(e=>{for(const[t,n]of d)e=e.split(`${t}*`).join(`${t}{0,${n}}`).split(`${t}+`).join(`${t}{1,${n}}`);return e})(t),i=c++;o(e,i,t),u[e]=i,l[i]=t,a[i]=new RegExp(t,n?"g":void 0),s[i]=new RegExp(r,n?"g":void 0)};h("NUMERICIDENTIFIER","0|[1-9]\\d*"),h("NUMERICIDENTIFIERLOOSE","\\d+"),h("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${f}*`),h("MAINVERSION",`(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})`),h("MAINVERSIONLOOSE",`(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})`),h("PRERELEASEIDENTIFIER",`(?:${l[u.NUMERICIDENTIFIER]}|${l[u.NONNUMERICIDENTIFIER]})`),h("PRERELEASEIDENTIFIERLOOSE",`(?:${l[u.NUMERICIDENTIFIERLOOSE]}|${l[u.NONNUMERICIDENTIFIER]})`),h("PRERELEASE",`(?:-(${l[u.PRERELEASEIDENTIFIER]}(?:\\.${l[u.PRERELEASEIDENTIFIER]})*))`),h("PRERELEASELOOSE",`(?:-?(${l[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[u.PRERELEASEIDENTIFIERLOOSE]})*))`),h("BUILDIDENTIFIER",`${f}+`),h("BUILD",`(?:\\+(${l[u.BUILDIDENTIFIER]}(?:\\.${l[u.BUILDIDENTIFIER]})*))`),h("FULLPLAIN",`v?${l[u.MAINVERSION]}${l[u.PRERELEASE]}?${l[u.BUILD]}?`),h("FULL",`^${l[u.FULLPLAIN]}$`),h("LOOSEPLAIN",`[v=\\s]*${l[u.MAINVERSIONLOOSE]}${l[u.PRERELEASELOOSE]}?${l[u.BUILD]}?`),h("LOOSE",`^${l[u.LOOSEPLAIN]}$`),h("GTLT","((?:<|>)?=?)"),h("XRANGEIDENTIFIERLOOSE",`${l[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),h("XRANGEIDENTIFIER",`${l[u.NUMERICIDENTIFIER]}|x|X|\\*`),h("XRANGEPLAIN",`[v=\\s]*(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:${l[u.PRERELEASE]})?${l[u.BUILD]}?)?)?`),h("XRANGEPLAINLOOSE",`[v=\\s]*(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:${l[u.PRERELEASELOOSE]})?${l[u.BUILD]}?)?)?`),h("XRANGE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAIN]}$`),h("XRANGELOOSE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAINLOOSE]}$`),h("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),h("COERCERTL",l[u.COERCE],!0),h("LONETILDE","(?:~>?)"),h("TILDETRIM",`(\\s*)${l[u.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",h("TILDE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAIN]}$`),h("TILDELOOSE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAINLOOSE]}$`),h("LONECARET","(?:\\^)"),h("CARETTRIM",`(\\s*)${l[u.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",h("CARET",`^${l[u.LONECARET]}${l[u.XRANGEPLAIN]}$`),h("CARETLOOSE",`^${l[u.LONECARET]}${l[u.XRANGEPLAINLOOSE]}$`),h("COMPARATORLOOSE",`^${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]})$|^$`),h("COMPARATOR",`^${l[u.GTLT]}\\s*(${l[u.FULLPLAIN]})$|^$`),h("COMPARATORTRIM",`(\\s*)${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]}|${l[u.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",h("HYPHENRANGE",`^\\s*(${l[u.XRANGEPLAIN]})\\s+-\\s+(${l[u.XRANGEPLAIN]})\\s*$`),h("HYPHENRANGELOOSE",`^\\s*(${l[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[u.XRANGEPLAINLOOSE]})\\s*$`),h("STAR","(<|>)?=?\\s*\\*"),h("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),h("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(E7,E7.exports);var N7=E7.exports;const S7=/^[0-9]+$/,A7=(e,t)=>{const n=S7.test(e),r=S7.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1};var $7={compareIdentifiers:A7,rcompareIdentifiers:(e,t)=>A7(t,e)};const C7=j7,{MAX_LENGTH:M7,MAX_SAFE_INTEGER:P7}=D7,{safeRe:F7,t:T7}=N7,z7=O7,{compareIdentifiers:R7}=$7;var L7=class e{constructor(t,n){if(n=z7(n),t instanceof e){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if("string"!=typeof t)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>M7)throw new TypeError(`version is longer than ${M7} characters`);C7("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const r=t.trim().match(n.loose?F7[T7.LOOSE]:F7[T7.FULL]);if(!r)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>P7||this.major<0)throw new TypeError("Invalid major version");if(this.minor>P7||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>P7||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<P7)return t}return e})):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(C7("SemVer.compare",this.version,this.options,t),!(t instanceof e)){if("string"==typeof t&&t===this.version)return 0;t=new e(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof e||(t=new e(t,this.options)),R7(this.major,t.major)||R7(this.minor,t.minor)||R7(this.patch,t.patch)}comparePre(t){if(t instanceof e||(t=new e(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{const e=this.prerelease[n],r=t.prerelease[n];if(C7("prerelease compare",n,e,r),void 0===e&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===e)return-1;if(e!==r)return R7(e,r)}while(++n)}compareBuild(t){t instanceof e||(t=new e(t,this.options));let n=0;do{const e=this.build[n],r=t.build[n];if(C7("prerelease compare",n,e,r),void 0===e&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===e)return-1;if(e!==r)return R7(e,r)}while(++n)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(n)?1:0;if(!t&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let r=this.prerelease.length;for(;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);if(-1===r){if(t===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let r=[t,e];!1===n&&(r=[t]),0===R7(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=r):this.prerelease=r}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};const B7=L7;var I7=(e,t,n)=>new B7(e,n).compare(new B7(t,n));const U7=I7;var q7=(e,t,n)=>0===U7(e,t,n);const W7=I7;var Z7=(e,t,n)=>0!==W7(e,t,n);const H7=I7;var G7=(e,t,n)=>H7(e,t,n)>0;const V7=I7;var Y7=(e,t,n)=>V7(e,t,n)>=0;const X7=I7;var J7=(e,t,n)=>X7(e,t,n)<0;const Q7=I7;var K7=(e,t,n)=>Q7(e,t,n)<=0;const eee=q7,tee=Z7,nee=G7,ree=Y7,iee=J7,oee=K7;var aee,see,lee,uee,cee=(e,t,n,r)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e===n;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return eee(e,n,r);case"!=":return tee(e,n,r);case">":return nee(e,n,r);case">=":return ree(e,n,r);case"<":return iee(e,n,r);case"<=":return oee(e,n,r);default:throw new TypeError(`Invalid operator: ${t}`)}};function fee(){if(uee)return lee;uee=1;class e{constructor(t,i){if(i=n(i),t instanceof e)return t.loose===!!i.loose&&t.includePrerelease===!!i.includePrerelease?t:new e(t.raw,i);if(t instanceof r)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=i,this.loose=!!i.loose,this.includePrerelease=!!i.includePrerelease,this.raw=t.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!h(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const t of this.set)if(1===t.length&&p(t[0])){this.set=[t];break}}this.format()}format(){return this.range=this.set.map((e=>e.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(e){const n=((this.options.includePrerelease&&f)|(this.options.loose&&d))+":"+e,o=t.get(n);if(o)return o;const p=this.options.loose,m=p?a[s.HYPHENRANGELOOSE]:a[s.HYPHENRANGE];e=e.replace(m,D(this.options.includePrerelease)),i("hyphen replace",e),e=e.replace(a[s.COMPARATORTRIM],l),i("comparator trim",e),e=e.replace(a[s.TILDETRIM],u),i("tilde trim",e),e=e.replace(a[s.CARETTRIM],c),i("caret trim",e);let y=e.split(" ").map((e=>g(e,this.options))).join(" ").split(/\s+/).map((e=>E(e,this.options)));p&&(y=y.filter((e=>(i("loose invalid filter",e,this.options),!!e.match(a[s.COMPARATORLOOSE]))))),i("range list",y);const v=new Map,b=y.map((e=>new r(e,this.options)));for(const t of b){if(h(t))return[t];v.set(t.value,t)}v.size>1&&v.has("")&&v.delete("");const x=[...v.values()];return t.set(n,x),x}intersects(t,n){if(!(t instanceof e))throw new TypeError("a Range is required");return this.set.some((e=>m(e,n)&&t.set.some((t=>m(t,n)&&e.every((e=>t.every((t=>e.intersects(t,n)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new o(e,this.options)}catch(Zee){return!1}for(let t=0;t<this.set.length;t++)if(j(this.set[t],e,this.options))return!0;return!1}}lee=e;const t=new w7({max:1e3}),n=O7,r=function(){if(see)return aee;see=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(r,i){if(i=n(i),r instanceof t){if(r.loose===!!i.loose)return r;r=r.value}r=r.trim().split(/\s+/).join(" "),a("comparator",r,i),this.options=i,this.loose=!!i.loose,this.parse(r),this.semver===e?this.value="":this.value=this.operator+this.semver.version,a("comp",this)}parse(t){const n=this.options.loose?r[i.COMPARATORLOOSE]:r[i.COMPARATOR],o=t.match(n);if(!o)throw new TypeError(`Invalid comparator: ${t}`);this.operator=void 0!==o[1]?o[1]:"","="===this.operator&&(this.operator=""),o[2]?this.semver=new s(o[2],this.options.loose):this.semver=e}toString(){return this.value}test(t){if(a("Comparator.test",t,this.options.loose),this.semver===e||t===e)return!0;if("string"==typeof t)try{t=new s(t,this.options)}catch(Zee){return!1}return o(t,this.operator,this.semver,this.options)}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new l(e.value,r).test(this.value):""===e.operator?""===e.value||new l(this.value,r).test(e.semver):!((r=n(r)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===e.value)||!r.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))||(!this.operator.startsWith(">")||!e.operator.startsWith(">"))&&(!this.operator.startsWith("<")||!e.operator.startsWith("<"))&&(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))&&!(o(this.semver,"<",e.semver,r)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))&&!(o(this.semver,">",e.semver,r)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}}aee=t;const n=O7,{safeRe:r,t:i}=N7,o=cee,a=j7,s=L7,l=fee();return aee}(),i=j7,o=L7,{safeRe:a,t:s,comparatorTrimReplace:l,tildeTrimReplace:u,caretTrimReplace:c}=N7,{FLAG_INCLUDE_PRERELEASE:f,FLAG_LOOSE:d}=D7,h=e=>"<0.0.0-0"===e.value,p=e=>""===e.value,m=(e,t)=>{let n=!0;const r=e.slice();let i=r.pop();for(;n&&r.length;)n=r.every((e=>i.intersects(e,t))),i=r.pop();return n},g=(e,t)=>(i("comp",e,t),e=x(e,t),i("caret",e),e=v(e,t),i("tildes",e),e=k(e,t),i("xrange",e),e=O(e,t),i("stars",e),e),y=e=>!e||"x"===e.toLowerCase()||"*"===e,v=(e,t)=>e.trim().split(/\s+/).map((e=>b(e,t))).join(" "),b=(e,t)=>{const n=t.loose?a[s.TILDELOOSE]:a[s.TILDE];return e.replace(n,((t,n,r,o,a)=>{let s;return i("tilde",e,t,n,r,o,a),y(n)?s="":y(r)?s=`>=${n}.0.0 <${+n+1}.0.0-0`:y(o)?s=`>=${n}.${r}.0 <${n}.${+r+1}.0-0`:a?(i("replaceTilde pr",a),s=`>=${n}.${r}.${o}-${a} <${n}.${+r+1}.0-0`):s=`>=${n}.${r}.${o} <${n}.${+r+1}.0-0`,i("tilde return",s),s}))},x=(e,t)=>e.trim().split(/\s+/).map((e=>w(e,t))).join(" "),w=(e,t)=>{i("caret",e,t);const n=t.loose?a[s.CARETLOOSE]:a[s.CARET],r=t.includePrerelease?"-0":"";return e.replace(n,((t,n,o,a,s)=>{let l;return i("caret",e,t,n,o,a,s),y(n)?l="":y(o)?l=`>=${n}.0.0${r} <${+n+1}.0.0-0`:y(a)?l="0"===n?`>=${n}.${o}.0${r} <${n}.${+o+1}.0-0`:`>=${n}.${o}.0${r} <${+n+1}.0.0-0`:s?(i("replaceCaret pr",s),l="0"===n?"0"===o?`>=${n}.${o}.${a}-${s} <${n}.${o}.${+a+1}-0`:`>=${n}.${o}.${a}-${s} <${n}.${+o+1}.0-0`:`>=${n}.${o}.${a}-${s} <${+n+1}.0.0-0`):(i("no pr"),l="0"===n?"0"===o?`>=${n}.${o}.${a}${r} <${n}.${o}.${+a+1}-0`:`>=${n}.${o}.${a}${r} <${n}.${+o+1}.0-0`:`>=${n}.${o}.${a} <${+n+1}.0.0-0`),i("caret return",l),l}))},k=(e,t)=>(i("replaceXRanges",e,t),e.split(/\s+/).map((e=>_(e,t))).join(" ")),_=(e,t)=>{e=e.trim();const n=t.loose?a[s.XRANGELOOSE]:a[s.XRANGE];return e.replace(n,((n,r,o,a,s,l)=>{i("xRange",e,n,r,o,a,s,l);const u=y(o),c=u||y(a),f=c||y(s),d=f;return"="===r&&d&&(r=""),l=t.includePrerelease?"-0":"",u?n=">"===r||"<"===r?"<0.0.0-0":"*":r&&d?(c&&(a=0),s=0,">"===r?(r=">=",c?(o=+o+1,a=0,s=0):(a=+a+1,s=0)):"<="===r&&(r="<",c?o=+o+1:a=+a+1),"<"===r&&(l="-0"),n=`${r+o}.${a}.${s}${l}`):c?n=`>=${o}.0.0${l} <${+o+1}.0.0-0`:f&&(n=`>=${o}.${a}.0${l} <${o}.${+a+1}.0-0`),i("xRange return",n),n}))},O=(e,t)=>(i("replaceStars",e,t),e.trim().replace(a[s.STAR],"")),E=(e,t)=>(i("replaceGTE0",e,t),e.trim().replace(a[t.includePrerelease?s.GTE0PRE:s.GTE0],"")),D=e=>(t,n,r,i,o,a,s,l,u,c,f,d,h)=>`${n=y(r)?"":y(i)?`>=${r}.0.0${e?"-0":""}`:y(o)?`>=${r}.${i}.0${e?"-0":""}`:a?`>=${n}`:`>=${n}${e?"-0":""}`} ${l=y(u)?"":y(c)?`<${+u+1}.0.0-0`:y(f)?`<${u}.${+c+1}.0-0`:d?`<=${u}.${c}.${f}-${d}`:e?`<${u}.${c}.${+f+1}-0`:`<=${l}`}`.trim(),j=(e,t,n)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let n=0;n<e.length;n++)if(i(e[n].semver),e[n].semver!==r.ANY&&e[n].semver.prerelease.length>0){const r=e[n].semver;if(r.major===t.major&&r.minor===t.minor&&r.patch===t.patch)return!0}return!1}return!0};return lee}const dee=fee();var hee=(e,t,n)=>{try{t=new dee(t,n)}catch(Zee){return!1}return t.test(e)},pee=V8(hee);var mee='.vega-embed {\n  position: relative;\n  display: inline-block;\n  box-sizing: border-box;\n}\n.vega-embed.has-actions {\n  padding-right: 38px;\n}\n.vega-embed details:not([open]) > :not(summary) {\n  display: none !important;\n}\n.vega-embed summary {\n  list-style: none;\n  position: absolute;\n  top: 0;\n  right: 0;\n  padding: 6px;\n  z-index: 1000;\n  background: white;\n  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n  color: #1b1e23;\n  border: 1px solid #aaa;\n  border-radius: 999px;\n  opacity: 0.2;\n  transition: opacity 0.4s ease-in;\n  cursor: pointer;\n  line-height: 0px;\n}\n.vega-embed summary::-webkit-details-marker {\n  display: none;\n}\n.vega-embed summary:active {\n  box-shadow: #aaa 0px 0px 0px 1px inset;\n}\n.vega-embed summary svg {\n  width: 14px;\n  height: 14px;\n}\n.vega-embed details[open] summary {\n  opacity: 0.7;\n}\n.vega-embed:hover summary, .vega-embed:focus-within summary {\n  opacity: 1 !important;\n  transition: opacity 0.2s ease;\n}\n.vega-embed .vega-actions {\n  position: absolute;\n  z-index: 1001;\n  top: 35px;\n  right: -9px;\n  display: flex;\n  flex-direction: column;\n  padding-bottom: 8px;\n  padding-top: 8px;\n  border-radius: 4px;\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n  border: 1px solid #d9d9d9;\n  background: white;\n  animation-duration: 0.15s;\n  animation-name: scale-in;\n  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n  text-align: left;\n}\n.vega-embed .vega-actions a {\n  padding: 8px 16px;\n  font-family: sans-serif;\n  font-size: 14px;\n  font-weight: 600;\n  white-space: nowrap;\n  color: #434a56;\n  text-decoration: none;\n}\n.vega-embed .vega-actions a:hover, .vega-embed .vega-actions a:focus {\n  background-color: #f7f7f9;\n  color: black;\n}\n.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n  content: "";\n  display: inline-block;\n  position: absolute;\n}\n.vega-embed .vega-actions::before {\n  left: auto;\n  right: 14px;\n  top: -16px;\n  border: 8px solid rgba(0, 0, 0, 0);\n  border-bottom-color: #d9d9d9;\n}\n.vega-embed .vega-actions::after {\n  left: auto;\n  right: 15px;\n  top: -14px;\n  border: 7px solid rgba(0, 0, 0, 0);\n  border-bottom-color: #fff;\n}\n.vega-embed .chart-wrapper.fit-x {\n  width: 100%;\n}\n.vega-embed .chart-wrapper.fit-y {\n  height: 100%;\n}\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: auto;\n  padding-right: 14px;\n}\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6);\n  }\n  to {\n    opacity: 1;\n    transform: scale(1);\n  }\n}\n';function gee(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(const i of n)yee(e,i);return e}function yee(e,t){for(const n of Object.keys(t))Da(e,n,t[n],!0)}function vee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vee(Object(n),!0).forEach((function(t){G8(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const xee=YZ;let wee=N9;const kee="undefined"!=typeof window?window:void 0;void 0===wee&&kee?.vl?.compile&&(wee=kee.vl);const _ee={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},Oee={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},Eee={vega:"Vega","vega-lite":"Vega-Lite"},Dee={vega:xee.version,"vega-lite":wee?wee.version:"not available"},jee={vega:e=>e,"vega-lite":(e,t)=>wee.compile(e,{config:t}).spec},Nee='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>',See="chart-wrapper";function Aee(e,t,n,r){const i=`<html><head>${t}</head><body><pre><code class="json">`,o=`</code></pre>${n}</body></html>`,a=window.open("");a.document.write(i+e+o),a.document.title=`${Eee[r]} JSON Source`}function $ee(e){return(t=e)&&"load"in t?e:xee.loader(e);var t}async function Cee(e,t,n){let r,i;void 0===n&&(n={}),bs(t)?(i=$ee(n.loader),r=JSON.parse(await i.load(t))):r=t;const o=function(e){const t=e.usermeta?.embedOptions??{};return bs(t.defaultStyle)&&(t.defaultStyle=!1),t}(r),a=o.loader;i&&!a||(i=$ee(n.loader??a));const s=await Mee(o,i),l=await Mee(n,i),u=bee(bee({},gee(l,s)),{},{config:Ea(l.config??{},s.config??{})});return await async function(e,t,n,r){void 0===n&&(n={});const i=n.theme?Ea(C8[n.theme],n.config??{}):n.config,o=ps(n.actions)?n.actions:gee({},_ee,n.actions??{}),a=bee(bee({},Oee),n.i18n),s=n.renderer??"canvas",l=n.logLevel??xee.Warn,u=n.downloadFileName??"visualization",c="string"==typeof e?document.querySelector(e):e;if(!c)throw new Error(`${e} does not exist`);if(!1!==n.defaultStyle){const e="vega-embed-style",{root:t,rootContainer:r}=function(e){const t=e.getRootNode?e.getRootNode():document;return t instanceof ShadowRoot?{root:t,rootContainer:t}:{root:document,rootContainer:document.head??document.body}}(c);if(!t.getElementById(e)){const t=document.createElement("style");t.id=e,t.innerHTML=void 0===n.defaultStyle||!0===n.defaultStyle?mee.toString():n.defaultStyle,r.appendChild(t)}}const f=function(e,t){if(e.$schema){const n=S9(e.$schema);t&&t!==n.library&&console.warn(`The given visualization spec is written in ${Eee[n.library]}, but mode argument sets ${Eee[t]??t}.`);const r=n.library;return pee(Dee[r],`^${n.version.slice(1)}`)||console.warn(`The input spec uses ${Eee[r]} ${n.version}, but the current version of ${Eee[r]} is v${Dee[r]}.`),r}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t??"vega"}(t,n.mode);let d=jee[f](t,i);if("vega-lite"===f&&d.$schema){const e=S9(d.$schema);pee(Dee.vega,`^${e.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${e.version}, but current version is v${Dee.vega}.`)}c.classList.add("vega-embed"),o&&c.classList.add("has-actions");c.innerHTML="";let h=c;if(o){const e=document.createElement("div");e.classList.add(See),c.appendChild(e),h=e}const p=n.patch;p&&(d=p instanceof Function?p(d):Bo(d,p,!0,!1).newDocument);n.formatLocale&&xee.formatLocale(n.formatLocale);n.timeFormatLocale&&xee.timeFormatLocale(n.timeFormatLocale);if(n.expressionFunctions)for(const w in n.expressionFunctions){const e=n.expressionFunctions[w];"fn"in e?xee.expressionFunction(w,e.fn,e.visitor):e instanceof Function&&xee.expressionFunction(w,e)}const{ast:m}=n,g=xee.parse(d,"vega-lite"===f?{}:i,{ast:m}),y=new(n.viewClass||xee.View)(g,bee({loader:r,logLevel:l,renderer:s},m?{expr:xee.expressionInterpreter??n.expr??aH}:{}));if(y.addSignalListener("autosize",((e,t)=>{const{type:n}=t;"fit-x"==n?(h.classList.add("fit-x"),h.classList.remove("fit-y")):"fit-y"==n?(h.classList.remove("fit-x"),h.classList.add("fit-y")):"fit"==n?h.classList.add("fit-x","fit-y"):h.classList.remove("fit-x","fit-y")})),!1!==n.tooltip){const e=function(e){return"function"==typeof e}(n.tooltip)?n.tooltip:new W8(!0===n.tooltip?{}:n.tooltip).call;y.tooltip(e)}let v,{hover:b}=n;void 0===b&&(b="vega"===f);if(b){const{hoverSet:e,updateSet:t}="boolean"==typeof b?{}:b;y.hover(e,t)}n&&(null!=n.width&&y.width(n.width),null!=n.height&&y.height(n.height),null!=n.padding&&y.padding(n.padding));if(await y.initialize(h,n.bind).runAsync(),!1!==o){let e=c;if(!1!==n.defaultStyle){const t=document.createElement("details");t.title=a.CLICK_TO_VIEW_ACTIONS,c.append(t),e=t;const n=document.createElement("summary");n.innerHTML=Nee,t.append(n),v=e=>{t.contains(e.target)||t.removeAttribute("open")},document.addEventListener("click",v)}const r=document.createElement("div");if(e.append(r),r.classList.add("vega-actions"),!0===o||!1!==o.export)for(const t of["svg","png"])if(!0===o||!0===o.export||o.export[t]){const e=a[`${t.toUpperCase()}_ACTION`],i=document.createElement("a"),o=_a(n.scaleFactor)?n.scaleFactor[t]:n.scaleFactor;i.text=e,i.href="#",i.target="_blank",i.download=`${u}.${t}`,i.addEventListener("mousedown",(async function(e){e.preventDefault();const n=await y.toImageURL(t,o);this.href=n})),r.append(i)}if(!0===o||!1!==o.source){const e=document.createElement("a");e.text=a.SOURCE_ACTION,e.href="#",e.addEventListener("click",(function(e){Aee(Ko(t),n.sourceHeader??"",n.sourceFooter??"",f),e.preventDefault()})),r.append(e)}if("vega-lite"===f&&(!0===o||!1!==o.compiled)){const e=document.createElement("a");e.text=a.COMPILED_ACTION,e.href="#",e.addEventListener("click",(function(e){Aee(Ko(d),n.sourceHeader??"",n.sourceFooter??"","vega"),e.preventDefault()})),r.append(e)}if(!0===o||!1!==o.editor){const e=n.editorUrl??"https://vega.github.io/editor/",o=document.createElement("a");o.text=a.EDITOR_ACTION,o.href="#",o.addEventListener("click",(function(n){!function(e,t,n){const r=e.open(t),i=250,{origin:o}=new URL(t);let a=~~(1e4/i);e.addEventListener("message",(function t(n){n.source===r&&(a=0,e.removeEventListener("message",t,!1))}),!1),setTimeout((function e(){a<=0||(r.postMessage(n,o),setTimeout(e,i),a-=1)}),i)}(window,e,{config:i,mode:f,renderer:s,spec:Ko(t)}),n.preventDefault()})),r.append(o)}}function x(){v&&document.removeEventListener("click",v),y.finalize()}return{view:y,spec:t,vgSpec:d,finalize:x,embedOptions:n}}(e,r,u,i)}async function Mee(e,t){const n=bs(e.config)?JSON.parse(await t.load(e.config)):e.config??{},r=bs(e.patch)?JSON.parse(await t.load(e.patch)):e.patch;return bee(bee(bee({},e),r?{patch:r}:{}),n?{config:n}:{})}function Pee(e,t){Object.keys(t).forEach((n=>{!function(e,t,n){var r;n&&((r=n)&&"[object Function]"==={}.toString.call(r)?n(e.data(t)):e.change(t,xee.changeset().remove((()=>!0)).insert(n)))}(e,n,t[n])}))}function Fee(e){const t=new Set;return e.forEach((e=>{Object.keys(e).forEach((e=>{t.add(e)}))})),t}const Tee=()=>{};function zee(e,t){const n=Object.keys(t);return n.forEach((n=>{try{e.addSignalListener(n,t[n])}catch(aa){console.warn("Cannot add invalid signal listener.",aa)}})),n.length>0}function Ree(e,t){const n=Object.keys(t);return n.forEach((n=>{try{e.removeSignalListener(n,t[n])}catch(aa){console.warn("Cannot remove invalid signal listener.",aa)}})),n.length>0}function Lee(e){const{spec:t,width:n,height:r}=e;return void 0!==n&&void 0!==r?{...t,width:n,height:r}:void 0!==n?{...t,width:n}:void 0!==r?{...t,height:r}:t}function Bee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Iee extends a.PureComponent{constructor(){super(...arguments),Bee(this,"containerRef",a.createRef()),Bee(this,"resultPromise",void 0),Bee(this,"handleError",(e=>{const{onError:t=Tee}=this.props;t(e,this.containerRef.current),console.warn(e)})),Bee(this,"modifyView",(e=>{this.resultPromise&&this.resultPromise.then((t=>(t&&e(t.view),!0))).catch(this.handleError)}))}componentDidMount(){this.createView()}componentDidUpdate(e){const t=Fee([this.props,e]);if(t.delete("className"),t.delete("signalListeners"),t.delete("spec"),t.delete("style"),t.delete("width"),t.delete("height"),Array.from(t).some((t=>this.props[t]!==e[t])))this.clearView(),this.createView();else{const t=function(e,t){if(e===t)return!1;const n={width:!1,height:!1,isExpensive:!1},r=Fee([e,t]);return!r.has("width")||"width"in e&&"width"in t&&e.width===t.width||("width"in e&&"number"==typeof e.width?n.width=e.width:n.isExpensive=!0),!r.has("height")||"height"in e&&"height"in t&&e.height===t.height||("height"in e&&"number"==typeof e.height?n.height=e.height:n.isExpensive=!0),r.delete("width"),r.delete("height"),[...r].some((n=>!(n in e)||!(n in t)||!fH(e[n],t[n])))&&(n.isExpensive=!0),!(!1===n.width&&!1===n.height&&!n.isExpensive)&&n}(Lee(this.props),Lee(e)),{signalListeners:n}=this.props,{signalListeners:r}=e;if(t)if(t.isExpensive)this.clearView(),this.createView();else{const e=!wo(n,r);this.modifyView((i=>{!1!==t.width&&i.width(t.width),!1!==t.height&&i.height(t.height),e&&(r&&Ree(i,r),n&&zee(i,n)),i.run()}))}else wo(n,r)||this.modifyView((e=>{r&&Ree(e,r),n&&zee(e,n),e.run()}))}}componentWillUnmount(){this.clearView()}createView(){const{spec:e,onNewView:t,signalListeners:n={},width:r,height:i,...o}=this.props;if(this.containerRef.current){const e=Lee(this.props);this.resultPromise=Cee(this.containerRef.current,e,o).then((e=>{if(e){const{view:t}=e;zee(t,n)&&t.run()}return e})).catch(this.handleError),t&&this.modifyView(t)}}clearView(){return this.resultPromise&&this.resultPromise.then((e=>{e&&e.finalize()})).catch(this.handleError),this.resultPromise=void 0,this}render(){const{className:e,style:t}=this.props;return a.createElement("div",{ref:this.containerRef,className:e,style:t})}}function Uee(){return Uee=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Uee.apply(this,arguments)}function qee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Bee(Iee,"propTypes",{className:bo.string,onError:bo.func});class Wee extends a.PureComponent{constructor(){super(...arguments),qee(this,"vegaEmbed",a.createRef()),qee(this,"handleNewView",(e=>{this.update();const{onNewView:t=Tee}=this.props;t(e)}))}componentDidMount(){this.update()}componentDidUpdate(e){wo(this.props.data,e.data)||this.update()}update(){const{data:e}=this.props;this.vegaEmbed.current&&e&&Object.keys(e).length>0&&this.vegaEmbed.current.modifyView((t=>{Pee(t,e),t.resize().run()}))}render(){const{data:e,...t}=this.props;return a.createElement(Iee,Uee({ref:this.vegaEmbed},t,{onNewView:this.handleNewView}))}}qee(Wee,"defaultProps",{data:{}})},4882:(e,t,n)=>{n.d(t,{U:()=>f});var r=n(4749),i=n(4993),o=n(4733),a=n(2983);const s=(e,t)=>{const n=new URL(t,new URL(e,"resolve://pathname/"));if("resolve:"===n.protocol){const{pathname:n,search:r,hash:i}=new URL(t,new URL(e,"http://example.com/"));return n+r+i}return n.toString()},l={1:{},2:{h1:o.XJ,h2:o.aC,h3:o.k8,h4:o.by,h5:o.Cd},3:{h1:o.aC,h2:o.k8,h3:o.by,h4:o.Cd,h5:o.Cd},4:{h1:o.k8,h2:o.by,h3:o.Cd,h4:o.Cd,h5:o.Cd},5:{h1:o.by,h2:o.Cd,h3:o.Cd,h4:o.Cd,h5:o.Cd},6:{h1:o.Cd,h2:o.Cd,h3:o.Cd,h4:o.Cd,h5:o.Cd}},u=e=>({img:t=>{let{src:n,...i}=t;return a.createElement("img",(0,r.Z)({},i,{src:s(e,n),className:"utrecht-img utrecht-img--fit"}))}}),c=(e,t)=>{if(e){const e={...l[t-1]};return e.h1=()=>null,e}return l[t]},f=e=>{let{children:t,omitH1:n=!1,headingLevel:r=1,baseUrl:o=""}=e;return a.createElement(i.Zo,{components:{...c(n,r),...u(o)}},t)}},7289:(e,t,n)=>{n.d(t,{U:()=>c});var r=n(7090),i=n(1478),o=n(2959),a=n(8856),s=n(2983);const l="story-tabs__tab_Ets0",u="story-tabs__link_j5UT",c=e=>{let{tabs:t}=e;return s.createElement(o.Z,null,t.map((e=>{let{id:t,label:n,story:o}=e;const{siteConfig:c}=(0,r.Z)(),f=c.customFields.storybookUrl,d=`${f}?path=/docs/${o}`,h=`${f}iframe.html?id=${o}&viewMode=docs#singleStory=true&shortcuts=false`;return s.createElement(i.Z,{value:t,label:n,key:t},s.createElement("div",{className:l},s.createElement(a.Z,{src:h,style:{width:"1px",minWidth:"100%"},heightCalculationMethod:"lowestElement"}),s.createElement("a",{className:u,href:d,target:"_blank",rel:"noreferrer"},"Storybook: ",o)))})))}},6280:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>g,contentTitle:()=>p,default:()=>x,frontMatter:()=>h,metadata:()=>m,toc:()=>y});var r=n(4749),i=(n(2983),n(4993)),o=n(4882),a=n(7289);const s={toc:[{value:"Activeren met <em>touch</em>",id:"activeren-met-touch",level:2},{value:"Activeren met toetsenbord",id:"activeren-met-toetsenbord",level:2},{value:"Activeren met een muis",id:"activeren-met-een-muis",level:2},{value:"Activeren met een <em>screen reader</em>",id:"activeren-met-een-screen-reader",level:2},{value:"Terug met de <em>Back button</em>",id:"terug-met-de-back-button",level:2},{value:"Er zijn veel soorten links",id:"er-zijn-veel-soorten-links",level:2},{value:"Link versus button",id:"link-versus-button",level:2},{value:"Design",id:"design",level:2},{value:"Onderstreep de link",id:"onderstreep-de-link",level:3},{value:"Geen icoon voor externe links",id:"geen-icoon-voor-externe-links",level:3},{value:"<code>hover</code> en <code>focus</code>",id:"hover-en-focus",level:3},{value:"Contrast met elke achtergrondkleur",id:"contrast-met-elke-achtergrondkleur",level:3},{value:"Content",id:"content",level:2},{value:"Gebruik van links in tekst",id:"gebruik-van-links-in-tekst",level:3},{value:"Links in een zin",id:"links-in-een-zin",level:3},{value:"Do&#39;s",id:"dos",level:3},{value:"Don&#39;ts",id:"donts",level:3},{value:"States",id:"states",level:2},{value:"Link in plaats van <code>&lt;a&gt;</code>",id:"link-in-plaats-van-a",level:2},{value:"HTML",id:"html",level:2},{value:"<code>tabindex=&quot;-1&quot;</code>",id:"tabindex-1",level:3},{value:"Privacy",id:"privacy",level:2},{value:"Hoe het niet moet",id:"hoe-het-niet-moet",level:2},{value:"Geen zichtbaar verschil tussen hover en focus state",id:"geen-zichtbaar-verschil-tussen-hover-en-focus-state",level:3},{value:"Link-tekst betekent verschillende dingen",id:"link-tekst-betekent-verschillende-dingen",level:3},{value:"Verkeerde taal",id:"verkeerde-taal",level:3},{value:"Link naar huidige pagina niet opmaken",id:"link-naar-huidige-pagina-niet-opmaken",level:3},{value:"Onnodige link naar huidige pagina",id:"onnodige-link-naar-huidige-pagina",level:3},{value:"Link zonder <code>href</code> attribuut",id:"link-zonder-href-attribuut",level:3},{value:"Referenties",id:"referenties",level:2},{value:"Relevante WCAG regels",id:"relevante-wcag-regels",level:3}]},l="wrapper";function u(e){let{components:t,...n}=e;return(0,i.kt)(l,(0,r.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"link"},"Link"),(0,i.kt)("p",null,"Met de link maak je navigatie mogelijk naar een gerelateerde pagina."),(0,i.kt)("h2",{id:"activeren-met-touch"},"Activeren met ",(0,i.kt)("em",{parentName:"h2"},"touch")),(0,i.kt)("p",null,"Veel gebruikers activeren de link door te klikken op een ",(0,i.kt)("em",{parentName:"p"},"touch screen"),". Deze gebruikers zien niet de ",(0,i.kt)("em",{parentName:"p"},"hover")," state van een link, dus een link moet ook duidelijk herkenbaar zijn zonder ooit het design van de ",(0,i.kt)("em",{parentName:"p"},"hover")," state te zien."),(0,i.kt)("h2",{id:"activeren-met-toetsenbord"},"Activeren met toetsenbord"),(0,i.kt)("p",null,"Sommige gebruikers gebruiken het toetsenbord om telkens met \xe9\xe9n druk op de knop naar de volgende link te gaan. De ",(0,i.kt)("inlineCode",{parentName:"p"},"focus-visible")," variant moet daarom opvallend zijn, zodat je weet welke link je kunt activeren met ",(0,i.kt)("inlineCode",{parentName:"p"},"Enter"),". Links moet je kunnen activeren met ",(0,i.kt)("inlineCode",{parentName:"p"},"Enter"),", maar niet met ",(0,i.kt)("inlineCode",{parentName:"p"},"Space"),"."),(0,i.kt)("h2",{id:"activeren-met-een-muis"},"Activeren met een muis"),(0,i.kt)("p",null,"Gebuikers met een muis kunnen de ",(0,i.kt)("em",{parentName:"p"},"hover")," state zien wanneer de muisaanwezer over de link heen beweegt. Links met een ",(0,i.kt)("inlineCode",{parentName:"p"},"title")," attribuut kunnen dan een tooltip tonen die in de weg zit (gebruik daarom geen ",(0,i.kt)("inlineCode",{parentName:"p"},"title")," attribuut)."),(0,i.kt)("p",null,"Gebruikers die zowel toetsenbord als muis gebruiken moeten kunnen onderscheiden welke link focus heeft, en welke de ",(0,i.kt)("em",{parentName:"p"},"hover")," state heeft."),(0,i.kt)("h2",{id:"activeren-met-een-screen-reader"},"Activeren met een ",(0,i.kt)("em",{parentName:"h2"},"screen reader")),(0,i.kt)("p",null,'Sommige gebruikers gebruiken een lijst van alle links op een pagina, en kiezen een link uit op basis van de link-tekst. Deze gebruikers bekijken niet de hele pagina, en zien niet altijd de link in de context van de omliggende tekst. Daarom is het belangrijk dat de link-tekst op zichzelf duidelijk maakt welke pagina je opent. Om de juiste link te kunnen kiezen, is het ook belangrijk dat niet dezelfde link-tekst wordt gebruikt voor verschillende links. Gebruik dus niet "Lees meer" als link-tekst, die tekst is meestal niet uniek op een pagina en is onduidelijk zonder context.'),(0,i.kt)("h2",{id:"terug-met-de-back-button"},"Terug met de ",(0,i.kt)("em",{parentName:"h2"},"Back button")),(0,i.kt)("p",null,"Na het activeren van een link, moet een gebruiker weer terug kunnen naar de vorige pagina. Gebruikers doen dat met bijvoorbeeld de ",(0,i.kt)("em",{parentName:"p"},"back button")," van de browser, of met een ",(0,i.kt)("em",{parentName:"p"},"swipe gesture")," op een ",(0,i.kt)("em",{parentName:"p"},"touch screen"),"."),(0,i.kt)("p",null,"Als je gewoon ",(0,i.kt)("inlineCode",{parentName:"p"},'<a href="...">')," in HTML gebruikt dan werkt de back button zoals het hoort. Met extra code kun je de back button onbedoeld kapot maken. Als je het ",(0,i.kt)("inlineCode",{parentName:"p"},"target")," attribuut gebruikt, dan werkt de ",(0,i.kt)("em",{parentName:"p"},"back button")," niet (bijvoorbeeld: ",(0,i.kt)("inlineCode",{parentName:"p"},'target="_blank"'),")."),(0,i.kt)("p",null,"Als je een ",(0,i.kt)("em",{parentName:"p"},"single page app")," maakt moet je goed testen dat de back button nog goed werkt. Wanneer je de ",(0,i.kt)("inlineCode",{parentName:"p"},"click")," event van de link stopt met ",(0,i.kt)("inlineCode",{parentName:"p"},"event.preventDefault()")," en met script een eigen navigatie maakt, dan moet je de ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/API/History"},"History API")," gebruiken om een even goede ervaring te bieden als gewone links in HTML."),(0,i.kt)("h2",{id:"er-zijn-veel-soorten-links"},"Er zijn veel soorten links"),(0,i.kt)("p",null,"Je kunt links groeperen in de navigatie-regio van de pagina, zodat gebruikers snel vinden welke informatie er nog meer is. Je kunt links plaatsen in de lopende tekst. Je kunt overzichtelijke lijstjes met links plaatsen in de tekst. Je kunt links plaatsen naar dezelfde informatie in een ander formaat of in een andere taal. Je kunt van hele blokken een link maken, om die informatie in detail te openen."),(0,i.kt)("h2",{id:"link-versus-button"},"Link versus button"),(0,i.kt)("p",null,"Links worden vooral gebruikt om te navigeren en verschijnen dan ook in of direct na een zin."),(0,i.kt)("p",null,"Buttons worden gebruikt voor acties, zoals 'toevoegen', 'sluiten' of 'opslaan'."),(0,i.kt)("h2",{id:"design"},"Design"),(0,i.kt)("h3",{id:"onderstreep-de-link"},"Onderstreep de link"),(0,i.kt)("p",null,"Links zijn het meest herkenbaar als je de tekst van de link onderstreept, want dat is gebruikelijk sinds het begin van het web. Gebruik een kleur met voldoende contrast voor de streep, zodat iedereen die de tekst kan zien ook de streep kan zien. De kleur van de streep kan minder contrast hebben als de streep dikker is."),(0,i.kt)("p",null,"Een streep die door de letters gaat maakt de tekst minder leesbaar. Gebruikers met dyslexie kunnen woorden beter herkennen als het woordbeeld niet wordt aangetast. Maak het woordbeeld van links rustiger met de volgende twee CSS properties. Je kunt met ",(0,i.kt)("inlineCode",{parentName:"p"},"text-decoration-skip-ink")," in CSS de streep automatisch laten onderbreken, zodat je voorkomt dat woorden een beetje doorstreept worden. Met ",(0,i.kt)("inlineCode",{parentName:"p"},"text-underline-offset")," kun je de afstand tussen de streep en de letters iets groter maken, zodat een onderbroken streep minder vaak nodig is."),(0,i.kt)("p",null,"Links die staan op een herkenbare plek zoals de hoofdnavigatie, zijn vaak al herkenbaar als link wanneer ze niet onderstreept zijn. Je kunt extra duidelijk maken dat het een link is door de tekst alsnog onderstrepen als ",(0,i.kt)("inlineCode",{parentName:"p"},"hover")," of ",(0,i.kt)("inlineCode",{parentName:"p"},"focus"),' effect, zodat een gebruiker zeker weet dat de browser mogelijkheden heeft zoals "Openen deze link in een nieuwe tab" of "Deel deze link".'),(0,i.kt)("p",null,"Heeft de link een icoon \xe9n tekst, onderstreep dan alleen de tekst."),(0,i.kt)("h3",{id:"geen-icoon-voor-externe-links"},"Geen icoon voor externe links"),(0,i.kt)("p",null,"Gebruik geen speciaal icoon bij links naar een externe website. Door ",(0,i.kt)("a",{parentName:"p",href:"https://designnotes.blog.gov.uk/2016/11/28/removing-the-external-link-icon-from-gov-uk/"},"onderzoek naar externe links van GOV.UK")," weten we dat gebruikers hier weinig voordeel van hebben."),(0,i.kt)("h3",{id:"hover-en-focus"},(0,i.kt)("inlineCode",{parentName:"h3"},"hover")," en ",(0,i.kt)("inlineCode",{parentName:"h3"},"focus")),(0,i.kt)("p",null,"Wanneer een gebruiker met de muis over een link gaat (",(0,i.kt)("inlineCode",{parentName:"p"},"hover"),"), of met het toetsenbord een link selecteert (",(0,i.kt)("inlineCode",{parentName:"p"},"focus"),"), dan is het belangrijk dat er geen onvoorspelbare wijzigingen in de layout zijn."),(0,i.kt)("p",null,"Gebruik voor ",(0,i.kt)("inlineCode",{parentName:"p"},"hover")," en ",(0,i.kt)("inlineCode",{parentName:"p"},"focus")," geen effecten waardoor de tekst van de link over meer regels wordt verdeeld, of waardoor de tekst na de link verschuift. Gebruik daarom geen andere ",(0,i.kt)("inlineCode",{parentName:"p"},"font-size")," of ",(0,i.kt)("inlineCode",{parentName:"p"},"font-weight")," als effect."),(0,i.kt)("p",null,"Gebruik voor ",(0,i.kt)("inlineCode",{parentName:"p"},"hover")," en ",(0,i.kt)("inlineCode",{parentName:"p"},"focus")," geen effect waardoor de positie van de link verschuift, waardoor het moeilijk wordt de link aan te klikken."),(0,i.kt)("h3",{id:"contrast-met-elke-achtergrondkleur"},"Contrast met elke achtergrondkleur"),(0,i.kt)("p",null,"Links kunnen staan in componenten die een speciale achtergrondkleur hebben, zoals componenten met een signaalkleur als achtergrond. De linkkleur moet voldoende contrast hebben met die achtergrondkleuren. Controleer alle mogelijke varianten, want misschien moet je in die situaties een bijpassende link-kleur kiezen."),(0,i.kt)("h2",{id:"content"},"Content"),(0,i.kt)("h3",{id:"gebruik-van-links-in-tekst"},"Gebruik van links in tekst"),(0,i.kt)("p",null,"Links moeten duidelijk zijn: gebruikers begrijpen dat je de link gebruikt om naar een andere pagina te gaan, en het is voorspelbaar naar welke pagina je toe gaat."),(0,i.kt)("p",null,"Gebruikers met ondersteunende technologie, zoals een schermlezer of braillebalk, horen/voelen vaak als eerste alle links in de content om hen te helpen snel te kunnen navigeren door de content. Er kan ook behoefte zijn om de de content vergroot te willen bekijken, zodat de gebruikers alleen de linktekst en een paar woorden eromheen tegelijkertijd kan zien."),(0,i.kt)("p",null,'Maak geen links met een onduidelijke tekst, zoals "hier" of "lees meer".'),(0,i.kt)("h3",{id:"links-in-een-zin"},"Links in een zin"),(0,i.kt)("p",null,"Links moeten nooit een hele zin in beslag nemen, maar alleen de tekst die beschrijft waar de gebruikers naar toe gaan als ze op de link klikken."),(0,i.kt)("h3",{id:"dos"},"Do's"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Plaats links aan het einde van een zin als dat mogelijk is."),(0,i.kt)("li",{parentName:"ul"},"Maak duidelijk waar de link je naar toe brengt."),(0,i.kt)("li",{parentName:"ul"},"Gebruik het meest relevante woord van de link aan het begin van de link tekst. Bezoekers lezen niet verder dan de eerste twee woorden van een link."),(0,i.kt)("li",{parentName:"ul"},"Zorg dat de link ook begrijpelijk is zonder dat je de zinnen er omheen gelezen hebt.")),(0,i.kt)("h3",{id:"donts"},"Don'ts"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Gebruik geen buttons waar je een link kan gebruiken."),(0,i.kt)("li",{parentName:"ul"},"Gebruik geen vage of te algemene termen voor de link tekst. Help de gebruiker met voorspellen waar hij naar toe gaat."),(0,i.kt)("li",{parentName:"ul"},"Open interne links niet in een nieuwe tab. Hiermee schakel je \xe9\xe9n navigatiemanier uit om terug te gaan naar eerdere pagina's, de terug knop van de brower.")),(0,i.kt)("h2",{id:"states"},"States"),(0,i.kt)("p",null,"We beschrijven de volgende states van een link:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"normal"),": geen van de onderstaande states is van toepassing op de link. Deze state is gewoon de ",(0,i.kt)("inlineCode",{parentName:"li"},"utrecht-link")," class in de code, maar we beschrijven hem hier om aan te geven dat de link 'normaal' is zonder een andere state."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"active"),": de gebruiker activeert de link op dit moment. Bijvoorbeeld door er op te klikken. De ",(0,i.kt)("inlineCode",{parentName:"li"},"active")," state duurt maar heel kort."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"hover"),": de gebruiker heeft de aanwijzer boven de link. Bijvoorbeeld door met de muiscursor er over te 'zweven'."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"focus"),": de link heeft de focus doordat er op geklikt of getapt is. Denk ook aan voice of eye-tracking."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"focus-visible"),": de link heeft de focus door de 'tab' knop van het keyboard."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"visited"),": de link is eerder gebruikt door de gebruiker."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"busy"),": de button is geactiveerd en de actie wordt nu nog uitgevoerd.")),(0,i.kt)("h2",{id:"link-in-plaats-van-a"},"Link in plaats van ",(0,i.kt)("inlineCode",{parentName:"h2"},"<a>")),(0,i.kt)("p",null,'Voor de component naam hebben we voor "',(0,i.kt)("inlineCode",{parentName:"p"},"link"),'" gekozen, en niet voor "',(0,i.kt)("inlineCode",{parentName:"p"},"a"),'" zoals de ',(0,i.kt)("a",{parentName:"p",href:"https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element"},(0,i.kt)("inlineCode",{parentName:"a"},"<a>"))," in HTML. Buiten de context van HTML-code (bijvoorbeeld in Figma) is ",(0,i.kt)("inlineCode",{parentName:"p"},"a"),"niet duidelijk genoeg, en we verwachten niet dat er grote verwarring ontstaat met het ",(0,i.kt)("a",{parentName:"p",href:"https://html.spec.whatwg.org/multipage/semantics.html#the-link-element"},(0,i.kt)("inlineCode",{parentName:"a"},"<link>"))," element van HTML."),(0,i.kt)("h2",{id:"html"},"HTML"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Gebruik het ",(0,i.kt)("inlineCode",{parentName:"li"},"<a>")," element om links aan te maken."),(0,i.kt)("li",{parentName:"ul"},"Gebuik niet het ",(0,i.kt)("inlineCode",{parentName:"li"},"title")," attribuut. Sommige browsers gebruiken een tooltip om de tekst uit het ",(0,i.kt)("inlineCode",{parentName:"li"},"title")," attribuut te tonen, die tooltip kan over de tekst heenstaan waardoor het niet leesbaar is."),(0,i.kt)("li",{parentName:"ul"},"Gebruik nooit een ",(0,i.kt)("inlineCode",{parentName:"li"},"<button>")," of een ander element met een ",(0,i.kt)("inlineCode",{parentName:"li"},"click")," event om zelf een link na te maken."),(0,i.kt)("li",{parentName:"ul"},"Gebruik ",(0,i.kt)("inlineCode",{parentName:"li"},'aria-current="page"')," wanneer de link verwijst naar de huidige pagina. Voor consistente navigatie (",(0,i.kt)("a",{parentName:"li",href:"https://www.w3.org/TR/WCAG21/#consistent-navigation"},"WCAG eis 3.2.3"),") is het beter om links in de navigatie te laten staan dan om geen ",(0,i.kt)("inlineCode",{parentName:"li"},"<a>")," te gebruiken voor de huidige pagina."),(0,i.kt)("li",{parentName:"ul"},"Vermijd het gebruik van ",(0,i.kt)("inlineCode",{parentName:"li"},'href="#"'),". Dit brengt de focus naar het begin van de pagina en dat is nooit wensbaar."),(0,i.kt)("li",{parentName:"ul"},"Gebruik nooit ",(0,i.kt)("inlineCode",{parentName:"li"},'tabindex="0"')," bij het ",(0,i.kt)("inlineCode",{parentName:"li"},"<a>")," element. Links kunnen al standaard focus ontvangen."),(0,i.kt)("li",{parentName:"ul"},"Vermijd onnodig gebruik van ",(0,i.kt)("inlineCode",{parentName:"li"},'tabindex="-1"'),", er zijn weinig situaties waar het nodig is."),(0,i.kt)("li",{parentName:"ul"},"Gebruik ",(0,i.kt)("inlineCode",{parentName:"li"},"aria-label")," en niet ",(0,i.kt)("inlineCode",{parentName:"li"},"title")," voor het volledige label van de link. Soms is de inhoud van het ",(0,i.kt)("inlineCode",{parentName:"li"},"a"),' element niet een goed label, bijvoorbeeld wanneer er een icoon in staat of het zichtbare label een algemene tekst is zoals "Lees meer". Zie ook ',(0,i.kt)("a",{parentName:"li",href:"https://www.w3.org/WAI/WCAG21/Techniques/aria/ARIA8"},"WCAG Technique ARIA8"))),(0,i.kt)("h3",{id:"tabindex-1"},(0,i.kt)("inlineCode",{parentName:"h3"},'tabindex="-1"')),(0,i.kt)("p",null,"Gebruik ",(0,i.kt)("inlineCode",{parentName:"p"},'tabindex="-1"')," in zeldzame gevallen dat het gebruiksvriendelijker is om een link weg te halen uit tabvolgorde. Toetsenbordgebruikers moeten toegang hebben tot dezelfde links als gebruikers van een muis."),(0,i.kt)("p",null,"Als het nodig is twee identieke links kort na elkaar te plaatsen, dan is het onnodig en onhandig dat dezelfde link twee keer na elkaar focus krijgt. In dat geval is het beter om \xe9\xe9n van de links uit de tabvolgorde te verwijderen."),(0,i.kt)("p",null,"Bijvoorbeeld:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<article>\n  <h2 id="heading-puppy-geboren"><a href="/nieuws/monster-puppy">Puppy met zes poten</a></h2>\n  <p>\n    In de gemeente Monster is een puppy geboren met zes poten.\n    <a href="/nieuws/monster-puppy" tabindex="-1" aria-labelledby="heading-puppy-geboren">Lees verder...</a>\n  </p>\n</article>\n')),(0,i.kt)("h2",{id:"privacy"},"Privacy"),(0,i.kt)("p",null,"Als de ",(0,i.kt)("inlineCode",{parentName:"p"},"visited")," een ander visueel ontwerp heeft dan een normale link, dan kunnen anderen zien welke pagina's zijn bekeken. Gebruik daarom liever geen ",(0,i.kt)("inlineCode",{parentName:"p"},"visited")," design tokens voor websites waar de privacy van de gebruiker in gevaar komt."),(0,i.kt)("p",null,'Als je een linkt maakt naar een externe website, dan kan die website zien op welke pagina de bezoeker op dat moment was. Dit is slecht voor de privacy, gebruik daarom altijd gebruik van de "externe link" code om deze informatie af te schermen.'),(0,i.kt)("h2",{id:"hoe-het-niet-moet"},"Hoe het niet moet"),(0,i.kt)("h3",{id:"geen-zichtbaar-verschil-tussen-hover-en-focus-state"},"Geen zichtbaar verschil tussen hover en focus state"),(0,i.kt)("p",null,"Als toetsenbordgebruiker is het belangrijk dat je weet welke link je activeert als je op ",(0,i.kt)("inlineCode",{parentName:"p"},"Enter")," drukt. Als de hover-variant van de link (bijna) hetzelfde is als de focus-variant, dan weet je niet zeker welke link je zult activeren."),(0,i.kt)("h3",{id:"link-tekst-betekent-verschillende-dingen"},"Link-tekst betekent verschillende dingen"),(0,i.kt)("p",null,'Niet goed: "contact" linkt eerst naar de contact-pagina, verder op linkt "contact" naar een telefoonnummer.'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<nav>\n  <a href="/contact/">contact</a>\n</nav>\n\x3c!-- ...op een andere plek in dezelfde pagina --\x3e\n<p>Neem <a href="tel:555-1234">contact</a> op met de klantenservice, vandaag tot 6 uur bereikbaar.</p>\n')),(0,i.kt)("p",null,"Beter:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<nav>\n  <a href="/contact/">contact</a>\n</nav>\n\x3c!-- ...op een andere plek in dezelfde pagina --\x3e\n<p><a href="tel:555-1234">Bel de klantenservice</a>, vandaag tot 6 uur bereikbaar.</p>\n')),(0,i.kt)("h3",{id:"verkeerde-taal"},"Verkeerde taal"),(0,i.kt)("p",null,"Als je linkt naar een pagina waarvan de beschrijving in een andere taal is dan de context waarin de link staat, dan moet je de taal instellen op de link zelf (WCAG 3.1.2)."),(0,i.kt)("p",null,"Niet:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<a href="/nl/">Nederlands</a>\n<a href="/en/">English</a>\n<a href="/fr/">Fran\xe7ois</a>\n')),(0,i.kt)("p",null,"Wel:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<a href="/nl/">Nederlands</a>\n<a href="/en/" lang="en">English</a>\n<a href="/fr/" lang="fr">Fran\xe7ois</a>\n')),(0,i.kt)("p",null,"Niet:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<p>\n  In de presentatie\n  <a href="https://www.slideshare.net/stubbornella/object-oriented-css"\n    >Object Oriented CSS for high performance web applications and sites</a\n  >\n  vertelt Nicole Sullivan over een aanpak om CSS te schrijven.\n</p>\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<p>\n  In de presentatie\n  <a href="https://www.slideshare.net/stubbornella/object-oriented-css" lang="en"\n    >Object Oriented CSS for high performance web applications and sites</a\n  >\n  vertelt Nicole Sullivan over een aanpak om CSS te schrijven.\n</p>\n')),(0,i.kt)("h3",{id:"link-naar-huidige-pagina-niet-opmaken"},"Link naar huidige pagina niet opmaken"),(0,i.kt)("p",null,"Gebruik niet ",(0,i.kt)("em",{parentName:"p"},"alleen")," een class name om duidelijk te maken dat de link verwijst naar de huidige pagina."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<a href="/">Home</a> \u203a <a href="/nieuws/">Nieuws</a> \u203a\n<a href="/nieuws/burgemeester" class="current">Nieuwe burgemeester</a>\n')),(0,i.kt)("p",null,"Gebruik altijd ",(0,i.kt)("inlineCode",{parentName:"p"},"aria-current")," om de informatie beschikbaar te maken aan de browser en tools:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<a href="/">Home</a> \u203a <a href="/nieuws/">Nieuws</a> \u203a\n<a href="/nieuws/burgemeester" class="current" aria-current="page">Nieuwe burgemeester</a>\n')),(0,i.kt)("h3",{id:"onnodige-link-naar-huidige-pagina"},"Onnodige link naar huidige pagina"),(0,i.kt)("p",null,"Niet goed: een link naar de homepage plaatsen op de homepage zelf. Op andere pagina's is het natuurlijk wel handig om het logo een link te maken."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<header>\n  <a href="/">\n    <img class="utrecht-logo" src="/logo.svg" alt="Keuringsdienst van waarde" />\n  </a>\n</header>\n<h1>Home</h1>\n')),(0,i.kt)("p",null,"Wel goed: logo zonder link op de homepage."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<header>\n  <img class="utrecht-logo" src="/logo.svg" alt="Keuringsdienst van waarde" />\n</header>\n<h1>Home</h1>\n')),(0,i.kt)("h3",{id:"link-zonder-href-attribuut"},"Link zonder ",(0,i.kt)("inlineCode",{parentName:"h3"},"href")," attribuut"),(0,i.kt)("p",null,"Niet goed: een link zonder ",(0,i.kt)("inlineCode",{parentName:"p"},"href")," attribuut is niet ",(0,i.kt)("em",{parentName:"p"},"focusable"),", waardoor je de link niet kan activeren."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},"<a onclick=\"navigate('/step-1')\">Vorige</a>\n")),(0,i.kt)("h2",{id:"referenties"},"Referenties"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.interaction-design.org/literature/article/tips-for-better-hyperlink-ux"},(0,i.kt)("em",{parentName:"a"},"Tips for Better Hyperlink UX"),", door de Interaction Design Foundation"),": waarom 'klik hier' niet werkt."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://blog.prototypr.io/a-guide-to-designing-perfect-links-in-ux-414558f35730"},(0,i.kt)("em",{parentName:"a"},"A comprehensive guide to designing perfect links in UX"),", op Prototypr"),": best practices rondom links."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://uxplanet.org/dos-and-don-ts-of-web-design-8c9d6a5de7c6"},(0,i.kt)("em",{parentName:"a"},"Do\u2019s and Don\u2019ts of Web Design")," van UX Planet"),": interessante do's en don'ts over Web Design, onder andere over links."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.nngroup.com/articles/writing-links/"},(0,i.kt)("em",{parentName:"a"},"Writing Hyperlinks: Salient, Descriptive, Start with Keyword")," door Norman Nielsen Group"),": hoe schrijf je goede links? Een uitgebreid artikel over links."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://wunder.io/wunderpedia/accessibility/accessible-uis/hover-focus-active/"},(0,i.kt)("em",{parentName:"a"},"Hover, focus, active"),", door Wunder"),": goede uitleg over de states die elementen zoals de link en button hebben in browsers."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.nngroup.com/articles/guidelines-for-visualizing-links/"},(0,i.kt)("em",{parentName:"a"},"Guidelines for Visualizing Links"),", door Nielsen Normal Group"),": richtlijnen voor het design van links."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/a"},"MDN: ",(0,i.kt)("inlineCode",{parentName:"a"},"<a>"),": The Anchor element"),": uitgebreid overzicht van alle mogelijkheden van links in HTML.")),(0,i.kt)("h3",{id:"relevante-wcag-regels"},"Relevante WCAG regels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.w3.org/TR/WCAG21/#use-of-color"},"WCAG 1.4.1"),": een link is niet voor iedereen duidelijk herkenbaar wanneer je alleen kleur gebruikt. Gebruik ook onderstreping om de link duidelijk te maken."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.w3.org/TR/WCAG21/#contrast-minimum"},"WCAG 1.4.3")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.w3.org/TR/WCAG21/#link-purpose-in-context"},"WCAG 2.4.4")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.w3.org/TR/WCAG21/#label-in-name"},"WCAG 2.5.3")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.w3.org/TR/WCAG21/#language-of-parts"},"WCAG 3.1.2"))))}u.isMDXComponent=!0;const c={toc:[{value:"Design beslissingen",id:"design-beslissingen",level:2},{value:"Tekstlink",id:"tekstlink",level:2},{value:"Ankerlinks",id:"ankerlinks",level:2},{value:"Link met pijl",id:"link-met-pijl",level:3},{value:"Linklijst",id:"linklijst",level:2},{value:"Top navigatie link",id:"top-navigatie-link",level:2},{value:"Side navigatie link",id:"side-navigatie-link",level:2},{value:"Call-to-action button",id:"call-to-action-button",level:2},{value:"Top taak button",id:"top-taak-button",level:2},{value:"Headings als link",id:"headings-als-link",level:2},{value:"Telefoonnummer link",id:"telefoonnummer-link",level:2},{value:"Accordion link",id:"accordion-link",level:2},{value:"Link Card",id:"link-card",level:2}]},f="wrapper";function d(e){let{components:t,...n}=e;return(0,i.kt)(f,(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"soorten-links"},"Soorten links"),(0,i.kt)("p",null,"Er is een aantal verschillende soorten links in het Design System te vinden:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Tekstlinks"),(0,i.kt)("li",{parentName:"ul"},"Ankerlinks"),(0,i.kt)("li",{parentName:"ul"},"Links met pijl"),(0,i.kt)("li",{parentName:"ul"},"Linklijst"),(0,i.kt)("li",{parentName:"ul"},"Top navigatie link"),(0,i.kt)("li",{parentName:"ul"},"Side navigatie link"),(0,i.kt)("li",{parentName:"ul"},"CTA Button"),(0,i.kt)("li",{parentName:"ul"},"Top taak button"),(0,i.kt)("li",{parentName:"ul"},"Heading als link"),(0,i.kt)("li",{parentName:"ul"},"Telefoonnummer link"),(0,i.kt)("li",{parentName:"ul"},"Accordion link"),(0,i.kt)("li",{parentName:"ul"},"Link cards (wordt ingevuld als component gebouwd wordt)")),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null}),(0,i.kt)("th",{parentName:"tr",align:null},"Tekst link"),(0,i.kt)("th",{parentName:"tr",align:null},"Link met pijl"),(0,i.kt)("th",{parentName:"tr",align:null},"Ankerlinks"),(0,i.kt)("th",{parentName:"tr",align:null},"Linklijst"),(0,i.kt)("th",{parentName:"tr",align:null},"Top navigatie link"),(0,i.kt)("th",{parentName:"tr",align:null},"Side bar navigatie link"),(0,i.kt)("th",{parentName:"tr",align:null},"CTA Button link"),(0,i.kt)("th",{parentName:"tr",align:null},"Top taak button"),(0,i.kt)("th",{parentName:"tr",align:null},"Headings that are links"),(0,i.kt)("th",{parentName:"tr",align:null},"Tel nummer link"),(0,i.kt)("th",{parentName:"tr",align:null},"Accordion link"),(0,i.kt)("th",{parentName:"tr",align:null},"Link cards"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},":active"),(0,i.kt)("td",{parentName:"tr",align:null},"onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null},"niet onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null},"onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null},"niet onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null},"niet onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null},"niet onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null},"niet onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null},"niet onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null},"onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null},"onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null},"niet onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},":hover kleur"),(0,i.kt)("td",{parentName:"tr",align:null},"kleur veranderd"),(0,i.kt)("td",{parentName:"tr",align:null},"kleur veranderd"),(0,i.kt)("td",{parentName:"tr",align:null},"kleur veranderd"),(0,i.kt)("td",{parentName:"tr",align:null},"kleur veranderd"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"kleur lichter"),(0,i.kt)("td",{parentName:"tr",align:null},"kleur veranderd"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},":hover achtergrondkleur"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"achtergrond kleur lichter"),(0,i.kt)("td",{parentName:"tr",align:null},"achtergrond kleur lichter"),(0,i.kt)("td",{parentName:"tr",align:null},"achtergrond kleur lichter"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"achtergrond kleur lichter"),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},":hover onderstreping"),(0,i.kt)("td",{parentName:"tr",align:null},"dikkere onderstreping"),(0,i.kt)("td",{parentName:"tr",align:null},"dikke onderstreping"),(0,i.kt)("td",{parentName:"tr",align:null},"dikkere onderstreping"),(0,i.kt)("td",{parentName:"tr",align:null},"dikkere onderstreping"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"dikkere onderstreping"),(0,i.kt)("td",{parentName:"tr",align:null},"onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},":hover grootte"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"formaat 1.2 keer groter"),(0,i.kt)("td",{parentName:"tr",align:null},"formaat 1.2 keer groter"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},":focus outline"),(0,i.kt)("td",{parentName:"tr",align:null},"dotted outline"),(0,i.kt)("td",{parentName:"tr",align:null},"dotted outline"),(0,i.kt)("td",{parentName:"tr",align:null},"dotted outline"),(0,i.kt)("td",{parentName:"tr",align:null},"dotted outline"),(0,i.kt)("td",{parentName:"tr",align:null},"dotted outline"),(0,i.kt)("td",{parentName:"tr",align:null},"dotted outline"),(0,i.kt)("td",{parentName:"tr",align:null},"dotted outline"),(0,i.kt)("td",{parentName:"tr",align:null},"dotted outline"),(0,i.kt)("td",{parentName:"tr",align:null},"dotted outline"),(0,i.kt)("td",{parentName:"tr",align:null},"dotted outline"),(0,i.kt)("td",{parentName:"tr",align:null},"dotted outline"),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},":focus onderstreping"),(0,i.kt)("td",{parentName:"tr",align:null},"onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"niet onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"niet onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null})))),(0,i.kt)("h2",{id:"design-beslissingen"},"Design beslissingen"),(0,i.kt)("p",null,"We maken de volgende design beslissingen over links:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Links zijn onderstreept om een gebruiker snel en duidelijk te laten zien dat het een link is."),(0,i.kt)("li",{parentName:"ul"},"Bij een hover krijgt een link in de tekst een dikkere onderstreping om duidelijk aan te geven dat de link onder de muisknop zit."),(0,i.kt)("li",{parentName:"ul"},"Bij een hover maken we het component groter als het component een border of een achtergrondkleur heeft zodat je visuele feedback hebt van je hover zonder dat je een onderstreping ziet. De accordion en de hoofdnavigatie zijn de uitzondering op deze regel, maar deze krijgen wel weer een onderstreping."),(0,i.kt)("li",{parentName:"ul"},"Bij een focus krijgt een component een gestippelde outline. Er is geen visuele feedback van de muis met een hover, dus op deze manier geven we aan dat dit component is geselecteerd."),(0,i.kt)("li",{parentName:"ul"},"De gestippelde outline van de focus bestaat uit zwarte en witte puntjes zodat er altijd genoeg contrast is en dus niet afhankelijk is van de achtergrond kleur."),(0,i.kt)("li",{parentName:"ul"},"We houden de visuele weergave van de focus state en de hover state strict van elkaar gescheiden zodat beide states een eigen unieke ervaring hebben, ook al is de bezoeker hier niet actief mee bezig."),(0,i.kt)("li",{parentName:"ul"},"Een link die nog niet onderstreept is krijgt bij een hover state juist wel een onderstreping om aan te geven dat je er op kan klikken.")),(0,i.kt)("h2",{id:"tekstlink"},"Tekstlink"),(0,i.kt)("p",null,"Tekstlinks zijn standaard donkerblauw en onderstreept. In sommige gevallen zijn tekstlinks zwart of wit. Dit geldt bij teksten op een gekleurde achtergrond, waar blauw niet voldoende contrast biedt. De link tekst is andere kleur blauw in hover state De link tekst is onderstreept in hover state maar niet in focus state, een eventueel icon is niet onderstreept"),(0,i.kt)("h2",{id:"ankerlinks"},"Ankerlinks"),(0,i.kt)("p",null,"Ankerlinks worden gebruikt om te navigeren naar specifieke content op de pagina. Ankerlinks staan boven de content waar ze naar verwijzen, komen alleen voor op contentpagina\u2019s en worden gebruikt als opsomming. Ankerlinks zijn worden veel gebruikt als een soort inhoudsopgave van de pagina.\nAnkerlinks zijn blauw, onderstreept en hebben een rood bolletje als voorloopteken."),(0,i.kt)("h3",{id:"link-met-pijl"},"Link met pijl"),(0,i.kt)("p",null,"Links met een pijl als voorloopteken worden gebruikt aan het einde van een tekst. Ze verwijzen naar gerelateerde informatie over het onderwerp wat er in de voorafgaande tekst is besproken. De links zijn dik gedrukt en niet onderstreept."),(0,i.kt)("h2",{id:"linklijst"},"Linklijst"),(0,i.kt)("p",null,"Lijklijsten hebben een pijl als voorloopteken worden gebruikt aan het einde van een tekst. Ze verwijzen naar gerelateerde informatie over het onderwerp wat er in de voorafgaande tekst is besproken. De links zijn donkerblauw, bold en hebben een pijl (>) als voorloopteken. Dit type link wordt ook gebruikt in de linklijst en de subnavigatie."),(0,i.kt)("p",null,"Bij een variant van de linklijsten is de pijl zwart (#000) in plaats van donkerblauw. Deze link wordt gebruikt in de linklijsten \u2018related\u2019 die verwijzen naar gerelateerde content onderaan een contentpagina."),(0,i.kt)("h2",{id:"top-navigatie-link"},"Top navigatie link"),(0,i.kt)("p",null,"De top navigatie link is onderdeel van de top navigatiebalk die wordt gebruikt als hoofdnavigatie en die de gebruiker moet helpen te navigeren door de site."),(0,i.kt)("h2",{id:"side-navigatie-link"},"Side navigatie link"),(0,i.kt)("p",null,"De side navigatie link is onderdeel van het metromenu die wordt gebruikt om te kunnen navigeren door een onderdeel van de site."),(0,i.kt)("h2",{id:"call-to-action-button"},"Call-to-action button"),(0,i.kt)("p",null,"De Call-to-action button vertelt de gebruiker een actie uit te voeren."),(0,i.kt)("h2",{id:"top-taak-button"},"Top taak button"),(0,i.kt)("p",null,"De Top taak button is onderdeel van een set aan top taken die de gebruiker helpt bij navigeren door de meest gebruikte taken van de site duidelijk aan te bieden."),(0,i.kt)("h2",{id:"headings-als-link"},"Headings als link"),(0,i.kt)("p",null,"Soms zijn headers een link."),(0,i.kt)("h2",{id:"telefoonnummer-link"},"Telefoonnummer link"),(0,i.kt)("p",null,"De telefoonnummer link stelt gebruikers in staat vanaf de website direct met de gemeente te bellen."),(0,i.kt)("h2",{id:"accordion-link"},"Accordion link"),(0,i.kt)("p",null,"Accordions geven overzicht door content achter een klik zichtbaar te maken."),(0,i.kt)("h2",{id:"link-card"},"Link Card"),(0,i.kt)("p",null,"Wordt ingevuld als component gebouwd wordt."))}d.isMDXComponent=!0;const h={title:"Link",hide_title:!0,hide_table_of_contents:!1,sidebar_label:"Link",sidebar_position:1,pagination_label:"Link",description:"Utrecht Link component.",keywords:["link","links","hyperlink","interactie","anker","ankerlink","navigatie","sitenavigatie","tekstlink"]},p=void 0,m={unversionedId:"componenten/typografie/link",id:"componenten/typografie/link",title:"Link",description:"Utrecht Link component.",source:"@site/docs/componenten/typografie/link.mdx",sourceDirName:"componenten/typografie",slug:"/componenten/typografie/link",permalink:"/utrecht/docs/componenten/typografie/link",draft:!1,editUrl:"https://github.com/nl-design-system/utrecht/tree/main/documentation/docs/componenten/typografie/link.mdx",tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"Link",hide_title:!0,hide_table_of_contents:!1,sidebar_label:"Link",sidebar_position:1,pagination_label:"Link",description:"Utrecht Link component.",keywords:["link","links","hyperlink","interactie","anker","ankerlink","navigatie","sitenavigatie","tekstlink"]},sidebar:"components",previous:{title:"Heading",permalink:"/utrecht/docs/componenten/typografie/heading"},next:{title:"Paragraaf",permalink:"/utrecht/docs/componenten/typografie/paragraaf"}},g={},y=[{value:"UX Richtlijnen",id:"ux-richtlijnen",level:2},{value:"Soorten links",id:"soorten-links",level:2},{value:"Link Component",id:"link-component",level:2},{value:"Standaard",id:"standaard",level:3},{value:"Email",id:"email",level:3},{value:"Telefoon",id:"telefoon",level:3},{value:"Externe link",id:"externe-link",level:3},{value:"Met icoon links",id:"met-icoon-links",level:3},{value:"Voor wisselen taal link",id:"voor-wisselen-taal-link",level:3}],v={toc:y},b="wrapper";function x(e){let{components:t,...n}=e;return(0,i.kt)(b,(0,r.Z)({},v,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"{/",(0,i.kt)("em",{parentName:"p"}," @license CC0-1.0 "),"/}"),(0,i.kt)("h1",{id:"link"},"Link"),(0,i.kt)("h2",{id:"ux-richtlijnen"},"UX Richtlijnen"),(0,i.kt)("p",null,"Links helpen je gebruiker te navigeren door je app of pagina."),(0,i.kt)(o.U,{headingLevel:2,omitH1:!0,mdxType:"Markdown"},(0,i.kt)(u,{mdxType:"UXGuidelines"})),(0,i.kt)("h2",{id:"soorten-links"},"Soorten links"),(0,i.kt)(o.U,{headingLevel:3,omitH1:!0,mdxType:"Markdown"},(0,i.kt)(d,{mdxType:"SoortenLinks"})),(0,i.kt)("h2",{id:"link-component"},"Link Component"),(0,i.kt)("h3",{id:"standaard"},"Standaard"),(0,i.kt)(a.U,{tabs:[{id:"html",label:"HTML",story:"html-link--default-story"},{id:"css",label:"CSS",story:"css-link--default-story"}],mdxType:"StoryTabs"}),(0,i.kt)("h3",{id:"email"},"Email"),(0,i.kt)(a.U,{tabs:[{id:"html",label:"HTML",story:"html-link--email"},{id:"css",label:"CSS",story:"css-link--email"}],mdxType:"StoryTabs"}),(0,i.kt)("h3",{id:"telefoon"},"Telefoon"),(0,i.kt)(a.U,{tabs:[{id:"html",label:"HTML",story:"html-link--telephone"},{id:"css",label:"CSS",story:"css-link--telephone"}],mdxType:"StoryTabs"}),(0,i.kt)("h3",{id:"externe-link"},"Externe link"),(0,i.kt)(a.U,{tabs:[{id:"html",label:"HTML",story:"html-link--external"},{id:"css",label:"CSS",story:"css-link--external"}],mdxType:"StoryTabs"}),(0,i.kt)("h3",{id:"met-icoon-links"},"Met icoon links"),(0,i.kt)(a.U,{tabs:[{id:"css",label:"CSS",story:"css-link--icon-left"}],mdxType:"StoryTabs"}),(0,i.kt)("h3",{id:"voor-wisselen-taal-link"},"Voor wisselen taal link"),(0,i.kt)("p",null,"Als de taal een andere is dan het huidige document"),(0,i.kt)(a.U,{tabs:[{id:"html",label:"HTML",story:"html-link--alternate-lang"},{id:"css",label:"CSS",story:"css-link--alternate-lang"}],mdxType:"StoryTabs"}),(0,i.kt)("p",null,"Als de taal dezelfde taal is als het huidige document"),(0,i.kt)(a.U,{tabs:[{id:"html",label:"HTML",story:"html-link--current-lang"},{id:"css",label:"CSS",story:"css-link--current-lang"}],mdxType:"StoryTabs"}))}x.isMDXComponent=!0}}]);