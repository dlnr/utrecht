/*! For license information please see 0fda66b8.8db3be66.js.LICENSE.txt */
"use strict";(self.webpackChunk_utrecht_docusaurus=self.webpackChunk_utrecht_docusaurus||[]).push([[901],{4733:(e,t,n)=>{n.d(t,{Cd:()=>un,GS:()=>Zn,SC:()=>Fi,XJ:()=>Ht,Z0:()=>zr,aC:()=>Xt,by:()=>on,iA:()=>si,k8:()=>en,nL:()=>Ut,nv:()=>yr,pj:()=>bi,xs:()=>$i});var r=n(520),i=n(1460),o=n(8035),a=n(2983),s=n(7458),l=n(4517),u=(n(2795),n(4749),n(1806),["appearance","busy","disabled","children","className","hint","pressed","type"]);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d=(0,a.forwardRef)((function(e,t){var n=e.appearance,r=e.busy,o=e.disabled,a=e.children,c=e.className,d=e.hint,h=e.pressed,p=e.type,m=(0,i.Z)(e,u);return(0,s.jsx)("button",f(f({ref:t,className:(0,l.Z)("utrecht-button",r&&"utrecht-button--busy",o&&"utrecht-button--disabled","submit"===p&&"utrecht-button--submit","primary-action-button"===n&&"utrecht-button--primary-action","secondary-action-button"===n&&"utrecht-button--secondary-action","subtle-button"===n&&"utrecht-button--subtle","danger"===d&&"utrecht-button--danger","warning"===d&&"utrecht-button--warning","ready"===d&&"utrecht-button--ready",!0===h&&"utrecht-button--pressed",c),"aria-busy":r||void 0,"aria-pressed":"boolean"==typeof h?h:void 0,disabled:o,type:p||"button"},m),{},{children:a}))}));d.displayName="Button";var h=["appearance","className","level"];function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g=(0,a.forwardRef)((function(e,t){var n=e.appearance,r=e.className,o=e.level,a=(0,i.Z)(e,h),u=["utrecht-heading-1","utrecht-heading-2","utrecht-heading-3","utrecht-heading-4","utrecht-heading-5","utrecht-heading-6"],c=2===o?"h2":3===o?"h3":4===o?"h4":5===o?"h5":6===o?"h6":"h1",f=n&&-1!==u.indexOf(n)?n:u[o-1]||"utrecht-heading-1";return(0,s.jsx)(c,m(m({className:(0,l.Z)(f,r)},a),{},{ref:t}))}));g.displayName="Heading";var y=["children","group","headingLevel","heading"];function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var x=(0,a.forwardRef)((function(e,t){var n=e.id,r=e.label,i=e.headingLevel,o=void 0===i?1:i,u=e.expanded,c=void 0!==u&&u,f=e.disabled,h=e.section,p=e.children,m=e.buttonRef,y=e.onActivate,v=e.onButtonBlur,x=e.onButtonFocus,w={className:(0,l.Z)("utrecht-accordion__panel",{"utrecht-accordion__panel--expanded":c}),hidden:!c,"aria-hidden":!c},k="utrecht-accordion",_=n||(0,a.useId)(),O="".concat(k).concat(_,"-button"),E="".concat(k).concat(_,"-panel");return(0,s.jsxs)("div",{className:(0,l.Z)("utrecht-accordion__section"),id:n,ref:t,children:[(0,s.jsx)(g,{level:o,className:(0,l.Z)("utrecht-accordion__header"),children:(0,s.jsx)(d,{className:(0,l.Z)("utrecht-accordion__button"),appearance:"subtle-button","aria-expanded":!0===c,"aria-controls":E,disabled:f,id:O,onClick:function(){return"function"==typeof y&&y(t)},onFocus:function(){return"function"==typeof x&&x(t)},onBlur:function(){return"function"==typeof v&&v(t)},ref:m,children:r})}),h?(0,s.jsx)("section",b(b({id:E,"aria-labelledby":O},w),{},{children:p})):(0,s.jsx)("div",b(b({},w),{},{children:p}))]})}));x.displayName="AccordionSection";var w=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.group,o=e.headingLevel,u=e.heading,c=(0,i.Z)(e,y),f=(0,a.useId)();return(0,s.jsxs)(s.Fragment,{children:[!!u&&"number"==typeof o&&(0,s.jsx)(g,{level:o,children:u}),(0,s.jsx)("div",b(b({className:(0,l.Z)("utrecht-accordion"),role:r?"group":void 0,"aria-labelledby":r?f:void 0},c),{},{ref:t,children:n}))]})}));w.displayName="Accordion";(function(e){var t=e.sections,n=(0,a.useRef)(null),i=function(e,t){console.log("useAccordion");var n=e.map((function(e){return(0,a.useRef)(null)})),r=e.map((function(e){return(0,a.useRef)(null)}));return{ref:t,refs:n,buttonRefs:r,activeElement:null,sections:e,focusNextSection:function(e){var t,i,o,a,s=n.indexOf(e),l=s>=0?r[s]:void 0,u=l?(i=r,(a=(o=l)?i.indexOf(o):-1)>=0&&a+1<=i.length-1?i[a+1]:void 0):void 0;null==u||null===(t=u.current)||void 0===t||t.focus()},focusFirstSection:function(){var e,t,i=(t=r).length>=1?t[0]:void 0;console.log(n),null==i||null===(e=i.current)||void 0===e||e.focus()},focusPreviousSection:function(e){var t,i,o,a,s=n.indexOf(e),l=s>=0?r[s]:void 0,u=l?(i=r,(a=(o=l)?i.indexOf(o):-1)>=0&&a-1<=i.length-1?i[a-1]:void 0):void 0;null==u||null===(t=u.current)||void 0===t||t.focus()},focusLastSection:function(){var e,t,n=(t=r).length>=1?t[t.length-1]:void 0;null==n||null===(e=n.current)||void 0===e||e.focus()}}}(t,n),o=i.refs,l=i.buttonRefs,u=i.focusNextSection,c=i.focusFirstSection,f=i.focusLastSection,d=i.focusPreviousSection,h=(0,a.useState)(null),p=(0,r.Z)(h,2),m=p[0],g=p[1],y=(0,a.useState)(t),v=(0,r.Z)(y,2),k=v[0],_=v[1],O=function(e){g(e)},E=function(e){g(null)};return(0,s.jsx)(w,{onKeyDown:function(e){if("End"===e.code)f();else if("Home"===e.code)c();else if("ArrowDown"===e.code)m&&u(m);else{if("ArrowUp"!==e.code)return;m&&d(m)}e.preventDefault()},ref:n,children:k.map((function(e,t){return(0,a.createElement)(x,b(b({},e),{},{ref:o[t],buttonRef:l[t],key:t,onButtonFocus:O,onButtonBlur:E,onActivate:function(e){var t=o.indexOf(e);_(k.map((function(e,n){return n===t?b(b({},e),{},{expanded:!e.expanded}):e})))}}),e.body)}))})}).displayName="AccordionProvider";var k=["children","className","icon","type"];function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.icon,a=e.type,u=(0,i.Z)(e,k);return(0,s.jsxs)("div",O(O({},u),{},{ref:t,className:(0,l.Z)("utrecht-alert",{"utrecht-alert--error":"error"===a,"utrecht-alert--info":"info"===a,"utrecht-alert--ok":"ok"===a,"utrecht-alert--warning":"warning"===a},r),children:[o&&(0,s.jsx)("div",{className:"utrecht-alert__icon",children:o}),(0,s.jsx)("div",{className:"utrecht-alert__message",children:n})]}))}));E.displayName="Alert";var D=["children","className","icon","type"];function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.icon,a=e.type,u=(0,i.Z)(e,D);return(0,s.jsxs)("dialog",N(N({},u),{},{ref:t,className:(0,l.Z)("utrecht-alert-dialog",{"utrecht-alert-dialog--error":"error"===a,"utrecht-alert-dialog--info":"info"===a,"utrecht-alert-dialog--warning":"warning"===a,className:r}),children:[o&&(0,s.jsx)("div",{className:"utrecht-alert-dialog__icon",children:o}),(0,s.jsx)("div",{className:"utrecht-alert-dialog__message",children:n})]}))}));S.displayName="AlertDialog";var A=["children","className"];function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var M=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,A);return(0,s.jsx)("article",C(C({},o),{},{ref:t,className:(0,l.Z)("utrecht-article",r),children:n}))}));M.displayName="Article";var P=["children","className"];function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var z=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,P);return(0,s.jsx)("div",T(T({},o),{},{ref:t,className:(0,l.Z)("utrecht-backdrop",r),children:n}))}));z.displayName="Backdrop";var R=["children","className","value"];function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.value,a=(0,i.Z)(e,R),u=B({children:n,className:(0,l.Z)("utrecht-badge-counter",r)},a);return void 0!==o?(0,s.jsx)("data",B(B({},u),{},{value:o,ref:t})):(0,s.jsx)("span",B(B({},u),{},{ref:t}))}));I.displayName="BadgeCounter";var U=["children","className"];function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Z=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,U);return(0,s.jsx)("div",W(W({},o),{},{ref:t,className:(0,l.Z)("utrecht-badge-list",r),children:n}))}));Z.displayName="BadgeList";var H=["boxContent","children","className","external","href","placeholder","role"];function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Y=(0,a.forwardRef)((function(e,t){var n=e.boxContent,r=e.children,o=e.className,a=e.external,u=e.href,c=e.placeholder,f=e.role,d=(0,i.Z)(e,H);return(0,s.jsx)("a",V(V({href:c?void 0:u,ref:t,role:f||(c?"link":void 0),className:(0,l.Z)("utrecht-link",{"utrecht-link--box-content":n,"utrecht-link--external":a,"utrecht-link--placeholder":c},o),"aria-disabled":c?"true":void 0,rel:a?"external noopener noreferrer":void 0},d),{},{children:r}))}));Y.displayName="Link";var X=["appearance","children","className","headingLevel","label"];function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var K=function(e){var t=e.prop;return{itemScope:!0,itemType:e.type,itemProp:t}},ee=function(e){return{itemProp:e}},te=(0,a.forwardRef)((function(e,t){var n=e.appearance,r=e.children,o=e.className,u=e.headingLevel,c=void 0===u?2:u,f=e.label,d=(0,i.Z)(e,X),h=f?(0,a.useId)():void 0;return(0,s.jsxs)("nav",Q(Q({},d),{},{ref:t,className:(0,l.Z)("utrecht-breadcrumb",{"utrecht-breadcrumb--arrows":"arrows"===n},o),"aria-labelledby":h,children:[f&&(0,s.jsx)(g,{id:h,className:"utrecht-breadcrumb__heading",level:c,"aria-hidden":"true",children:f}),(0,s.jsx)("ol",Q(Q({className:"utrecht-breadcrumb__list"},K({type:"https://schema.org/BreadcrumbList"})),{},{children:r}))]}))}));te.displayName="BreadcrumbNav";var ne=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.current,i=e.href,o=e.index,a=e.rel;return(0,s.jsx)("li",Q(Q({className:"utrecht-breadcrumb__item"},K({type:"https://schema.org/ListItem",prop:"itemListElement"})),{},{children:(0,s.jsxs)(Y,Q(Q({className:"utrecht-breadcrumb__link",href:i,rel:a,"aria-current":r&&"location"},ee("item")),{},{ref:t,children:[(0,s.jsx)("span",Q(Q({className:"utrecht-breadcrumb__text"},ee("name")),{},{children:n})),"number"==typeof o?(0,s.jsx)("meta",Q(Q({},ee("position")),{},{content:String(o+1)})):null]}))}))}));ne.displayName="BreadcrumbLink";var re=["children","className"];function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ae=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,re);return(0,s.jsx)("p",oe(oe({},o),{},{ref:t,className:(0,l.Z)("utrecht-button-group",r),children:n}))}));ae.displayName="ButtonGroup";var se=["appearance","children","className","external","href","placeholder","role"];function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ce=function(e){var t;" "===e.key&&"function"==typeof(null===(t=e.target)||void 0===t?void 0:t.click)&&(e.preventDefault(),e.target.click())},fe=(0,a.forwardRef)((function(e,t){var n=e.appearance,r=e.children,o=e.className,a=e.external,u=e.href,c=e.placeholder,f=e.role,d=(0,i.Z)(e,se),h=d;return"button"===f&&(h=ue(ue({},d),{},{onKeyDown:ce})),(0,s.jsx)("a",ue(ue({href:c?void 0:u,ref:t,role:f||(c?"link":void 0),className:(0,l.Z)("utrecht-button-link","utrecht-button-link--html-a",{"utrecht-button-link--external":a,"utrecht-button-link--primary-action":"primary-action-button"===n,"utrecht-button-link--secondary-action":"secondary-action-button"===n,"utrecht-button-link--subtle":"subtle-button"===n,"utrecht-button-link--placeholder":c},o),rel:a?"external noopener noreferrer":void 0,"aria-disabled":c?"true":void 0},h),{},{children:r}))}));fe.displayName="ButtonLink";var de=["appearance","disabled","invalid","required","className"];function he(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?he(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):he(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var me=(0,a.forwardRef)((function(e,t){var n=e.appearance,r=void 0===n?"custom":n,o=e.disabled,a=e.invalid,u=e.required,c=e.className,f=(0,i.Z)(e,de);return(0,s.jsx)("input",pe(pe({},f),{},{ref:t,type:"checkbox",className:(0,l.Z)("utrecht-checkbox","utrecht-checkbox--html-input",{"utrecht-checkbox--disabled":o,"utrecht-checkbox--custom":"custom"===r,"utrecht-checkbox--invalid":a,"utrecht-checkbox--required":u},c),"aria-invalid":a||void 0,disabled:o,required:u}))}));me.displayName="Checkbox";var ge=["children","className"];function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var be=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,ge);return(0,s.jsx)("code",ve(ve({ref:t,className:(0,l.Z)("utrecht-code",r)},o),{},{children:n}))}));be.displayName="Code";var xe=["children","className"];function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _e=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,xe);return(0,s.jsx)("pre",ke(ke({ref:t,className:(0,l.Z)("utrecht-code-block",r)},o),{},{children:(0,s.jsx)("code",{className:"utrecht-code-block__content",children:n})}))}));_e.displayName="CodeBlock";var Oe=["children","className","color","style"];function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function De(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var je=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.color,a=e.style,u=(0,i.Z)(e,Oe);return(0,s.jsx)("data",De(De({ref:t,className:(0,l.Z)("utrecht-color-sample",r),style:De(De({},a),{},{color:o}),value:o},u),{},{children:n}))}));je.displayName="ColorSample";var Ne=["children","currency","amount","locale","className"];function Se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $e=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.currency,o=void 0===r?"EUR":r,a=e.amount,u=e.locale,c=void 0===u?"nl-NL":u,f=e.className,d=(0,i.Z)(e,Ne),h="string"==typeof a?parseFloat(a):a,p=function(e,t,n){return new Intl.NumberFormat(e,{style:"currency",currency:t,minimumFractionDigits:Number.isInteger(n)?0:void 0,useGrouping:!1}).format(n).replace(/[\s]+/g,"").replace("-","\u2212")}(c,o,h),m=function(e,t,n){var r=new Intl.NumberFormat(e,{style:"currency",currency:t}).format(n);return r=r.replace(/-/,"\u2212"),"nl"!==e&&"nl-NL"!==e||!/\u2212/.test(r)||(r=r.replace(/(.+)\u2212(.+)/,"\u2212 $1$2")),r.replace(/ /g,"\xa0")}(c,o,h);return(0,s.jsx)("data",Ae(Ae({},d),{},{ref:t,value:"".concat(o," ").concat(a),className:(0,l.Z)("utrecht-currency-data",h<0&&"utrecht-currency-data--negative",h>0&&"utrecht-currency-data--positive",f),"aria-label":p,children:n||m}))}));$e.displayName="CurrencyData";var Ce=["children","className","dateTime","value"];function Me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Me(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Fe=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.dateTime,a=e.value,u=(0,i.Z)(e,Ce),c=Pe({children:n,className:(0,l.Z)("utrecht-badge-data",r)},u);return void 0!==o?(0,s.jsx)("time",Pe(Pe({},c),{},{dateTime:o,ref:t})):void 0!==a?(0,s.jsx)("data",Pe(Pe({},c),{},{value:a,ref:t})):(0,s.jsx)("span",Pe(Pe({},c),{},{ref:t}))}));Fe.displayName="DataBadge";var Te=["children","className"];function ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ze(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Le=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Te);return(0,s.jsx)("div",Re(Re({},o),{},{ref:t,className:(0,l.Z)("utrecht-document",r),children:n}))}));Le.displayName="Document";var Be=["appearance","children","className"],Ie=["children","className"],Ue=["children","className"],qe=["children","className"];function We(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?We(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):We(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var He=(0,a.forwardRef)((function(e,t){var n=e.appearance,r=e.children,o=e.className,a=(0,i.Z)(e,Be);return(0,s.jsx)("dl",Ze(Ze({},a),{},{className:(0,l.Z)("utrecht-data-list","utrecht-data-list--html-dl","rows"===n&&"utrecht-data-list--rows",o),ref:t,children:r}))}));He.displayName="DataList";var Ge=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Ie);return(0,s.jsx)("div",Ze(Ze({},o),{},{className:(0,l.Z)("utrecht-data-list__item",r),ref:t,children:n}))}));Ge.displayName="DataListItem";var Ve=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Ue);return(0,s.jsx)("dt",Ze(Ze({},o),{},{className:(0,l.Z)("utrecht-data-list__item-key",r),ref:t,children:n}))}));Ve.displayName="DataListKey";var Ye=(0,a.forwardRef)((function(e,t){var n=e.value,r=e.children,i=e.className,o=e.emptyDescription,a=e.multiline,u=e.notranslate,c=""===n||null===n;return(0,s.jsx)("dd",{className:(0,l.Z)("utrecht-data-list__item-value","utrecht-data-list__item-value--html-dd",i,a&&"utrecht-data-list__item-value--multiline"),translate:"boolean"==typeof u?u?"no":"yes":void 0,ref:t,children:c?(0,s.jsx)("span",{"aria-label":o,children:"-"}):r})}));Ye.displayName="DataListValue";var Xe=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,qe);return(0,s.jsx)("dd",Ze(Ze({},o),{},{className:(0,l.Z)("utrecht-data-list__actions","utrecht-data-list__actions--html-dd",r),ref:t,children:n}))}));Xe.displayName="DataListActions";var Je=["children","className"];function Qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qe(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var et=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Je);return(0,s.jsx)("em",Ke(Ke({ref:t,className:(0,l.Z)("utrecht-emphasis","utrecht-emphasis--stressed",r)},o),{},{children:n}))}));et.displayName="Emphasis";var tt=["aria-describedby","aria-label","aria-labelledby","className","children","disabled","form","invalid","name","role"],nt=["className","children","disabled","invalid"];function rt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function it(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rt(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ot=(0,a.forwardRef)((function(e,t){var n=e["aria-describedby"],r=e["aria-label"],o=e["aria-labelledby"],a=e.className,u=e.children,c=e.disabled,f=e.form,d=e.invalid,h=e.name,p=e.role,m=(0,i.Z)(e,tt);return(0,s.jsx)("div",it(it({},m),{},{ref:t,className:(0,l.Z)("utrecht-form-fieldset",c&&"utrecht-form-fieldset--disabled",d&&"utrecht-form-fieldset--invalid",a),children:(0,s.jsx)("fieldset",{"aria-describedby":n,"aria-label":r,"aria-labelledby":o,"aria-invalid":d||void 0,disabled:c,form:f,name:h,role:p,className:(0,l.Z)("utrecht-form-fieldset__fieldset","utrecht-form-fieldset--html-fieldset"),children:u})}))}));ot.displayName="Fieldset";var at=(0,a.forwardRef)((function(e,t){var n=e.className,r=e.children,o=e.disabled,a=e.invalid,u=(0,i.Z)(e,nt);return(0,s.jsx)("fieldset",it(it({},u),{},{ref:t,"aria-invalid":a||void 0,disabled:o,className:(0,l.Z)("utrecht-form-fieldset","utrecht-form-fieldset--html-fieldset",o&&"utrecht-form-fieldset--disabled",a&&"utrecht-form-fieldset--invalid",n),children:r}))}));at.displayName="Fieldset";var st=["className","children"];function lt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lt(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ct=(0,a.forwardRef)((function(e,t){var n=e.className,r=e.children,o=(0,i.Z)(e,st);return(0,s.jsx)("legend",ut(ut({},o),{},{ref:t,className:(0,l.Z)("utrecht-form-fieldset__legend","utrecht-form-fieldset__legend--html-legend",n),children:r}))}));ct.displayName="FieldsetLegend";var ft=["className","children"];function dt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ht(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dt(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var pt=(0,a.forwardRef)((function(e,t){var n=e.className,r=e.children,o=(0,i.Z)(e,ft);return(0,s.jsx)("figure",ht(ht({},o),{},{ref:t,className:(0,l.Z)("utrecht-figure",n),children:r}))}));pt.displayName="Figure";var mt=["className","children"];function gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gt(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var vt=(0,a.forwardRef)((function(e,t){var n=e.className,r=e.children,o=(0,i.Z)(e,mt);return(0,s.jsx)("figcaption",yt(yt({},o),{},{ref:t,className:(0,l.Z)("utrecht-figure__caption",n),children:r}))}));vt.displayName="FigureCaption";var bt=["className","children","invalid","type"];function xt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xt(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var kt=(0,a.forwardRef)((function(e,t){var n=e.className,r=e.children,o=e.invalid,a=e.type,u=(0,i.Z)(e,bt);return(0,s.jsx)("div",wt(wt({},u),{},{ref:t,className:(0,l.Z)("utrecht-form-field",{"utrecht-form-field--invalid":o,"utrecht-form-field--checkbox":"checkbox"===a,"utrecht-form-field--radio":"radio"===a,"utrecht-form-field--text":!a||"text"===a},n),children:r}))}));kt.displayName="FormField";var _t=["invalid","valid","warning","className","children"];function Ot(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ot(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ot(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Dt=(0,a.forwardRef)((function(e,t){var n=e.invalid,r=e.valid,o=e.warning,a=e.className,u=e.children,c=(0,i.Z)(e,_t);return(0,s.jsx)("div",Et(Et({},c),{},{ref:t,className:(0,l.Z)("utrecht-form-field-description",n&&"utrecht-form-field-description--invalid",r&&"utrecht-form-field-description--valid",o&&"utrecht-form-field-description--warning",a),children:u}))}));Dt.displayName="FormFieldDescription";var jt=["children","className","type","disabled","checked"];function Nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function St(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nt(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var At=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.type,a=e.disabled,u=e.checked,c=(0,i.Z)(e,jt);return(0,s.jsx)("label",St(St({},c),{},{ref:t,className:(0,l.Z)("utrecht-form-label",o&&"utrecht-form-label--".concat(o),a&&"utrecht-form-label--disabled",u&&"utrecht-form-label--checked",r),children:n}))}));At.displayName="FormLabel";var $t=["checked","disabled","invalid","id","hidden","required","role","tabIndex","className"];function Ct(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Mt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ct(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ct(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Pt=(0,a.forwardRef)((function(e,t){var n=e.checked,r=e.disabled,o=e.invalid,a=e.id,u=e.hidden,c=e.required,f=e.role,d=e.tabIndex,h=e.className,p=(0,i.Z)(e,$t);return(0,s.jsxs)("div",{className:(0,l.Z)("utrecht-form-toggle","utrecht-form-toggle--html-checkbox",{"utrecht-form-toggle--disabled":r,"utrecht-form-toggle--invalid":o,"utrecht-form-toggle--required":c},h),hidden:u,children:[(0,s.jsx)("input",Mt({id:a,"aria-invalid":o||void 0,type:"checkbox",className:"utrecht-form-toggle__checkbox",defaultChecked:n||void 0,disabled:r||void 0,required:c,ref:t,role:f,tabIndex:d},p)),(0,s.jsx)("label",{htmlFor:a,className:"utrecht-form-toggle__track",children:(0,s.jsx)("div",{className:"utrecht-form-toggle__thumb"})})]})}));Pt.displayName="FormToggle";var Ft=["children","className"];function Tt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tt(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Rt=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Ft);return(0,s.jsx)("div",zt(zt({},o),{},{ref:t,className:(0,l.Z)("utrecht-html",r),children:n}))}));Rt.displayName="HTMLContent";var Lt=["children","className"];function Bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function It(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bt(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ut=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Lt);return(0,s.jsx)("h1",It(It({},o),{},{ref:t,className:(0,l.Z)("utrecht-heading-1",r),children:n}))}));Ut.displayName="Heading1";var qt=["children","className"];function Wt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wt(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ht=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,qt);return(0,s.jsx)("h2",Zt(Zt({},o),{},{ref:t,className:(0,l.Z)("utrecht-heading-2",r),children:n}))}));Ht.displayName="Heading2";var Gt=["children","className"];function Vt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vt(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Xt=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Gt);return(0,s.jsx)("h3",Yt(Yt({},o),{},{ref:t,className:(0,l.Z)("utrecht-heading-3",r),children:n}))}));Xt.displayName="Heading3";var Jt=["children","className"];function Qt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qt(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var en=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Jt);return(0,s.jsx)("h4",Kt(Kt({},o),{},{ref:t,className:(0,l.Z)("utrecht-heading-4",r),children:n}))}));en.displayName="Heading4";var tn=["children","className"];function nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nn(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var on=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,tn);return(0,s.jsx)("h5",rn(rn({},o),{},{ref:t,className:(0,l.Z)("utrecht-heading-5",r),children:n}))}));on.displayName="Heading5";var an=["children","className"];function sn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ln(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sn(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var un=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,an);return(0,s.jsx)("h6",ln(ln({},o),{},{ref:t,className:(0,l.Z)("utrecht-heading-6",r),children:n}))}));un.displayName="Heading6";var cn=["children","className"];function fn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fn(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var hn=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,cn);return(0,s.jsx)("hgroup",dn(dn({},o),{},{ref:t,className:(0,l.Z)("utrecht-heading-group",r),children:n}))}));hn.displayName="HeadingGroup";var pn=["children","value","className"];function mn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mn(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var yn=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.value,o=e.className,a=(0,i.Z)(e,pn),u=r.replace(/[\s+\W]+/g,"").toUpperCase(),c=u.replace(/(.{4})(?!$)/g,"$1 ");return console.log({value:r,normalized:u,formatted:c}),(0,s.jsx)("data",gn(gn({},a),{},{ref:t,value:u,className:(0,l.Z)("utrecht-iban-data",o),translate:"no",children:n||c}))}));yn.displayName="IBANData";var vn=["children","className"];function bn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bn(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var wn=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,vn);return(0,s.jsx)("span",xn(xn({"aria-hidden":"true",ref:t,className:(0,l.Z)("utrecht-icon",r)},o),{},{children:n}))}));wn.displayName="Icon";var kn=["className","photo"];function _n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function On(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_n(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_n(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var En=(0,a.forwardRef)((function(e,t){var n=e.className,r=e.photo,o=(0,i.Z)(e,kn);return(0,s.jsx)("img",On(On({},o),{},{ref:t,className:(0,l.Z)("utrecht-img",{"utrecht-img--photo":r},n)}))}));En.displayName="Image";var Dn=["children","disabled","inline","className","pressed","type"];function jn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Nn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jn(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Sn=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.disabled,o=e.inline,a=e.className,u=e.pressed,c=e.type,f=(0,i.Z)(e,Dn);return(0,s.jsx)("button",Nn(Nn({ref:t,"aria-pressed":"boolean"==typeof u?u:void 0,className:(0,l.Z)("utrecht-link-button","utrecht-link-button--html-button",{"utrecht-link-button--disabled":r,"utrecht-link-button--inline":o,"utrecht-link-button--pressed":u},a),disabled:r,type:c||"button"},f),{},{children:n}))}));Sn.displayName="LinkButton";var An=["children","className","external"];function $n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Cn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$n(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$n(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Mn=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.external,a=(0,i.Z)(e,An);return(0,s.jsx)("a",Cn(Cn({},a),{},{ref:t,className:(0,l.Z)("utrecht-link-social",r),rel:!1!==o?"external noopener noreferrer":void 0,children:n}))}));Mn.displayName="LinkSocial";var Pn=["children","className"];function Fn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Tn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fn(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var zn=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Pn);return(0,s.jsx)("mark",Tn(Tn({ref:t,className:(0,l.Z)("utrecht-mark",r)},o),{},{children:n}))}));zn.displayName="Mark";var Rn=["children","className","value"];function Ln(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Bn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ln(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ln(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var In=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.value,a=(0,i.Z)(e,Rn);return(0,s.jsx)("data",Bn(Bn({value:"string"==typeof o||"number"==typeof o?String(o):void 0},a),{},{ref:t,className:(0,l.Z)("utrecht-value-number",r),children:n}))}));In.displayName="NumberValue";var Un=["children","className"];function qn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qn(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Zn=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Un);return(0,s.jsx)("ol",Wn(Wn({},o),{},{ref:t,className:(0,l.Z)("utrecht-ordered-list",r),children:n}))}));Zn.displayName="OrderedList";var Hn=["children","className"];function Gn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Vn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gn(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Yn=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Hn);return(0,s.jsx)("li",Vn(Vn({},o),{},{ref:t,className:(0,l.Z)("utrecht-ordered-list__item",r),children:n}))}));Yn.displayName="OrderedListItem";var Xn=["children","className"];function Jn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jn(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Kn=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Xn);return(0,s.jsx)("div",Qn(Qn({},o),{},{ref:t,className:(0,l.Z)("utrecht-page",r),children:n}))}));Kn.displayName="Page";var er=["children","className"],tr=["children","className"];function nr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nr(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ir=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,er);return(0,s.jsx)("div",rr(rr({},o),{},{ref:t,className:(0,l.Z)("utrecht-page-content",r),children:n}))}));ir.displayName="PageContent";var or=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,tr);return(0,s.jsx)("main",rr(rr({},o),{},{ref:t,className:(0,l.Z)("utrecht-page-content__main",r),children:n}))}));or.displayName="PageContentMain";var ar=["children","className"];function sr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function lr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sr(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ur=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,ar);return(0,s.jsx)("footer",lr(lr({},o),{},{ref:t,className:(0,l.Z)("utrecht-page-footer",r),children:n}))}));ur.displayName="PageFooter";var cr=["children","className"];function fr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fr(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var hr=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,cr);return(0,s.jsx)("header",dr(dr({},o),{},{ref:t,className:(0,l.Z)("utrecht-page-header",r),children:n}))}));hr.displayName="PageHeader";var pr=["children","className","lead","small"];function mr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mr(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var yr=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.lead,a=e.small,u=(0,i.Z)(e,pr);return(0,s.jsx)("p",gr(gr({},u),{},{ref:t,className:(0,l.Z)("utrecht-paragraph",o&&"utrecht-paragraph--lead",a&&"utrecht-paragraph--small",r),children:o?(0,s.jsx)("b",{className:"utrecht-paragraph__b",children:n}):a?(0,s.jsx)("small",{className:"utrecht-paragraph__small",children:n}):n}))}));yr.displayName="Paragraph";var vr=["loading","className"];function br(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var xr=(0,a.forwardRef)((function(e,t){var n=e.loading,r=e.className,a=(0,i.Z)(e,vr);return(0,s.jsx)("span",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?br(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):br(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({ref:t,className:(0,l.Z)("utrecht-data-placeholder",{"utrecht-data-placeholder--loading":n},r)},a))}));xr.displayName="DataPlaceholder";var wr=["children","className"];function kr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kr(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Or=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,wr);return(0,s.jsx)("p",_r(_r({},o),{},{ref:t,className:(0,l.Z)("utrecht-pre-heading",r),children:n}))}));Or.displayName="PreHeading";var Er=["disabled","required","className","invalid"];function Dr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var jr=(0,a.forwardRef)((function(e,t){var n=e.disabled,r=e.required,a=e.className,u=e.invalid,c=(0,i.Z)(e,Er);return(0,s.jsx)("input",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dr(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({type:"radio","aria-invalid":u||void 0,disabled:n,required:r,ref:t,className:(0,l.Z)("utrecht-radio-button","utrecht-radio-button--html-input",n&&"utrecht-radio-button--disabled",u&&"utrecht-radio-button--invalid",a)},c))}));jr.displayName="RadioButton";var Nr=["busy","invalid","required","className","noscript","children"],Sr=["disabled","invalid","value","children","className"];function Ar(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ar(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ar(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Cr=(0,a.forwardRef)((function(e,t){var n=e.busy,r=e.invalid,o=e.required,a=e.className,u=e.noscript,c=e.children,f=(0,i.Z)(e,Nr);return(0,s.jsx)("select",$r($r({"aria-busy":n||void 0,"aria-invalid":r||void 0,required:!!u&&o,"aria-required":u?void 0:o,className:(0,l.Z)("utrecht-select","utrecht-select--html-select",n&&"utrecht-select--busy",r&&"utrecht-select--invalid",o&&"utrecht-select--required",a),ref:t},f),{},{children:c}))}));Cr.displayName="Select";var Mr=(0,a.forwardRef)((function(e,t){var n=e.disabled,r=e.invalid,o=e.value,a=e.children,u=e.className,c=(0,i.Z)(e,Sr);return(0,s.jsx)("option",$r($r({},c),{},{ref:t,disabled:n,value:o,className:(0,l.Z)("utrecht-select__option",n&&"utrecht-select__option--disabled",r&&"utrecht-select__option--invalid",u),children:a}))}));Mr.displayName="SelectOption";var Pr=["className","children"];function Fr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Tr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fr(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var zr=(0,a.forwardRef)((function(e,t){var n=e.className;e.children;var r=(0,i.Z)(e,Pr);return(0,s.jsx)("hr",Tr(Tr({},r),{},{ref:t,className:(0,l.Z)("utrecht-separator",n)}))}));zr.displayName="Separator";var Rr=["children","className"];function Lr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Br(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lr(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ir=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Rr);return(0,s.jsx)("p",{children:(0,s.jsx)("a",Br(Br({ref:t},o),{},{className:(0,l.Z)("utrecht-skip-link","utrecht-skip-link--visible-on-focus",r),children:n}))})}));Ir.displayName="SkipLink";var Ur=["aside","children","className","type"];function qr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qr(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Zr=(0,a.forwardRef)((function(e,t){var n=e.aside,r=e.children,o=e.className,a=e.type,u=Wr(Wr({},(0,i.Z)(e,Ur)),{},{ref:t,className:(0,l.Z)("utrecht-spotlight-section",{"utrecht-spotlight-section--info":"info"===a,"utrecht-spotlight-section--warning":"warning"===a},o)});return n?(0,s.jsx)("aside",Wr(Wr({},u),{},{children:r})):(0,s.jsx)("section",Wr(Wr({},u),{},{children:r}))}));Zr.displayName="SpotlightSection";var Hr=["className","status"];function Gr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Vr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gr(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Yr=(0,a.forwardRef)((function(e,t){var n=e.className,r=e.status,o=(0,i.Z)(e,Hr);return(0,s.jsx)("span",Vr(Vr({className:(0,l.Z)("utrecht-badge-status","utrecht-badge-status--".concat(r||"neutral"),n)},o),{},{ref:t}))}));Yr.displayName="StatusBadge";var Xr=["children","className"];function Jr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jr(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Kr=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Xr);return(0,s.jsx)("strong",Qr(Qr({ref:t,className:(0,l.Z)("utrecht-emphasis","utrecht-emphasis--strong",r)},o),{},{children:n}))}));Kr.displayName="Strong";var ei=["children","className"];function ti(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ni(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ti(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ti(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ri=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,ei);return(0,s.jsx)("div",ni(ni({},o),{},{ref:t,className:(0,l.Z)("utrecht-surface",r),children:n}))}));ri.displayName="Surface";var ii=["busy","children","className"];function oi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ai(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oi(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var si=(0,a.forwardRef)((function(e,t){var n=e.busy,r=e.children,o=e.className,a=(0,i.Z)(e,ii);return(0,s.jsx)("table",ai(ai({"aria-busy":n},a),{},{ref:t,className:(0,l.Z)("utrecht-table",{"utrecht-table--busy":n},o),children:r}))}));si.displayName="Table";var li=["children","className"];function ui(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ci(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ui(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ui(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var fi=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,li);return(0,s.jsx)("tbody",ci(ci({},o),{},{ref:t,className:(0,l.Z)("utrecht-table__body",r),children:n}))}));fi.displayName="TableBody";var di=["children","className"];function hi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hi(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var mi=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,di);return(0,s.jsx)("caption",pi(pi({},o),{},{ref:t,className:(0,l.Z)("utrecht-table__caption",r),children:n}))}));mi.displayName="TableCaption";var gi=["children","className","numericColumn","selected"];function yi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yi(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var bi=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.numericColumn,a=e.selected,u=(0,i.Z)(e,gi);return(0,s.jsx)("td",vi(vi({"aria-selected":!!a||void 0},u),{},{ref:t,className:(0,l.Z)("utrecht-table__cell",{"utrecht-table__cell--selected":a,"utrecht-table__cell--numeric-column":o},r),children:n}))}));bi.displayName="TableCell";var xi=["children","className","sticky"];function wi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ki(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wi(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _i=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.sticky,a=(0,i.Z)(e,xi);return(0,s.jsx)("tfoot",ki(ki({},a),{},{ref:t,className:(0,l.Z)("utrecht-table__footer",{"utrecht-table__footer--sticky":o},r),children:n}))}));_i.displayName="TableFooter";var Oi=["children","className","sticky"];function Ei(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Di(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ei(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ei(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ji=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.sticky,a=(0,i.Z)(e,Oi);return(0,s.jsx)("thead",Di(Di({},a),{},{ref:t,className:(0,l.Z)("utrecht-table__header",{"utrecht-table__header--sticky":o},r),children:n}))}));ji.displayName="TableHeader";var Ni=["children","className","numericColumn","selected","sticky","scope"];function Si(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ai(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Si(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Si(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $i=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.numericColumn,a=e.selected,u=e.sticky,c=e.scope,f=(0,i.Z)(e,Ni);return(0,s.jsx)("th",Ai(Ai({"aria-selected":!!a||void 0,scope:c},f),{},{ref:t,className:(0,l.Z)("utrecht-table__header-cell",{"utrecht-table__header-cell--numeric-column":o,"utrecht-table__header-cell--selected":a,"utrecht-table__header-cell--sticky-inline":u&&"row"===c,"utrecht-table__header-cell--sticky-block":u&&"col"===c},r),children:n}))}));$i.displayName="TableHeaderCell";var Ci=["children","className","selected"];function Mi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mi(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Fi=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=e.selected,a=(0,i.Z)(e,Ci);return(0,s.jsx)("tr",Pi(Pi({"aria-selected":!!o||void 0},a),{},{ref:t,className:(0,l.Z)("utrecht-table__row",{"utrecht-table__row--selected":o},r),children:n}))}));Fi.displayName="TableRow";var Ti=["dir","disabled","invalid","readOnly","required","className"];function zi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ri(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zi(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Li=(0,a.forwardRef)((function(e,t){var n=e.dir,r=e.disabled,o=e.invalid,a=e.readOnly,u=e.required,c=e.className,f=(0,i.Z)(e,Ti);return(0,s.jsx)("textarea",Ri(Ri({},f),{},{ref:t,className:(0,l.Z)("utrecht-textarea","utrecht-textarea--html-textarea",r&&"utrecht-textarea--disabled",o&&"utrecht-textarea--invalid",a&&"utrecht-textarea--readonly",u&&"utrecht-textarea--required",c),dir:null!=n?n:"auto",disabled:r,readOnly:a,required:u,"aria-invalid":o||void 0}))}));Li.displayName="Textarea";var Bi=["dir","disabled","invalid","readOnly","required","className","type","maxLength","inputMode"];function Ii(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ui(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ii(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ii(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var qi=(0,a.forwardRef)((function(e,t){var n=e.dir,r=e.disabled,o=e.invalid,a=e.readOnly,u=e.required,c=e.className,f=e.type,d=void 0===f?"text":f,h=e.maxLength,p=e.inputMode,m=(0,i.Z)(e,Bi);return(0,s.jsx)("input",Ui(Ui({},m),{},{ref:t,type:d,className:(0,l.Z)("utrecht-textbox","utrecht-textbox--html-input",r&&"utrecht-textbox--disabled",o&&"utrecht-textbox--invalid",a&&"utrecht-textbox--readonly",u&&"utrecht-textbox--required",c),maxLength:h,dir:null!=n?n:"auto",disabled:r,readOnly:a,required:u,"aria-invalid":o||void 0,inputMode:p||("number"===d?"numeric":void 0)}))}));qi.displayName="Textbox";var Wi=["children","className"];function Zi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Hi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zi(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Gi=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Wi);return(0,s.jsx)("bdi",Hi(Hi({translate:"no"},o),{},{ref:t,className:(0,l.Z)("utrecht-url",r),children:n}))}));Gi.displayName="URLValue";var Vi=["children","className"];function Yi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yi(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ji=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Vi);return(0,s.jsx)("ul",Xi(Xi({role:"list"},o),{},{ref:t,className:(0,l.Z)("utrecht-unordered-list",r),children:n}))}));Ji.displayName="UnorderedList";var Qi=["children","className"];function Ki(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function eo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ki(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ki(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var to=(0,a.forwardRef)((function(e,t){var n=e.children,r=e.className,o=(0,i.Z)(e,Qi);return(0,s.jsx)("li",eo(eo({},o),{},{ref:t,className:(0,l.Z)("utrecht-unordered-list__item",r),children:n}))}));function no(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}to.displayName="UnorderedListItem";var ro={exports:{}};var io,oo,ao,so;function lo(){if(oo)return io;oo=1;return io="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}ro.exports=function(){if(so)return ao;so=1;var e=lo();function t(){}function n(){}return n.resetWarningCache=t,ao=function(){function r(t,n,r,i,o,a){if(a!==e){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function i(){return r}r.isRequired=r;var o={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:i,element:r,elementType:r,instanceOf:i,node:r,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:n,resetWarningCache:t};return o.PropTypes=o,o}}()();var uo=no(ro.exports);const co={};function fo(e,t){void 0===e&&(e=co),void 0===t&&(t=co);const n=Object.keys(e),r=Object.keys(t);return e===t||n.length===r.length&&n.every((n=>e[n]===t[n]))}var ho,po=(ho=function(e,t){return ho=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},ho(e,t)},function(e,t){function n(){this.constructor=e}ho(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),mo=Object.prototype.hasOwnProperty;function go(e,t){return mo.call(e,t)}function yo(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var i in e)go(e,i)&&r.push(i);return r}function vo(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function bo(e){for(var t,n=0,r=e.length;n<r;){if(!((t=e.charCodeAt(n))>=48&&t<=57))return!1;n++}return!0}function xo(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function wo(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function ko(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(ko(e[t]))return!0}else if("object"==typeof e)for(var r=yo(e),i=r.length,o=0;o<i;o++)if(ko(e[r[o]]))return!0;return!1}function _o(e,t){var n=[e];for(var r in t){var i="object"==typeof t[r]?JSON.stringify(t[r],null,2):t[r];void 0!==i&&n.push(r+": "+i)}return n.join("\n")}var Oo=function(e){function t(t,n,r,i,o){var a=this.constructor,s=e.call(this,_o(t,{name:n,index:r,operation:i,tree:o}))||this;return s.name=n,s.index=r,s.operation=i,s.tree=o,Object.setPrototypeOf(s,a.prototype),s.message=_o(t,{name:n,index:r,operation:i,tree:o}),s}return po(t,e),t}(Error),Eo=Oo,Do=vo,jo={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=So(n,this.path);r&&(r=vo(r));var i=Ao(n,{op:"remove",path:this.from}).removed;return Ao(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=So(n,this.from);return Ao(n,{op:"add",path:this.path,value:vo(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:Po(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},No={add:function(e,t,n){return bo(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){return{newDocument:n,removed:e.splice(t,1)[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:jo.move,copy:jo.copy,test:jo.test,_get:jo._get};function So(e,t){if(""==t)return e;var n={op:"_get",path:t};return Ao(e,n),n.value}function Ao(e,t,n,r,i,o){if(void 0===n&&(n=!1),void 0===r&&(r=!0),void 0===i&&(i=!0),void 0===o&&(o=0),n&&("function"==typeof n?n(t,0,e,t.path):Co(t,0)),""===t.path){var a={newDocument:e};if("add"===t.op)return a.newDocument=t.value,a;if("replace"===t.op)return a.newDocument=t.value,a.removed=e,a;if("move"===t.op||"copy"===t.op)return a.newDocument=So(e,t.from),"move"===t.op&&(a.removed=e),a;if("test"===t.op){if(a.test=Po(e,t.value),!1===a.test)throw new Eo("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a.newDocument=e,a}if("remove"===t.op)return a.removed=e,a.newDocument=null,a;if("_get"===t.op)return t.value=e,a;if(n)throw new Eo("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,t,e);return a}r||(e=vo(e));var s=(t.path||"").split("/"),l=e,u=1,c=s.length,f=void 0,d=void 0,h=void 0;for(h="function"==typeof n?n:Co;;){if((d=s[u])&&-1!=d.indexOf("~")&&(d=wo(d)),i&&("__proto__"==d||"prototype"==d&&u>0&&"constructor"==s[u-1]))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===f&&(void 0===l[d]?f=s.slice(0,u).join("/"):u==c-1&&(f=t.path),void 0!==f&&h(t,0,e,f)),u++,Array.isArray(l)){if("-"===d)d=l.length;else{if(n&&!bo(d))throw new Eo("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,t,e);bo(d)&&(d=~~d)}if(u>=c){if(n&&"add"===t.op&&d>l.length)throw new Eo("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,t,e);if(!1===(a=No[t.op].call(t,l,d,e)).test)throw new Eo("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a}}else if(u>=c){if(!1===(a=jo[t.op].call(t,l,d,e)).test)throw new Eo("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a}if(l=l[d],n&&u<c&&(!l||"object"!=typeof l))throw new Eo("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,t,e)}}function $o(e,t,n,r,i){if(void 0===r&&(r=!0),void 0===i&&(i=!0),n&&!Array.isArray(t))throw new Eo("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=vo(e));for(var o=new Array(t.length),a=0,s=t.length;a<s;a++)o[a]=Ao(e,t[a],n,!0,i,a),e=o[a].newDocument;return o.newDocument=e,o}function Co(e,t,n,r){if("object"!=typeof e||null===e||Array.isArray(e))throw new Eo("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(!jo[e.op])throw new Eo("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n);if("string"!=typeof e.path)throw new Eo("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new Eo('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new Eo("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new Eo("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&ko(e.value))throw new Eo("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n)if("add"==e.op){var i=e.path.split("/").length,o=r.split("/").length;if(i!==o+1&&i!==o)throw new Eo("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==r)throw new Eo("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if("move"===e.op||"copy"===e.op){var a=Mo([{op:"_get",path:e.from,value:void 0}],n);if(a&&"OPERATION_PATH_UNRESOLVABLE"===a.name)throw new Eo("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}function Mo(e,t,n){try{if(!Array.isArray(e))throw new Eo("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)$o(vo(t),vo(e),n||!0);else{n=n||Co;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(x9){if(x9 instanceof Eo)return x9;throw x9}}function Po(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var n,r,i,o=Array.isArray(e),a=Array.isArray(t);if(o&&a){if((r=e.length)!=t.length)return!1;for(n=r;0!=n--;)if(!Po(e[n],t[n]))return!1;return!0}if(o!=a)return!1;var s=Object.keys(e);if((r=s.length)!==Object.keys(t).length)return!1;for(n=r;0!=n--;)if(!t.hasOwnProperty(s[n]))return!1;for(n=r;0!=n--;)if(!Po(e[i=s[n]],t[i]))return!1;return!0}return e!=e&&t!=t}var Fo=Object.freeze({__proto__:null,JsonPatchError:Eo,_areEquals:Po,applyOperation:Ao,applyPatch:$o,applyReducer:function(e,t,n){var r=Ao(e,t);if(!1===r.test)throw new Eo("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument},deepClone:Do,getValueByPointer:So,validate:Mo,validator:Co}),To=new WeakMap,zo=function(e){this.observers=new Map,this.obj=e},Ro=function(e,t){this.callback=e,this.observer=t};function Lo(e,t){void 0===t&&(t=!1);var n=To.get(e.object);Bo(n.value,e.object,e.patches,"",t),e.patches.length&&$o(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function Bo(e,t,n,r,i){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var o=yo(t),a=yo(e),s=!1,l=a.length-1;l>=0;l--){var u=e[f=a[l]];if(!go(t,f)||void 0===t[f]&&void 0!==u&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(i&&n.push({op:"test",path:r+"/"+xo(f),value:vo(u)}),n.push({op:"remove",path:r+"/"+xo(f)}),s=!0):(i&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}));else{var c=t[f];"object"==typeof u&&null!=u&&"object"==typeof c&&null!=c&&Array.isArray(u)===Array.isArray(c)?Bo(u,c,n,r+"/"+xo(f),i):u!==c&&(i&&n.push({op:"test",path:r+"/"+xo(f),value:vo(u)}),n.push({op:"replace",path:r+"/"+xo(f),value:vo(c)}))}}if(s||o.length!=a.length)for(l=0;l<o.length;l++){var f;go(e,f=o[l])||void 0===t[f]||n.push({op:"add",path:r+"/"+xo(f),value:vo(t[f])})}}}var Io=Object.freeze({__proto__:null,compare:function(e,t,n){void 0===n&&(n=!1);var r=[];return Bo(e,t,r,"",n),r},generate:Lo,observe:function(e,t){var n,r=function(e){return To.get(e)}(e);if(r){var i=function(e,t){return e.observers.get(t)}(r,t);n=i&&i.observer}else r=new zo(e),To.set(e,r);if(n)return n;if(n={},r.value=vo(e),t){n.callback=t,n.next=null;var o=function(){Lo(n)},a=function(){clearTimeout(n.next),n.next=setTimeout(o)};"undefined"!=typeof window&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return n.patches=[],n.object=e,n.unobserve=function(){Lo(n),clearTimeout(n.next),function(e,t){e.observers.delete(t.callback)}(r,n),"undefined"!=typeof window&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},r.observers.set(t,new Ro(t,n)),n},unobserve:function(e,t){t.unobserve()}});Object.assign({},Fo,Io,{JsonPatchError:Oo,deepClone:vo,escapePathComponent:xo,unescapePathComponent:wo});var Uo=/("(?:[^\\"]|\\.)*")|[:,]/g,qo=function(e,t){var n,r,i;return t=t||{},n=JSON.stringify([1],void 0,void 0===t.indent?2:t.indent).slice(2,-3),r=""===n?1/0:void 0===t.maxLength?80:t.maxLength,i=t.replacer,function e(t,o,a){var s,l,u,c,f,d,h,p,m,g,y,v;if(t&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0===(y=JSON.stringify(t,i)))return y;if(h=r-o.length-a,y.length<=h&&(m=y.replace(Uo,(function(e,t){return t||e+" "})),m.length<=h))return m;if(null!=i&&(t=JSON.parse(y),i=void 0),"object"==typeof t&&null!==t){if(p=o+n,u=[],l=0,Array.isArray(t))for(g="[",s="]",h=t.length;l<h;l++)u.push(e(t[l],p,l===h-1?0:1)||"null");else for(g="{",s="}",h=(d=Object.keys(t)).length;l<h;l++)c=d[l],f=JSON.stringify(c)+": ",void 0!==(v=e(t[c],p,f.length+(l===h-1?0:1)))&&u.push(f+v);if(u.length>0)return[g,n+u.join(",\n"+p),s].join("\n"+o)}return y}(e,"",0)},Wo=no(qo);function Zo(e,t,n){return e.fields=t||[],e.fname=n,e}function Ho(e){return null==e?null:e.fname}function Go(e){return null==e?null:e.fields}function Vo(e){return 1===e.length?Yo(e[0]):Xo(e)}const Yo=e=>function(t){return t[e]},Xo=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function Jo(e){throw Error(e)}function Qo(e){const t=[],n=e.length;let r,i,o,a=null,s=0,l="";function u(){t.push(l+e.substring(r,i)),l="",r=i+1}for(e+="",r=i=0;i<n;++i)if(o=e[i],"\\"===o)l+=e.substring(r,i++),r=i;else if(o===a)u(),a=null,s=-1;else{if(a)continue;r===s&&'"'===o||r===s&&"'"===o?(r=i+1,a=o):"."!==o||s?"["===o?(i>r&&u(),s=r=i+1):"]"===o&&(s||Jo("Access path missing open bracket: "+e),s>0&&u(),s=0,r=i+1):i>r?u():r=i+1}return s&&Jo("Access path missing closing bracket: "+e),a&&Jo("Access path missing closing quote: "+e),i>r&&(i++,u()),t}function Ko(e,t,n){const r=Qo(e);return e=1===r.length?r[0]:e,Zo((n&&n.get||Vo)(r),[e],t||e)}const ea=Ko("id"),ta=Zo((e=>e),[],"identity"),na=Zo((()=>0),[],"zero"),ra=Zo((()=>1),[],"one"),ia=Zo((()=>!0),[],"true"),oa=Zo((()=>!1),[],"false");function aa(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const sa=0,la=1,ua=2,ca=3,fa=4;function da(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:aa,r=e||sa;return{level(e){return arguments.length?(r=+e,this):r},error(){return r>=la&&n(t||"error","ERROR",arguments),this},warn(){return r>=ua&&n(t||"warn","WARN",arguments),this},info(){return r>=ca&&n(t||"log","INFO",arguments),this},debug(){return r>=fa&&n(t||"log","DEBUG",arguments),this}}}var ha=Array.isArray;function pa(e){return e===Object(e)}const ma=e=>"__proto__"!==e;function ga(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(((e,t)=>{for(const n in t)if("signals"===n)e.signals=va(e.signals,t.signals);else{const r="legend"===n?{layout:1}:"style"===n||null;ya(e,n,t[n],r)}return e}),{})}function ya(e,t,n,r){if(!ma(t))return;let i,o;if(pa(n)&&!ha(n))for(i in o=pa(e[t])?e[t]:e[t]={},n)r&&(!0===r||r[i])?ya(o,i,n[i]):ma(i)&&(o[i]=n[i]);else e[t]=n}function va(e,t){if(null==e)return t;const n={},r=[];function i(e){n[e.name]||(n[e.name]=1,r.push(e))}return t.forEach(i),e.forEach(i),r}function ba(e){return e[e.length-1]}function xa(e){return null==e||""===e?null:+e}const wa=e=>t=>e*Math.exp(t),ka=e=>t=>Math.log(e*t),_a=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),Oa=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,Ea=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function Da(e,t,n,r){const i=n(e[0]),o=n(ba(e)),a=(o-i)*t;return[r(i-a),r(o-a)]}function ja(e,t){return Da(e,t,xa,ta)}function Na(e,t){var n=Math.sign(e[0]);return Da(e,t,ka(n),wa(n))}function Sa(e,t,n){return Da(e,t,Ea(n),Ea(1/n))}function Aa(e,t,n){return Da(e,t,_a(n),Oa(n))}function $a(e,t,n,r,i){const o=r(e[0]),a=r(ba(e)),s=null!=t?r(t):(o+a)/2;return[i(s+(o-s)*n),i(s+(a-s)*n)]}function Ca(e,t,n){return $a(e,t,n,xa,ta)}function Ma(e,t,n){const r=Math.sign(e[0]);return $a(e,t,n,ka(r),wa(r))}function Pa(e,t,n,r){return $a(e,t,n,Ea(r),Ea(1/r))}function Fa(e,t,n,r){return $a(e,t,n,_a(r),Oa(r))}function Ta(e){return 1+~~(new Date(e).getMonth()/3)}function za(e){return 1+~~(new Date(e).getUTCMonth()/3)}function Ra(e){return null!=e?ha(e)?e:[e]:[]}function La(e,t,n){let r,i=e[0],o=e[1];return o<i&&(r=o,o=i,i=r),r=o-i,r>=n-t?[t,n]:[i=Math.min(Math.max(i,t),n-r),i+r]}function Ba(e){return"function"==typeof e}const Ia="descending";function Ua(e,t,n){n=n||{},t=Ra(t)||[];const r=[],i=[],o={},a=n.comparator||Wa;return Ra(e).forEach(((e,a)=>{null!=e&&(r.push(t[a]===Ia?-1:1),i.push(e=Ba(e)?e:Ko(e,null,n)),(Go(e)||[]).forEach((e=>o[e]=1)))})),0===i.length?null:Zo(a(i,r),Object.keys(o))}const qa=(e,t)=>(e<t||null==e)&&null!=t?-1:(e>t||null==t)&&null!=e?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t==t?-1:t!=t&&e==e?1:0),Wa=(e,t)=>1===e.length?Za(e[0],t[0]):Ha(e,t,e.length),Za=(e,t)=>function(n,r){return qa(e(n),e(r))*t},Ha=(e,t,n)=>(t.push(0),function(r,i){let o,a=0,s=-1;for(;0===a&&++s<n;)o=e[s],a=qa(o(r),o(i));return a*t[s]});function Ga(e){return Ba(e)?e:()=>e}function Va(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout((()=>(t(r),n=null)),e)}}function Ya(e){for(let t,n,r=1,i=arguments.length;r<i;++r)for(n in t=arguments[r],t)e[n]=t[n];return e}function Xa(e,t){let n,r,i,o,a=0;if(e&&(n=e.length))if(null==t){for(r=e[a];a<n&&(null==r||r!=r);r=e[++a]);for(i=o=r;a<n;++a)r=e[a],null!=r&&(r<i&&(i=r),r>o&&(o=r))}else{for(r=t(e[a]);a<n&&(null==r||r!=r);r=t(e[++a]));for(i=o=r;a<n;++a)r=t(e[a]),null!=r&&(r<i&&(i=r),r>o&&(o=r))}return[i,o]}function Ja(e,t){const n=e.length;let r,i,o,a,s,l=-1;if(null==t){for(;++l<n;)if(i=e[l],null!=i&&i>=i){r=o=i;break}if(l===n)return[-1,-1];for(a=s=l;++l<n;)i=e[l],null!=i&&(r>i&&(r=i,a=l),o<i&&(o=i,s=l))}else{for(;++l<n;)if(i=t(e[l],l,e),null!=i&&i>=i){r=o=i;break}if(l===n)return[-1,-1];for(a=s=l;++l<n;)i=t(e[l],l,e),null!=i&&(r>i&&(r=i,a=l),o<i&&(o=i,s=l))}return[a,s]}const Qa=Object.prototype.hasOwnProperty;function Ka(e,t){return Qa.call(e,t)}const es={};function ts(e){let t,n={};function r(e){return Ka(n,e)&&n[e]!==es}const i={size:0,empty:0,object:n,has:r,get:e=>r(e)?n[e]:void 0,set(e,t){return r(e)||(++i.size,n[e]===es&&--i.empty),n[e]=t,this},delete(e){return r(e)&&(--i.size,++i.empty,n[e]=es),this},clear(){i.size=i.empty=0,i.object=n={}},test(e){return arguments.length?(t=e,i):t},clean(){const e={};let r=0;for(const i in n){const o=n[i];o===es||t&&t(o)||(e[i]=o,++r)}i.size=r,i.empty=0,i.object=n=e}};return e&&Object.keys(e).forEach((t=>{i.set(t,e[t])})),i}function ns(e,t,n,r,i,o){if(!n&&0!==n)return o;const a=+n;let s,l=e[0],u=ba(e);u<l&&(s=l,l=u,u=s),s=Math.abs(t-l);const c=Math.abs(u-t);return s<c&&s<=a?r:c<=a?i:o}function rs(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),Ya(r,n)}function is(e,t,n,r){let i,o=t[0],a=t[t.length-1];return o>a&&(i=o,o=a,a=i),r=void 0===r||r,((n=void 0===n||n)?o<=e:o<e)&&(r?e<=a:e<a)}function os(e){return"boolean"==typeof e}function as(e){return"[object Date]"===Object.prototype.toString.call(e)}function ss(e){return e&&Ba(e[Symbol.iterator])}function ls(e){return"number"==typeof e}function us(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function cs(e){return"string"==typeof e}function fs(e,t,n){e&&(e=t?Ra(e).map((e=>e.replace(/\\(.)/g,"$1"))):Ra(e));const r=e&&e.length,i=n&&n.get||Vo,o=e=>i(t?[e]:Qo(e));let a;if(r)if(1===r){const t=o(e[0]);a=function(e){return""+t(e)}}else{const t=e.map(o);a=function(e){let n=""+t[0](e),i=0;for(;++i<r;)n+="|"+t[i](e);return n}}else a=function(){return""};return Zo(a,e,"key")}function ds(e,t){const n=e[0],r=ba(e),i=+t;return i?1===i?r:n+i*(r-n):n}function hs(e){let t,n,r;e=+e||1e4;const i=()=>{t={},n={},r=0},o=(i,o)=>(++r>e&&(n=t,t={},r=1),t[i]=o);return i(),{clear:i,has:e=>Ka(t,e)||Ka(n,e),get:e=>Ka(t,e)?t[e]:Ka(n,e)?o(e,n[e]):void 0,set:(e,n)=>Ka(t,e)?t[e]=n:o(e,n)}}function ps(e,t,n,r){const i=t.length,o=n.length;if(!o)return t;if(!i)return n;const a=r||new t.constructor(i+o);let s=0,l=0,u=0;for(;s<i&&l<o;++u)a[u]=e(t[s],n[l])>0?n[l++]:t[s++];for(;s<i;++s,++u)a[u]=t[s];for(;l<o;++l,++u)a[u]=n[l];return a}function ms(e,t){let n="";for(;--t>=0;)n+=e;return n}function gs(e,t,n,r){const i=n||" ",o=e+"",a=t-o.length;return a<=0?o:"left"===r?ms(i,a)+o:"center"===r?ms(i,~~(a/2))+o+ms(i,Math.ceil(a/2)):o+ms(i,a)}function ys(e){return e&&ba(e)-e[0]||0}function vs(e){return ha(e)?"["+e.map(vs)+"]":pa(e)||cs(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function bs(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e)&&!!e}const xs=e=>ls(e)||as(e)?e:Date.parse(e);function ws(e,t){return t=t||xs,null==e||""===e?null:t(e)}function ks(e){return null==e||""===e?null:e+""}function _s(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function Os(e,t,n,r){const i=null!=r?r:"\u2026",o=e+"",a=o.length,s=Math.max(0,t-i.length);return a<=t?o:"left"===n?i+o.slice(a-s):"center"===n?o.slice(0,Math.ceil(s/2))+i+o.slice(a-~~(s/2)):o.slice(0,s)+i}function Es(e,t,n){if(e)if(t){const r=e.length;for(let i=0;i<r;++i){const r=t(e[i]);r&&n(r,i,e)}}else e.forEach(n)}var Ds={},js={},Ns=34,Ss=10,As=13;function $s(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function Cs(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var r in e)r in t||n.push(t[r]=r)})),n}function Ms(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function Ps(e){var t,n=e.getUTCHours(),r=e.getUTCMinutes(),i=e.getUTCSeconds(),o=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":((t=e.getUTCFullYear())<0?"-"+Ms(-t,6):t>9999?"+"+Ms(t,6):Ms(t,4))+"-"+Ms(e.getUTCMonth()+1,2)+"-"+Ms(e.getUTCDate(),2)+(o?"T"+Ms(n,2)+":"+Ms(r,2)+":"+Ms(i,2)+"."+Ms(o,3)+"Z":i?"T"+Ms(n,2)+":"+Ms(r,2)+":"+Ms(i,2)+"Z":r||n?"T"+Ms(n,2)+":"+Ms(r,2)+"Z":"")}function Fs(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var r,i=[],o=e.length,a=0,s=0,l=o<=0,u=!1;function c(){if(l)return js;if(u)return u=!1,Ds;var t,r,i=a;if(e.charCodeAt(i)===Ns){for(;a++<o&&e.charCodeAt(a)!==Ns||e.charCodeAt(++a)===Ns;);return(t=a)>=o?l=!0:(r=e.charCodeAt(a++))===Ss?u=!0:r===As&&(u=!0,e.charCodeAt(a)===Ss&&++a),e.slice(i+1,t-1).replace(/""/g,'"')}for(;a<o;){if((r=e.charCodeAt(t=a++))===Ss)u=!0;else if(r===As)u=!0,e.charCodeAt(a)===Ss&&++a;else if(r!==n)continue;return e.slice(i,t)}return l=!0,e.slice(i,o)}for(e.charCodeAt(o-1)===Ss&&--o,e.charCodeAt(o-1)===As&&--o;(r=c())!==js;){for(var f=[];r!==Ds&&r!==js;)f.push(r),r=c();t&&null==(f=t(f,s++))||i.push(f)}return i}function i(t,n){return t.map((function(t){return n.map((function(e){return a(t[e])})).join(e)}))}function o(t){return t.map(a).join(e)}function a(e){return null==e?"":e instanceof Date?Ps(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,i,o=r(e,(function(e,r){if(n)return n(e,r-1);i=e,n=t?function(e,t){var n=$s(e);return function(r,i){return t(n(r),i,e)}}(e,t):$s(e)}));return o.columns=i||[],o},parseRows:r,format:function(t,n){return null==n&&(n=Cs(t)),[n.map(a).join(e)].concat(i(t,n)).join("\n")},formatBody:function(e,t){return null==t&&(t=Cs(e)),i(e,t).join("\n")},formatRows:function(e){return e.map(o).join("\n")},formatRow:o,formatValue:a}}function Ts(e){return e}function zs(e,t){return"string"==typeof t&&(t=e.objects[t]),"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map((function(t){return Rs(e,t)}))}:Rs(e,t)}function Rs(e,t){var n=t.id,r=t.bbox,i=null==t.properties?{}:t.properties,o=Ls(e,t);return null==n&&null==r?{type:"Feature",properties:i,geometry:o}:null==r?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function Ls(e,t){var n=function(e){if(null==e)return Ts;var t,n,r=e.scale[0],i=e.scale[1],o=e.translate[0],a=e.translate[1];return function(e,s){s||(t=n=0);var l=2,u=e.length,c=new Array(u);for(c[0]=(t+=e[0])*r+o,c[1]=(n+=e[1])*i+a;l<u;)c[l]=e[l],++l;return c}}(e.transform),r=e.arcs;function i(e,t){t.length&&t.pop();for(var i=r[e<0?~e:e],o=0,a=i.length;o<a;++o)t.push(n(i[o],o));e<0&&function(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}(t,a)}function o(e){return n(e)}function a(e){for(var t=[],n=0,r=e.length;n<r;++n)i(e[n],t);return t.length<2&&t.push(t[0]),t}function s(e){for(var t=a(e);t.length<4;)t.push(t[0]);return t}function l(e){return e.map(s)}return function e(t){var n,r=t.type;switch(r){case"GeometryCollection":return{type:r,geometries:t.geometries.map(e)};case"Point":n=o(t.coordinates);break;case"MultiPoint":n=t.coordinates.map(o);break;case"LineString":n=a(t.arcs);break;case"MultiLineString":n=t.arcs.map(a);break;case"Polygon":n=l(t.arcs);break;case"MultiPolygon":n=t.arcs.map(l);break;default:return null}return{type:r,coordinates:n}}(t)}function Bs(e,t){var n={},r={},i={},o=[],a=-1;function s(e,t){for(var r in e){var i=e[r];delete t[i.start],delete i.start,delete i.end,i.forEach((function(e){n[e<0?~e:e]=1})),o.push(i)}}return t.forEach((function(n,r){var i,o=e.arcs[n<0?~n:n];o.length<3&&!o[1][0]&&!o[1][1]&&(i=t[++a],t[a]=n,t[r]=i)})),t.forEach((function(t){var n,o,a=function(t){var n,r=e.arcs[t<0?~t:t],i=r[0];e.transform?(n=[0,0],r.forEach((function(e){n[0]+=e[0],n[1]+=e[1]}))):n=r[r.length-1];return t<0?[n,i]:[i,n]}(t),s=a[0],l=a[1];if(n=i[s])if(delete i[n.end],n.push(t),n.end=l,o=r[l]){delete r[o.start];var u=o===n?n:n.concat(o);r[u.start=n.start]=i[u.end=o.end]=u}else r[n.start]=i[n.end]=n;else if(n=r[l])if(delete r[n.start],n.unshift(t),n.start=s,o=i[s]){delete i[o.end];var c=o===n?n:o.concat(n);r[c.start=o.start]=i[c.end=n.end]=c}else r[n.start]=i[n.end]=n;else r[(n=[t]).start=s]=i[n.end=l]=n})),s(i,r),s(r,i),t.forEach((function(e){n[e<0?~e:e]||o.push([e])})),o}function Is(e){return Ls(e,Us.apply(this,arguments))}function Us(e,t,n){var r,i,o;if(arguments.length>1)r=function(e,t,n){var r,i=[],o=[];function a(e){var t=e<0?~e:e;(o[t]||(o[t]=[])).push({i:e,g:r})}function s(e){e.forEach(a)}function l(e){e.forEach(s)}function u(e){e.forEach(l)}function c(e){switch(r=e,e.type){case"GeometryCollection":e.geometries.forEach(c);break;case"LineString":s(e.arcs);break;case"MultiLineString":case"Polygon":l(e.arcs);break;case"MultiPolygon":u(e.arcs)}}return c(t),o.forEach(null==n?function(e){i.push(e[0].i)}:function(e){n(e[0].g,e[e.length-1].g)&&i.push(e[0].i)}),i}(0,t,n);else for(i=0,r=new Array(o=e.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:Bs(e,r)}}function qs(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Ws(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Zs(e){let t,n,r;function i(e,r,i,o){if(void 0===i&&(i=0),void 0===o&&(o=e.length),i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<0?i=t+1:o=t}while(i<o)}return i}return 2!==e.length?(t=qs,n=(t,n)=>qs(e(t),n),r=(t,n)=>e(t)-n):(t=e===qs||e===Ws?e:Hs,n=e,r=e),{left:i,center:function(e,t,n,o){void 0===n&&(n=0),void 0===o&&(o=e.length);const a=i(e,t,n,o-1);return a>n&&r(e[a-1],t)>-r(e[a],t)?a-1:a},right:function(e,r,i,o){if(void 0===i&&(i=0),void 0===o&&(o=e.length),i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<=0?i=t+1:o=t}while(i<o)}return i}}}function Hs(){return 0}function Gs(e){return null===e?NaN:+e}const Vs=Zs(qs),Ys=Vs.right,Xs=Vs.left;Zs(Gs).center;var Js=Ys;class Qs{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=t[r],o=e+i,a=Math.abs(e)<Math.abs(i)?e-(o-i):i-(o-e);a&&(t[n++]=a),e=o}return t[n]=e,this._n=n+1,this}valueOf(){const e=this._partials;let t,n,r,i=this._n,o=0;if(i>0){for(o=e[--i];i>0&&(t=o,n=e[--i],o=t+n,r=n-(o-t),!r););i>0&&(r<0&&e[i-1]<0||r>0&&e[i-1]>0)&&(n=2*r,t=o+n,n==t-o&&(o=t))}return o}}class Ks extends Map{constructor(e,t){if(void 0===t&&(t=il),super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[n,r]of e)this.set(n,r)}get(e){return super.get(tl(this,e))}has(e){return super.has(tl(this,e))}set(e,t){return super.set(nl(this,e),t)}delete(e){return super.delete(rl(this,e))}}class el extends Set{constructor(e,t){if(void 0===t&&(t=il),super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const n of e)this.add(n)}has(e){return super.has(tl(this,e))}add(e){return super.add(nl(this,e))}delete(e){return super.delete(rl(this,e))}}function tl(e,t){let{_intern:n,_key:r}=e;const i=r(t);return n.has(i)?n.get(i):t}function nl(e,t){let{_intern:n,_key:r}=e;const i=r(t);return n.has(i)?n.get(i):(n.set(i,t),t)}function rl(e,t){let{_intern:n,_key:r}=e;const i=r(t);return n.has(i)&&(t=n.get(i),n.delete(i)),t}function il(e){return null!==e&&"object"==typeof e?e.valueOf():e}function ol(e,t){return(null==e||!(e>=e))-(null==t||!(t>=t))||(e<t?-1:e>t?1:0)}const al=Math.sqrt(50),sl=Math.sqrt(10),ll=Math.sqrt(2);function ul(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=al?10:o>=sl?5:o>=ll?2:1;let s,l,u;return i<0?(u=Math.pow(10,-i)/a,s=Math.round(e*u),l=Math.round(t*u),s/u<e&&++s,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*a,s=Math.round(e/u),l=Math.round(t/u),s*u<e&&++s,l*u>t&&--l),l<s&&.5<=n&&n<2?ul(e,t,2*n):[s,l,u]}function cl(e,t,n){if(!((n=+n)>0))return[];if((e=+e)===(t=+t))return[e];const r=t<e,[i,o,a]=r?ul(t,e,n):ul(e,t,n);if(!(o>=i))return[];const s=o-i+1,l=new Array(s);if(r)if(a<0)for(let u=0;u<s;++u)l[u]=(o-u)/-a;else for(let u=0;u<s;++u)l[u]=(o-u)*a;else if(a<0)for(let u=0;u<s;++u)l[u]=(i+u)/-a;else for(let u=0;u<s;++u)l[u]=(i+u)*a;return l}function fl(e,t,n){return ul(e=+e,t=+t,n=+n)[2]}function dl(e,t,n){n=+n;const r=(t=+t)<(e=+e),i=r?fl(t,e,n):fl(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function hl(e,t){let n;if(void 0===t)for(const r of e)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function pl(e,t){let n;if(void 0===t)for(const r of e)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function ml(e,t,n,r,i){if(void 0===n&&(n=0),void 0===r&&(r=1/0),t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(i=void 0===i?ol:function(e){if(void 0===e&&(e=qs),e===qs)return ol;if("function"!=typeof e)throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||0===r?r:(0===e(n,n))-(0===e(t,t))}}(i);r>n;){if(r-n>600){const o=r-n+1,a=t-n+1,s=Math.log(o),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(o-l)/o)*(a-o/2<0?-1:1);ml(e,t,Math.max(n,Math.floor(t-a*l/o+u)),Math.min(r,Math.floor(t+(o-a)*l/o+u)),i)}const o=e[t];let a=n,s=r;for(gl(e,n,t),i(e[r],o)>0&&gl(e,n,r);a<s;){for(gl(e,a,s),++a,--s;i(e[a],o)<0;)++a;for(;i(e[s],o)>0;)--s}0===i(e[n],o)?gl(e,n,s):(++s,gl(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function gl(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function yl(e,t,n){if(e=Float64Array.from(function*(e,t){if(void 0===t)for(let n of e)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)null!=(r=t(r,++n,e))&&(r=+r)>=r&&(yield r)}}(e,n)),(r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return pl(e);if(t>=1)return hl(e);var r,i=(r-1)*t,o=Math.floor(i),a=hl(ml(e,o).subarray(0,o+1));return a+(pl(e.subarray(o+1))-a)*(i-o)}}function vl(e,t,n){if(void 0===n&&(n=Gs),(r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),a=+n(e[o],o,e);return a+(+n(e[o+1],o+1,e)-a)*(i-o)}}function bl(e,t){return yl(e,.5,t)}function xl(e){return Array.from(function*(e){for(const t of e)yield*t}(e))}function wl(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),o=new Array(i);++r<i;)o[r]=e+r*n;return o}function kl(e,t){let n=0;if(void 0===t)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function _l(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Ol(e){return(e=_l(Math.abs(e)))?e[1]:NaN}var El,Dl=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function jl(e){if(!(t=Dl.exec(e)))throw new Error("invalid format: "+e);var t;return new Nl({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Nl(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Sl(e,t){var n=_l(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}jl.prototype=Nl.prototype,Nl.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Al={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Sl(100*e,t),r:Sl,s:function(e,t){var n=_l(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(El=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+_l(e,Math.max(0,t+o-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function $l(e){return e}var Cl,Ml,Pl,Fl=Array.prototype.map,Tl=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function zl(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?$l:(t=Fl.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,o=[],a=0,s=t[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),o.push(e.substring(i-=s,i+s)),!((l+=s+1)>r));)s=t[a=(a+1)%t.length];return o.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",o=void 0===e.currency?"":e.currency[1]+"",a=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?$l:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(Fl.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",u=void 0===e.minus?"\u2212":e.minus+"",c=void 0===e.nan?"NaN":e.nan+"";function f(e){var t=(e=jl(e)).fill,n=e.align,f=e.sign,d=e.symbol,h=e.zero,p=e.width,m=e.comma,g=e.precision,y=e.trim,v=e.type;"n"===v?(m=!0,v="g"):Al[v]||(void 0===g&&(g=12),y=!0,v="g"),(h||"0"===t&&"="===n)&&(h=!0,t="0",n="=");var b="$"===d?i:"#"===d&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",x="$"===d?o:/[%p]/.test(v)?l:"",w=Al[v],k=/[defgprs%]/.test(v);function _(e){var i,o,l,d=b,_=x;if("c"===v)_=w(e)+_,e="";else{var O=(e=+e)<0||1/e<0;if(e=isNaN(e)?c:w(Math.abs(e),g),y&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),O&&0==+e&&"+"!==f&&(O=!1),d=(O?"("===f?f:u:"-"===f||"("===f?"":f)+d,_=("s"===v?Tl[8+El/3]:"")+_+(O&&"("===f?")":""),k)for(i=-1,o=e.length;++i<o;)if(48>(l=e.charCodeAt(i))||l>57){_=(46===l?a+e.slice(i+1):e.slice(i))+_,e=e.slice(0,i);break}}m&&!h&&(e=r(e,1/0));var E=d.length+e.length+_.length,D=E<p?new Array(p-E+1).join(t):"";switch(m&&h&&(e=r(D+e,D.length?p-_.length:1/0),D=""),n){case"<":e=d+e+_+D;break;case"=":e=d+D+e+_;break;case"^":e=D.slice(0,E=D.length>>1)+d+e+_+D.slice(E);break;default:e=D+d+e+_}return s(e)}return g=void 0===g?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),_.toString=function(){return e+""},_}return{format:f,formatPrefix:function(e,t){var n=f(((e=jl(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(Ol(t)/3))),i=Math.pow(10,-r),o=Tl[8+r/3];return function(e){return n(i*e)+o}}}}function Rl(e){return Math.max(0,-Ol(Math.abs(e)))}function Ll(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Ol(t)/3)))-Ol(Math.abs(e)))}function Bl(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Ol(t)-Ol(e))+1}!function(e){Cl=zl(e),Ml=Cl.format,Pl=Cl.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]});const Il=new Date,Ul=new Date;function ql(e,t,n,r){function i(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return i.floor=t=>(e(t=new Date(+t)),t),i.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),i.round=e=>{const t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),i.range=(n,r,o)=>{const a=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return a;let s;do{a.push(s=new Date(+n)),t(n,o),e(n)}while(s<n&&n<r);return a},i.filter=n=>ql((t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),((e,r)=>{if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););})),n&&(i.count=(t,r)=>(Il.setTime(+t),Ul.setTime(+r),e(Il),e(Ul),Math.floor(n(Il,Ul))),i.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(r?t=>r(t)%e==0:t=>i.count(0,t)%e==0):i:null)),i}const Wl=ql((()=>{}),((e,t)=>{e.setTime(+e+t)}),((e,t)=>t-e));Wl.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?ql((t=>{t.setTime(Math.floor(t/e)*e)}),((t,n)=>{t.setTime(+t+n*e)}),((t,n)=>(n-t)/e)):Wl:null),Wl.range;const Zl=1e3,Hl=6e4,Gl=60*Hl,Vl=24*Gl,Yl=7*Vl,Xl=30*Vl,Jl=365*Vl,Ql=ql((e=>{e.setTime(e-e.getMilliseconds())}),((e,t)=>{e.setTime(+e+t*Zl)}),((e,t)=>(t-e)/Zl),(e=>e.getUTCSeconds()));Ql.range;const Kl=ql((e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Zl)}),((e,t)=>{e.setTime(+e+t*Hl)}),((e,t)=>(t-e)/Hl),(e=>e.getMinutes()));Kl.range;const eu=ql((e=>{e.setUTCSeconds(0,0)}),((e,t)=>{e.setTime(+e+t*Hl)}),((e,t)=>(t-e)/Hl),(e=>e.getUTCMinutes()));eu.range;const tu=ql((e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Zl-e.getMinutes()*Hl)}),((e,t)=>{e.setTime(+e+t*Gl)}),((e,t)=>(t-e)/Gl),(e=>e.getHours()));tu.range;const nu=ql((e=>{e.setUTCMinutes(0,0,0)}),((e,t)=>{e.setTime(+e+t*Gl)}),((e,t)=>(t-e)/Gl),(e=>e.getUTCHours()));nu.range;const ru=ql((e=>e.setHours(0,0,0,0)),((e,t)=>e.setDate(e.getDate()+t)),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Hl)/Vl),(e=>e.getDate()-1));ru.range;const iu=ql((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/Vl),(e=>e.getUTCDate()-1));iu.range;const ou=ql((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/Vl),(e=>Math.floor(e/Vl)));function au(e){return ql((t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),((e,t)=>{e.setDate(e.getDate()+7*t)}),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Hl)/Yl))}ou.range;const su=au(0),lu=au(1),uu=au(2),cu=au(3),fu=au(4),du=au(5),hu=au(6);function pu(e){return ql((t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)}),((e,t)=>(t-e)/Yl))}su.range,lu.range,uu.range,cu.range,fu.range,du.range,hu.range;const mu=pu(0),gu=pu(1),yu=pu(2),vu=pu(3),bu=pu(4),xu=pu(5),wu=pu(6);mu.range,gu.range,yu.range,vu.range,bu.range,xu.range,wu.range;const ku=ql((e=>{e.setDate(1),e.setHours(0,0,0,0)}),((e,t)=>{e.setMonth(e.getMonth()+t)}),((e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())),(e=>e.getMonth()));ku.range;const _u=ql((e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)}),((e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())),(e=>e.getUTCMonth()));_u.range;const Ou=ql((e=>{e.setMonth(0,1),e.setHours(0,0,0,0)}),((e,t)=>{e.setFullYear(e.getFullYear()+t)}),((e,t)=>t.getFullYear()-e.getFullYear()),(e=>e.getFullYear()));Ou.every=e=>isFinite(e=Math.floor(e))&&e>0?ql((t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),((t,n)=>{t.setFullYear(t.getFullYear()+n*e)})):null,Ou.range;const Eu=ql((e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)}),((e,t)=>t.getUTCFullYear()-e.getUTCFullYear()),(e=>e.getUTCFullYear()));function Du(e,t,n,r,i,o){const a=[[Ql,1,Zl],[Ql,5,5e3],[Ql,15,15e3],[Ql,30,3e4],[o,1,Hl],[o,5,5*Hl],[o,15,15*Hl],[o,30,30*Hl],[i,1,Gl],[i,3,3*Gl],[i,6,6*Gl],[i,12,12*Gl],[r,1,Vl],[r,2,2*Vl],[n,1,Yl],[t,1,Xl],[t,3,3*Xl],[e,1,Jl]];function s(t,n,r){const i=Math.abs(n-t)/r,o=Zs((e=>{let[,,t]=e;return t})).right(a,i);if(o===a.length)return e.every(dl(t/Jl,n/Jl,r));if(0===o)return Wl.every(Math.max(dl(t,n,r),1));const[s,l]=a[i/a[o-1][2]<a[o][2]/i?o-1:o];return s.every(l)}return[function(e,t,n){const r=t<e;r&&([e,t]=[t,e]);const i=n&&"function"==typeof n.range?n:s(e,t,n),o=i?i.range(e,+t+1):[];return r?o.reverse():o},s]}Eu.every=e=>isFinite(e=Math.floor(e))&&e>0?ql((t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),((t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null,Eu.range;const[ju,Nu]=Du(Eu,_u,mu,ou,nu,eu),[Su,Au]=Du(Ou,ku,su,ru,tu,Kl),$u="year",Cu="quarter",Mu="month",Pu="week",Fu="date",Tu="day",zu="dayofyear",Ru="hours",Lu="minutes",Bu="seconds",Iu="milliseconds",Uu=[$u,Cu,Mu,Pu,Fu,Tu,zu,Ru,Lu,Bu,Iu],qu=Uu.reduce(((e,t,n)=>(e[t]=1+n,e)),{});function Wu(e){const t=Ra(e).slice(),n={};t.length||Jo("Missing time unit."),t.forEach((e=>{Ka(qu,e)?n[e]=1:Jo(`Invalid time unit: ${e}.`)}));return(n[Pu]||n[Tu]?1:0)+(n[Cu]||n[Mu]||n[Fu]?1:0)+(n[zu]?1:0)>1&&Jo(`Incompatible time units: ${e}`),t.sort(((e,t)=>qu[e]-qu[t])),t}const Zu={[$u]:"%Y ",[Cu]:"Q%q ",[Mu]:"%b ",[Fu]:"%d ",[Pu]:"W%U ",[Tu]:"%a ",[zu]:"%j ",[Ru]:"%H:00",[Lu]:"00:%M",[Bu]:":%S",[Iu]:".%L",[`${$u}-${Mu}`]:"%Y-%m ",[`${$u}-${Mu}-${Fu}`]:"%Y-%m-%d ",[`${Ru}-${Lu}`]:"%H:%M"};function Hu(e,t){const n=Ya({},Zu,t),r=Wu(e),i=r.length;let o,a,s="",l=0;for(l=0;l<i;)for(o=r.length;o>l;--o)if(a=r.slice(l,o).join("-"),null!=n[a]){s+=n[a],l=o;break}return s.trim()}const Gu=new Date;function Vu(e){return Gu.setFullYear(e),Gu.setMonth(0),Gu.setDate(1),Gu.setHours(0,0,0,0),Gu}function Yu(e){return Ju(new Date(e))}function Xu(e){return Qu(new Date(e))}function Ju(e){return ru.count(Vu(e.getFullYear())-1,e)}function Qu(e){return su.count(Vu(e.getFullYear())-1,e)}function Ku(e){return Vu(e).getDay()}function ec(e,t,n,r,i,o,a){if(0<=e&&e<100){const s=new Date(-1,t,n,r,i,o,a);return s.setFullYear(e),s}return new Date(e,t,n,r,i,o,a)}function tc(e){return rc(new Date(e))}function nc(e){return ic(new Date(e))}function rc(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return iu.count(t-1,e)}function ic(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return mu.count(t-1,e)}function oc(e){return Gu.setTime(Date.UTC(e,0,1)),Gu.getUTCDay()}function ac(e,t,n,r,i,o,a){if(0<=e&&e<100){const e=new Date(Date.UTC(-1,t,n,r,i,o,a));return e.setUTCFullYear(n.y),e}return new Date(Date.UTC(e,t,n,r,i,o,a))}function sc(e,t,n,r,i){const o=t||1,a=ba(e),s=(e,t,i)=>function(e,t,n,r){const i=n<=1?e:r?(t,i)=>r+n*Math.floor((e(t,i)-r)/n):(t,r)=>n*Math.floor(e(t,r)/n);return t?(e,n)=>t(i(e,n),n):i}(n[i=i||e],r[i],e===a&&o,t),l=new Date,u=_s(e),c=u[$u]?s($u):Ga(2012),f=u[Mu]?s(Mu):u[Cu]?s(Cu):na,d=u[Pu]&&u[Tu]?s(Tu,1,Pu+Tu):u[Pu]?s(Pu,1):u[Tu]?s(Tu,1):u[Fu]?s(Fu,1):u[zu]?s(zu,1):ra,h=u[Ru]?s(Ru):na,p=u[Lu]?s(Lu):na,m=u[Bu]?s(Bu):na,g=u[Iu]?s(Iu):na;return function(e){l.setTime(+e);const t=c(l);return i(t,f(l),d(l,t),h(l),p(l),m(l),g(l))}}function lc(e,t,n){return t+7*e-(n+6)%7}const uc={[$u]:e=>e.getFullYear(),[Cu]:e=>Math.floor(e.getMonth()/3),[Mu]:e=>e.getMonth(),[Fu]:e=>e.getDate(),[Ru]:e=>e.getHours(),[Lu]:e=>e.getMinutes(),[Bu]:e=>e.getSeconds(),[Iu]:e=>e.getMilliseconds(),[zu]:e=>Ju(e),[Pu]:e=>Qu(e),[Pu+Tu]:(e,t)=>lc(Qu(e),e.getDay(),Ku(t)),[Tu]:(e,t)=>lc(1,e.getDay(),Ku(t))},cc={[Cu]:e=>3*e,[Pu]:(e,t)=>lc(e,0,Ku(t))};function fc(e,t){return sc(e,t||1,uc,cc,ec)}const dc={[$u]:e=>e.getUTCFullYear(),[Cu]:e=>Math.floor(e.getUTCMonth()/3),[Mu]:e=>e.getUTCMonth(),[Fu]:e=>e.getUTCDate(),[Ru]:e=>e.getUTCHours(),[Lu]:e=>e.getUTCMinutes(),[Bu]:e=>e.getUTCSeconds(),[Iu]:e=>e.getUTCMilliseconds(),[zu]:e=>rc(e),[Pu]:e=>ic(e),[Tu]:(e,t)=>lc(1,e.getUTCDay(),oc(t)),[Pu+Tu]:(e,t)=>lc(ic(e),e.getUTCDay(),oc(t))},hc={[Cu]:e=>3*e,[Pu]:(e,t)=>lc(e,0,oc(t))};function pc(e,t){return sc(e,t||1,dc,hc,ac)}const mc={[$u]:Ou,[Cu]:ku.every(3),[Mu]:ku,[Pu]:su,[Fu]:ru,[Tu]:ru,[zu]:ru,[Ru]:tu,[Lu]:Kl,[Bu]:Ql,[Iu]:Wl},gc={[$u]:Eu,[Cu]:_u.every(3),[Mu]:_u,[Pu]:mu,[Fu]:iu,[Tu]:iu,[zu]:iu,[Ru]:nu,[Lu]:eu,[Bu]:Ql,[Iu]:Wl};function yc(e){return mc[e]}function vc(e){return gc[e]}function bc(e,t,n){return e?e.offset(t,n):void 0}function xc(e,t,n){return bc(yc(e),t,n)}function wc(e,t,n){return bc(vc(e),t,n)}function kc(e,t,n,r){return e?e.range(t,n,r):void 0}function _c(e,t,n,r){return kc(yc(e),t,n,r)}function Oc(e,t,n,r){return kc(vc(e),t,n,r)}const Ec=1e3,Dc=6e4,jc=36e5,Nc=864e5,Sc=2592e6,Ac=31536e6,$c=[$u,Mu,Fu,Ru,Lu,Bu,Iu],Cc=$c.slice(0,-1),Mc=Cc.slice(0,-1),Pc=Mc.slice(0,-1),Fc=Pc.slice(0,-1),Tc=[$u,Mu],zc=[$u],Rc=[[Cc,1,Ec],[Cc,5,5e3],[Cc,15,15e3],[Cc,30,3e4],[Mc,1,Dc],[Mc,5,3e5],[Mc,15,9e5],[Mc,30,18e5],[Pc,1,jc],[Pc,3,108e5],[Pc,6,216e5],[Pc,12,432e5],[Fc,1,Nc],[[$u,Pu],1,6048e5],[Tc,1,Sc],[Tc,3,7776e6],[zc,1,Ac]];function Lc(e){const t=e.extent,n=e.maxbins||40,r=Math.abs(ys(t))/n;let i,o,a=Zs((e=>e[2])).right(Rc,r);return a===Rc.length?(i=zc,o=dl(t[0]/Ac,t[1]/Ac,n)):a?(a=Rc[r/Rc[a-1][2]<Rc[a][2]/r?a-1:a],i=a[0],o=a[1]):(i=$c,o=Math.max(dl(t[0],t[1],n),1)),{units:i,step:o}}function Bc(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Ic(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Uc(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function qc(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,a=e.shortDays,s=e.months,l=e.shortMonths,u=tf(i),c=nf(i),f=tf(o),d=nf(o),h=tf(a),p=nf(a),m=tf(s),g=nf(s),y=tf(l),v=nf(l),b={a:function(e){return a[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return l[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:Of,e:Of,f:Sf,g:Bf,G:Uf,H:Ef,I:Df,j:jf,L:Nf,m:Af,M:$f,p:function(e){return i[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:fd,s:dd,S:Cf,u:Mf,U:Pf,V:Tf,w:zf,W:Rf,x:null,X:null,y:Lf,Y:If,Z:qf,"%":cd},x={a:function(e){return a[e.getUTCDay()]},A:function(e){return o[e.getUTCDay()]},b:function(e){return l[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:Wf,e:Wf,f:Yf,g:ad,G:ld,H:Zf,I:Hf,j:Gf,L:Vf,m:Xf,M:Jf,p:function(e){return i[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:fd,s:dd,S:Qf,u:Kf,U:ed,V:nd,w:rd,W:id,x:null,X:null,y:od,Y:sd,Z:ud,"%":cd},w={a:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=f.exec(t.slice(n));return r?(e.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=y.exec(t.slice(n));return r?(e.m=v.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=g.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return O(e,t,n,r)},d:pf,e:pf,f:xf,g:cf,G:uf,H:gf,I:gf,j:mf,L:bf,m:hf,M:yf,p:function(e,t,n){var r=u.exec(t.slice(n));return r?(e.p=c.get(r[0].toLowerCase()),n+r[0].length):-1},q:df,Q:kf,s:_f,S:vf,u:of,U:af,V:sf,w:rf,W:lf,x:function(e,t,r){return O(e,n,t,r)},X:function(e,t,n){return O(e,r,t,n)},y:cf,Y:uf,Z:ff,"%":wf};function k(e,t){return function(n){var r,i,o,a=[],s=-1,l=0,u=e.length;for(n instanceof Date||(n=new Date(+n));++s<u;)37===e.charCodeAt(s)&&(a.push(e.slice(l,s)),null!=(i=Yc[r=e.charAt(++s)])?r=e.charAt(++s):i="e"===r?" ":"0",(o=t[r])&&(r=o(n,i)),a.push(r),l=s+1);return a.push(e.slice(l,s)),a.join("")}}function _(e,t){return function(n){var r,i,o=Uc(1900,void 0,1);if(O(o,e,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(t&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=Ic(Uc(o.y,0,1))).getUTCDay(),r=i>4||0===i?gu.ceil(r):gu(r),r=iu.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=Bc(Uc(o.y,0,1))).getDay(),r=i>4||0===i?lu.ceil(r):lu(r),r=ru.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?Ic(Uc(o.y,0,1)).getUTCDay():Bc(Uc(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,Ic(o)):Bc(o)}}function O(e,t,n,r){for(var i,o,a=0,s=t.length,l=n.length;a<s;){if(r>=l)return-1;if(37===(i=t.charCodeAt(a++))){if(i=t.charAt(a++),!(o=w[i in Yc?t.charAt(a++):i])||(r=o(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return b.x=k(n,b),b.X=k(r,b),b.c=k(t,b),x.x=k(n,x),x.X=k(r,x),x.c=k(t,x),{format:function(e){var t=k(e+="",b);return t.toString=function(){return e},t},parse:function(e){var t=_(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=k(e+="",x);return t.toString=function(){return e},t},utcParse:function(e){var t=_(e+="",!0);return t.toString=function(){return e},t}}}var Wc,Zc,Hc,Gc,Vc,Yc={"-":"",_:" ",0:"0"},Xc=/^\s*\d+/,Jc=/^%/,Qc=/[\\^$*+?|[\]().{}]/g;function Kc(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function ef(e){return e.replace(Qc,"\\$&")}function tf(e){return new RegExp("^(?:"+e.map(ef).join("|")+")","i")}function nf(e){return new Map(e.map(((e,t)=>[e.toLowerCase(),t])))}function rf(e,t,n){var r=Xc.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function of(e,t,n){var r=Xc.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function af(e,t,n){var r=Xc.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function sf(e,t,n){var r=Xc.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function lf(e,t,n){var r=Xc.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function uf(e,t,n){var r=Xc.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function cf(e,t,n){var r=Xc.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function ff(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function df(e,t,n){var r=Xc.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function hf(e,t,n){var r=Xc.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function pf(e,t,n){var r=Xc.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function mf(e,t,n){var r=Xc.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function gf(e,t,n){var r=Xc.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function yf(e,t,n){var r=Xc.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function vf(e,t,n){var r=Xc.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function bf(e,t,n){var r=Xc.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function xf(e,t,n){var r=Xc.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function wf(e,t,n){var r=Jc.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function kf(e,t,n){var r=Xc.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function _f(e,t,n){var r=Xc.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Of(e,t){return Kc(e.getDate(),t,2)}function Ef(e,t){return Kc(e.getHours(),t,2)}function Df(e,t){return Kc(e.getHours()%12||12,t,2)}function jf(e,t){return Kc(1+ru.count(Ou(e),e),t,3)}function Nf(e,t){return Kc(e.getMilliseconds(),t,3)}function Sf(e,t){return Nf(e,t)+"000"}function Af(e,t){return Kc(e.getMonth()+1,t,2)}function $f(e,t){return Kc(e.getMinutes(),t,2)}function Cf(e,t){return Kc(e.getSeconds(),t,2)}function Mf(e){var t=e.getDay();return 0===t?7:t}function Pf(e,t){return Kc(su.count(Ou(e)-1,e),t,2)}function Ff(e){var t=e.getDay();return t>=4||0===t?fu(e):fu.ceil(e)}function Tf(e,t){return e=Ff(e),Kc(fu.count(Ou(e),e)+(4===Ou(e).getDay()),t,2)}function zf(e){return e.getDay()}function Rf(e,t){return Kc(lu.count(Ou(e)-1,e),t,2)}function Lf(e,t){return Kc(e.getFullYear()%100,t,2)}function Bf(e,t){return Kc((e=Ff(e)).getFullYear()%100,t,2)}function If(e,t){return Kc(e.getFullYear()%1e4,t,4)}function Uf(e,t){var n=e.getDay();return Kc((e=n>=4||0===n?fu(e):fu.ceil(e)).getFullYear()%1e4,t,4)}function qf(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Kc(t/60|0,"0",2)+Kc(t%60,"0",2)}function Wf(e,t){return Kc(e.getUTCDate(),t,2)}function Zf(e,t){return Kc(e.getUTCHours(),t,2)}function Hf(e,t){return Kc(e.getUTCHours()%12||12,t,2)}function Gf(e,t){return Kc(1+iu.count(Eu(e),e),t,3)}function Vf(e,t){return Kc(e.getUTCMilliseconds(),t,3)}function Yf(e,t){return Vf(e,t)+"000"}function Xf(e,t){return Kc(e.getUTCMonth()+1,t,2)}function Jf(e,t){return Kc(e.getUTCMinutes(),t,2)}function Qf(e,t){return Kc(e.getUTCSeconds(),t,2)}function Kf(e){var t=e.getUTCDay();return 0===t?7:t}function ed(e,t){return Kc(mu.count(Eu(e)-1,e),t,2)}function td(e){var t=e.getUTCDay();return t>=4||0===t?bu(e):bu.ceil(e)}function nd(e,t){return e=td(e),Kc(bu.count(Eu(e),e)+(4===Eu(e).getUTCDay()),t,2)}function rd(e){return e.getUTCDay()}function id(e,t){return Kc(gu.count(Eu(e)-1,e),t,2)}function od(e,t){return Kc(e.getUTCFullYear()%100,t,2)}function ad(e,t){return Kc((e=td(e)).getUTCFullYear()%100,t,2)}function sd(e,t){return Kc(e.getUTCFullYear()%1e4,t,4)}function ld(e,t){var n=e.getUTCDay();return Kc((e=n>=4||0===n?bu(e):bu.ceil(e)).getUTCFullYear()%1e4,t,4)}function ud(){return"+0000"}function cd(){return"%"}function fd(e){return+e}function dd(e){return Math.floor(+e/1e3)}function hd(e){const t={};return n=>t[n]||(t[n]=e(n))}function pd(e){const t=hd(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(e){const n=jl(e||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let o=function(e,t){let n,r=e.lastIndexOf("e");if(r>0)return r;for(r=e.length;--r>t;)if(n=e.charCodeAt(r),n>=48&&n<=57)return r+1}(r,i);const a=o<r.length?r.slice(o):"";for(;--o>i;)if("0"!==r[o]){++o;break}return r.slice(0,o)+a}}(t(n),t(".1f")(1)[1])}return t(n)},formatSpan(e,r,i,o){o=jl(null==o?",f":o);const a=dl(e,r,i),s=Math.max(Math.abs(e),Math.abs(r));let l;if(null==o.precision)switch(o.type){case"s":return isNaN(l=Ll(a,s))||(o.precision=l),n(o,s);case"":case"e":case"g":case"p":case"r":isNaN(l=Bl(a,s))||(o.precision=l-("e"===o.type));break;case"f":case"%":isNaN(l=Rl(a))||(o.precision=l-2*("%"===o.type))}return t(o)}}}let md,gd;function yd(){return md=pd({format:Ml,formatPrefix:Pl})}function vd(e){return pd(zl(e))}function bd(e){return arguments.length?md=vd(e):md}function xd(e,t,n){pa(n=n||{})||Jo(`Invalid time multi-format specifier: ${n}`);const r=t(Bu),i=t(Lu),o=t(Ru),a=t(Fu),s=t(Pu),l=t(Mu),u=t(Cu),c=t($u),f=e(n[Iu]||".%L"),d=e(n[Bu]||":%S"),h=e(n[Lu]||"%I:%M"),p=e(n[Ru]||"%I %p"),m=e(n[Fu]||n[Tu]||"%a %d"),g=e(n[Pu]||"%b %d"),y=e(n[Mu]||"%B"),v=e(n[Cu]||"%B"),b=e(n[$u]||"%Y");return e=>(r(e)<e?f:i(e)<e?d:o(e)<e?h:a(e)<e?p:l(e)<e?s(e)<e?m:g:c(e)<e?u(e)<e?y:v:b)(e)}function wd(e){const t=hd(e.format),n=hd(e.utcFormat);return{timeFormat:e=>cs(e)?t(e):xd(t,yc,e),utcFormat:e=>cs(e)?n(e):xd(n,vc,e),timeParse:hd(e.parse),utcParse:hd(e.utcParse)}}function kd(){return gd=wd({format:Zc,parse:Hc,utcFormat:Gc,utcParse:Vc})}function _d(e){return wd(qc(e))}function Od(e){return arguments.length?gd=_d(e):gd}!function(e){Wc=qc(e),Zc=Wc.format,Hc=Wc.parse,Gc=Wc.utcFormat,Vc=Wc.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),yd(),kd();const Ed=(e,t)=>Ya({},e,t);function Dd(e,t){const n=e?vd(e):bd(),r=t?_d(t):Od();return Ed(n,r)}function jd(e,t){const n=arguments.length;return n&&2!==n&&Jo("defaultLocale expects either zero or two arguments."),n?Ed(bd(e),Od(t)):Ed(bd(),Od())}const Nd=/^(data:|([A-Za-z]+:)?\/\/)/,Sd=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Ad=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,$d="file://";async function Cd(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function Md(e,t){t=Ya({},this.options,t);const n=this.fileAccess,r={href:null};let i,o,a;const s=Sd.test(e.replace(Ad,""));null!=e&&"string"==typeof e&&s||Jo("Sanitize failure, invalid URI: "+vs(e));const l=Nd.test(e);return(a=t.baseURL)&&!l&&(e.startsWith("/")||a.endsWith("/")||(e="/"+e),e=a+e),o=(i=e.startsWith($d))||"file"===t.mode||"http"!==t.mode&&!l&&n,i?e=e.slice($d.length):e.startsWith("//")&&("file"===t.defaultProtocol?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!o}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),"image"===t.context&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function Pd(e){return e?t=>new Promise(((n,r)=>{e.readFile(t,((e,t)=>{e?r(e):n(t)}))})):Fd}async function Fd(){Jo("No file system access.")}function Td(e){return e?async function(t,n){const r=Ya({},this.options.http,n),i=n&&n.response,o=await e(t,r);return o.ok?Ba(o[i])?o[i]():o.text():Jo(o.status+""+o.statusText)}:zd}async function zd(){Jo("No HTTP fetch method available.")}const Rd=e=>null!=e&&e==e,Ld=e=>!(Number.isNaN(+e)||e instanceof Date),Bd={boolean:bs,integer:xa,number:xa,date:ws,string:ks,unknown:ta},Id=[e=>"true"===e||"false"===e||!0===e||!1===e,e=>Ld(e)&&Number.isInteger(+e),Ld,e=>!Number.isNaN(Date.parse(e))],Ud=["boolean","integer","number","date"];function qd(e,t){if(!e||!e.length)return"unknown";const n=e.length,r=Id.length,i=Id.map(((e,t)=>t+1));for(let o,a,s=0,l=0;s<n;++s)for(a=t?e[s][t]:e[s],o=0;o<r;++o)if(i[o]&&Rd(a)&&!Id[o](a)&&(i[o]=0,++l,l===Id.length))return"string";return Ud[i.reduce(((e,t)=>0===e?t:e),0)-1]}function Wd(e,t){return t.reduce(((t,n)=>(t[n]=qd(e,n),t)),{})}function Zd(e){const t=function(t,n){const r={delimiter:e};return Hd(t,n?Ya(n,r):r)};return t.responseType="text",t}function Hd(e,t){return t.header&&(e=t.header.map(vs).join(t.delimiter)+"\n"+e),Fs(t.delimiter).parse(e+"")}function Gd(e,t){const n=t&&t.property?Ko(t.property):ta;return!pa(e)||(r=e,"function"==typeof Buffer&&Ba(Buffer.isBuffer)&&Buffer.isBuffer(r))?n(JSON.parse(e)):function(e,t){!ha(e)&&ss(e)&&(e=[...e]);return t&&t.copy?JSON.parse(JSON.stringify(e)):e}(n(e),t);var r}Hd.responseType="text",Gd.responseType="json";const Vd={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function Yd(e,t){let n,r,i,o;return e=Gd(e,t),t&&t.feature?(n=zs,i=t.feature):t&&t.mesh?(n=Is,i=t.mesh,o=Vd[t.filter]):Jo("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,o):Jo("Invalid TopoJSON object: "+i),r&&r.features||[r]}Yd.responseType="json";const Xd={dsv:Hd,csv:Zd(","),tsv:Zd("\t"),json:Gd,topojson:Yd};function Jd(e,t){return arguments.length>1?(Xd[e]=t,this):Ka(Xd,e)?Xd[e]:null}function Qd(e){const t=Jd(e);return t&&t.responseType||"text"}function Kd(e,t,n,r){const i=Jd((t=t||{}).type||"json");return i||Jo("Unknown data format type: "+t.type),e=i(e,t),t.parse&&function(e,t,n,r){if(!e.length)return;const i=Od();n=n||i.timeParse,r=r||i.utcParse;let o,a,s,l,u,c,f=e.columns||Object.keys(e[0]);"auto"===t&&(t=Wd(e,f));f=Object.keys(t);const d=f.map((e=>{const i=t[e];let o,a;if(i&&(i.startsWith("date:")||i.startsWith("utc:"))){o=i.split(/:(.+)?/,2),a=o[1],("'"===a[0]&&"'"===a[a.length-1]||'"'===a[0]&&'"'===a[a.length-1])&&(a=a.slice(1,-1));return("utc"===o[0]?r:n)(a)}if(!Bd[i])throw Error("Illegal format pattern: "+e+":"+i);return Bd[i]}));for(s=0,u=e.length,c=f.length;s<u;++s)for(o=e[s],l=0;l<c;++l)a=f[l],o[a]=d[l](o[a])}(e,t.parse,n,r),Ka(e,"columns")&&delete e.columns,e}const eh=function(e,t){return n=>({options:n||{},sanitize:Md,load:Cd,fileAccess:!!t,file:Pd(t),http:Td(e)})}("undefined"!=typeof fetch&&fetch,null);function th(e){const t=e||ta,n=[],r={};return n.add=e=>{const i=t(e);return r[i]||(r[i]=1,n.push(e)),n},n.remove=e=>{const i=t(e);if(r[i]){r[i]=0;const t=n.indexOf(e);t>=0&&n.splice(t,1)}return n},n}async function nh(e,t){try{await t(e)}catch(n){e.error(n)}}const rh=Symbol("vega_id");let ih=1;function oh(e){return!(!e||!ah(e))}function ah(e){return e[rh]}function sh(e,t){return e[rh]=t,e}function lh(e){const t=e===Object(e)?e:{data:e};return ah(t)?t:sh(t,ih++)}function uh(e){return ch(e,lh({}))}function ch(e,t){for(const n in e)t[n]=e[n];return t}function fh(e,t){return sh(t,ah(e))}function dh(e,t){return e?t?(n,r)=>e(n,r)||ah(t(n))-ah(t(r)):(t,n)=>e(t,n)||ah(t)-ah(n):null}function hh(e){return e&&e.constructor===ph}function ph(){const e=[],t=[],n=[],r=[],i=[];let o=null,a=!1;return{constructor:ph,insert(t){const n=Ra(t),r=n.length;for(let i=0;i<r;++i)e.push(n[i]);return this},remove(e){const n=Ba(e)?r:t,i=Ra(e),o=i.length;for(let t=0;t<o;++t)n.push(i[t]);return this},modify(e,t,r){const o={field:t,value:Ga(r)};return Ba(e)?(o.filter=e,i.push(o)):(o.tuple=e,n.push(o)),this},encode(e,t){return Ba(e)?i.push({filter:e,field:t}):n.push({tuple:e,field:t}),this},clean(e){return o=e,this},reflow(){return a=!0,this},pulse(s,l){const u={},c={};let f,d,h,p,m,g;for(f=0,d=l.length;f<d;++f)u[ah(l[f])]=1;for(f=0,d=t.length;f<d;++f)m=t[f],u[ah(m)]=-1;for(f=0,d=r.length;f<d;++f)p=r[f],l.forEach((e=>{p(e)&&(u[ah(e)]=-1)}));for(f=0,d=e.length;f<d;++f)m=e[f],g=ah(m),u[g]?u[g]=1:s.add.push(lh(e[f]));for(f=0,d=l.length;f<d;++f)m=l[f],u[ah(m)]<0&&s.rem.push(m);function y(e,t,n){n?e[t]=n(e):s.encode=t,a||(c[ah(e)]=e)}for(f=0,d=n.length;f<d;++f)h=n[f],m=h.tuple,p=h.field,g=u[ah(m)],g>0&&(y(m,p,h.value),s.modifies(p));for(f=0,d=i.length;f<d;++f)h=i[f],p=h.filter,l.forEach((e=>{p(e)&&u[ah(e)]>0&&y(e,h.field,h.value)})),s.modifies(h.field);if(a)s.mod=t.length||r.length?l.filter((e=>u[ah(e)]>0)):l.slice();else for(g in c)s.mod.push(c[g]);return(o||null==o&&(t.length||r.length))&&s.clean(!0),s}}}const mh="_:mod:_";function gh(){Object.defineProperty(this,mh,{writable:!0,value:{}})}gh.prototype={set(e,t,n,r){const i=this,o=i[e],a=i[mh];return null!=t&&t>=0?(o[t]!==n||r)&&(o[t]=n,a[t+":"+e]=-1,a[e]=-1):(o!==n||r)&&(i[e]=n,a[e]=ha(n)?1+n.length:-1),i},modified(e,t){const n=this[mh];if(!arguments.length){for(const e in n)if(n[e])return!0;return!1}if(ha(e)){for(let t=0;t<e.length;++t)if(n[e[t]])return!0;return!1}return null!=t&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[mh]={},this}};let yh=0;const vh=new gh;function bh(e,t,n,r){this.id=++yh,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function xh(e){return function(t){const n=this.flags;return 0===arguments.length?!!(n&e):(this.flags=t?n|e:n&~e,this)}}bh.prototype={targets(){return this._targets||(this._targets=th(ea))},set(e){return this.value!==e?(this.value=e,1):0},skip:xh(1),modified:xh(2),parameters(e,t,n){t=!1!==t;const r=this._argval=this._argval||new gh,i=this._argops=this._argops||[],o=[];let a,s,l,u;const c=(e,n,a)=>{a instanceof bh?(a!==this&&(t&&a.targets().add(this),o.push(a)),i.push({op:a,name:e,index:n})):r.set(e,n,a)};for(a in e)if(s=e[a],"pulse"===a)Ra(s).forEach((e=>{e instanceof bh?e!==this&&(e.targets().add(this),o.push(e)):Jo("Pulse parameters must be operator instances.")})),this.source=s;else if(ha(s))for(r.set(a,-1,Array(l=s.length)),u=0;u<l;++u)c(a,u,s[u]);else c(a,-1,s);return this.marshall().clear(),n&&(i.initonly=!0),o},marshall(e){const t=this._argval||vh,n=this._argops;let r,i,o,a;if(n){const s=n.length;for(i=0;i<s;++i)r=n[i],o=r.op,a=o.modified()&&o.stamp===e,t.set(r.name,r.index,o.value,a);if(n.initonly){for(i=0;i<s;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,r,i;if(e)for(t=0,n=e.length;t<n;++t)r=e[t],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};let wh=0;function kh(e,t,n){this.id=++wh,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function _h(e,t,n){return new kh(e,t,n)}kh.prototype={_filter:ia,_apply:ta,targets(){return this._targets||(this._targets=th(ea))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,r=n?n.length:0;for(let e=0;e<r;++e)n[e].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=_h(e);return this.targets().add(t),t},apply(e){const t=_h(null,e);return this.targets().add(t),t},merge(){const e=_h();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter((()=>{const n=Date.now();return n-t>e?(t=n,1):0}))},debounce(e){const t=_h();return this.targets().add(_h(null,null,Va(e,(e=>{const n=e.dataflow;t.receive(e),n&&n.run&&n.run()})))),t},between(e,t){let n=!1;return e.targets().add(_h(null,null,(()=>n=!0))),t.targets().add(_h(null,null,(()=>n=!1))),this.filter((()=>n))},detach(){this._filter=ia,this._targets=null}};const Oh={skip:!0};function Eh(e,t,n,r,i,o){const a=Ya({},o,Oh);let s,l;Ba(n)||(n=Ga(n)),void 0===r?s=t=>e.touch(n(t)):Ba(r)?(l=new bh(null,r,i,!1),s=t=>{l.evaluate(t);const r=n(t),i=l.value;hh(i)?e.pulse(r,i,o):e.update(r,i,a)}):s=t=>e.update(n(t),r,a),t.apply(s)}function Dh(e,t,n,r,i,o){if(void 0===r)t.targets().add(n);else{const a=o||{},s=new bh(null,function(e,t){return t=Ba(t)?t:Ga(t),e?function(n,r){const i=t(n,r);return e.skip()||(e.skip(i!==this.value).value=i),i}:t}(n,r),i,!1);s.modified(a.force),s.rank=t.rank,t.targets().add(s),n&&(s.skip(!0),s.value=n.value,s.targets().add(n),e.connect(n,[s]))}}const jh={};function Nh(e,t,n){this.dataflow=e,this.stamp=null==t?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function Sh(e,t){const n=[];return Es(e,t,(e=>n.push(e))),n}function Ah(e,t){const n={};return e.visit(t,(e=>{n[ah(e)]=1})),e=>n[ah(e)]?null:e}function $h(e,t){return e?(n,r)=>e(n,r)&&t(n,r):t}function Ch(e,t,n,r){const i=this;let o=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;for(const a of n)if(a.stamp===t){if(a.fields){const e=i.fields||(i.fields={});for(const t in a.fields)e[t]=1}a.changed(i.ADD)&&(o|=i.ADD),a.changed(i.REM)&&(o|=i.REM),a.changed(i.MOD)&&(o|=i.MOD)}this.changes=o}function Mh(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}Nh.prototype={StopPropagation:jh,ADD:1,REM:2,MOD:4,ADD_REM:3,ADD_MOD:5,ALL:7,REFLOW:8,SOURCE:16,NO_SOURCE:32,NO_FIELDS:64,fork(e){return new Nh(this.dataflow).init(this,e)},clone(){const e=this.fork(7);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(23)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new Nh(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,!e.fields||64&t||(n.fields=e.fields),1&t?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),2&t?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),4&t?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),32&t?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||7;return 1&t&&this.add.length||2&t&&this.rem.length||4&t&&this.mod.length},reflow(e){if(e)return this.fork(7).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(4,Ah(this,1))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return ha(e)?e.forEach((e=>t[e]=!0)):t[e]=!0,this},modified(e,t){const n=this.fields;return!(!t&&!this.mod.length||!n)&&(arguments.length?ha(e)?e.some((e=>n[e])):n[e]:!!n)},filter(e,t){const n=this;return 1&e&&(n.addF=$h(n.addF,t)),2&e&&(n.remF=$h(n.remF,t)),4&e&&(n.modF=$h(n.modF,t)),16&e&&(n.srcF=$h(n.srcF,t)),n},materialize(e){const t=this;return 1&(e=e||7)&&t.addF&&(t.add=Sh(t.add,t.addF),t.addF=null),2&e&&t.remF&&(t.rem=Sh(t.rem,t.remF),t.remF=null),4&e&&t.modF&&(t.mod=Sh(t.mod,t.modF),t.modF=null),16&e&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,r=t;if(16&e)return Es(n.source,n.srcF,r),n;1&e&&Es(n.add,n.addF,r),2&e&&Es(n.rem,n.remF,r),4&e&&Es(n.mod,n.modF,r);const i=n.source;if(8&e&&i){const e=n.add.length+n.mod.length;e===i.length||Es(i,e?Ah(n,5):n.srcF,r)}return n}},rs(Ch,Nh,{fork(e){const t=new Nh(this.dataflow).init(this,e&this.NO_FIELDS);return void 0!==e&&(e&t.ADD&&this.visit(t.ADD,(e=>t.add.push(e))),e&t.REM&&this.visit(t.REM,(e=>t.rem.push(e))),e&t.MOD&&this.visit(t.MOD,(e=>t.mod.push(e)))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?ha(e)?e.some((e=>n[e])):n[e]:0},filter(){Jo("MultiPulse does not support filtering.")},materialize(){Jo("MultiPulse does not support materialization.")},visit(e,t){const n=this,r=n.pulses,i=r.length;let o=0;if(e&n.SOURCE)for(;o<i;++o)r[o].visit(e,t);else for(;o<i;++o)r[o].stamp===n.stamp&&r[o].visit(e,t);return n}});const Ph={skip:!1,force:!1};function Fh(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),Th(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let r;return t.length?(r=t[0],t[0]=n,function(e,t,n){const r=t,i=e.length,o=e[t];let a,s=1+(t<<1);for(;s<i;)a=s+1,a<i&&n(e[s],e[a])>=0&&(s=a),e[t]=e[s],s=1+((t=s)<<1);e[t]=o,Th(e,r,t,n)}(t,0,e)):r=n,r}}}function Th(e,t,n,r){let i,o;const a=e[n];for(;n>t&&(o=n-1>>1,i=e[o],r(a,i)<0);)e[n]=i,n=o;return e[n]=a}function zh(){this.logger(da()),this.logLevel(la),this._clock=0,this._rank=0,this._locale=jd();try{this._loader=eh()}catch(x9){}this._touched=th(ea),this._input={},this._pulse=null,this._heap=Fh(((e,t)=>e.qrank-t.qrank)),this._postrun=[]}function Rh(e){return function(){return this._log[e].apply(this,arguments)}}function Lh(e,t){bh.call(this,e,null,t)}zh.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:Rh("error"),warn:Rh("warn"),info:Rh("info"),debug:Rh("debug"),logLevel:Rh("level"),cleanThreshold:1e4,add:function(e,t,n,r){let i,o=1;return e instanceof bh?i=e:e&&e.prototype instanceof bh?i=new e:Ba(e)?i=new bh(null,e):(o=0,i=new bh(e,t)),this.rank(i),o&&(r=n,n=t),n&&this.connect(i,i.parameters(n,r)),this.touch(i),i},connect:function(e,t){const n=e.rank,r=t.length;for(let i=0;i<r;++i)if(n<t[i].rank)return void this.rerank(e)},rank:function(e){e.rank=++this._rank},rerank:function(e){const t=[e];let n,r,i;for(;t.length;)if(this.rank(n=t.pop()),r=n._targets)for(i=r.length;--i>=0;)t.push(n=r[i]),n===e&&Jo("Cycle detected in dataflow graph.")},pulse:function(e,t,n){this.touch(e,n||Ph);const r=new Nh(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,i),this},touch:function(e,t){const n=t||Ph;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this},update:function(e,t,n){const r=n||Ph;return(e.set(t)||r.force)&&this.touch(e,r),this},changeset:ph,ingest:function(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))},parse:function(e,t){const n=this.locale();return Kd(e,t,n.timeParse,n.utcParse)},preload:async function(e,t,n){const r=this,i=r._pending||function(e){let t;const n=new Promise((e=>t=e));return n.requests=0,n.done=()=>{0==--n.requests&&(e._pending=null,t(e))},e._pending=n}(r);i.requests+=1;const o=await r.request(t,n);return r.pulse(e,r.changeset().remove(ia).insert(o.data||[])),i.done(),o},request:async function(e,t){const n=this;let r,i=0;try{r=await n.loader().load(e,{context:"dataflow",response:Qd(t&&t.type)});try{r=n.parse(r,t)}catch(o){i=-2,n.warn("Data ingestion failed",e,o)}}catch(o){i=-1,n.warn("Loading failed",e,o)}return{data:r,status:i}},events:function(e,t,n,r){const i=this,o=_h(n,r),a=function(e){e.dataflow=i;try{o.receive(e)}catch(Jo){i.error(Jo)}finally{i.run()}};let s;s="string"==typeof e&&"undefined"!=typeof document?document.querySelectorAll(e):Ra(e);const l=s.length;for(let u=0;u<l;++u)s[u].addEventListener(t,a);return o},on:function(e,t,n,r,i){return(e instanceof bh?Dh:Eh)(this,e,t,n,r,i),this},evaluate:async function(e,t,n){const r=this,i=[];if(r._pulse)return Mh(r);if(r._pending&&await r._pending,t&&await nh(r,t),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const o=++r._clock;r._pulse=new Nh(r,o,e),r._touched.forEach((e=>r._enqueue(e,!0))),r._touched=th(ea);let a,s,l,u=0;try{for(;r._heap.size()>0;)a=r._heap.pop(),a.rank===a.qrank?(s=a.run(r._getPulse(a,e)),s.then?s=await s:s.async&&(i.push(s.async),s=jh),s!==jh&&a._targets&&a._targets.forEach((e=>r._enqueue(e))),++u):r._enqueue(a,!0)}catch(c){r._heap.clear(),l=c}if(r._input={},r._pulse=null,r.debug(`Pulse ${o}: ${u} operators`),l&&(r._postrun=[],r.error(l)),r._postrun.length){const e=r._postrun.sort(((e,t)=>t.priority-e.priority));r._postrun=[];for(let t=0;t<e.length;++t)await nh(r,e[t].callback)}return n&&await nh(r,n),i.length&&Promise.all(i).then((e=>r.runAsync(null,(()=>{e.forEach((e=>{try{e(r)}catch(c){r.error(c)}}))})))),r},run:function(e,t,n){return this._pulse?Mh(this):(this.evaluate(e,t,n),this)},runAsync:async function(e,t,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(r,r),this._running},runAfter:function(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(r){this.error(r)}},_enqueue:function(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))},_getPulse:function(e,t){const n=e.source,r=this._clock;return n&&ha(n)?new Ch(this,r,n.map((e=>e.pulse)),t):this._input[e.id]||function(e,t){if(t&&t.stamp===e.stamp)return t;e=e.fork(),t&&t!==jh&&(e.source=t.source);return e}(this._pulse,n&&n.pulse)}},rs(Lh,bh,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then((e=>this.pulse=e)):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const Bh={};function Ih(e){const t=Uh(e);return t&&t.Definition||null}function Uh(e){return e=e&&e.toLowerCase(),Ka(Bh,e)?Bh[e]:null}function*qh(e,t){if(null==t)for(let n of e)null!=n&&""!==n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)r=t(r,++n,e),null!=r&&""!==r&&(r=+r)>=r&&(yield r)}}function Wh(e,t,n){const r=Float64Array.from(qh(e,n));return r.sort(qs),t.map((e=>vl(r,e)))}function Zh(e,t){return Wh(e,[.25,.5,.75],t)}function Hh(e,t){const n=e.length,r=function(e,t){const n=function(e,t){let n,r=0,i=0,o=0;if(void 0===t)for(let a of e)null!=a&&(a=+a)>=a&&(n=a-i,i+=n/++r,o+=n*(a-i));else{let a=-1;for(let s of e)null!=(s=t(s,++a,e))&&(s=+s)>=s&&(n=s-i,i+=n/++r,o+=n*(s-i))}if(r>1)return o/(r-1)}(e,t);return n?Math.sqrt(n):n}(e,t),i=Zh(e,t),o=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,o)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function Gh(e){const t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2];let o,a,s,l,u,c,f=e.extent[0],d=e.extent[1];const h=e.span||d-f||Math.abs(f)||1;if(e.step)o=e.step;else if(e.steps){for(l=h/t,u=0,c=e.steps.length;u<c&&e.steps[u]<l;++u);o=e.steps[Math.max(0,u-1)]}else{for(a=Math.ceil(Math.log(t)/r),s=e.minstep||0,o=Math.max(s,Math.pow(n,Math.round(Math.log(h)/r)-a));Math.ceil(h/o)>t;)o*=n;for(u=0,c=i.length;u<c;++u)l=o/i[u],l>=s&&h/l<=t&&(o=l)}l=Math.log(o);const p=l>=0?0:1+~~(-l/r),m=Math.pow(n,-p-1);return(e.nice||void 0===e.nice)&&(l=Math.floor(f/o+m)*o,f=f<l?l-o:l,d=Math.ceil(d/o)*o),{start:f,stop:d===f?f+o:d,step:o}}var Vh=Math.random;function Yh(e,t,n,r){if(!e.length)return[void 0,void 0];const i=Float64Array.from(qh(e,r)),o=i.length,a=t;let s,l,u,c;for(u=0,c=Array(a);u<a;++u){for(s=0,l=0;l<o;++l)s+=i[~~(Vh()*o)];c[u]=s/o}return c.sort(qs),[yl(c,n/2),yl(c,1-n/2)]}function Xh(e,t,n,r){r=r||(e=>e);const i=e.length,o=new Float64Array(i);let a,s=0,l=1,u=r(e[0]),c=u,f=u+t;for(;l<i;++l){if(a=r(e[l]),a>=f){for(c=(u+c)/2;s<l;++s)o[s]=c;f=a+t,u=a}c=a}for(c=(u+c)/2;s<l;++s)o[s]=c;return n?function(e,t){const n=e.length;let r,i,o=0,a=1;for(;e[o]===e[a];)++a;for(;a<n;){for(r=a+1;e[a]===e[r];)++r;if(e[a]-e[a-1]<t){for(i=a+(o+r-a-a>>1);i<a;)e[i++]=e[a];for(;i>a;)e[i--]=e[o]}o=a,a=r}return e}(o,t+t/4):o}const Jh=Math.sqrt(2*Math.PI),Qh=Math.SQRT2;let Kh=NaN;function ep(e,t){e=e||0,t=null==t?1:t;let n,r,i=0,o=0;if(Kh==Kh)i=Kh,Kh=NaN;else{do{i=2*Vh()-1,o=2*Vh()-1,n=i*i+o*o}while(0===n||n>1);r=Math.sqrt(-2*Math.log(n)/n),i*=r,Kh=o*r}return e+i*t}function tp(e,t,n){const r=(e-(t||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*Jh)}function np(e,t,n){const r=(e-(t=t||0))/(n=null==n?1:n),i=Math.abs(r);let o;if(i>37)o=0;else{const e=Math.exp(-i*i/2);let t;i<7.07106781186547?(t=.0352624965998911*i+.700383064443688,t=t*i+6.37396220353165,t=t*i+33.912866078383,t=t*i+112.079291497871,t=t*i+221.213596169931,t=t*i+220.206867912376,o=e*t,t=.0883883476483184*i+1.75566716318264,t=t*i+16.064177579207,t=t*i+86.7807322029461,t=t*i+296.564248779674,t=t*i+637.333633378831,t=t*i+793.826512519948,t=t*i+440.413735824752,o/=t):(t=i+.65,t=i+4/t,t=i+3/t,t=i+2/t,t=i+1/t,o=e/t/2.506628274631)}return r>0?1-o:o}function rp(e,t,n){return e<0||e>1?NaN:(t||0)+(null==n?1:n)*Qh*function(e){let t,n=-Math.log((1-e)*(1+e));n<6.25?(n-=3.125,t=-364441206401782e-35,t=t*n-16850591381820166e-35,t=128584807152564e-32+t*n,t=11157877678025181e-33+t*n,t=t*n-1333171662854621e-31,t=20972767875968562e-33+t*n,t=6637638134358324e-30+t*n,t=t*n-4054566272975207e-29,t=t*n-8151934197605472e-29,t=26335093153082323e-28+t*n,t=t*n-12975133253453532e-27,t=t*n-5415412054294628e-26,t=1.0512122733215323e-9+t*n,t=t*n-4.112633980346984e-9,t=t*n-2.9070369957882005e-8,t=4.2347877827932404e-7+t*n,t=t*n-13654692000834679e-22,t=t*n-13882523362786469e-21,t=.00018673420803405714+t*n,t=t*n-.000740702534166267,t=t*n-.006033670871430149,t=.24015818242558962+t*n,t=1.6536545626831027+t*n):n<16?(n=Math.sqrt(n)-3.25,t=2.2137376921775787e-9,t=9.075656193888539e-8+t*n,t=t*n-2.7517406297064545e-7,t=1.8239629214389228e-8+t*n,t=15027403968909828e-22+t*n,t=t*n-4013867526981546e-21,t=29234449089955446e-22+t*n,t=12475304481671779e-21+t*n,t=t*n-47318229009055734e-21,t=6828485145957318e-20+t*n,t=24031110387097894e-21+t*n,t=t*n-.0003550375203628475,t=.0009532893797373805+t*n,t=t*n-.0016882755560235047,t=.002491442096107851+t*n,t=t*n-.003751208507569241,t=.005370914553590064+t*n,t=1.0052589676941592+t*n,t=3.0838856104922208+t*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,t=-27109920616438573e-27,t=t*n-2.555641816996525e-10,t=1.5076572693500548e-9+t*n,t=t*n-3.789465440126737e-9,t=7.61570120807834e-9+t*n,t=t*n-1.496002662714924e-8,t=2.914795345090108e-8+t*n,t=t*n-6.771199775845234e-8,t=2.2900482228026655e-7+t*n,t=t*n-9.9298272942317e-7,t=4526062597223154e-21+t*n,t=t*n-1968177810553167e-20,t=7599527703001776e-20+t*n,t=t*n-.00021503011930044477,t=t*n-.00013871931833623122,t=1.0103004648645344+t*n,t=4.849906401408584+t*n):t=1/0;return t*e}(2*e-1)}function ip(e,t){let n,r;const i={mean(e){return arguments.length?(n=e||0,i):n},stdev(e){return arguments.length?(r=null==e?1:e,i):r},sample:()=>ep(n,r),pdf:e=>tp(e,n,r),cdf:e=>np(e,n,r),icdf:e=>rp(e,n,r)};return i.mean(e).stdev(t)}function op(e,t){const n=ip();let r=0;const i={data(n){return arguments.length?(e=n,r=n?n.length:0,i.bandwidth(t)):e},bandwidth(n){return arguments.length?(!(t=n)&&e&&(t=Hh(e)),i):t},sample:()=>e[~~(Vh()*r)]+t*n.sample(),pdf(i){let o=0,a=0;for(;a<r;++a)o+=n.pdf((i-e[a])/t);return o/t/r},cdf(i){let o=0,a=0;for(;a<r;++a)o+=n.cdf((i-e[a])/t);return o/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(e)}function ap(e,t){return e=e||0,t=null==t?1:t,Math.exp(e+ep()*t)}function sp(e,t,n){if(e<=0)return 0;t=t||0,n=null==n?1:n;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*Jh*e)}function lp(e,t,n){return np(Math.log(e),t,n)}function up(e,t,n){return Math.exp(rp(e,t,n))}function cp(e,t){let n,r;const i={mean(e){return arguments.length?(n=e||0,i):n},stdev(e){return arguments.length?(r=null==e?1:e,i):r},sample:()=>ap(n,r),pdf:e=>sp(e,n,r),cdf:e=>lp(e,n,r),icdf:e=>up(e,n,r)};return i.mean(e).stdev(t)}function fp(e,t){let n,r=0;const i={weights(e){return arguments.length?(n=function(e){const t=[];let n,i=0;for(n=0;n<r;++n)i+=t[n]=null==e[n]?1:+e[n];for(n=0;n<r;++n)t[n]/=i;return t}(t=e||[]),i):t},distributions(n){return arguments.length?(n?(r=n.length,e=n):(r=0,e=[]),i.weights(t)):e},sample(){const t=Vh();let i=e[r-1],o=n[0],a=0;for(;a<r-1;o+=n[++a])if(t<o){i=e[a];break}return i.sample()},pdf(t){let i=0,o=0;for(;o<r;++o)i+=n[o]*e[o].pdf(t);return i},cdf(t){let i=0,o=0;for(;o<r;++o)i+=n[o]*e[o].cdf(t);return i},icdf(){throw Error("Mixture icdf not supported.")}};return i.distributions(e).weights(t)}function dp(e,t){return null==t&&(t=null==e?1:e,e=0),e+(t-e)*Vh()}function hp(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function pp(e,t,n){return null==n&&(n=null==t?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function mp(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function gp(e,t){let n,r;const i={min(e){return arguments.length?(n=e||0,i):n},max(e){return arguments.length?(r=null==e?1:e,i):r},sample:()=>dp(n,r),pdf:e=>hp(e,n,r),cdf:e=>pp(e,n,r),icdf:e=>mp(e,n,r)};return null==t&&(t=null==e?1:e,e=0),i.min(e).max(t)}function yp(e,t,n){let r=0,i=0;for(const o of e){const e=n(o);null==t(o)||null==e||isNaN(e)||(r+=(e-r)/++i)}return{coef:[r],predict:()=>r,rSquared:0}}function vp(e,t,n,r){const i=r-e*e,o=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-o*e,o]}function bp(e,t,n,r){e=e.filter((e=>{let r=t(e),i=n(e);return null!=r&&(r=+r)>=r&&null!=i&&(i=+i)>=i})),r&&e.sort(((e,n)=>t(e)-t(n)));const i=e.length,o=new Float64Array(i),a=new Float64Array(i);let s,l,u,c=0,f=0,d=0;for(u of e)o[c]=s=+t(u),a[c]=l=+n(u),++c,f+=(s-f)/c,d+=(l-d)/c;for(c=0;c<i;++c)o[c]-=f,a[c]-=d;return[o,a,f,d]}function xp(e,t,n,r){let i,o,a=-1;for(const s of e)i=t(s),o=n(s),null!=i&&(i=+i)>=i&&null!=o&&(o=+o)>=o&&r(i,o,++a)}function wp(e,t,n,r,i){let o=0,a=0;return xp(e,t,n,((e,t)=>{const n=t-i(e),s=t-r;o+=n*n,a+=s*s})),1-o/a}function kp(e,t,n){let r=0,i=0,o=0,a=0,s=0;xp(e,t,n,((e,t)=>{++s,r+=(e-r)/s,i+=(t-i)/s,o+=(e*t-o)/s,a+=(e*e-a)/s}));const l=vp(r,i,o,a),u=e=>l[0]+l[1]*e;return{coef:l,predict:u,rSquared:wp(e,t,n,i,u)}}function _p(e,t,n){let r=0,i=0,o=0,a=0,s=0;xp(e,t,n,((e,t)=>{++s,e=Math.log(e),r+=(e-r)/s,i+=(t-i)/s,o+=(e*t-o)/s,a+=(e*e-a)/s}));const l=vp(r,i,o,a),u=e=>l[0]+l[1]*Math.log(e);return{coef:l,predict:u,rSquared:wp(e,t,n,i,u)}}function Op(e,t,n){const[r,i,o,a]=bp(e,t,n);let s,l,u,c=0,f=0,d=0,h=0,p=0;xp(e,t,n,((e,t)=>{s=r[p++],l=Math.log(t),u=s*t,c+=(t*l-c)/p,f+=(u-f)/p,d+=(u*l-d)/p,h+=(s*u-h)/p}));const[m,g]=vp(f/a,c/a,d/a,h/a),y=e=>Math.exp(m+g*(e-o));return{coef:[Math.exp(m-g*o),g],predict:y,rSquared:wp(e,t,n,a,y)}}function Ep(e,t,n){let r=0,i=0,o=0,a=0,s=0,l=0;xp(e,t,n,((e,t)=>{const n=Math.log(e),u=Math.log(t);++l,r+=(n-r)/l,i+=(u-i)/l,o+=(n*u-o)/l,a+=(n*n-a)/l,s+=(t-s)/l}));const u=vp(r,i,o,a),c=e=>u[0]*Math.pow(e,u[1]);return u[0]=Math.exp(u[0]),{coef:u,predict:c,rSquared:wp(e,t,n,s,c)}}function Dp(e,t,n){const[r,i,o,a]=bp(e,t,n),s=r.length;let l,u,c,f,d=0,h=0,p=0,m=0,g=0;for(l=0;l<s;)u=r[l],c=i[l++],f=u*u,d+=(f-d)/l,h+=(f*u-h)/l,p+=(f*f-p)/l,m+=(u*c-m)/l,g+=(f*c-g)/l;const y=p-d*d,v=d*y-h*h,b=(g*d-m*h)/v,x=(m*y-g*h)/v,w=-b*d,k=e=>b*(e-=o)*e+x*e+w+a;return{coef:[w-x*o+b*o*o+a,x-2*b*o,b],predict:k,rSquared:wp(e,t,n,a,k)}}function jp(e,t,n,r){if(0===r)return yp(e,t,n);if(1===r)return kp(e,t,n);if(2===r)return Dp(e,t,n);const[i,o,a,s]=bp(e,t,n),l=i.length,u=[],c=[],f=r+1;let d,h,p,m,g;for(d=0;d<f;++d){for(p=0,m=0;p<l;++p)m+=Math.pow(i[p],d)*o[p];for(u.push(m),g=new Float64Array(f),h=0;h<f;++h){for(p=0,m=0;p<l;++p)m+=Math.pow(i[p],d+h);g[h]=m}c.push(g)}c.push(u);const y=function(e){const t=e.length-1,n=[];let r,i,o,a,s;for(r=0;r<t;++r){for(a=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][a])&&(a=i);for(o=r;o<t+1;++o)s=e[o][r],e[o][r]=e[o][a],e[o][a]=s;for(i=r+1;i<t;++i)for(o=t;o>=r;o--)e[o][i]-=e[o][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(s=0,o=i+1;o<t;++o)s+=e[o][i]*n[o];n[i]=(e[t][i]-s)/e[i][i]}return n}(c),v=e=>{e-=a;let t=s+y[0]+y[1]*e+y[2]*e*e;for(d=3;d<f;++d)t+=y[d]*Math.pow(e,d);return t};return{coef:Np(f,y,-a,s),predict:v,rSquared:wp(e,t,n,s,v)}}function Np(e,t,n,r){const i=Array(e);let o,a,s,l;for(o=0;o<e;++o)i[o]=0;for(o=e-1;o>=0;--o)for(s=t[o],l=1,i[o]+=s,a=1;a<=o;++a)l*=(o+1-a)/a,i[o-a]+=s*Math.pow(n,a)*l;return i[0]+=r,i}function Sp(e,t,n,r){const[i,o,a,s]=bp(e,t,n,!0),l=i.length,u=Math.max(2,~~(r*l)),c=new Float64Array(l),f=new Float64Array(l),d=new Float64Array(l).fill(1);for(let h=-1;++h<=2;){const e=[0,u-1];for(let n=0;n<l;++n){const t=i[n],r=e[0],a=e[1],s=t-i[r]>i[a]-t?r:a;let l=0,u=0,h=0,p=0,m=0;const g=1/Math.abs(i[s]-t||1);for(let e=r;e<=a;++e){const n=i[e],r=o[e],a=Ap(Math.abs(t-n)*g)*d[e],s=n*a;l+=a,u+=s,h+=r*a,p+=r*s,m+=n*s}const[y,v]=vp(u/l,h/l,p/l,m/l);c[n]=y+v*t,f[n]=Math.abs(o[n]-c[n]),$p(i,n+1,e)}if(2===h)break;const t=bl(f);if(Math.abs(t)<1e-12)break;for(let n,r,i=0;i<l;++i)n=f[i]/(6*t),d[i]=n>=1?1e-12:(r=1-n*n)*r}return function(e,t,n,r){const i=e.length,o=[];let a,s=0,l=0,u=[];for(;s<i;++s)a=e[s]+n,u[0]===a?u[1]+=(t[s]-u[1])/++l:(l=0,u[1]+=r,u=[a,t[s]],o.push(u));return u[1]+=r,o}(i,c,a,s)}function Ap(e){return(e=1-e*e*e)*e*e}function $p(e,t,n){const r=e[t];let i=n[0],o=n[1]+1;if(!(o>=e.length))for(;t>i&&e[o]-r<=r-e[i];)n[0]=++i,n[1]=o,++o}const Cp=.5*Math.PI/180;function Mp(e,t,n,r){n=n||25,r=Math.max(n,r||200);const i=t=>[t,e(t)],o=t[0],a=t[1],s=a-o,l=s/r,u=[i(o)],c=[];if(n===r){for(let e=1;e<r;++e)u.push(i(o+e/n*s));return u.push(i(a)),u}c.push(i(a));for(let m=n;--m>0;)c.push(i(o+m/n*s));let f=u[0],d=c[c.length-1];const h=1/s,p=function(e,t){let n=e,r=e;const i=t.length;for(let o=0;o<i;++o){const e=t[o][1];e<n&&(n=e),e>r&&(r=e)}return 1/(r-n)}(f[1],c);for(;d;){const e=i((f[0]+d[0])/2);e[0]-f[0]>=l&&Pp(f,e,d,h,p)>Cp?c.push(e):(f=d,u.push(d),c.pop()),d=c[c.length-1]}return u}function Pp(e,t,n,r,i){const o=Math.atan2(i*(n[1]-e[1]),r*(n[0]-e[0])),a=Math.atan2(i*(t[1]-e[1]),r*(t[0]-e[0]));return Math.abs(o-a)}function Fp(e){return e&&e.length?1===e.length?e[0]:(t=e,e=>{const n=t.length;let r=1,i=String(t[0](e));for(;r<n;++r)i+="|"+t[r](e);return i}):function(){return""};var t}function Tp(e,t,n){return n||e+(t?"_"+t:"")}const zp=()=>{},Rp={init:zp,add:zp,rem:zp,idx:0},Lp={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||void 0===e.min)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||void 0===e.max)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},Bp=Object.keys(Lp).filter((e=>"__count__"!==e));function Ip(e,t){return Lp[e](t)}function Up(e,t){return e.idx-t.idx}function qp(){this.valid=0,this.missing=0,this._ops.forEach((e=>e.init(this)))}function Wp(e,t){null!=e&&""!==e?e==e&&(++this.valid,this._ops.forEach((n=>n.add(this,e,t)))):++this.missing}function Zp(e,t){null!=e&&""!==e?e==e&&(--this.valid,this._ops.forEach((n=>n.rem(this,e,t)))):--this.missing}function Hp(e){return this._out.forEach((t=>e[t.out]=t.value(this))),e}function Gp(e,t){const n=t||ta,r=function(e){const t={};e.forEach((e=>t[e.name]=e));const n=e=>{e.req&&e.req.forEach((e=>{t[e]||n(t[e]=Lp[e]())}))};return e.forEach(n),Object.values(t).sort(Up)}(e),i=e.slice().sort(Up);function o(e){this._ops=r,this._out=i,this.cell=e,this.init()}return o.prototype.init=qp,o.prototype.add=Wp,o.prototype.rem=Zp,o.prototype.set=Hp,o.prototype.get=n,o.fields=e.map((e=>e.out)),o}function Vp(e){this._key=e?Ko(e):ah,this.reset()}[...Bp,"__count__"].forEach((e=>{Lp[e]=function(e,t){return n=>Ya({name:e,out:n||e},Rp,t)}(e,Lp[e])}));const Yp=Vp.prototype;function Xp(e){Lh.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Yp.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},Yp.add=function(e){this._add.push(e)},Yp.rem=function(e){this._rem.push(e)},Yp.values=function(){if(this._get=null,0===this._rem.length)return this._add;const e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,o=Array(r-i),a={};let s,l,u;for(s=0;s<i;++s)a[n(t[s])]=1;for(s=0,l=0;s<r;++s)a[n(u=e[s])]?a[n(u)]=0:o[l++]=u;return this._rem=[],this._add=o},Yp.distinct=function(e){const t=this.values(),n={};let r,i=t.length,o=0;for(;--i>=0;)r=e(t[i])+"",Ka(n,r)||(n[r]=1,++o);return o},Yp.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=Ja(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext},Yp.argmin=function(e){return this.extent(e)[0]||{}},Yp.argmax=function(e){return this.extent(e)[1]||{}},Yp.min=function(e){const t=this.extent(e)[0];return null!=t?e(t):void 0},Yp.max=function(e){const t=this.extent(e)[1];return null!=t?e(t):void 0},Yp.quartile=function(e){return this._get===e&&this._q||(this._q=Zh(this.values(),e),this._get=e),this._q},Yp.q1=function(e){return this.quartile(e)[0]},Yp.q2=function(e){return this.quartile(e)[1]},Yp.q3=function(e){return this.quartile(e)[2]},Yp.ci=function(e){return this._get===e&&this._ci||(this._ci=Yh(this.values(),1e3,.05,e),this._get=e),this._ci},Yp.ci0=function(e){return this.ci(e)[0]},Yp.ci1=function(e){return this.ci(e)[1]},Xp.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Bp},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},rs(Xp,Lh,{transform(e,t){const n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return n.stamp=r.stamp,n.value&&(i||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(e):Object.create(null),t.visit(t.SOURCE,(e=>n.add(e)))):(n.value=n.value||n.init(e),t.visit(t.REM,(e=>n.rem(e))),t.visit(t.ADD,(e=>n.add(e)))),r.modifies(n._outputs),n._drop=!1!==e.drop,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&r.clean(!0).runAfter((()=>this.clean())),n.changes(r)},cross(){const e=this,t=e.value,n=e._dnames,r=n.map((()=>({}))),i=n.length;function o(e){let t,o,a,s;for(t in e)for(a=e[t].tuple,o=0;o<i;++o)r[o][s=a[n[o]]]=s}o(e._prev),o(t),function o(a,s,l){const u=n[l],c=r[l++];for(const n in c){const r=a?a+"|"+n:n;s[u]=c[n],l<i?o(r,s,l):t[r]||e.cell(r,s)}}("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],r={};function i(e){const n=Ra(Go(e)),i=n.length;let o,a=0;for(;a<i;++a)r[o=n[a]]||(r[o]=1,t.push(o))}this._dims=Ra(e.groupby),this._dnames=this._dims.map((e=>{const t=Ho(e);return i(e),n.push(t),t})),this.cellkey=e.key?e.key:Fp(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const o=e.fields||[null],a=e.ops||["count"],s=e.as||[],l=o.length,u={};let c,f,d,h,p,m;for(l!==a.length&&Jo("Unmatched number of fields and aggregate ops."),m=0;m<l;++m)c=o[m],f=a[m],null==c&&"count"!==f&&Jo("Null aggregate field specified."),h=Ho(c),p=Tp(f,h,s[m]),n.push(p),"count"!==f?(d=u[h],d||(i(c),d=u[h]=[],d.field=c,this._measures.push(d)),"count"!==f&&(this._countOnly=!1),d.push(Ip(f,p))):this._counts.push(p);return this._measures=this._measures.map((e=>Gp(e,e.field))),Object.create(null)},cellkey:Fp(),cell(e,t){let n=this.value[e];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const e=this._measures,t=e.length;n.agg=Array(t);for(let r=0;r<t;++r)n.agg[r]=new e[r](n)}return n.store&&(n.data=new Vp),n},newtuple(e,t){const n=this._dnames,r=this._dims,i=r.length,o={};for(let a=0;a<i;++a)o[n[a]]=r[a](e);return t?fh(t.tuple,o):lh(o)},clean(){const e=this.value;for(const t in e)0===e[t].num&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].add(r[i].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].rem(r[i].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let r=0,i=n.length;r<i;++r)t[n[r]]=e.num;if(!this._countOnly){const n=e.agg;for(let e=0,r=n.length;e<r;++e)n[e].set(t)}return t},changes(e){const t=this._adds,n=this._mods,r=this._prev,i=this._drop,o=e.add,a=e.rem,s=e.mod;let l,u,c,f;if(r)for(u in r)l=r[u],i&&!l.num||a.push(l.tuple);for(c=0,f=this._alen;c<f;++c)o.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)l=n[c],(0===l.num&&i?a:s).push(this.celltuple(l)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});function Jp(e){Lh.call(this,null,e)}function Qp(e,t,n){const r=e;let i=t||[],o=n||[],a={},s=0;return{add:e=>o.push(e),remove:e=>a[r(e)]=++s,size:()=>i.length,data:(e,t)=>(s&&(i=i.filter((e=>!a[r(e)])),a={},s=0),t&&e&&i.sort(e),o.length&&(i=e?ps(e,i,o.sort(e)):i.concat(o),o=[]),i)}}function Kp(e){Lh.call(this,[],e)}function em(e){bh.call(this,null,tm,e)}function tm(e){return this.value&&!e.modified()?this.value:Ua(e.fields,e.orders)}function nm(e){Lh.call(this,null,e)}function rm(e){Lh.call(this,null,e)}Jp.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},rs(Jp,Lh,{transform(e,t){const n=!1!==e.interval,r=this._bins(e),i=r.start,o=r.step,a=e.as||["bin0","bin1"],s=a[0],l=a[1];let u;return u=e.modified()?(t=t.reflow(!0)).SOURCE:t.modified(Go(e.field))?t.ADD_MOD:t.ADD,t.visit(u,n?e=>{const t=r(e);e[s]=t,e[l]=null==t?null:i+o*(1+(t-i)/o)}:e=>e[s]=r(e)),t.modifies(n?a:s)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=Gh(e),r=n.step;let i,o,a=n.start,s=a+Math.ceil((n.stop-a)/r)*r;null!=(i=e.anchor)&&(o=i-(a+r*Math.floor((i-a)/r)),a+=o,s+=o);const l=function(e){let n=xa(t(e));return null==n?null:n<a?-1/0:n>s?1/0:(n=Math.max(a,Math.min(n,s-r)),a+r*Math.floor(1e-14+(n-a)/r))};return l.start=a,l.stop=n.stop,l.step=r,this.value=Zo(l,Go(t),e.name||"bin_"+Ho(t))}}),Kp.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},rs(Kp,Lh,{transform(e,t){const n=t.fork(t.ALL),r=Qp(ah,this.value,n.materialize(n.ADD).add),i=e.sort,o=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(o),this.value=n.source=r.data(dh(i),o),t.source&&t.source.root&&(this.value.root=t.source.root),n}}),rs(em,bh),nm.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},rs(nm,Lh,{transform(e,t){const n=t=>n=>{for(var r,i=function(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase()}return e.match(n)}(s(n),e.case,o)||[],l=0,u=i.length;l<u;++l)a.test(r=i[l])||t(r)},r=this._parameterCheck(e,t),i=this._counts,o=this._match,a=this._stop,s=e.field,l=e.as||["text","count"],u=n((e=>i[e]=1+(i[e]||0))),c=n((e=>i[e]-=1));return r?t.visit(t.SOURCE,u):(t.visit(t.ADD,u),t.visit(t.REM,c)),this._finish(t,l)},_parameterCheck(e,t){let n=!1;return!e.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),!e.modified("pattern")&&this._match||(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],o=t[1],a=e.fork(e.NO_SOURCE|e.NO_FIELDS);let s,l,u;for(s in n)l=r[s],u=n[s]||0,!l&&u?(r[s]=l=lh({}),l[i]=s,l[o]=u,a.add.push(l)):0===u?(l&&a.rem.push(l),n[s]=null,r[s]=null):l[o]!==u&&(l[o]=u,a.mod.push(l));return a.modifies(t)}}),rm.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},rs(rm,Lh,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],i=r[0],o=r[1],a=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let s=this.value;return a?(s&&(n.rem=s),s=t.materialize(t.SOURCE).source,n.add=this.value=function(e,t,n,r){for(var i,o,a=[],s={},l=e.length,u=0;u<l;++u)for(s[t]=o=e[u],i=0;i<l;++i)s[n]=e[i],r(s)&&(a.push(lh(s)),(s={})[t]=o);return a}(s,i,o,e.filter||ia)):n.mod=s,n.source=this.value,n.modifies(r)}});const im={kde:op,mixture:fp,normal:ip,lognormal:cp,uniform:gp},om="function";function am(e,t){const n=e[om];Ka(im,n)||Jo("Unknown distribution function: "+n);const r=im[n]();for(const i in e)"field"===i?r.data((e.from||t()).map(e[i])):"distributions"===i?r[i](e[i].map((e=>am(e,t)))):typeof r[i]===om&&r[i](e[i]);return r}function sm(e){Lh.call(this,null,e)}const lm=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],um={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:lm},{name:"weights",type:"number",array:!0}]};function cm(e,t){return e?e.map(((e,n)=>t[n]||Ho(e))):null}function fm(e,t,n){const r=[],i=e=>e(l);let o,a,s,l,u,c;if(null==t)r.push(e.map(n));else for(o={},a=0,s=e.length;a<s;++a)l=e[a],u=t.map(i),c=o[u],c||(o[u]=c=[],c.dims=u,r.push(c)),c.push(n(l));return r}sm.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:lm.concat(um)},{name:"as",type:"string",array:!0,default:["value","density"]}]},rs(sm,Lh,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=am(e.distribution,function(e){return()=>e.materialize(e.SOURCE).source}(t)),i=e.steps||e.minsteps||25,o=e.steps||e.maxsteps||200;let a=e.method||"pdf";"pdf"!==a&&"cdf"!==a&&Jo("Invalid density method: "+a),e.extent||r.data||Jo("Missing density extent parameter."),a=r[a];const s=e.as||["value","density"],l=Mp(a,e.extent||Xa(r.data()),i,o).map((e=>{const t={};return t[s[0]]=e[0],t[s[1]]=e[1],lh(t)}));this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function dm(e){Lh.call(this,null,e)}dm.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]};function hm(e){bh.call(this,null,pm,e),this.modified(!0)}function pm(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:Zo((n=>t(n,e)),Go(t),Ho(t))}function mm(e){Lh.call(this,[void 0,void 0],e)}function gm(e,t){bh.call(this,e),this.parent=t,this.count=0}function ym(e){Lh.call(this,{},e),this._keys=ts();const t=this._targets=[];t.active=0,t.forEach=e=>{for(let n=0,r=t.active;n<r;++n)e(t[n],n,t)}}function vm(e){bh.call(this,null,bm,e)}function bm(e){return this.value&&!e.modified()?this.value:ha(e.name)?Ra(e.name).map((e=>Ko(e))):Ko(e.name,e.as)}function xm(e){Lh.call(this,ts(),e)}function wm(e){Lh.call(this,[],e)}function km(e){Lh.call(this,[],e)}function _m(e){Lh.call(this,null,e)}function Om(e){Lh.call(this,[],e)}rs(dm,Lh,{transform(e,t){if(this.value&&!e.modified()&&!t.changed())return t;const n=t.materialize(t.SOURCE).source,r=fm(t.source,e.groupby,ta),i=e.smooth||!1,o=e.field,a=e.step||((e,t)=>ys(Xa(e,t))/30)(n,o),s=dh(((e,t)=>o(e)-o(t))),l=e.as||"bin",u=r.length;let c,f=1/0,d=-1/0,h=0;for(;h<u;++h){const e=r[h].sort(s);c=-1;for(const t of Xh(e,a,i,o))t<f&&(f=t),t>d&&(d=t),e[++c][l]=t}return this.value={start:f,stop:d,step:a},t.reflow(!0).modifies(l)}}),rs(hm,bh),mm.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},rs(mm,Lh,{transform(e,t){const n=this.value,r=e.field,i=t.changed()||t.modified(r.fields)||e.modified("field");let o=n[0],a=n[1];if((i||null==o)&&(o=1/0,a=-1/0),t.visit(i?t.SOURCE:t.ADD,(e=>{const t=xa(r(e));null!=t&&(t<o&&(o=t),t>a&&(a=t))})),!Number.isFinite(o)||!Number.isFinite(a)){let e=Ho(r);e&&(e=` for field "${e}"`),t.dataflow.warn(`Infinite extent${e}: [${o}, ${a}]`),o=a=void 0}this.value=[o,a]}}),rs(gm,bh,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}}),rs(ym,Lh,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,r){const i=this.value;let o,a,s=Ka(i,e)&&i[e];return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(a=r||(a=this._group[e])&&a.tuple,o=n.dataflow,s=new gm(n.fork(n.NO_SOURCE),this),o.add(s).connect(t(o,e,a)),i[e]=s,this.activate(s)),s},clean(){const e=this.value;let t=0;for(const n in e)if(0===e[n].count){const r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){const e=this._targets.filter((e=>e&&e.count>0));this.initTargets(e)}},initTargets(e){const t=this._targets,n=t.length,r=e?e.length:0;let i=0;for(;i<r;++i)t[i]=e[i];for(;i<n&&null!=t[i];++i)t[i]=null;t.active=r},transform(e,t){const n=t.dataflow,r=e.key,i=e.subflow,o=this._keys,a=e.modified("key"),s=e=>this.subflow(e,i,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,(e=>{const t=ah(e),n=o.get(t);void 0!==n&&(o.delete(t),s(n).rem(e))})),t.visit(t.ADD,(e=>{const t=r(e);o.set(ah(e),t),s(t).add(e)})),a||t.modified(r.fields)?t.visit(t.MOD,(e=>{const t=ah(e),n=o.get(t),i=r(e);n===i?s(i).mod(e):(o.set(t,i),s(n).rem(e),s(i).add(e))})):t.changed(t.MOD)&&t.visit(t.MOD,(e=>{s(o.get(ah(e))).mod(e)})),a&&t.visit(t.REFLOW,(e=>{const t=ah(e),n=o.get(t),i=r(e);n!==i&&(o.set(t,i),s(n).rem(e),s(i).add(e))})),t.clean()?n.runAfter((()=>{this.clean(),o.clean()})):o.empty>n.cleanThreshold&&n.runAfter(o.clean),t}}),rs(vm,bh),xm.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},rs(xm,Lh,{transform(e,t){const n=t.dataflow,r=this.value,i=t.fork(),o=i.add,a=i.rem,s=i.mod,l=e.expr;let u=!0;function c(t){const n=ah(t),i=l(t,e),c=r.get(n);i&&c?(r.delete(n),o.push(t)):i||c?u&&i&&!c&&s.push(t):(r.set(n,1),a.push(t))}return t.visit(t.REM,(e=>{const t=ah(e);r.has(t)?r.delete(t):a.push(e)})),t.visit(t.ADD,(t=>{l(t,e)?o.push(t):r.set(ah(t),1)})),t.visit(t.MOD,c),e.modified()&&(u=!1,t.visit(t.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}}),wm.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},rs(wm,Lh,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=cm(r,e.as||[]),o=e.index||null,a=i.length;return n.rem=this.value,t.visit(t.SOURCE,(e=>{const t=r.map((t=>t(e))),s=t.reduce(((e,t)=>Math.max(e,t.length)),0);let l,u,c,f=0;for(;f<s;++f){for(u=uh(e),l=0;l<a;++l)u[i[l]]=null==(c=t[l][f])?null:c;o&&(u[o]=f),n.add.push(u)}})),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(i)}}),km.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},rs(km,Lh,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(Ho),o=e.as||["key","value"],a=o[0],s=o[1],l=r.length;return n.rem=this.value,t.visit(t.SOURCE,(e=>{for(let t,o=0;o<l;++o)t=uh(e),t[a]=i[o],t[s]=r[o](e),n.add.push(t)})),this.value=n.source=n.add,n.modifies(o)}}),_m.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},rs(_m,Lh,{transform(e,t){const n=e.expr,r=e.as,i=e.modified(),o=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(o,(t=>t[r]=n(t,e)))}}),rs(Om,Lh,{transform(e,t){const n=t.fork(t.ALL),r=e.generator;let i,o,a,s=this.value,l=e.size-s.length;if(l>0){for(i=[];--l>=0;)i.push(a=lh(r(e))),s.push(a);n.add=n.add.length?n.materialize(n.ADD).add.concat(i):i}else o=s.slice(0,-l),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(o):o,s=s.slice(-l);return n.source=this.value=s,n}});const Em={value:"value",median:bl,mean:function(e,t){let n=0,r=0;if(void 0===t)for(let i of e)null!=i&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let o of e)null!=(o=t(o,++i,e))&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n},min:pl,max:hl},Dm=[];function jm(e){Lh.call(this,[],e)}function Nm(e){Xp.call(this,e)}function Sm(e){Lh.call(this,null,e)}function Am(e){bh.call(this,null,$m,e)}function $m(e){return this.value&&!e.modified()?this.value:fs(e.fields,e.flat)}function Cm(e){Lh.call(this,[],e),this._pending=null}function Mm(e,t,n){n.forEach(lh);const r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function Pm(e){Lh.call(this,{},e)}function Fm(e){bh.call(this,null,Tm,e)}function Tm(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let r,i,o=1/0,a=-1/0;for(r=0;r<n;++r)i=t[r],i[0]<o&&(o=i[0]),i[1]>a&&(a=i[1]);return[o,a]}function zm(e){bh.call(this,null,Rm,e)}function Rm(e){return this.value&&!e.modified()?this.value:e.values.reduce(((e,t)=>e.concat(t)),[])}function Lm(e){Lh.call(this,null,e)}function Bm(e){Xp.call(this,e)}function Im(e){ym.call(this,e)}function Um(e){Lh.call(this,null,e)}function qm(e){Lh.call(this,null,e)}function Wm(e){Lh.call(this,null,e)}jm.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},rs(jm,Lh,{transform(e,t){var n,r,i,o,a,s,l,u,c,f,d=t.fork(t.ALL),h=function(e){var t,n=e.method||Em.value;if(null!=Em[n])return n===Em.value?(t=void 0!==e.value?e.value:0,()=>t):Em[n];Jo("Unrecognized imputation method: "+n)}(e),p=function(e){const t=e.field;return e=>e?t(e):NaN}(e),m=Ho(e.field),g=Ho(e.key),y=(e.groupby||[]).map(Ho),v=function(e,t,n,r){var i,o,a,s,l,u,c,f,d=e=>e(f),h=[],p=r?r.slice():[],m={},g={};for(p.forEach(((e,t)=>m[e]=t+1)),s=0,c=e.length;s<c;++s)u=n(f=e[s]),l=m[u]||(m[u]=p.push(u)),(a=g[o=(i=t?t.map(d):Dm)+""])||(a=g[o]=[],h.push(a),a.values=i),a[l-1]=f;return h.domain=p,h}(t.source,e.groupby,e.key,e.keyvals),b=[],x=this.value,w=v.domain.length;for(a=0,u=v.length;a<u;++a)for(i=(n=v[a]).values,r=NaN,l=0;l<w;++l)if(null==n[l]){for(o=v.domain[l],f={_impute:!0},s=0,c=i.length;s<c;++s)f[y[s]]=i[s];f[g]=o,f[m]=Number.isNaN(r)?r=h(n,p):r,b.push(lh(f))}return b.length&&(d.add=d.materialize(d.ADD).add.concat(b)),x.length&&(d.rem=d.materialize(d.REM).rem.concat(x)),this.value=b,d}}),Nm.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:Bp},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},rs(Nm,Xp,{transform(e,t){const n=this,r=e.modified();let i;return n.value&&(r||t.modified(n._inputs,!0))?(i=n.value=r?n.init(e):{},t.visit(t.SOURCE,(e=>n.add(e)))):(i=n.value=n.value||this.init(e),t.visit(t.REM,(e=>n.rem(e))),t.visit(t.ADD,(e=>n.add(e)))),n.changes(),t.visit(t.SOURCE,(e=>{Ya(e,i[n.cellkey(e)].tuple)})),t.reflow(r).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(e[n]),e[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}}),Sm.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},rs(Sm,Lh,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=fm(r,e.groupby,e.field),o=(e.groupby||[]).map(Ho),a=e.bandwidth,s=e.cumulative?"cdf":"pdf",l=e.as||["value","density"],u=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;"pdf"!==s&&"cdf"!==s&&Jo("Invalid density method: "+s),"shared"===e.resolve&&(c||(c=Xa(r,e.field)),f=d=e.steps||d),i.forEach((t=>{const n=op(t,a)[s],r=e.counts?t.length:1;Mp(n,c||Xa(t),f,d).forEach((e=>{const n={};for(let r=0;r<o.length;++r)n[o[r]]=t.dims[r];n[l[0]]=e[0],n[l[1]]=e[1]*r,u.push(lh(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}}),rs(Am,bh),rs(Cm,Lh,{transform(e,t){const n=t.dataflow;if(this._pending)return Mm(this,t,this._pending);if(function(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}(e))return t.StopPropagation;if(e.values)return Mm(this,t,n.parse(e.values,e.format));if(e.async){const t=n.request(e.url,e.format).then((e=>(this._pending=Ra(e.data),e=>e.touch(this))));return{async:t}}return n.request(e.url,e.format).then((e=>Mm(this,t,Ra(e.data))))}}),Pm.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},rs(Pm,Lh,{transform(e,t){const n=e.fields,r=e.index,i=e.values,o=null==e.default?null:e.default,a=e.modified(),s=n.length;let l,u,c,f=a?t.SOURCE:t.ADD,d=t,h=e.as;return i?(u=i.length,s>1&&!h&&Jo('Multi-field lookup requires explicit "as" parameter.'),h&&h.length!==s*u&&Jo('The "as" parameter has too few output field names.'),h=h||i.map(Ho),l=function(e){for(var t,a,l=0,c=0;l<s;++l)if(null==(a=r.get(n[l](e))))for(t=0;t<u;++t,++c)e[h[c]]=o;else for(t=0;t<u;++t,++c)e[h[c]]=i[t](a)}):(h||Jo("Missing output field names."),l=function(e){for(var t,i=0;i<s;++i)t=r.get(n[i](e)),e[h[i]]=null==t?o:t}),a?d=t.reflow(!0):(c=n.some((e=>t.modified(e.fields))),f|=c?t.MOD:0),t.visit(f,l),d.modifies(h)}}),rs(Fm,bh),rs(zm,bh),rs(Lm,Lh,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),Bm.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:Bp,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},rs(Bm,Xp,{_transform:Xp.prototype.transform,transform(e,t){return this._transform(function(e,t){const n=e.field,r=e.value,i=("count"===e.op?"__count__":e.op)||"sum",o=Go(n).concat(Go(r)),a=function(e,t,n){const r={},i=[];return n.visit(n.SOURCE,(t=>{const n=e(t);r[n]||(r[n]=1,i.push(n))})),i.sort(qa),t?i.slice(0,t):i}(n,e.limit||0,t);t.changed()&&e.set("__pivot__",null,null,!0);return{key:e.key,groupby:e.groupby,ops:a.map((()=>i)),fields:a.map((e=>function(e,t,n,r){return Zo((r=>t(r)===e?n(r):NaN),r,e+"")}(e,n,r,o))),as:a.map((e=>e+"")),modified:e.modified.bind(e)}}(e,t),t)}}),rs(Im,ym,{transform(e,t){const n=e.subflow,r=e.field,i=e=>this.subflow(ah(e),n,t,e);return(e.modified("field")||r&&t.modified(Go(r)))&&Jo("PreFacet does not support field modification."),this.initTargets(),r?(t.visit(t.MOD,(e=>{const t=i(e);r(e).forEach((e=>t.mod(e)))})),t.visit(t.ADD,(e=>{const t=i(e);r(e).forEach((e=>t.add(lh(e))))})),t.visit(t.REM,(e=>{const t=i(e);r(e).forEach((e=>t.rem(e)))}))):(t.visit(t.MOD,(e=>i(e).mod(e))),t.visit(t.ADD,(e=>i(e).add(e))),t.visit(t.REM,(e=>i(e).rem(e)))),t.clean()&&t.runAfter((()=>this.clean())),t}}),Um.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},rs(Um,Lh,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=cm(e.fields,e.as||[]),o=r?(e,t)=>function(e,t,n,r){for(let i=0,o=n.length;i<o;++i)t[r[i]]=n[i](e);return t}(e,t,r,i):ch;let a;return this.value?a=this.value:(t=t.addAll(),a=this.value={}),t.visit(t.REM,(e=>{const t=ah(e);n.rem.push(a[t]),a[t]=null})),t.visit(t.ADD,(e=>{const t=o(e,lh({}));a[ah(e)]=t,n.add.push(t)})),t.visit(t.MOD,(e=>{n.mod.push(o(e,a[ah(e)]))})),n}}),rs(qm,Lh,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}}),Wm.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};function Zm(e){Lh.call(this,null,e)}function Hm(e){Lh.call(this,[],e),this.count=0}function Gm(e){Lh.call(this,null,e)}function Vm(e){Lh.call(this,null,e),this.modified(!0)}function Ym(e){Lh.call(this,null,e)}rs(Wm,Lh,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const i=fm(t.materialize(t.SOURCE).source,e.groupby,e.field),o=(e.groupby||[]).map(Ho),a=[],s=e.step||.01,l=e.probs||wl(s/2,1-1e-14,s),u=l.length;return i.forEach((e=>{const t=Wh(e,l);for(let n=0;n<u;++n){const i={};for(let t=0;t<o.length;++t)i[o[t]]=e.dims[t];i[r[0]]=l[n],i[r[1]]=t[n],a.push(lh(i))}})),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}}),rs(Zm,Lh,{transform(e,t){let n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,(e=>{const t=ah(e);n.rem.push(r[t]),r[t]=null})),t.visit(t.ADD,(e=>{const t=uh(e);r[ah(e)]=t,n.add.push(t)})),t.visit(t.MOD,(e=>{const t=r[ah(e)];for(const r in e)t[r]=e[r],n.modifies(r);n.mod.push(t)}))),n}}),Hm.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},rs(Hm,Lh,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,o=this.value.reduce(((e,t)=>(e[ah(t)]=1,e)),{});let a=this.value,s=this.count,l=0;function u(e){let t,r;a.length<i?a.push(e):(r=~~((s+1)*Vh()),r<a.length&&r>=l&&(t=a[r],o[ah(t)]&&n.rem.push(t),a[r]=e)),++s}if(t.rem.length&&(t.visit(t.REM,(e=>{const t=ah(e);o[t]&&(o[t]=-1,n.rem.push(e)),--s})),a=a.filter((e=>-1!==o[ah(e)]))),(t.rem.length||r)&&a.length<i&&t.source&&(l=s=a.length,t.visit(t.SOURCE,(e=>{o[ah(e)]||u(e)})),l=-1),r&&a.length>i){const e=a.length-i;for(let t=0;t<e;++t)o[ah(a[t])]=-1,n.rem.push(a[t]);a=a.slice(e)}return t.mod.length&&t.visit(t.MOD,(e=>{o[ah(e)]&&n.mod.push(e)})),t.add.length&&t.visit(t.ADD,u),(t.add.length||l<0)&&(n.add=a.filter((e=>!o[ah(e)]))),this.count=s,this.value=n.source=a,n}}),Gm.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},rs(Gm,Lh,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=wl(e.start,e.stop,e.step||1).map((e=>{const t={};return t[r]=e,lh(t)})),n.add=t.add.concat(this.value),n}}),rs(Vm,Lh,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});const Xm=["unit0","unit1"];function Jm(e){Lh.call(this,ts(),e)}function Qm(e){Lh.call(this,null,e)}Ym.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:Uu,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:Xm}]},rs(Ym,Lh,{transform(e,t){const n=e.field,r=!1!==e.interval,i="utc"===e.timezone,o=this._floor(e,t),a=(i?vc:yc)(o.unit).offset,s=e.as||Xm,l=s[0],u=s[1],c=o.step;let f=o.start||1/0,d=o.stop||-1/0,h=t.ADD;return(e.modified()||t.changed(t.REM)||t.modified(Go(n)))&&(h=(t=t.reflow(!0)).SOURCE,f=1/0,d=-1/0),t.visit(h,(e=>{const t=n(e);let i,s;null==t?(e[l]=null,r&&(e[u]=null)):(e[l]=i=s=o(t),r&&(e[u]=s=a(i,c)),i<f&&(f=i),s>d&&(d=s))})),o.start=f,o.stop=d,t.modifies(r?s:l)},_floor(e,t){const n="utc"===e.timezone,{units:r,step:i}=e.units?{units:e.units,step:e.step||1}:Lc({extent:e.extent||Xa(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),o=Wu(r),a=this.value||{},s=(n?pc:fc)(o,i);return s.unit=ba(o),s.units=o,s.step=i,s.start=a.start,s.stop=a.stop,this.value=s}}),rs(Jm,Lh,{transform(e,t){const n=t.dataflow,r=e.field,i=this.value,o=e=>i.set(r(e),e);let a=!0;return e.modified("field")||t.modified(r.fields)?(i.clear(),t.visit(t.SOURCE,o)):t.changed()?(t.visit(t.REM,(e=>i.delete(r(e)))),t.visit(t.ADD,o)):a=!1,this.modified(a),i.empty>n.cleanThreshold&&n.runAfter(i.clean),t.fork()}}),rs(Qm,Lh,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(dh(e.sort)):t.source).map(e.field))}});const Km={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){const e=Km.rank(),t=e.next;return{init:e.init,next:e=>(t(e)-1)/(e.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,r=t.compare;let i=t.index;if(e<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;e=i}return(1+e)/n.length}}},ntile:function(e,t){(t=+t)>0||Jo("ntile num must be greater than zero.");const n=Km.cume_dist(),r=n.next;return{init:n.init,next:e=>Math.ceil(t*r(e))}},lag:function(e,t){return t=+t||1,{next:n=>{const r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return(t=+t)>0||Jo("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const r=e(n.data[n.index]);return null!=r?t=r:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:r=>{const i=r.data;return r.index<=n?t:(n=function(e,t,n){for(let r=t.length;n<r;++n){if(null!=e(t[n]))return n}return-1}(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}};const eg=Object.keys(Km);function tg(e){const t=Ra(e.ops),n=Ra(e.fields),r=Ra(e.params),i=Ra(e.as),o=this.outputs=[],a=this.windows=[],s={},l={},u=[],c=[];let f=!0;function d(e){Ra(Go(e)).forEach((e=>s[e]=1))}d(e.sort),t.forEach(((e,t)=>{const s=n[t],h=Ho(s),p=Tp(e,h,i[t]);if(d(s),o.push(p),Ka(Km,e))a.push(function(e,t,n,r){const i=Km[e](t,n);return{init:i.init||na,update:function(e,t){t[r]=i.next(e)}}}(e,n[t],r[t],p));else{if(null==s&&"count"!==e&&Jo("Null aggregate field specified."),"count"===e)return void u.push(p);f=!1;let t=l[h];t||(t=l[h]=[],t.field=s,c.push(t)),t.push(Ip(e,p))}})),(u.length||c.length)&&(this.cell=function(e,t,n){e=e.map((e=>Gp(e,e.field)));const r={num:0,agg:null,store:!1,count:t};if(!n)for(var i=e.length,o=r.agg=Array(i),a=0;a<i;++a)o[a]=new e[a](r);if(r.store)var s=r.data=new Vp;return r.add=function(e){if(r.num+=1,!n){s&&s.add(e);for(let t=0;t<i;++t)o[t].add(o[t].get(e),e)}},r.rem=function(e){if(r.num-=1,!n){s&&s.rem(e);for(let t=0;t<i;++t)o[t].rem(o[t].get(e),e)}},r.set=function(e){let i,a;for(s&&s.values(),i=0,a=t.length;i<a;++i)e[t[i]]=r.num;if(!n)for(i=0,a=o.length;i<a;++i)o[i].set(e)},r.init=function(){r.num=0,s&&s.reset();for(let e=0;e<i;++e)o[e].init()},r}(c,u,f)),this.inputs=Object.keys(s)}const ng=tg.prototype;function rg(e){Lh.call(this,{},e),this._mlen=0,this._mods=[]}function ig(e,t,n,r){const i=r.sort,o=i&&!r.ignorePeers,a=r.frame||[null,0],s=e.data(n),l=s.length,u=o?Zs(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:s,compare:i||Ga(-1)};t.init();for(let f=0;f<l;++f)og(c,a,f,l),o&&ag(c,u),t.update(c,s[f])}function og(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=null==t[0]?0:Math.max(0,n-Math.abs(t[0])),e.i1=null==t[1]?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function ag(e,t){const n=e.i0,r=e.i1-1,i=e.compare,o=e.data,a=o.length-1;n>0&&!i(o[n],o[n-1])&&(e.i0=t.left(o,o[n])),r<a&&!i(o[r],o[r+1])&&(e.i1=t.right(o,o[r]))}ng.init=function(){this.windows.forEach((e=>e.init())),this.cell&&this.cell.init()},ng.update=function(e,t){const n=this.cell,r=this.windows,i=e.data,o=r&&r.length;let a;if(n){for(a=e.p0;a<e.i0;++a)n.rem(i[a]);for(a=e.p1;a<e.i1;++a)n.add(i[a]);n.set(t)}for(a=0;a<o;++a)r[a].update(e,t)},rg.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:eg.concat(Bp)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},rs(rg,Lh,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),r=dh(e.sort),i=Fp(e.groupby),o=e=>this.group(i(e));let a=this.state;a&&!n||(a=this.state=new tg(e)),n||t.modified(a.inputs)?(this.value={},t.visit(t.SOURCE,(e=>o(e).add(e)))):(t.visit(t.REM,(e=>o(e).remove(e))),t.visit(t.ADD,(e=>o(e).add(e))));for(let s=0,l=this._mlen;s<l;++s)ig(this._mods[s],a,r,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(a.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=Qp(ah),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});var sg=Object.freeze({__proto__:null,aggregate:Xp,bin:Jp,collect:Kp,compare:em,countpattern:nm,cross:rm,density:sm,dotbin:dm,expression:hm,extent:mm,facet:ym,field:vm,filter:xm,flatten:wm,fold:km,formula:_m,generate:Om,impute:jm,joinaggregate:Nm,kde:Sm,key:Am,load:Cm,lookup:Pm,multiextent:Fm,multivalues:zm,params:Lm,pivot:Bm,prefacet:Im,project:Um,proxy:qm,quantile:Wm,relay:Zm,sample:Hm,sequence:Gm,sieve:Vm,subflow:gm,timeunit:Ym,tupleindex:Jm,values:Qm,window:rg});function lg(e){return function(){return e}}const ug=Math.abs,cg=Math.atan2,fg=Math.cos,dg=Math.max,hg=Math.min,pg=Math.sin,mg=Math.sqrt,gg=1e-12,yg=Math.PI,vg=yg/2,bg=2*yg;function xg(e){return e>=1?vg:e<=-1?-vg:Math.asin(e)}const wg=Math.PI,kg=2*wg,_g=1e-6,Og=kg-_g;function Eg(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}let Dg=class{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?Eg:function(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Eg;const n=10**t;return function(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(e)}moveTo(e,t){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,t){this._append`L${this._x1=+e},${this._y1=+t}`}quadraticCurveTo(e,t,n,r){this._append`Q${+e},${+t},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(e,t,n,r,i,o){this._append`C${+e},${+t},${+n},${+r},${this._x1=+i},${this._y1=+o}`}arcTo(e,t,n,r,i){if(e=+e,t=+t,n=+n,r=+r,(i=+i)<0)throw new Error(`negative radius: ${i}`);let o=this._x1,a=this._y1,s=n-e,l=r-t,u=o-e,c=a-t,f=u*u+c*c;if(null===this._x1)this._append`M${this._x1=e},${this._y1=t}`;else if(f>_g)if(Math.abs(c*s-l*u)>_g&&i){let d=n-o,h=r-a,p=s*s+l*l,m=d*d+h*h,g=Math.sqrt(p),y=Math.sqrt(f),v=i*Math.tan((wg-Math.acos((p+f-m)/(2*g*y)))/2),b=v/y,x=v/g;Math.abs(b-1)>_g&&this._append`L${e+b*u},${t+b*c}`,this._append`A${i},${i},0,0,${+(c*d>u*h)},${this._x1=e+x*s},${this._y1=t+x*l}`}else this._append`L${this._x1=e},${this._y1=t}`;else;}arc(e,t,n,r,i,o){if(e=+e,t=+t,o=!!o,(n=+n)<0)throw new Error(`negative radius: ${n}`);let a=n*Math.cos(r),s=n*Math.sin(r),l=e+a,u=t+s,c=1^o,f=o?r-i:i-r;null===this._x1?this._append`M${l},${u}`:(Math.abs(this._x1-l)>_g||Math.abs(this._y1-u)>_g)&&this._append`L${l},${u}`,n&&(f<0&&(f=f%kg+kg),f>Og?this._append`A${n},${n},0,1,${c},${e-a},${t-s}A${n},${n},0,1,${c},${this._x1=l},${this._y1=u}`:f>_g&&this._append`A${n},${n},0,${+(f>=wg)},${c},${this._x1=e+n*Math.cos(i)},${this._y1=t+n*Math.sin(i)}`)}rect(e,t,n,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}};function jg(){return new Dg}function Ng(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(null==n)t=null;else{const e=Math.floor(n);if(!(e>=0))throw new RangeError(`invalid digits: ${n}`);t=e}return e},()=>new Dg(t)}function Sg(e){return e.innerRadius}function Ag(e){return e.outerRadius}function $g(e){return e.startAngle}function Cg(e){return e.endAngle}function Mg(e){return e&&e.padAngle}function Pg(e,t,n,r,i,o,a){var s=e-n,l=t-r,u=(a?o:-o)/mg(s*s+l*l),c=u*l,f=-u*s,d=e+c,h=t+f,p=n+c,m=r+f,g=(d+p)/2,y=(h+m)/2,v=p-d,b=m-h,x=v*v+b*b,w=i-o,k=d*m-p*h,_=(b<0?-1:1)*mg(dg(0,w*w*x-k*k)),O=(k*b-v*_)/x,E=(-k*v-b*_)/x,D=(k*b+v*_)/x,j=(-k*v+b*_)/x,N=O-g,S=E-y,A=D-g,$=j-y;return N*N+S*S>A*A+$*$&&(O=D,E=j),{cx:O,cy:E,x01:-c,y01:-f,x11:O*(i/w-1),y11:E*(i/w-1)}}function Fg(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function Tg(e){this._context=e}function zg(e){return new Tg(e)}function Rg(e){return e[0]}function Lg(e){return e[1]}function Bg(e,t){var n=lg(!0),r=null,i=zg,o=null,a=Ng(s);function s(s){var l,u,c,f=(s=Fg(s)).length,d=!1;for(null==r&&(o=i(c=a())),l=0;l<=f;++l)!(l<f&&n(u=s[l],l,s))===d&&((d=!d)?o.lineStart():o.lineEnd()),d&&o.point(+e(u,l,s),+t(u,l,s));if(c)return o=null,c+""||null}return e="function"==typeof e?e:void 0===e?Rg:lg(e),t="function"==typeof t?t:void 0===t?Lg:lg(t),s.x=function(t){return arguments.length?(e="function"==typeof t?t:lg(+t),s):e},s.y=function(e){return arguments.length?(t="function"==typeof e?e:lg(+e),s):t},s.defined=function(e){return arguments.length?(n="function"==typeof e?e:lg(!!e),s):n},s.curve=function(e){return arguments.length?(i=e,null!=r&&(o=i(r)),s):i},s.context=function(e){return arguments.length?(null==e?r=o=null:o=i(r=e),s):r},s}function Ig(e,t,n){var r=null,i=lg(!0),o=null,a=zg,s=null,l=Ng(u);function u(u){var c,f,d,h,p,m=(u=Fg(u)).length,g=!1,y=new Array(m),v=new Array(m);for(null==o&&(s=a(p=l())),c=0;c<=m;++c){if(!(c<m&&i(h=u[c],c,u))===g)if(g=!g)f=c,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),d=c-1;d>=f;--d)s.point(y[d],v[d]);s.lineEnd(),s.areaEnd()}g&&(y[c]=+e(h,c,u),v[c]=+t(h,c,u),s.point(r?+r(h,c,u):y[c],n?+n(h,c,u):v[c]))}if(p)return s=null,p+""||null}function c(){return Bg().defined(i).curve(a).context(o)}return e="function"==typeof e?e:void 0===e?Rg:lg(+e),t="function"==typeof t?t:lg(void 0===t?0:+t),n="function"==typeof n?n:void 0===n?Lg:lg(+n),u.x=function(t){return arguments.length?(e="function"==typeof t?t:lg(+t),r=null,u):e},u.x0=function(t){return arguments.length?(e="function"==typeof t?t:lg(+t),u):e},u.x1=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:lg(+e),u):r},u.y=function(e){return arguments.length?(t="function"==typeof e?e:lg(+e),n=null,u):t},u.y0=function(e){return arguments.length?(t="function"==typeof e?e:lg(+e),u):t},u.y1=function(e){return arguments.length?(n=null==e?null:"function"==typeof e?e:lg(+e),u):n},u.lineX0=u.lineY0=function(){return c().x(e).y(t)},u.lineY1=function(){return c().x(e).y(n)},u.lineX1=function(){return c().x(r).y(t)},u.defined=function(e){return arguments.length?(i="function"==typeof e?e:lg(!!e),u):i},u.curve=function(e){return arguments.length?(a=e,null!=o&&(s=a(o)),u):a},u.context=function(e){return arguments.length?(null==e?o=s=null:s=a(o=e),u):o},u}jg.prototype=Dg.prototype,Tg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};var Ug={draw(e,t){const n=mg(t/yg);e.moveTo(n,0),e.arc(0,0,n,0,bg)}};function qg(){}function Wg(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Zg(e){this._context=e}function Hg(e){this._context=e}function Gg(e){this._context=e}function Vg(e,t){this._basis=new Zg(e),this._beta=t}Zg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Wg(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Wg(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},Hg.prototype={areaStart:qg,areaEnd:qg,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Wg(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},Gg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Wg(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},Vg.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r,i=e[0],o=t[0],a=e[n]-i,s=t[n]-o,l=-1;++l<=n;)r=l/n,this._basis.point(this._beta*e[l]+(1-this._beta)*(i+r*a),this._beta*t[l]+(1-this._beta)*(o+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var Yg=function e(t){function n(e){return 1===t?new Zg(e):new Vg(e,t)}return n.beta=function(t){return e(+t)},n}(.85);function Xg(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function Jg(e,t){this._context=e,this._k=(1-t)/6}Jg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Xg(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Xg(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Qg=function e(t){function n(e){return new Jg(e,t)}return n.tension=function(t){return e(+t)},n}(0);function Kg(e,t){this._context=e,this._k=(1-t)/6}Kg.prototype={areaStart:qg,areaEnd:qg,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Xg(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var ey=function e(t){function n(e){return new Kg(e,t)}return n.tension=function(t){return e(+t)},n}(0);function ty(e,t){this._context=e,this._k=(1-t)/6}ty.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Xg(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var ny=function e(t){function n(e){return new ty(e,t)}return n.tension=function(t){return e(+t)},n}(0);function ry(e,t,n){var r=e._x1,i=e._y1,o=e._x2,a=e._y2;if(e._l01_a>gg){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>gg){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*u+e._x1*e._l23_2a-t*e._l12_2a)/c,a=(a*u+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,o,a,e._x2,e._y2)}function iy(e,t){this._context=e,this._alpha=t}iy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:ry(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var oy=function e(t){function n(e){return t?new iy(e,t):new Jg(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function ay(e,t){this._context=e,this._alpha=t}ay.prototype={areaStart:qg,areaEnd:qg,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:ry(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var sy=function e(t){function n(e){return t?new ay(e,t):new Kg(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function ly(e,t){this._context=e,this._alpha=t}ly.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:ry(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var uy=function e(t){function n(e){return t?new ly(e,t):new ty(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function cy(e){this._context=e}function fy(e){return e<0?-1:1}function dy(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),a=(n-e._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(fy(o)+fy(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function hy(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function py(e,t,n){var r=e._x0,i=e._y0,o=e._x1,a=e._y1,s=(o-r)/3;e._context.bezierCurveTo(r+s,i+s*t,o-s,a-s*n,o,a)}function my(e){this._context=e}function gy(e){this._context=new yy(e)}function yy(e){this._context=e}function vy(e){this._context=e}function by(e){var t,n,r=e.length-1,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,o[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/o[t-1],o[t]-=n,a[t]-=n*a[t-1];for(i[r-1]=a[r-1]/o[r-1],t=r-2;t>=0;--t)i[t]=(a[t]-i[t+1])/o[t];for(o[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function xy(e,t){this._context=e,this._t=t}function wy(e,t){if("undefined"!=typeof document&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}cy.prototype={areaStart:qg,areaEnd:qg,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},my.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:py(this,this._t0,hy(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,py(this,hy(this,n=dy(this,e,t)),n);break;default:py(this,this._t0,n=dy(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(gy.prototype=Object.create(my.prototype)).point=function(e,t){my.prototype.point.call(this,t,e)},yy.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}},vy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=by(e),i=by(t),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[a],t[a]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},xy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};const ky=()=>"undefined"!=typeof Image?Image:null;function _y(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function Oy(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}const Ey=Symbol("implicit");function Dy(){var e=new Ks,t=[],n=[],r=Ey;function i(i){let o=e.get(i);if(void 0===o){if(r!==Ey)return r;e.set(i,o=t.push(i)-1)}return n[o%n.length]}return i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new Ks;for(const r of n)e.has(r)||e.set(r,t.push(r)-1);return i},i.range=function(e){return arguments.length?(n=Array.from(e),i):n.slice()},i.unknown=function(e){return arguments.length?(r=e,i):r},i.copy=function(){return Dy(t,n).unknown(r)},_y.apply(i,arguments),i}function jy(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Ny(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Sy(){}var Ay=.7,$y=1/Ay,Cy="\\s*([+-]?\\d+)\\s*",My="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Py="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Fy=/^#([0-9a-f]{3,8})$/,Ty=new RegExp(`^rgb\\(${Cy},${Cy},${Cy}\\)$`),zy=new RegExp(`^rgb\\(${Py},${Py},${Py}\\)$`),Ry=new RegExp(`^rgba\\(${Cy},${Cy},${Cy},${My}\\)$`),Ly=new RegExp(`^rgba\\(${Py},${Py},${Py},${My}\\)$`),By=new RegExp(`^hsl\\(${My},${Py},${Py}\\)$`),Iy=new RegExp(`^hsla\\(${My},${Py},${Py},${My}\\)$`),Uy={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function qy(){return this.rgb().formatHex()}function Wy(){return this.rgb().formatRgb()}function Zy(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Fy.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Hy(t):3===n?new Xy(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Gy(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Gy(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Ty.exec(e))?new Xy(t[1],t[2],t[3],1):(t=zy.exec(e))?new Xy(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Ry.exec(e))?Gy(t[1],t[2],t[3],t[4]):(t=Ly.exec(e))?Gy(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=By.exec(e))?nv(t[1],t[2]/100,t[3]/100,1):(t=Iy.exec(e))?nv(t[1],t[2]/100,t[3]/100,t[4]):Uy.hasOwnProperty(e)?Hy(Uy[e]):"transparent"===e?new Xy(NaN,NaN,NaN,0):null}function Hy(e){return new Xy(e>>16&255,e>>8&255,255&e,1)}function Gy(e,t,n,r){return r<=0&&(e=t=n=NaN),new Xy(e,t,n,r)}function Vy(e){return e instanceof Sy||(e=Zy(e)),e?new Xy((e=e.rgb()).r,e.g,e.b,e.opacity):new Xy}function Yy(e,t,n,r){return 1===arguments.length?Vy(e):new Xy(e,t,n,null==r?1:r)}function Xy(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function Jy(){return`#${tv(this.r)}${tv(this.g)}${tv(this.b)}`}function Qy(){const e=Ky(this.opacity);return`${1===e?"rgb(":"rgba("}${ev(this.r)}, ${ev(this.g)}, ${ev(this.b)}${1===e?")":`, ${e})`}`}function Ky(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ev(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function tv(e){return((e=ev(e))<16?"0":"")+e.toString(16)}function nv(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ov(e,t,n,r)}function rv(e){if(e instanceof ov)return new ov(e.h,e.s,e.l,e.opacity);if(e instanceof Sy||(e=Zy(e)),!e)return new ov;if(e instanceof ov)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,l=(o+i)/2;return s?(a=t===o?(n-r)/s+6*(n<r):n===o?(r-t)/s+2:(t-n)/s+4,s/=l<.5?o+i:2-o-i,a*=60):s=l>0&&l<1?0:a,new ov(a,s,l,e.opacity)}function iv(e,t,n,r){return 1===arguments.length?rv(e):new ov(e,t,n,null==r?1:r)}function ov(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function av(e){return(e=(e||0)%360)<0?e+360:e}function sv(e){return Math.max(0,Math.min(1,e||0))}function lv(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}jy(Sy,Zy,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:qy,formatHex:qy,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return rv(this).formatHsl()},formatRgb:Wy,toString:Wy}),jy(Xy,Yy,Ny(Sy,{brighter(e){return e=null==e?$y:Math.pow($y,e),new Xy(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?Ay:Math.pow(Ay,e),new Xy(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Xy(ev(this.r),ev(this.g),ev(this.b),Ky(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Jy,formatHex:Jy,formatHex8:function(){return`#${tv(this.r)}${tv(this.g)}${tv(this.b)}${tv(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Qy,toString:Qy})),jy(ov,iv,Ny(Sy,{brighter(e){return e=null==e?$y:Math.pow($y,e),new ov(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?Ay:Math.pow(Ay,e),new ov(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Xy(lv(e>=240?e-240:e+120,i,r),lv(e,i,r),lv(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new ov(av(this.h),sv(this.s),sv(this.l),Ky(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ky(this.opacity);return`${1===e?"hsl(":"hsla("}${av(this.h)}, ${100*sv(this.s)}%, ${100*sv(this.l)}%${1===e?")":`, ${e})`}`}}));const uv=Math.PI/180,cv=180/Math.PI,fv=.96422,dv=1,hv=.82521,pv=4/29,mv=6/29,gv=3*mv*mv,yv=mv*mv*mv;function vv(e){if(e instanceof xv)return new xv(e.l,e.a,e.b,e.opacity);if(e instanceof Dv)return jv(e);e instanceof Xy||(e=Vy(e));var t,n,r=Ov(e.r),i=Ov(e.g),o=Ov(e.b),a=wv((.2225045*r+.7168786*i+.0606169*o)/dv);return r===i&&i===o?t=n=a:(t=wv((.4360747*r+.3850649*i+.1430804*o)/fv),n=wv((.0139322*r+.0971045*i+.7141733*o)/hv)),new xv(116*a-16,500*(t-a),200*(a-n),e.opacity)}function bv(e,t,n,r){return 1===arguments.length?vv(e):new xv(e,t,n,null==r?1:r)}function xv(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function wv(e){return e>yv?Math.pow(e,1/3):e/gv+pv}function kv(e){return e>mv?e*e*e:gv*(e-pv)}function _v(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Ov(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Ev(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof Dv)return new Dv(e.h,e.c,e.l,e.opacity);if(e instanceof xv||(e=vv(e)),0===e.a&&0===e.b)return new Dv(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*cv;return new Dv(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}(e):new Dv(e,t,n,null==r?1:r)}function Dv(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function jv(e){if(isNaN(e.h))return new xv(e.l,0,0,e.opacity);var t=e.h*uv;return new xv(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}jy(xv,bv,Ny(Sy,{brighter(e){return new xv(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker(e){return new xv(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new Xy(_v(3.1338561*(t=fv*kv(t))-1.6168667*(e=dv*kv(e))-.4906146*(n=hv*kv(n))),_v(-.9787684*t+1.9161415*e+.033454*n),_v(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),jy(Dv,Ev,Ny(Sy,{brighter(e){return new Dv(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker(e){return new Dv(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb(){return jv(this).rgb()}}));var Nv=-.14861,Sv=1.78277,Av=-.29227,$v=-.90649,Cv=1.97294,Mv=Cv*$v,Pv=Cv*Sv,Fv=Sv*Av-$v*Nv;function Tv(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof zv)return new zv(e.h,e.s,e.l,e.opacity);e instanceof Xy||(e=Vy(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(Fv*r+Mv*t-Pv*n)/(Fv+Mv-Pv),o=r-i,a=(Cv*(n-i)-Av*o)/$v,s=Math.sqrt(a*a+o*o)/(Cv*i*(1-i)),l=s?Math.atan2(a,o)*cv-120:NaN;return new zv(l<0?l+360:l,s,i,e.opacity)}(e):new zv(e,t,n,null==r?1:r)}function zv(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function Rv(e,t,n,r,i){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*r+a*i)/6}function Lv(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],a=r>0?e[r-1]:2*i-o,s=r<t-1?e[r+2]:2*o-i;return Rv((n-r/t)*t,a,i,o,s)}}function Bv(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],a=e[(r+1)%t],s=e[(r+2)%t];return Rv((n-r/t)*t,i,o,a,s)}}jy(zv,Tv,Ny(Sy,{brighter(e){return e=null==e?$y:Math.pow($y,e),new zv(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?Ay:Math.pow(Ay,e),new zv(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*uv,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new Xy(255*(t+n*(Nv*r+Sv*i)),255*(t+n*(Av*r+$v*i)),255*(t+n*(Cv*r)),this.opacity)}}));var Iv=e=>()=>e;function Uv(e,t){return function(n){return e+n*t}}function qv(e,t){var n=t-e;return n?Uv(e,n>180||n<-180?n-360*Math.round(n/360):n):Iv(isNaN(e)?t:e)}function Wv(e){return 1==(e=+e)?Zv:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):Iv(isNaN(t)?n:t)}}function Zv(e,t){var n=t-e;return n?Uv(e,n):Iv(isNaN(e)?t:e)}var Hv=function e(t){var n=Wv(t);function r(e,t){var r=n((e=Yy(e)).r,(t=Yy(t)).r),i=n(e.g,t.g),o=n(e.b,t.b),a=Zv(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=o(t),e.opacity=a(t),e+""}}return r.gamma=e,r}(1);function Gv(e){return function(t){var n,r,i=t.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=Yy(t[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=e(o),a=e(a),s=e(s),r.opacity=1,function(e){return r.r=o(e),r.g=a(e),r.b=s(e),r+""}}}var Vv=Gv(Lv),Yv=Gv(Bv);function Xv(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(o){for(n=0;n<r;++n)i[n]=e[n]*(1-o)+t[n]*o;return i}}function Jv(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Qv(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=ob(e[n],t[n]);for(;n<r;++n)a[n]=t[n];return function(e){for(n=0;n<i;++n)a[n]=o[n](e);return a}}function Kv(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function eb(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function tb(e,t){var n,r={},i={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?r[n]=ob(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}var nb=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,rb=new RegExp(nb.source,"g");function ib(e,t){var n,r,i,o=nb.lastIndex=rb.lastIndex=0,a=-1,s=[],l=[];for(e+="",t+="";(n=nb.exec(e))&&(r=rb.exec(t));)(i=r.index)>o&&(i=t.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,l.push({i:a,x:eb(n,r)})),o=rb.lastIndex;return o<t.length&&(i=t.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,r=0;r<t;++r)s[(n=l[r]).i]=n.x(e);return s.join("")})}function ob(e,t){var n,r=typeof t;return null==t||"boolean"===r?Iv(t):("number"===r?eb:"string"===r?(n=Zy(t))?(t=n,Hv):ib:t instanceof Zy?Hv:t instanceof Date?Kv:Jv(t)?Xv:Array.isArray(t)?Qv:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?tb:eb)(e,t)}function ab(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var sb,lb=180/Math.PI,ub={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function cb(e,t,n,r,i,o){var a,s,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*lb,skewX:Math.atan(l)*lb,scaleX:a,scaleY:s}}function fb(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}return function(o,a){var s=[],l=[];return o=e(o),a=e(a),function(e,r,i,o,a,s){if(e!==i||r!==o){var l=a.push("translate(",null,t,null,n);s.push({i:l-4,x:eb(e,i)},{i:l-2,x:eb(r,o)})}else(i||o)&&a.push("translate("+i+t+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,l),function(e,t,n,o){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:eb(e,t)})):t&&n.push(i(n)+"rotate("+t+r)}(o.rotate,a.rotate,s,l),function(e,t,n,o){e!==t?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:eb(e,t)}):t&&n.push(i(n)+"skewX("+t+r)}(o.skewX,a.skewX,s,l),function(e,t,n,r,o,a){if(e!==n||t!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:eb(e,n)},{i:s-2,x:eb(t,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,l),o=a=null,function(e){for(var t,n=-1,r=l.length;++n<r;)s[(t=l[n]).i]=t.x(e);return s.join("")}}}var db=fb((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?ub:cb(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),hb=fb((function(e){return null==e?ub:(sb||(sb=document.createElementNS("http://www.w3.org/2000/svg","g")),sb.setAttribute("transform",e),(e=sb.transform.baseVal.consolidate())?cb((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):ub)}),", ",")",")");function pb(e){return((e=Math.exp(e))+1/e)/2}var mb=function e(t,n,r){function i(e,i){var o,a,s=e[0],l=e[1],u=e[2],c=i[0],f=i[1],d=i[2],h=c-s,p=f-l,m=h*h+p*p;if(m<1e-12)a=Math.log(d/u)/t,o=function(e){return[s+e*h,l+e*p,u*Math.exp(t*e*a)]};else{var g=Math.sqrt(m),y=(d*d-u*u+r*m)/(2*u*n*g),v=(d*d-u*u-r*m)/(2*d*n*g),b=Math.log(Math.sqrt(y*y+1)-y),x=Math.log(Math.sqrt(v*v+1)-v);a=(x-b)/t,o=function(e){var r=e*a,i=pb(b),o=u/(n*g)*(i*function(e){return((e=Math.exp(2*e))-1)/(e+1)}(t*r+b)-function(e){return((e=Math.exp(e))-1/e)/2}(b));return[s+o*h,l+o*p,u*i/pb(t*r+b)]}}return o.duration=1e3*a*t/Math.SQRT2,o}return i.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},i}(Math.SQRT2,2,4);function gb(e){return function(t,n){var r=e((t=iv(t)).h,(n=iv(n)).h),i=Zv(t.s,n.s),o=Zv(t.l,n.l),a=Zv(t.opacity,n.opacity);return function(e){return t.h=r(e),t.s=i(e),t.l=o(e),t.opacity=a(e),t+""}}}var yb=gb(qv),vb=gb(Zv);function bb(e){return function(t,n){var r=e((t=Ev(t)).h,(n=Ev(n)).h),i=Zv(t.c,n.c),o=Zv(t.l,n.l),a=Zv(t.opacity,n.opacity);return function(e){return t.h=r(e),t.c=i(e),t.l=o(e),t.opacity=a(e),t+""}}}var xb=bb(qv),wb=bb(Zv);function kb(e){return function t(n){function r(t,r){var i=e((t=Tv(t)).h,(r=Tv(r)).h),o=Zv(t.s,r.s),a=Zv(t.l,r.l),s=Zv(t.opacity,r.opacity);return function(e){return t.h=i(e),t.s=o(e),t.l=a(Math.pow(e,n)),t.opacity=s(e),t+""}}return n=+n,r.gamma=t,r}(1)}var _b=kb(qv),Ob=kb(Zv);function Eb(e,t){void 0===t&&(t=e,e=ob);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return o[t](e-t)}}var Db=Object.freeze({__proto__:null,interpolate:ob,interpolateArray:function(e,t){return(Jv(t)?Xv:Qv)(e,t)},interpolateBasis:Lv,interpolateBasisClosed:Bv,interpolateCubehelix:_b,interpolateCubehelixLong:Ob,interpolateDate:Kv,interpolateDiscrete:function(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}},interpolateHcl:xb,interpolateHclLong:wb,interpolateHsl:yb,interpolateHslLong:vb,interpolateHue:function(e,t){var n=qv(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}},interpolateLab:function(e,t){var n=Zv((e=bv(e)).l,(t=bv(t)).l),r=Zv(e.a,t.a),i=Zv(e.b,t.b),o=Zv(e.opacity,t.opacity);return function(t){return e.l=n(t),e.a=r(t),e.b=i(t),e.opacity=o(t),e+""}},interpolateNumber:eb,interpolateNumberArray:Xv,interpolateObject:tb,interpolateRgb:Hv,interpolateRgbBasis:Vv,interpolateRgbBasisClosed:Yv,interpolateRound:ab,interpolateString:ib,interpolateTransformCss:db,interpolateTransformSvg:hb,interpolateZoom:mb,piecewise:Eb,quantize:function(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}});function jb(e){return+e}var Nb=[0,1];function Sb(e){return e}function Ab(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function $b(e,t,n){var r=e[0],i=e[1],o=t[0],a=t[1];return i<r?(r=Ab(i,r),o=n(a,o)):(r=Ab(r,i),o=n(o,a)),function(e){return o(r(e))}}function Cb(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=Ab(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(t){var n=Js(e,t,1,r)-1;return o[n](i[n](t))}}function Mb(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Pb(){var e,t,n,r,i,o,a=Nb,s=Nb,l=ob,u=Sb;function c(){var e=Math.min(a.length,s.length);return u!==Sb&&(u=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(a[0],a[e-1])),r=e>2?Cb:$b,i=o=null,f}function f(t){return null==t||isNaN(t=+t)?n:(i||(i=r(a.map(e),s,l)))(e(u(t)))}return f.invert=function(n){return u(t((o||(o=r(s,a.map(e),eb)))(n)))},f.domain=function(e){return arguments.length?(a=Array.from(e,jb),c()):a.slice()},f.range=function(e){return arguments.length?(s=Array.from(e),c()):s.slice()},f.rangeRound=function(e){return s=Array.from(e),l=ab,c()},f.clamp=function(e){return arguments.length?(u=!!e||Sb,c()):u!==Sb},f.interpolate=function(e){return arguments.length?(l=e,c()):l},f.unknown=function(e){return arguments.length?(n=e,f):n},function(n,r){return e=n,t=r,c()}}function Fb(){return Pb()(Sb,Sb)}function Tb(e,t,n,r){var i,o=dl(e,t,n);switch((r=jl(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(i=Ll(o,a))||(r.precision=i),Pl(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=Bl(o,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=Rl(o))||(r.precision=i-2*("%"===r.type))}return Ml(r)}function zb(e){var t=e.domain;return e.ticks=function(e){var n=t();return cl(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return Tb(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,i,o=t(),a=0,s=o.length-1,l=o[a],u=o[s],c=10;for(u<l&&(i=l,l=u,u=i,i=a,a=s,s=i);c-- >0;){if((i=fl(l,u,n))===r)return o[a]=l,o[s]=u,t(o);if(i>0)l=Math.floor(l/i)*i,u=Math.ceil(u/i)*i;else{if(!(i<0))break;l=Math.ceil(l*i)/i,u=Math.floor(u*i)/i}r=i}return e},e}function Rb(e,t){var n,r=0,i=(e=e.slice()).length-1,o=e[r],a=e[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),e[r]=t.floor(o),e[i]=t.ceil(a),e}function Lb(e){return Math.log(e)}function Bb(e){return Math.exp(e)}function Ib(e){return-Math.log(-e)}function Ub(e){return-Math.exp(-e)}function qb(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Wb(e){return(t,n)=>-e(-t,n)}function Zb(e){const t=e(Lb,Bb),n=t.domain;let r,i,o=10;function a(){return r=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}(o),i=function(e){return 10===e?qb:e===Math.E?Math.exp:t=>Math.pow(e,t)}(o),n()[0]<0?(r=Wb(r),i=Wb(i),e(Ib,Ub)):e(Lb,Bb),t}return t.base=function(e){return arguments.length?(o=+e,a()):o},t.domain=function(e){return arguments.length?(n(e),a()):n()},t.ticks=e=>{const t=n();let a=t[0],s=t[t.length-1];const l=s<a;l&&([a,s]=[s,a]);let u,c,f=r(a),d=r(s);const h=null==e?10:+e;let p=[];if(!(o%1)&&d-f<h){if(f=Math.floor(f),d=Math.ceil(d),a>0){for(;f<=d;++f)for(u=1;u<o;++u)if(c=f<0?u/i(-f):u*i(f),!(c<a)){if(c>s)break;p.push(c)}}else for(;f<=d;++f)for(u=o-1;u>=1;--u)if(c=f>0?u/i(-f):u*i(f),!(c<a)){if(c>s)break;p.push(c)}2*p.length<h&&(p=cl(a,s,h))}else p=cl(f,d,Math.min(d-f,h)).map(i);return l?p.reverse():p},t.tickFormat=(e,n)=>{if(null==e&&(e=10),null==n&&(n=10===o?"s":","),"function"!=typeof n&&(o%1||null!=(n=jl(n)).precision||(n.trim=!0),n=Ml(n)),e===1/0)return n;const a=Math.max(1,o*e/t.ticks().length);return e=>{let t=e/i(Math.round(r(e)));return t*o<o-.5&&(t*=o),t<=a?n(e):""}},t.nice=()=>n(Rb(n(),{floor:e=>i(Math.floor(r(e))),ceil:e=>i(Math.ceil(r(e)))})),t}function Hb(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Gb(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Vb(e){var t=1,n=e(Hb(t),Gb(t));return n.constant=function(n){return arguments.length?e(Hb(t=+n),Gb(t)):t},zb(n)}function Yb(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Xb(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Jb(e){return e<0?-e*e:e*e}function Qb(e){var t=e(Sb,Sb),n=1;return t.exponent=function(t){return arguments.length?1===(n=+t)?e(Sb,Sb):.5===n?e(Xb,Jb):e(Yb(n),Yb(1/n)):n},zb(t)}function Kb(){var e=Qb(Pb());return e.copy=function(){return Mb(e,Kb()).exponent(e.exponent())},_y.apply(e,arguments),e}function ex(e){return new Date(e)}function tx(e){return e instanceof Date?+e:+new Date(+e)}function nx(e,t,n,r,i,o,a,s,l,u){var c=Fb(),f=c.invert,d=c.domain,h=u(".%L"),p=u(":%S"),m=u("%I:%M"),g=u("%I %p"),y=u("%a %d"),v=u("%b %d"),b=u("%B"),x=u("%Y");function w(e){return(l(e)<e?h:s(e)<e?p:a(e)<e?m:o(e)<e?g:r(e)<e?i(e)<e?y:v:n(e)<e?b:x)(e)}return c.invert=function(e){return new Date(f(e))},c.domain=function(e){return arguments.length?d(Array.from(e,tx)):d().map(ex)},c.ticks=function(t){var n=d();return e(n[0],n[n.length-1],null==t?10:t)},c.tickFormat=function(e,t){return null==t?w:u(t)},c.nice=function(e){var n=d();return e&&"function"==typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?d(Rb(n,e)):c},c.copy=function(){return Mb(c,nx(e,t,n,r,i,o,a,s,l,u))},c}function rx(){var e,t,n,r,i,o=0,a=1,s=Sb,l=!1;function u(t){return null==t||isNaN(t=+t)?i:s(0===n?.5:(t=(r(t)-e)*n,l?Math.max(0,Math.min(1,t)):t))}function c(e){return function(t){var n,r;return arguments.length?([n,r]=t,s=e(n,r),u):[s(0),s(1)]}}return u.domain=function(i){return arguments.length?([o,a]=i,e=r(o=+o),t=r(a=+a),n=e===t?0:1/(t-e),u):[o,a]},u.clamp=function(e){return arguments.length?(l=!!e,u):l},u.interpolator=function(e){return arguments.length?(s=e,u):s},u.range=c(ob),u.rangeRound=c(ab),u.unknown=function(e){return arguments.length?(i=e,u):i},function(i){return r=i,e=i(o),t=i(a),n=e===t?0:1/(t-e),u}}function ix(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function ox(){var e=zb(rx()(Sb));return e.copy=function(){return ix(e,ox())},Oy.apply(e,arguments)}function ax(){var e=Qb(rx());return e.copy=function(){return ix(e,ax()).exponent(e.exponent())},Oy.apply(e,arguments)}function sx(){var e,t,n,r,i,o,a,s=0,l=.5,u=1,c=1,f=Sb,d=!1;function h(e){return isNaN(e=+e)?a:(e=.5+((e=+o(e))-t)*(c*e<c*t?r:i),f(d?Math.max(0,Math.min(1,e)):e))}function p(e){return function(t){var n,r,i;return arguments.length?([n,r,i]=t,f=Eb(e,[n,r,i]),h):[f(0),f(.5),f(1)]}}return h.domain=function(a){return arguments.length?([s,l,u]=a,e=o(s=+s),t=o(l=+l),n=o(u=+u),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),c=t<e?-1:1,h):[s,l,u]},h.clamp=function(e){return arguments.length?(d=!!e,h):d},h.interpolator=function(e){return arguments.length?(f=e,h):f},h.range=p(ob),h.rangeRound=p(ab),h.unknown=function(e){return arguments.length?(a=e,h):a},function(a){return o=a,e=a(s),t=a(l),n=a(u),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),c=t<e?-1:1,h}}function lx(){var e=Qb(sx());return e.copy=function(){return ix(e,lx()).exponent(e.exponent())},Oy.apply(e,arguments)}function ux(e,t,n){const r=e-t+2*n;return e?r>0?r:1:0}const cx="linear",fx="log",dx="pow",hx="sqrt",px="symlog",mx="time",gx="utc",yx="sequential",vx="diverging",bx="quantile",xx="quantize",wx="threshold",kx="ordinal",_x="point",Ox="band",Ex="bin-ordinal",Dx="continuous",jx="discrete",Nx="discretizing",Sx="interpolating",Ax="temporal";function $x(){const e=Dy().unknown(void 0),t=e.domain,n=e.range;let r,i,o=[0,1],a=!1,s=0,l=0,u=.5;function c(){const e=t().length,c=o[1]<o[0],f=o[1-c],d=ux(e,s,l);let h=o[c-0];r=(f-h)/(d||1),a&&(r=Math.floor(r)),h+=(f-h-r*(e-s))*u,i=r*(1-s),a&&(h=Math.round(h),i=Math.round(i));const p=wl(e).map((e=>h+r*e));return n(c?p.reverse():p)}return delete e.unknown,e.domain=function(e){return arguments.length?(t(e),c()):t()},e.range=function(e){return arguments.length?(o=[+e[0],+e[1]],c()):o.slice()},e.rangeRound=function(e){return o=[+e[0],+e[1]],a=!0,c()},e.bandwidth=function(){return i},e.step=function(){return r},e.round=function(e){return arguments.length?(a=!!e,c()):a},e.padding=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),s=l,c()):s},e.paddingInner=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),c()):s},e.paddingOuter=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),c()):l},e.align=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),c()):u},e.invertRange=function(e){if(null==e[0]||null==e[1])return;const r=o[1]<o[0],a=r?n().reverse():n(),s=a.length-1;let l,u,c,f=+e[0],d=+e[1];return f!=f||d!=d||(d<f&&(c=f,f=d,d=c),d<a[0]||f>o[1-r])?void 0:(l=Math.max(0,Ys(a,f)-1),u=f===d?l:Ys(a,d)-1,f-a[l]>i+1e-10&&++l,r&&(c=l,l=s-u,u=s-c),l>u?void 0:t().slice(l,u+1))},e.invert=function(t){const n=e.invertRange([t,t]);return n?n[0]:n},e.copy=function(){return $x().domain(t()).range(o).round(a).paddingInner(s).paddingOuter(l).align(u)},c()}function Cx(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return Cx(t())},e}var Mx=Array.prototype.map;const Px=Array.prototype.slice;const Fx=new Map,Tx=Symbol("vega_scale");function zx(e){return e[Tx]=!0,e}function Rx(e,t,n){return arguments.length>1?(Fx.set(e,function(e,t,n){const r=function(){const n=t();return n.invertRange||(n.invertRange=n.invert?function(e){return function(t){let n,r=t[0],i=t[1];return i<r&&(n=r,r=i,i=n),[e.invert(r),e.invert(i)]}}(n):n.invertExtent?function(e){return function(t){const n=e.range();let r,i,o,a,s=t[0],l=t[1],u=-1;for(l<s&&(i=s,s=l,l=i),o=0,a=n.length;o<a;++o)n[o]>=s&&n[o]<=l&&(u<0&&(u=o),r=o);if(!(u<0))return s=e.invertExtent(n[u]),l=e.invertExtent(n[r]),[void 0===s[0]?s[1]:s[0],void 0===l[1]?l[0]:l[1]]}}(n):void 0),n.type=e,zx(n)};return r.metadata=_s(Ra(n)),r}(e,t,n)),this):Lx(e)?Fx.get(e):void 0}function Lx(e){return Fx.has(e)}function Bx(e,t){const n=Fx.get(e);return n&&n.metadata[t]}function Ix(e){return Bx(e,Dx)}function Ux(e){return Bx(e,jx)}function qx(e){return Bx(e,Nx)}function Wx(e){return Bx(e,fx)}function Zx(e){return Bx(e,Sx)}function Hx(e){return Bx(e,bx)}Rx("identity",(function e(t){var n;function r(e){return null==e||isNaN(e=+e)?n:e}return r.invert=r,r.domain=r.range=function(e){return arguments.length?(t=Array.from(e,jb),r):t.slice()},r.unknown=function(e){return arguments.length?(n=e,r):n},r.copy=function(){return e(t).unknown(n)},t=arguments.length?Array.from(t,jb):[0,1],zb(r)})),Rx(cx,(function e(){var t=Fb();return t.copy=function(){return Mb(t,e())},_y.apply(t,arguments),zb(t)}),Dx),Rx(fx,(function e(){const t=Zb(Pb()).domain([1,10]);return t.copy=()=>Mb(t,e()).base(t.base()),_y.apply(t,arguments),t}),[Dx,fx]),Rx(dx,Kb,Dx),Rx(hx,(function(){return Kb.apply(null,arguments).exponent(.5)}),Dx),Rx(px,(function e(){var t=Vb(Pb());return t.copy=function(){return Mb(t,e()).constant(t.constant())},_y.apply(t,arguments)}),Dx),Rx(mx,(function(){return _y.apply(nx(Su,Au,Ou,ku,su,ru,tu,Kl,Ql,Zc).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}),[Dx,Ax]),Rx(gx,(function(){return _y.apply(nx(ju,Nu,Eu,_u,mu,iu,nu,eu,Ql,Gc).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}),[Dx,Ax]),Rx(yx,ox,[Dx,Sx]),Rx(`${yx}-${cx}`,ox,[Dx,Sx]),Rx(`${yx}-${fx}`,(function e(){var t=Zb(rx()).domain([1,10]);return t.copy=function(){return ix(t,e()).base(t.base())},Oy.apply(t,arguments)}),[Dx,Sx,fx]),Rx(`${yx}-${dx}`,ax,[Dx,Sx]),Rx(`${yx}-${hx}`,(function(){return ax.apply(null,arguments).exponent(.5)}),[Dx,Sx]),Rx(`${yx}-${px}`,(function e(){var t=Vb(rx());return t.copy=function(){return ix(t,e()).constant(t.constant())},Oy.apply(t,arguments)}),[Dx,Sx]),Rx(`${vx}-${cx}`,(function e(){var t=zb(sx()(Sb));return t.copy=function(){return ix(t,e())},Oy.apply(t,arguments)}),[Dx,Sx]),Rx(`${vx}-${fx}`,(function e(){var t=Zb(sx()).domain([.1,1,10]);return t.copy=function(){return ix(t,e()).base(t.base())},Oy.apply(t,arguments)}),[Dx,Sx,fx]),Rx(`${vx}-${dx}`,lx,[Dx,Sx]),Rx(`${vx}-${hx}`,(function(){return lx.apply(null,arguments).exponent(.5)}),[Dx,Sx]),Rx(`${vx}-${px}`,(function e(){var t=Vb(sx());return t.copy=function(){return ix(t,e()).constant(t.constant())},Oy.apply(t,arguments)}),[Dx,Sx]),Rx(bx,(function e(){var t,n=[],r=[],i=[];function o(){var e=0,t=Math.max(1,r.length);for(i=new Array(t-1);++e<t;)i[e-1]=vl(n,e/t);return a}function a(e){return null==e||isNaN(e=+e)?t:r[Js(i,e)]}return a.invertExtent=function(e){var t=r.indexOf(e);return t<0?[NaN,NaN]:[t>0?i[t-1]:n[0],t<i.length?i[t]:n[n.length-1]]},a.domain=function(e){if(!arguments.length)return n.slice();n=[];for(let t of e)null==t||isNaN(t=+t)||n.push(t);return n.sort(qs),o()},a.range=function(e){return arguments.length?(r=Array.from(e),o()):r.slice()},a.unknown=function(e){return arguments.length?(t=e,a):t},a.quantiles=function(){return i.slice()},a.copy=function(){return e().domain(n).range(r).unknown(t)},_y.apply(a,arguments)}),[Nx,bx]),Rx(xx,(function e(){var t,n=0,r=1,i=1,o=[.5],a=[0,1];function s(e){return null!=e&&e<=e?a[Js(o,e,0,i)]:t}function l(){var e=-1;for(o=new Array(i);++e<i;)o[e]=((e+1)*r-(e-i)*n)/(i+1);return s}return s.domain=function(e){return arguments.length?([n,r]=e,n=+n,r=+r,l()):[n,r]},s.range=function(e){return arguments.length?(i=(a=Array.from(e)).length-1,l()):a.slice()},s.invertExtent=function(e){var t=a.indexOf(e);return t<0?[NaN,NaN]:t<1?[n,o[0]]:t>=i?[o[i-1],r]:[o[t-1],o[t]]},s.unknown=function(e){return arguments.length?(t=e,s):s},s.thresholds=function(){return o.slice()},s.copy=function(){return e().domain([n,r]).range(a).unknown(t)},_y.apply(zb(s),arguments)}),Nx),Rx(wx,(function e(){var t,n=[.5],r=[0,1],i=1;function o(e){return null!=e&&e<=e?r[Js(n,e,0,i)]:t}return o.domain=function(e){return arguments.length?(n=Array.from(e),i=Math.min(n.length,r.length-1),o):n.slice()},o.range=function(e){return arguments.length?(r=Array.from(e),i=Math.min(n.length,r.length-1),o):r.slice()},o.invertExtent=function(e){var t=r.indexOf(e);return[n[t-1],n[t]]},o.unknown=function(e){return arguments.length?(t=e,o):t},o.copy=function(){return e().domain(n).range(r).unknown(t)},_y.apply(o,arguments)}),Nx),Rx(Ex,(function e(){let t=[],n=[];function r(e){return null==e||e!=e?void 0:n[(Js(t,e)-1)%n.length]}return r.domain=function(e){return arguments.length?(t=function(e){return Mx.call(e,xa)}(e),r):t.slice()},r.range=function(e){return arguments.length?(n=Px.call(e),r):n.slice()},r.tickFormat=function(e,n){return Tb(t[0],ba(t),null==e?10:e,n)},r.copy=function(){return e().domain(r.domain()).range(r.range())},r}),[jx,Nx]),Rx(kx,Dy,jx),Rx(Ox,$x,jx),Rx(_x,(function(){return Cx($x().paddingInner(1))}),jx);const Gx=["clamp","base","constant","exponent"];function Vx(e,t){const n=t[0],r=ba(t)-n;return function(t){return e(n+t*r)}}function Yx(e,t,n){return Eb(Qx(t||"rgb",n),e)}function Xx(e,t){const n=new Array(t),r=t+1;for(let i=0;i<t;)n[i]=e(++i/r);return n}function Jx(e,t,n){const r=n-t;let i,o,a;return r&&Number.isFinite(r)?(i=(o=e.type).indexOf("-"),o=i<0?o:o.slice(i+1),a=Rx(o)().domain([t,n]).range([0,1]),Gx.forEach((t=>e[t]?a[t](e[t]()):0)),a):Ga(.5)}function Qx(e,t){const n=Db[function(e){return"interpolate"+e.toLowerCase().split("-").map((e=>e[0].toUpperCase()+e.slice(1))).join("")}(e)];return null!=t&&n&&n.gamma?n.gamma(t):n}function Kx(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n}function ew(e,t){for(const n in e)nw(n,t(e[n]))}const tw={};function nw(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(tw[e]=t,this):tw[e]}ew({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},Kx),ew({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(e=>Yx(Kx(e))));const rw="symbol",iw="discrete",ow=e=>ha(e)?e.map((e=>String(e))):String(e),aw=(e,t)=>e[1]-t[1],sw=(e,t)=>t[1]-e[1];function lw(e,t,n){let r;return ls(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),null!=n&&(t=Math.min(t,Math.floor(ys(e.domain())/n||1)))),pa(t)&&(r=t.step,t=t.interval),cs(t)&&(t=e.type===mx?yc(t):e.type==gx?vc(t):Jo("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function uw(e,t,n){let r=e.range(),i=r[0],o=ba(r),a=aw;if(i>o&&(r=o,o=i,i=r,a=sw),i=Math.floor(i),o=Math.ceil(o),t=t.map((t=>[t,e(t)])).filter((e=>i<=e[1]&&e[1]<=o)).sort(a).map((e=>e[0])),n>0&&t.length>1){const e=[t[0],ba(t)];for(;t.length>n&&t.length>=3;)t=t.filter(((e,t)=>!(t%2)));t.length<3&&(t=e)}return t}function cw(e,t){return e.bins?uw(e,e.bins):e.ticks?e.ticks(t):e.domain()}function fw(e,t,n,r,i,o){const a=t.type;let s=ow;if(a===mx||i===mx)s=e.timeFormat(r);else if(a===gx||i===gx)s=e.utcFormat(r);else if(Wx(a)){const i=e.formatFloat(r);if(o||t.bins)s=i;else{const e=dw(t,n,!1);s=t=>e(t)?i(t):""}}else if(t.tickFormat){const i=t.domain();s=e.formatSpan(i[0],i[i.length-1],n,r)}else r&&(s=e.format(r));return s}function dw(e,t,n){const r=cw(e,t),i=e.base(),o=Math.log(i),a=Math.max(1,i*t/r.length),s=e=>{let t=e/Math.pow(i,Math.round(Math.log(e)/o));return t*i<i-.5&&(t*=i),t<=a};return n?r.filter(s):s}const hw={[bx]:"quantiles",[xx]:"thresholds",[wx]:"domain"},pw={[bx]:"quantiles",[xx]:"domain"};function mw(e,t){return e.bins?function(e){const t=e.slice(0,-1);return t.max=ba(e),t}(e.bins):e.type===fx?dw(e,t,!0):hw[e.type]?function(e){const t=[-1/0].concat(e);return t.max=1/0,t}(e[hw[e.type]]()):cw(e,t)}const gw=e=>hw[e.type]||e.bins;function yw(e,t,n,r,i,o,a){const s=pw[t.type]&&o!==mx&&o!==gx?function(e,t,n){const r=t[pw[t.type]](),i=r.length;let o,a=i>1?r[1]-r[0]:r[0];for(o=1;o<i;++o)a=Math.min(a,r[o]-r[o-1]);return e.formatSpan(0,a,30,n)}(e,t,i):fw(e,t,n,i,o,a);return r===rw&&gw(t)?vw(s):r===iw?xw(s):ww(s)}const vw=e=>(t,n,r)=>{const i=bw(r[n+1],bw(r.max,1/0)),o=kw(t,e),a=kw(i,e);return o&&a?o+" \u2013 "+a:a?"< "+a:"\u2265 "+o},bw=(e,t)=>null!=e?e:t,xw=e=>(t,n)=>n?e(t):null,ww=e=>t=>e(t),kw=(e,t)=>Number.isFinite(e)?t(e):null;function _w(e,t,n,r){const i=r||t.type;return cs(n)&&function(e){return Bx(e,Ax)}(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||i!==mx?n||i!==gx?yw(e,t,5,null,n,r,!0):e.utcFormat("%A, %d %B %Y, %X UTC"):e.timeFormat("%A, %d %B %Y, %X")}function Ow(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=_w(e,t,n.format,n.formatType);if(qx(t.type)){const e=mw(t).slice(1).map(i),n=e.length;return`${n} boundar${1===n?"y":"ies"}: ${e.join(", ")}`}if(Ux(t.type)){const e=t.domain(),n=e.length;return`${n} value${1===n?"":"s"}: ${n>r?e.slice(0,r-2).map(i).join(", ")+", ending with "+e.slice(-1).map(i):e.map(i).join(", ")}`}{const e=t.domain();return`values from ${i(e[0])} to ${i(ba(e))}`}}let Ew=0;const Dw="p_";function jw(e){return e&&e.gradient}function Nw(e,t,n){const r=e.gradient;let i=e.id,o="radial"===r?Dw:"";return i||(i=e.id="gradient_"+Ew++,"radial"===r?(e.x1=Sw(e.x1,.5),e.y1=Sw(e.y1,.5),e.r1=Sw(e.r1,0),e.x2=Sw(e.x2,.5),e.y2=Sw(e.y2,.5),e.r2=Sw(e.r2,.5),o=Dw):(e.x1=Sw(e.x1,0),e.y1=Sw(e.y1,0),e.x2=Sw(e.x2,1),e.y2=Sw(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+o+i+")"}function Sw(e,t){return null!=e?e:t}function Aw(e,t){var n,r=[];return n={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:r,stop:function(e,t){return r.push({offset:e,color:t}),n}}}const $w={basis:{curve:function(e){return new Zg(e)}},"basis-closed":{curve:function(e){return new Hg(e)}},"basis-open":{curve:function(e){return new Gg(e)}},bundle:{curve:Yg,tension:"beta",value:.85},cardinal:{curve:Qg,tension:"tension",value:0},"cardinal-open":{curve:ny,tension:"tension",value:0},"cardinal-closed":{curve:ey,tension:"tension",value:0},"catmull-rom":{curve:oy,tension:"alpha",value:.5},"catmull-rom-closed":{curve:sy,tension:"alpha",value:.5},"catmull-rom-open":{curve:uy,tension:"alpha",value:.5},linear:{curve:zg},"linear-closed":{curve:function(e){return new cy(e)}},monotone:{horizontal:function(e){return new gy(e)},vertical:function(e){return new my(e)}},natural:{curve:function(e){return new vy(e)}},step:{curve:function(e){return new xy(e,.5)}},"step-after":{curve:function(e){return new xy(e,1)}},"step-before":{curve:function(e){return new xy(e,0)}}};function Cw(e,t,n){var r=Ka($w,e)&&$w[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}const Mw={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},Pw=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,Fw=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,Tw=/^((\s+,?\s*)|(,\s*))/,zw=/^[01]/;function Rw(e){const t=[];return(e.match(Pw)||[]).forEach((e=>{let n=e[0];const r=n.toLowerCase(),i=Mw[r],o=function(e,t,n){const r=[];for(let i=0;t&&i<n.length;)for(let o=0;o<t;++o){const t="a"!==e||3!==o&&4!==o?Fw:zw,a=n.slice(i).match(t);if(null===a)throw Error("Invalid SVG path, incorrect parameter type");i+=a[0].length,r.push(+a[0]);const s=n.slice(i).match(Tw);null!==s&&(i+=s[0].length)}return r}(r,i,e.slice(1).trim()),a=o.length;if(a<i||a&&a%i!=0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([n,...o.slice(0,i)]),a!==i){"m"===r&&(n="M"===n?"L":"l");for(let e=i;e<a;e+=i)t.push([n,...o.slice(e,e+i)])}})),t}const Lw=Math.PI/180,Bw=Math.PI/2,Iw=2*Math.PI,Uw=Math.sqrt(3)/2;var qw={},Ww={},Zw=[].join;function Hw(e){const t=Zw.call(e);if(Ww[t])return Ww[t];var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7];const c=u*a,f=-l*s,d=l*a,h=u*s,p=Math.cos(i),m=Math.sin(i),g=Math.cos(o),y=Math.sin(o),v=.5*(o-i),b=Math.sin(.5*v),x=8/3*b*b/Math.sin(v),w=n+p-x*m,k=r+m+x*p,_=n+g,O=r+y,E=_+x*y,D=O-x*g;return Ww[t]=[c*w+f*k,d*w+h*k,c*E+f*D,d*E+h*D,c*_+f*O,d*_+h*O]}const Gw=["l",0,0,0,0,0,0,0];function Vw(e,t,n){const r=Gw[0]=e[0];if("a"===r||"A"===r)Gw[1]=t*e[1],Gw[2]=n*e[2],Gw[3]=e[3],Gw[4]=e[4],Gw[5]=e[5],Gw[6]=t*e[6],Gw[7]=n*e[7];else if("h"===r||"H"===r)Gw[1]=t*e[1];else if("v"===r||"V"===r)Gw[1]=n*e[1];else for(var i=1,o=e.length;i<o;++i)Gw[i]=(i%2==1?t:n)*e[i];return Gw}function Yw(e,t,n,r,i,o){var a,s,l,u,c,f=null,d=0,h=0,p=0,m=0,g=0,y=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==o&&(o=i),e.beginPath&&e.beginPath();for(var v=0,b=t.length;v<b;++v){switch(a=t[v],1===i&&1===o||(a=Vw(a,i,o)),a[0]){case"l":d+=a[1],h+=a[2],e.lineTo(d+n,h+r);break;case"L":d=a[1],h=a[2],e.lineTo(d+n,h+r);break;case"h":d+=a[1],e.lineTo(d+n,h+r);break;case"H":d=a[1],e.lineTo(d+n,h+r);break;case"v":h+=a[1],e.lineTo(d+n,h+r);break;case"V":h=a[1],e.lineTo(d+n,h+r);break;case"m":g=d+=a[1],y=h+=a[2],e.moveTo(d+n,h+r);break;case"M":g=d=a[1],y=h=a[2],e.moveTo(d+n,h+r);break;case"c":s=d+a[5],l=h+a[6],p=d+a[3],m=h+a[4],e.bezierCurveTo(d+a[1]+n,h+a[2]+r,p+n,m+r,s+n,l+r),d=s,h=l;break;case"C":d=a[5],h=a[6],p=a[3],m=a[4],e.bezierCurveTo(a[1]+n,a[2]+r,p+n,m+r,d+n,h+r);break;case"s":s=d+a[3],l=h+a[4],p=2*d-p,m=2*h-m,e.bezierCurveTo(p+n,m+r,d+a[1]+n,h+a[2]+r,s+n,l+r),p=d+a[1],m=h+a[2],d=s,h=l;break;case"S":s=a[3],l=a[4],p=2*d-p,m=2*h-m,e.bezierCurveTo(p+n,m+r,a[1]+n,a[2]+r,s+n,l+r),d=s,h=l,p=a[1],m=a[2];break;case"q":s=d+a[3],l=h+a[4],p=d+a[1],m=h+a[2],e.quadraticCurveTo(p+n,m+r,s+n,l+r),d=s,h=l;break;case"Q":s=a[3],l=a[4],e.quadraticCurveTo(a[1]+n,a[2]+r,s+n,l+r),d=s,h=l,p=a[1],m=a[2];break;case"t":s=d+a[1],l=h+a[2],null===f[0].match(/[QqTt]/)?(p=d,m=h):"t"===f[0]?(p=2*d-u,m=2*h-c):"q"===f[0]&&(p=2*d-p,m=2*h-m),u=p,c=m,e.quadraticCurveTo(p+n,m+r,s+n,l+r),h=l,p=(d=s)+a[1],m=h+a[2];break;case"T":s=a[1],l=a[2],p=2*d-p,m=2*h-m,e.quadraticCurveTo(p+n,m+r,s+n,l+r),d=s,h=l;break;case"a":Xw(e,d+n,h+r,[a[1],a[2],a[3],a[4],a[5],a[6]+d+n,a[7]+h+r]),d+=a[6],h+=a[7];break;case"A":Xw(e,d+n,h+r,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+r]),d=a[6],h=a[7];break;case"z":case"Z":d=g,h=y,e.closePath()}f=a}}function Xw(e,t,n,r){const i=function(e,t,n,r,i,o,a,s,l){const u=Zw.call(arguments);if(qw[u])return qw[u];const c=a*Lw,f=Math.sin(c),d=Math.cos(c),h=d*(s-e)*.5+f*(l-t)*.5,p=d*(l-t)*.5-f*(s-e)*.5;let m=h*h/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);m>1&&(m=Math.sqrt(m),n*=m,r*=m);const g=d/n,y=f/n,v=-f/r,b=d/r,x=g*s+y*l,w=v*s+b*l,k=g*e+y*t,_=v*e+b*t;let O=1/((k-x)*(k-x)+(_-w)*(_-w))-.25;O<0&&(O=0);let E=Math.sqrt(O);o==i&&(E=-E);const D=.5*(x+k)-E*(_-w),j=.5*(w+_)+E*(k-x),N=Math.atan2(w-j,x-D);let S=Math.atan2(_-j,k-D)-N;S<0&&1===o?S+=Iw:S>0&&0===o&&(S-=Iw);const A=Math.ceil(Math.abs(S/(Bw+.001))),$=[];for(let C=0;C<A;++C){const e=N+C*S/A,t=N+(C+1)*S/A;$[C]=[D,j,e,t,n,r,f,d]}return qw[u]=$}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let o=0;o<i.length;++o){const t=Hw(i[o]);e.bezierCurveTo(t[0],t[1],t[2],t[3],t[4],t[5])}}const Jw=.5773502691896257,Qw={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Iw)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,o=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-o),e.lineTo(i,-o),e.lineTo(0,-n),e.lineTo(-i,-o),e.lineTo(-r,-o),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Uw*n,i=r-n*Jw,o=n/4;e.moveTo(0,-r-i),e.lineTo(-o,r-i),e.lineTo(o,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Uw*n,i=r-n*Jw;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Uw*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Uw*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Uw*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Uw*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function Kw(e){return Ka(Qw,e)?Qw[e]:function(e){if(!Ka(ek,e)){const t=Rw(e);ek[e]={draw:function(e,n){Yw(e,t,0,0,Math.sqrt(n)/2)}}}return ek[e]}(e)}var ek={};const tk=.448084975506;function nk(e){return e.x}function rk(e){return e.y}function ik(e){return e.width}function ok(e){return e.height}function ak(e){return"function"==typeof e?e:()=>+e}function sk(e,t,n){return Math.max(t,Math.min(e,n))}function lk(){var e=nk,t=rk,n=ik,r=ok,i=ak(0),o=i,a=i,s=i,l=null;function u(u,c,f){var d,h=null!=c?c:+e.call(this,u),p=null!=f?f:+t.call(this,u),m=+n.call(this,u),g=+r.call(this,u),y=Math.min(m,g)/2,v=sk(+i.call(this,u),0,y),b=sk(+o.call(this,u),0,y),x=sk(+a.call(this,u),0,y),w=sk(+s.call(this,u),0,y);if(l||(l=d=jg()),v<=0&&b<=0&&x<=0&&w<=0)l.rect(h,p,m,g);else{var k=h+m,_=p+g;l.moveTo(h+v,p),l.lineTo(k-b,p),l.bezierCurveTo(k-tk*b,p,k,p+tk*b,k,p+b),l.lineTo(k,_-w),l.bezierCurveTo(k,_-tk*w,k-tk*w,_,k-w,_),l.lineTo(h+x,_),l.bezierCurveTo(h+tk*x,_,h,_-tk*x,h,_-x),l.lineTo(h,p+v),l.bezierCurveTo(h,p+tk*v,h+tk*v,p,h+v,p),l.closePath()}if(d)return l=null,d+""||null}return u.x=function(t){return arguments.length?(e=ak(t),u):e},u.y=function(e){return arguments.length?(t=ak(e),u):t},u.width=function(e){return arguments.length?(n=ak(e),u):n},u.height=function(e){return arguments.length?(r=ak(e),u):r},u.cornerRadius=function(e,t,n,r){return arguments.length?(i=ak(e),o=null!=t?ak(t):i,s=null!=n?ak(n):i,a=null!=r?ak(r):o,u):i},u.context=function(e){return arguments.length?(l=null==e?null:e,u):l},u}function uk(){var e,t,n,r,i,o,a,s,l=null;function u(e,t,n){const r=n/2;if(i){var u=a-t,c=e-o;if(u||c){var f=Math.sqrt(u*u+c*c),d=(u/=f)*s,h=(c/=f)*s,p=Math.atan2(c,u);l.moveTo(o-d,a-h),l.lineTo(e-u*r,t-c*r),l.arc(e,t,r,p-Math.PI,p),l.lineTo(o+d,a+h),l.arc(o,a,s,p,p+Math.PI)}else l.arc(e,t,r,0,Iw);l.closePath()}else i=1;o=e,a=t,s=r}function c(o){var a,s,c,f=o.length,d=!1;for(null==l&&(l=c=jg()),a=0;a<=f;++a)!(a<f&&r(s=o[a],a,o))===d&&(d=!d)&&(i=0),d&&u(+e(s,a,o),+t(s,a,o),+n(s,a,o));if(c)return l=null,c+""||null}return c.x=function(t){return arguments.length?(e=t,c):e},c.y=function(e){return arguments.length?(t=e,c):t},c.size=function(e){return arguments.length?(n=e,c):n},c.defined=function(e){return arguments.length?(r=e,c):r},c.context=function(e){return arguments.length?(l=null==e?null:e,c):l},c}function ck(e,t){return null!=e?e:t}const fk=e=>e.x||0,dk=e=>e.y||0,hk=e=>!(!1===e.defined),pk=function(){var e=Sg,t=Ag,n=lg(0),r=null,i=$g,o=Cg,a=Mg,s=null,l=Ng(u);function u(){var u,c,f=+e.apply(this,arguments),d=+t.apply(this,arguments),h=i.apply(this,arguments)-vg,p=o.apply(this,arguments)-vg,m=ug(p-h),g=p>h;if(s||(s=u=l()),d<f&&(c=d,d=f,f=c),d>gg)if(m>bg-gg)s.moveTo(d*fg(h),d*pg(h)),s.arc(0,0,d,h,p,!g),f>gg&&(s.moveTo(f*fg(p),f*pg(p)),s.arc(0,0,f,p,h,g));else{var y,v,b=h,x=p,w=h,k=p,_=m,O=m,E=a.apply(this,arguments)/2,D=E>gg&&(r?+r.apply(this,arguments):mg(f*f+d*d)),j=hg(ug(d-f)/2,+n.apply(this,arguments)),N=j,S=j;if(D>gg){var A=xg(D/f*pg(E)),$=xg(D/d*pg(E));(_-=2*A)>gg?(w+=A*=g?1:-1,k-=A):(_=0,w=k=(h+p)/2),(O-=2*$)>gg?(b+=$*=g?1:-1,x-=$):(O=0,b=x=(h+p)/2)}var C=d*fg(b),M=d*pg(b),P=f*fg(k),F=f*pg(k);if(j>gg){var T,z=d*fg(x),R=d*pg(x),L=f*fg(w),B=f*pg(w);if(m<yg)if(T=function(e,t,n,r,i,o,a,s){var l=n-e,u=r-t,c=a-i,f=s-o,d=f*l-c*u;if(!(d*d<gg))return[e+(d=(c*(t-o)-f*(e-i))/d)*l,t+d*u]}(C,M,L,B,z,R,P,F)){var I=C-T[0],U=M-T[1],q=z-T[0],W=R-T[1],Z=1/pg(function(e){return e>1?0:e<-1?yg:Math.acos(e)}((I*q+U*W)/(mg(I*I+U*U)*mg(q*q+W*W)))/2),H=mg(T[0]*T[0]+T[1]*T[1]);N=hg(j,(f-H)/(Z-1)),S=hg(j,(d-H)/(Z+1))}else N=S=0}O>gg?S>gg?(y=Pg(L,B,C,M,d,S,g),v=Pg(z,R,P,F,d,S,g),s.moveTo(y.cx+y.x01,y.cy+y.y01),S<j?s.arc(y.cx,y.cy,S,cg(y.y01,y.x01),cg(v.y01,v.x01),!g):(s.arc(y.cx,y.cy,S,cg(y.y01,y.x01),cg(y.y11,y.x11),!g),s.arc(0,0,d,cg(y.cy+y.y11,y.cx+y.x11),cg(v.cy+v.y11,v.cx+v.x11),!g),s.arc(v.cx,v.cy,S,cg(v.y11,v.x11),cg(v.y01,v.x01),!g))):(s.moveTo(C,M),s.arc(0,0,d,b,x,!g)):s.moveTo(C,M),f>gg&&_>gg?N>gg?(y=Pg(P,F,z,R,f,-N,g),v=Pg(C,M,L,B,f,-N,g),s.lineTo(y.cx+y.x01,y.cy+y.y01),N<j?s.arc(y.cx,y.cy,N,cg(y.y01,y.x01),cg(v.y01,v.x01),!g):(s.arc(y.cx,y.cy,N,cg(y.y01,y.x01),cg(y.y11,y.x11),!g),s.arc(0,0,f,cg(y.cy+y.y11,y.cx+y.x11),cg(v.cy+v.y11,v.cx+v.x11),g),s.arc(v.cx,v.cy,N,cg(v.y11,v.x11),cg(v.y01,v.x01),!g))):s.arc(0,0,f,k,w,g):s.lineTo(P,F)}else s.moveTo(0,0);if(s.closePath(),u)return s=null,u+""||null}return u.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-yg/2;return[fg(r)*n,pg(r)*n]},u.innerRadius=function(t){return arguments.length?(e="function"==typeof t?t:lg(+t),u):e},u.outerRadius=function(e){return arguments.length?(t="function"==typeof e?e:lg(+e),u):t},u.cornerRadius=function(e){return arguments.length?(n="function"==typeof e?e:lg(+e),u):n},u.padRadius=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:lg(+e),u):r},u.startAngle=function(e){return arguments.length?(i="function"==typeof e?e:lg(+e),u):i},u.endAngle=function(e){return arguments.length?(o="function"==typeof e?e:lg(+e),u):o},u.padAngle=function(e){return arguments.length?(a="function"==typeof e?e:lg(+e),u):a},u.context=function(e){return arguments.length?(s=null==e?null:e,u):s},u}().startAngle((e=>e.startAngle||0)).endAngle((e=>e.endAngle||0)).padAngle((e=>e.padAngle||0)).innerRadius((e=>e.innerRadius||0)).outerRadius((e=>e.outerRadius||0)).cornerRadius((e=>e.cornerRadius||0)),mk=Ig().x(fk).y1(dk).y0((e=>(e.y||0)+(e.height||0))).defined(hk),gk=Ig().y(dk).x1(fk).x0((e=>(e.x||0)+(e.width||0))).defined(hk),yk=Bg().x(fk).y(dk).defined(hk),vk=lk().x(fk).y(dk).width((e=>e.width||0)).height((e=>e.height||0)).cornerRadius((e=>ck(e.cornerRadiusTopLeft,e.cornerRadius)||0),(e=>ck(e.cornerRadiusTopRight,e.cornerRadius)||0),(e=>ck(e.cornerRadiusBottomRight,e.cornerRadius)||0),(e=>ck(e.cornerRadiusBottomLeft,e.cornerRadius)||0)),bk=function(e,t){let n=null,r=Ng(i);function i(){let i;if(n||(n=i=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),i)return n=null,i+""||null}return e="function"==typeof e?e:lg(e||Ug),t="function"==typeof t?t:lg(void 0===t?64:+t),i.type=function(t){return arguments.length?(e="function"==typeof t?t:lg(t),i):e},i.size=function(e){return arguments.length?(t="function"==typeof e?e:lg(+e),i):t},i.context=function(e){return arguments.length?(n=null==e?null:e,i):n},i}().type((e=>Kw(e.shape||"circle"))).size((e=>ck(e.size,64))),xk=uk().x(fk).y(dk).defined(hk).size((e=>e.size||1));function wk(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function kk(e,t,n,r){return vk.context(e)(t,n,r)}var _k=1;function Ok(){_k=1}function Ek(e,t,n){var r=t.clip,i=e._defs,o=t.clip_id||(t.clip_id="clip"+_k++),a=i.clipping[o]||(i.clipping[o]={id:o});return Ba(r)?a.path=r(null):wk(n)?a.path=kk(null,n,0,0):(a.width=n.width||0,a.height=n.height||0),"url(#"+o+")"}function Dk(e){this.clear(),e&&this.union(e)}function jk(e){this.mark=e,this.bounds=this.bounds||new Dk}function Nk(e){jk.call(this,e),this.items=this.items||[]}function Sk(e){this._pending=0,this._loader=e||eh()}function Ak(e){e._pending+=1}function $k(e){e._pending-=1}function Ck(e,t,n){if(t.stroke&&0!==t.opacity&&0!==t.strokeOpacity){const r=null!=t.strokeWidth?+t.strokeWidth:1;e.expand(r+(n?function(e,t){return e.strokeJoin&&"miter"!==e.strokeJoin?0:t}(t,r):0))}return e}Dk.prototype={clone(){return new Dk(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:o,y2:a}=this,s=Math.cos(e),l=Math.sin(e),u=t-t*s+n*l,c=n-t*l-n*s;return[s*r-l*i+u,l*r+s*i+c,s*r-l*a+u,l*r+s*a+c,s*o-l*i+u,l*o+s*i+c,s*o-l*a+u,l*o+s*a+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},rs(Nk,jk),Sk.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return Ak(t),t._loader.sanitize(e,{context:"href"}).then((e=>($k(t),e))).catch((()=>($k(t),null)))},loadImage(e){const t=this,n=ky();return Ak(t),t._loader.sanitize(e,{context:"image"}).then((e=>{const r=e.href;if(!r||!n)throw{url:r};const i=new n,o=Ka(e,"crossOrigin")?e.crossOrigin:"anonymous";return null!=o&&(i.crossOrigin=o),i.onload=()=>$k(t),i.onerror=()=>$k(t),i.src=r,i})).catch((e=>($k(t),{complete:!1,width:0,height:0,src:e&&e.url||""})))},ready(){const e=this;return new Promise((t=>{!function n(r){e.pending()?setTimeout((()=>{n(!0)}),10):t(r)}(!1)}))}};const Mk=Iw-1e-8;let Pk,Fk,Tk,zk,Rk,Lk,Bk,Ik;const Uk=(e,t)=>Pk.add(e,t),qk=(e,t)=>Uk(Fk=e,Tk=t),Wk=e=>Uk(e,Pk.y1),Zk=e=>Uk(Pk.x1,e),Hk=(e,t)=>Rk*e+Bk*t,Gk=(e,t)=>Lk*e+Ik*t,Vk=(e,t)=>Uk(Hk(e,t),Gk(e,t)),Yk=(e,t)=>qk(Hk(e,t),Gk(e,t));function Xk(e,t){return Pk=e,t?(zk=t*Lw,Rk=Ik=Math.cos(zk),Lk=Math.sin(zk),Bk=-Lk):(Rk=Ik=1,zk=Lk=Bk=0),Jk}const Jk={beginPath(){},closePath(){},moveTo:Yk,lineTo:Yk,rect(e,t,n,r){zk?(Vk(e+n,t),Vk(e+n,t+r),Vk(e,t+r),Yk(e,t)):(Uk(e+n,t+r),qk(e,t))},quadraticCurveTo(e,t,n,r){const i=Hk(e,t),o=Gk(e,t),a=Hk(n,r),s=Gk(n,r);Qk(Fk,i,a,Wk),Qk(Tk,o,s,Zk),qk(a,s)},bezierCurveTo(e,t,n,r,i,o){const a=Hk(e,t),s=Gk(e,t),l=Hk(n,r),u=Gk(n,r),c=Hk(i,o),f=Gk(i,o);Kk(Fk,a,l,c,Wk),Kk(Tk,s,u,f,Zk),qk(c,f)},arc(e,t,n,r,i,o){if(r+=zk,i+=zk,Fk=n*Math.cos(i)+e,Tk=n*Math.sin(i)+t,Math.abs(i-r)>Mk)Uk(e-n,t-n),Uk(e+n,t+n);else{const a=r=>Uk(n*Math.cos(r)+e,n*Math.sin(r)+t);let s,l;if(a(r),a(i),i!==r)if((r%=Iw)<0&&(r+=Iw),(i%=Iw)<0&&(i+=Iw),i<r&&(o=!o,s=r,r=i,i=s),o)for(i-=Iw,s=r-r%Bw,l=0;l<4&&s>i;++l,s-=Bw)a(s);else for(s=r-r%Bw+Bw,l=0;l<4&&s<i;++l,s+=Bw)a(s)}}};function Qk(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function Kk(e,t,n,r,i){const o=r-e+3*t-3*n,a=e+n-2*t,s=e-t;let l,u=0,c=0;Math.abs(o)>1e-14?(l=a*a+s*o,l>=0&&(l=Math.sqrt(l),u=(-a+l)/o,c=(-a-l)/o)):u=.5*s/a,0<u&&u<1&&i(e_(u,e,t,n,r)),0<c&&c<1&&i(e_(c,e,t,n,r))}function e_(e,t,n,r,i){const o=1-e,a=o*o,s=e*e;return a*o*t+3*a*e*n+3*o*s*r+s*e*i}var t_=(t_=wy(1,1))?t_.getContext("2d"):null;const n_=new Dk;function r_(e){return function(t,n){if(!t_)return!0;e(t_,t),n_.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:o,y2:a}=n_;for(let e=i;e<=a;++e)for(let t=r;t<=o;++t)if(t_.isPointInPath(t,e))return!0;return!1}}function i_(e,t){return t.contains(e.x||0,e.y||0)}function o_(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,o=e.height||0;return t.intersects(n_.set(n,r,n+i,r+o))}function a_(e,t){const n=e.x||0,r=e.y||0;return s_(t,n,r,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r)}function s_(e,t,n,r,i){const{x1:o,y1:a,x2:s,y2:l}=e,u=r-t,c=i-n;let f,d,h,p,m=0,g=1;for(p=0;p<4;++p){if(0===p&&(f=-u,d=-(o-t)),1===p&&(f=u,d=s-t),2===p&&(f=-c,d=-(a-n)),3===p&&(f=c,d=l-n),Math.abs(f)<1e-10&&d<0)return!1;if(h=d/f,f<0){if(h>g)return!1;h>m&&(m=h)}else if(f>0){if(h<m)return!1;h<g&&(g=h)}}return!0}function l_(e,t){e.globalCompositeOperation=t.blend||"source-over"}function u_(e,t){return null==e?t:e}function c_(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function f_(e,t,n){return jw(n)?function(e,t,n){const r=n.width(),i=n.height();let o;if("radial"===t.gradient)o=e.createRadialGradient(n.x1+u_(t.x1,.5)*r,n.y1+u_(t.y1,.5)*i,Math.max(r,i)*u_(t.r1,0),n.x1+u_(t.x2,.5)*r,n.y1+u_(t.y2,.5)*i,Math.max(r,i)*u_(t.r2,.5));else{const a=u_(t.x1,0),s=u_(t.y1,0),l=u_(t.x2,1),u=u_(t.y2,0);if(a!==l&&s!==u&&r!==i){const n=wy(Math.ceil(r),Math.ceil(i)),o=n.getContext("2d");return o.scale(r,i),o.fillStyle=c_(o.createLinearGradient(a,s,l,u),t.stops),o.fillRect(0,0,r,i),e.createPattern(n,"no-repeat")}o=e.createLinearGradient(n.x1+a*r,n.y1+s*i,n.x1+l*r,n.y1+u*i)}return c_(o,t.stops)}(e,n,t.bounds):n}function d_(e,t,n){return(n*=null==t.fillOpacity?1:t.fillOpacity)>0&&(e.globalAlpha=n,e.fillStyle=f_(e,t,t.fill),!0)}var h_=[];function p_(e,t,n){var r=null!=(r=t.strokeWidth)?r:1;return!(r<=0)&&((n*=null==t.strokeOpacity?1:t.strokeOpacity)>0&&(e.globalAlpha=n,e.strokeStyle=f_(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||h_),e.lineDashOffset=t.strokeDashOffset||0),!0))}function m_(e,t){return e.zindex-t.zindex||e.index-t.index}function g_(e){if(!e.zdirty)return e.zitems;var t,n,r,i=e.items,o=[];for(n=0,r=i.length;n<r;++n)(t=i[n]).index=n,t.zindex&&o.push(t);return e.zdirty=!1,e.zitems=o.sort(m_)}function y_(e,t){var n,r,i=e.items;if(!i||!i.length)return;const o=g_(e);if(o&&o.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||t(i[n]);i=o}for(n=0,r=i.length;n<r;++n)t(i[n])}function v_(e,t){var n,r,i=e.items;if(!i||!i.length)return null;const o=g_(e);for(o&&o.length&&(i=o),r=i.length;--r>=0;)if(n=t(i[r]))return n;if(i===o)for(r=(i=e.items).length;--r>=0;)if(!i[r].zindex&&(n=t(i[r])))return n;return null}function b_(e){return function(t,n,r){y_(n,(n=>{r&&!r.intersects(n.bounds)||w_(e,t,n,n)}))}}function x_(e){return function(t,n,r){!n.items.length||r&&!r.intersects(n.bounds)||w_(e,t,n.items[0],n.items)}}function w_(e,t,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(e(t,r)||(l_(t,n),n.fill&&d_(t,n,i)&&t.fill(),n.stroke&&p_(t,n,i)&&t.stroke()))}function k_(e){return e=e||ia,function(t,n,r,i,o,a){return r*=t.pixelRatio,i*=t.pixelRatio,v_(n,(n=>{const s=n.bounds;if((!s||s.contains(o,a))&&s)return e(t,n,r,i,o,a)?n:void 0}))}}function __(e,t){return function(n,r,i,o){var a,s,l=Array.isArray(r)?r[0]:r,u=null==t?l.fill:t,c=l.stroke&&n.isPointInStroke;return c&&(a=l.strokeWidth,s=l.strokeCap,n.lineWidth=null!=a?a:1,n.lineCap=null!=s?s:"butt"),!e(n,r)&&(u&&n.isPointInPath(i,o)||c&&n.isPointInStroke(i,o))}}function O_(e){return k_(__(e))}function E_(e,t){return"translate("+e+","+t+")"}function D_(e){return"rotate("+e+")"}function j_(e){return E_(e.x||0,e.y||0)}function N_(e,t,n){function r(e,n){var r=n.x||0,i=n.y||0,o=n.angle||0;e.translate(r,i),o&&e.rotate(o*=Lw),e.beginPath(),t(e,n),o&&e.rotate(-o),e.translate(-r,-i)}return{type:e,tag:"path",nested:!1,attr:function(e,n){e("transform",function(e){return E_(e.x||0,e.y||0)+(e.angle?" "+D_(e.angle):"")}(n)),e("d",t(null,n))},bound:function(e,n){return t(Xk(e,n.angle),n),Ck(e,n).translate(n.x||0,n.y||0)},draw:b_(r),pick:O_(r),isect:n||r_(r)}}var S_=N_("arc",(function(e,t){return pk.context(e)(t)}));function A_(e,t,n){function r(e,n){e.beginPath(),t(e,n)}const i=__(r);return{type:e,tag:"path",nested:!0,attr:function(e,n){var r=n.mark.items;r.length&&e("d",t(null,r))},bound:function(e,n){var r=n.items;return 0===r.length?e:(t(Xk(e),r),Ck(e,r[0]))},draw:x_(r),pick:function(e,t,n,r,o,a){var s=t.items,l=t.bounds;return!s||!s.length||l&&!l.contains(o,a)?null:(n*=e.pixelRatio,r*=e.pixelRatio,i(e,s,n,r)?s[0]:null)},isect:i_,tip:n}}var $_=A_("area",(function(e,t){const n=t[0],r=n.interpolate||"linear";return("horizontal"===n.orient?gk:mk).curve(Cw(r,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,r,i="horizontal"===e[0].orient?t[1]:t[0],o="horizontal"===e[0].orient?"y":"x",a=e.length,s=1/0;--a>=0;)!1!==e[a].defined&&(r=Math.abs(e[a][o]-i))<s&&(s=r,n=e[a]);return n}));function C_(e,t){e.beginPath(),wk(t)?kk(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function M_(e){const t=u_(e.strokeWidth,1);return null!=e.strokeOffset?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function P_(e,t){const n=M_(t);e("d",kk(null,t,n,n))}function F_(e,t,n,r){const i=M_(t);e.beginPath(),kk(e,t,(n||0)+i,(r||0)+i)}const T_=__(F_),z_=__(F_,!1),R_=__(F_,!0);var L_={type:"group",tag:"g",nested:!1,attr:function(e,t){e("transform",j_(t))},bound:function(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let t=0;t<r;++t)e.union(n[t].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),Ck(e,t),e.translate(t.x||0,t.y||0)},draw:function(e,t,n){y_(t,(t=>{const r=t.x||0,i=t.y||0,o=t.strokeForeground,a=null==t.opacity?1:t.opacity;(t.stroke||t.fill)&&a&&(F_(e,t,r,i),l_(e,t),t.fill&&d_(e,t,a)&&e.fill(),t.stroke&&!o&&p_(e,t,a)&&e.stroke()),e.save(),e.translate(r,i),t.clip&&C_(e,t),n&&n.translate(-r,-i),y_(t,(t=>{this.draw(e,t,n)})),n&&n.translate(r,i),e.restore(),o&&t.stroke&&a&&(F_(e,t,r,i),l_(e,t),p_(e,t,a)&&e.stroke())}))},pick:function(e,t,n,r,i,o){if(t.bounds&&!t.bounds.contains(i,o)||!t.items)return null;const a=n*e.pixelRatio,s=r*e.pixelRatio;return v_(t,(l=>{let u,c,f;const d=l.bounds;if(d&&!d.contains(i,o))return;c=l.x||0,f=l.y||0;const h=c+(l.width||0),p=f+(l.height||0),m=l.clip;if(m&&(i<c||i>h||o<f||o>p))return;if(e.save(),e.translate(c,f),c=i-c,f=o-f,m&&wk(l)&&!R_(e,l,a,s))return e.restore(),null;const g=l.strokeForeground,y=!1!==t.interactive;return y&&g&&l.stroke&&z_(e,l,a,s)?(e.restore(),l):(u=v_(l,(e=>function(e,t,n){return(!1!==e.interactive||"group"===e.marktype)&&e.bounds&&e.bounds.contains(t,n)}(e,c,f)?this.pick(e,n,r,c,f):null)),!u&&y&&(l.fill||!g&&l.stroke)&&T_(e,l,a,s)&&(u=l),e.restore(),u||null)}))},isect:o_,content:function(e,t,n){e("clip-path",t.clip?Ek(n,t,t):null)},background:function(e,t){e("class","background"),e("aria-hidden",!0),P_(e,t)},foreground:function(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?P_(e,t):e("d","")}},B_={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function I_(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then((t=>{e.image=t,e.image.url=e.url}))),n}function U_(e,t){return null!=e.width?e.width:t&&t.width?!1!==e.aspect&&e.height?e.height*t.width/t.height:t.width:0}function q_(e,t){return null!=e.height?e.height:t&&t.height?!1!==e.aspect&&e.width?e.width*t.height/t.width:t.height:0}function W_(e,t){return"center"===e?t/2:"right"===e?t:0}function Z_(e,t){return"middle"===e?t/2:"bottom"===e?t:0}var H_={type:"image",tag:"image",nested:!1,attr:function(e,t,n){const r=I_(t,n),i=U_(t,r),o=q_(t,r),a=(t.x||0)-W_(t.align,i),s=(t.y||0)-Z_(t.baseline,o);e("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",B_["xmlns:xlink"],"xlink:href"),e("transform",E_(a,s)),e("width",i),e("height",o),e("preserveAspectRatio",!1===t.aspect?"none":"xMidYMid")},bound:function(e,t){const n=t.image,r=U_(t,n),i=q_(t,n),o=(t.x||0)-W_(t.align,r),a=(t.y||0)-Z_(t.baseline,i);return e.set(o,a,o+r,a+i)},draw:function(e,t,n){y_(t,(t=>{if(n&&!n.intersects(t.bounds))return;const r=I_(t,this);let i=U_(t,r),o=q_(t,r);if(0===i||0===o)return;let a,s,l,u,c=(t.x||0)-W_(t.align,i),f=(t.y||0)-Z_(t.baseline,o);!1!==t.aspect&&(s=r.width/r.height,l=t.width/t.height,s==s&&l==l&&s!==l&&(l<s?(u=i/s,f+=(o-u)/2,o=u):(u=o*s,c+=(i-u)/2,i=u))),(r.complete||r.toDataURL)&&(l_(e,t),e.globalAlpha=null!=(a=t.opacity)?a:1,e.imageSmoothingEnabled=!1!==t.smooth,e.drawImage(r,c,f,i,o))}))},pick:k_(),isect:ia,get:I_,xOffset:W_,yOffset:Z_},G_=A_("line",(function(e,t){const n=t[0],r=n.interpolate||"linear";return yk.curve(Cw(r,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,r,i=Math.pow(e[0].strokeWidth||1,2),o=e.length;--o>=0;)if(!1!==e[o].defined&&(n=e[o].x-t[0])*n+(r=e[o].y-t[1])*r<i)return e[o];return null}));function V_(e,t){var n=t.path;if(null==n)return!0;var r=t.x||0,i=t.y||0,o=t.scaleX||1,a=t.scaleY||1,s=(t.angle||0)*Lw,l=t.pathCache;l&&l.path===n||((t.pathCache=l=Rw(n)).path=n),s&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(s),Yw(e,l,0,0,o,a),e.rotate(-s),e.translate(-r,-i)):Yw(e,l,r,i,o,a)}var Y_={type:"path",tag:"path",nested:!1,attr:function(e,t){var n=t.scaleX||1,r=t.scaleY||1;1===n&&1===r||e("vector-effect","non-scaling-stroke"),e("transform",function(e){return E_(e.x||0,e.y||0)+(e.angle?" "+D_(e.angle):"")+(e.scaleX||e.scaleY?" "+function(e,t){return"scale("+e+","+t+")"}(e.scaleX||1,e.scaleY||1):"")}(t)),e("d",t.path)},bound:function(e,t){return V_(Xk(e,t.angle),t)?e.set(0,0,0,0):Ck(e,t,!0)},draw:b_(V_),pick:O_(V_),isect:r_(V_)};function X_(e,t){e.beginPath(),kk(e,t)}var J_={type:"rect",tag:"path",nested:!1,attr:function(e,t){e("d",kk(null,t))},bound:function(e,t){var n,r;return Ck(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)},draw:b_(X_),pick:O_(X_),isect:o_};function Q_(e,t,n){var r,i,o,a;return!(!t.stroke||!p_(e,t,n))&&(r=t.x||0,i=t.y||0,o=null!=t.x2?t.x2:r,a=null!=t.y2?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(o,a),!0)}var K_={type:"rule",tag:"line",nested:!1,attr:function(e,t){e("transform",j_(t)),e("x2",null!=t.x2?t.x2-(t.x||0):0),e("y2",null!=t.y2?t.y2-(t.y||0):0)},bound:function(e,t){var n,r;return Ck(e.set(n=t.x||0,r=t.y||0,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r),t)},draw:function(e,t,n){y_(t,(t=>{if(!n||n.intersects(t.bounds)){var r=null==t.opacity?1:t.opacity;r&&Q_(e,t,r)&&(l_(e,t),e.stroke())}}))},pick:k_((function(e,t,n,r){return!!e.isPointInStroke&&(Q_(e,t,1)&&e.isPointInStroke(n,r))})),isect:a_},eO=N_("shape",(function(e,t){return(t.mark.shape||t.shape).context(e)(t)})),tO=N_("symbol",(function(e,t){return bk.context(e)(t)}),i_);const nO=hs();var rO={height:uO,measureWidth:sO,estimateWidth:oO,width:oO,canvas:iO};function iO(e){rO.width=e&&t_?sO:oO}function oO(e,t){return aO(hO(e,t),uO(e))}function aO(e,t){return~~(.8*e.length*t)}function sO(e,t){return uO(e)<=0||!(t=hO(e,t))?0:lO(t,mO(e))}function lO(e,t){const n=`(${t}) ${e}`;let r=nO.get(n);return void 0===r&&(t_.font=t,r=t_.measureText(e).width,nO.set(n,r)),r}function uO(e){return null!=e.fontSize?+e.fontSize||0:11}function cO(e){return null!=e.lineHeight?e.lineHeight:uO(e)+2}function fO(e){return t=e.lineBreak&&e.text&&!ha(e.text)?e.text.split(e.lineBreak):e.text,ha(t)?t.length>1?t:t[0]:t;var t}function dO(e){const t=fO(e);return(ha(t)?t.length-1:0)*cO(e)}function hO(e,t){const n=null==t?"":(t+"").trim();return e.limit>0&&n.length?function(e,t){var n=+e.limit,r=function(e){if(rO.width===sO){const t=mO(e);return e=>lO(e,t)}{const t=uO(e);return e=>aO(e,t)}}(e);if(r(t)<n)return t;var i,o=e.ellipsis||"\u2026",a="rtl"===e.dir,s=0,l=t.length;if(n-=r(o),a){for(;s<l;)i=s+l>>>1,r(t.slice(i))>n?s=i+1:l=i;return o+t.slice(s)}for(;s<l;)i=1+(s+l>>>1),r(t.slice(0,i))<n?s=i:l=i-1;return t.slice(0,s)+o}(e,n):n}function pO(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function mO(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+uO(e)+"px "+pO(e,t)}function gO(e){var t=e.baseline,n=uO(e);return Math.round("top"===t?.79*n:"middle"===t?.3*n:"bottom"===t?-.21*n:"line-top"===t?.29*n+.5*cO(e):"line-bottom"===t?.29*n-.5*cO(e):0)}iO(!0);const yO={left:"start",center:"middle",right:"end"},vO=new Dk;function bO(e){var t,n=e.x||0,r=e.y||0,i=e.radius||0;return i&&(t=(e.theta||0)-Bw,n+=i*Math.cos(t),r+=i*Math.sin(t)),vO.x1=n,vO.y1=r,vO}function xO(e,t,n){var r,i=rO.height(t),o=t.align,a=bO(t),s=a.x1,l=a.y1,u=t.dx||0,c=(t.dy||0)+gO(t)-Math.round(.8*i),f=fO(t);if(ha(f)?(i+=cO(t)*(f.length-1),r=f.reduce(((e,n)=>Math.max(e,rO.width(t,n))),0)):r=rO.width(t,f),"center"===o?u-=r/2:"right"===o&&(u-=r),e.set(u+=s,c+=l,u+r,c+i),t.angle&&!n)e.rotate(t.angle*Lw,s,l);else if(2===n)return e.rotatedPoints(t.angle*Lw,s,l);return e}var wO={type:"text",tag:"text",nested:!1,attr:function(e,t){var n,r=t.dx||0,i=(t.dy||0)+gO(t),o=bO(t),a=o.x1,s=o.y1,l=t.angle||0;e("text-anchor",yO[t.align]||"start"),l?(n=E_(a,s)+" "+D_(l),(r||i)&&(n+=" "+E_(r,i))):n=E_(a+r,s+i),e("transform",n)},bound:xO,draw:function(e,t,n){y_(t,(t=>{var r,i,o,a,s,l,u,c=null==t.opacity?1:t.opacity;if(!(n&&!n.intersects(t.bounds)||0===c||t.fontSize<=0||null==t.text||0===t.text.length)){if(e.font=mO(t),e.textAlign=t.align||"left",i=(r=bO(t)).x1,o=r.y1,t.angle&&(e.save(),e.translate(i,o),e.rotate(t.angle*Lw),i=o=0),i+=t.dx||0,o+=(t.dy||0)+gO(t),l=fO(t),l_(e,t),ha(l))for(s=cO(t),a=0;a<l.length;++a)u=hO(t,l[a]),t.fill&&d_(e,t,c)&&e.fillText(u,i,o),t.stroke&&p_(e,t,c)&&e.strokeText(u,i,o),o+=s;else u=hO(t,l),t.fill&&d_(e,t,c)&&e.fillText(u,i,o),t.stroke&&p_(e,t,c)&&e.strokeText(u,i,o);t.angle&&e.restore()}}))},pick:k_((function(e,t,n,r,i,o){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var a=bO(t),s=a.x1,l=a.y1,u=xO(vO,t,1),c=-t.angle*Lw,f=Math.cos(c),d=Math.sin(c),h=f*i-d*o+(s-f*s+d*l),p=d*i+f*o+(l-d*s-f*l);return u.contains(h,p)})),isect:function(e,t){const n=xO(vO,e,2);return s_(t,n[0],n[1],n[2],n[3])||s_(t,n[0],n[1],n[4],n[5])||s_(t,n[4],n[5],n[6],n[7])||s_(t,n[2],n[3],n[6],n[7])}},kO=A_("trail",(function(e,t){return xk.context(e)(t)}),(function(e,t){for(var n,r,i=e.length;--i>=0;)if(!1!==e[i].defined&&(n=e[i].x-t[0])*n+(r=e[i].y-t[1])*r<(n=e[i].size||1)*n)return e[i];return null})),_O={arc:S_,area:$_,group:L_,image:H_,line:G_,path:Y_,rect:J_,rule:K_,shape:eO,symbol:tO,text:wO,trail:kO};function OO(e,t,n){var r=_O[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new Dk),e,n)}var EO={mark:null};function DO(e,t,n){var r,i,o,a,s=_O[e.marktype],l=s.bound,u=e.items,c=u&&u.length;if(s.nested)return c?o=u[0]:(EO.mark=e,o=EO),a=OO(o,l,n),t=t&&t.union(a)||a;if(t=t||e.bounds&&e.bounds.clear()||new Dk,c)for(r=0,i=u.length;r<i;++r)t.union(OO(u[r],l,n));return e.bounds=t}const jO=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function NO(e,t){return JSON.stringify(e,jO,t)}function SO(e){return AO("string"==typeof e?JSON.parse(e):e)}function AO(e){var t,n,r,i=e.marktype,o=e.items;if(o)for(n=0,r=o.length;n<r;++n)t=i?"mark":"group",o[n][t]=e,o[n].zindex&&(o[n][t].zdirty=!0),"group"===(i||t)&&AO(o[n]);return i&&DO(e),e}function $O(e){arguments.length?this.root=SO(e):(this.root=CO({marktype:"group",name:"root",role:"frame"}),this.root.items=[new Nk(this.root)])}function CO(e,t){const n={bounds:new Dk,clip:!!e.clip,group:t,interactive:!1!==e.interactive,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return null!=e.aria&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function MO(e,t,n){return!e&&"undefined"!=typeof document&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function PO(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function FO(e,t,n,r){var i,o=e.childNodes[t];return o&&o.tagName.toLowerCase()===n.toLowerCase()||(i=o||null,o=MO(e.ownerDocument,n,r),e.insertBefore(o,i)),o}function TO(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function zO(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function RO(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function LO(e,t){this._active=null,this._handlers={},this._loader=e||eh(),this._tooltip=t||BO}function BO(e,t,n,r){e.element().setAttribute("title",r||"")}function IO(e){this._el=null,this._bgcolor=null,this._loader=new Sk(e)}$O.prototype={toJSON(e){return NO(this.root,e||0)},mark(e,t,n){const r=CO(e,t=t||this.root.items[0]);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}},LO.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const r in t)n.push(...t[r]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then((t=>{const n=new MouseEvent(e.type,e),r=MO(null,"a");for(const e in t)r.setAttribute(e,t[e]);r.dispatchEvent(n)})).catch((()=>{}))},handleTooltip(e,t,n){if(t&&null!=t.tooltip){t=function(e,t,n,r){var i,o,a=e&&e.mark;if(a&&(i=_O[a.marktype]).tip){for((o=RO(t,n))[0]-=r[0],o[1]-=r[1];e=e.mark.group;)o[0]-=e.x||0,o[1]-=e.y||0;e=i.tip(a.items,o)}return e}(t,e,this.canvas(),this._origin);const r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,o=i.width(),a=i.height();let s=i.x1+r[0]+n.left,l=i.y1+r[1]+n.top;for(;e.mark&&(e=e.mark.group);)s+=e.x||0,l+=e.y||0;return{x:s,y:l,width:o,height:a,left:s,top:l,right:s+o,bottom:l+a}}},IO.prototype={initialize(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then((()=>t)):Promise.resolve(t)},_load(e,t){var n=this,r=n._loader[e](t);if(!n._ready){const e=n._call;n._ready=n._loader.ready().then((t=>{t&&e(),n._ready=null}))}return r},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const UO="dragenter",qO="dragleave",WO="dragover",ZO="mousedown",HO="mousemove",GO="mouseout",VO="mouseover",YO="click",XO="mousewheel",JO="touchstart",QO="touchmove",KO="touchend",eE=HO,tE=GO,nE=YO;function rE(e,t){LO.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}function iE(e,t){(e=>e===JO||e===QO||e===KO?[JO,QO,KO]:[e])(t).forEach((t=>function(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?n=>e[t](n):n=>e.fire(t,n)))}(e,t)))}function oE(e,t,n){return function(r){const i=this._active,o=this.pickEvent(r);o===i||(i&&i.exit||this.fire(n,r),this._active=o,this.fire(t,r)),this.fire(e,r)}}function aE(e){return function(t){this.fire(e,t),this._active=null}}rs(rE,LO,{initialize(e,t,n){return this._canvas=e&&PO(e,"canvas"),[YO,ZO,HO,GO,qO].forEach((e=>iE(this,e))),LO.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup",UO,qO,WO,ZO,"mouseup",HO,GO,VO,YO,"dblclick","wheel",XO,JO,QO,KO],DOMMouseScroll(e){this.fire(XO,e)},mousemove:oE(HO,VO,GO),dragover:oE(WO,UO,qO),mouseout:aE(GO),dragleave:aE(qO),mousedown(e){this._down=this._active,this.fire(ZO,e)},click(e){this._down===this._active&&(this.fire(YO,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(JO,e,!0)},touchmove(e){this.fire(QO,e,!0)},touchend(e){this.fire(KO,e,!0),this._touch=null},fire(e,t,n){const r=n?this._touch:this._active,i=this._handlers[e];if(t.vegaType=e,e===nE&&r&&r.href?this.handleHref(t,r,r.href):e!==eE&&e!==tE||this.handleTooltip(t,r,e!==tE),i)for(let o=0,a=i.length;o<a;++o)i[o].handler.call(this._obj,t,r)},on(e,t){const n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(iE(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},pickEvent(e){const t=RO(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,r,i){const o=this.context();return _O[e.marktype].pick.call(this,o,e,t,n,r,i)}});var sE="undefined"!=typeof window&&window.devicePixelRatio||1;function lE(e){IO.call(this,e),this._options={},this._redraw=!1,this._dirty=new Dk,this._tempb=new Dk}const uE=IO.prototype;function cE(e,t){LO.call(this,e,t);const n=this;n._hrefHandler=fE(n,((e,t)=>{t&&t.href&&n.handleHref(e,t,t.href)})),n._tooltipHandler=fE(n,((e,t)=>{n.handleTooltip(e,t,e.type!==tE)}))}rs(lE,IO,{initialize(e,t,n,r,i,o){return this._options=o||{},this._canvas=this._options.externalContext?null:wy(1,1,this._options.type),e&&this._canvas&&(TO(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),uE.initialize.call(this,e,t,n,r,i)},resize(e,t,n,r){if(uE.resize.call(this,e,t,n,r),this._canvas)!function(e,t,n,r,i,o){const a="undefined"!=typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,s=e.getContext("2d"),l=a?sE:i;e.width=t*l,e.height=n*l;for(const u in o)s[u]=o[u];a&&1!==l&&(e.style.width=t+"px",e.style.height=n+"px"),s.pixelRatio=l,s.setTransform(l,0,0,l,l*r[0],l*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const e=this._options.externalContext;e||Jo("CanvasRenderer is missing a valid canvas or context"),e.scale(this._scale,this._scale),e.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,r=this._width,i=this._height,o=this._dirty,a=((e,t,n)=>(new Dk).set(0,0,t,n).translate(-e[0],-e[1]))(n,r,i);t.save();const s=this._redraw||o.empty()?(this._redraw=!1,a.expand(1)):function(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-n[0]%1,-n[1]%1),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}(t,a.intersect(o),n);return this.clear(-n[0],-n[1],r,i),this.draw(t,e,s),t.restore(),o.clear(),this},draw(e,t,n){const r=_O[t.marktype];t.clip&&function(e,t){var n=t.clip;e.save(),Ba(n)?(e.beginPath(),n(e),e.clip()):C_(e,t.group)}(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,r){const i=this._options,o=this.context();"pdf"===i.type||i.externalContext||o.clearRect(e,t,n,r),null!=this._bgcolor&&(o.fillStyle=this._bgcolor,o.fillRect(e,t,n,r))}});const fE=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)};rs(cE,LO,{initialize(e,t,n){let r=this._svg;return r&&(r.removeEventListener(nE,this._hrefHandler),r.removeEventListener(eE,this._tooltipHandler),r.removeEventListener(tE,this._tooltipHandler)),this._svg=r=e&&PO(e,"svg"),r&&(r.addEventListener(nE,this._hrefHandler),r.addEventListener(eE,this._tooltipHandler),r.addEventListener(tE,this._tooltipHandler)),LO.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){const i={type:e,handler:t,listener:fE(this,t)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const dE="aria-hidden",hE="aria-label",pE="role",mE="aria-roledescription",gE="graphics-object",yE="graphics-symbol",vE=(e,t,n)=>({[pE]:e,[mE]:t,[hE]:n||void 0}),bE=_s(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),xE={axis:{desc:"axis",caption:function(e){const t=e.datum,n=e.orient,r=t.title?EE(e):null,i=e.context,o=i.scales[t.scale].value,a=i.dataflow.locale(),s=o.type,l="left"===n||"right"===n?"Y":"X";return`${l}-axis`+(r?` titled '${r}'`:"")+` for a ${Ux(s)?"discrete":s} scale`+` with ${Ow(a,o,e)}`}},legend:{desc:"legend",caption:function(e){const t=e.datum,n=t.title?EE(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,o=Object.keys(i),a=e.context,s=a.scales[i[o[0]]].value,l=a.dataflow.locale();return u=r,(u.length?u[0].toUpperCase()+u.slice(1):u)+(n?` titled '${n}'`:"")+` for ${function(e){return e=e.map((e=>e+("fill"===e||"stroke"===e?" color":""))),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+ba(e)}(o)}`+` with ${Ow(l,s,e)}`;var u}},"title-text":{desc:"title",caption:e=>`Title text '${OE(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${OE(e)}'`}},wE={ariaRole:pE,ariaRoleDescription:mE,description:hE};function kE(e,t){const n=!1===t.aria;if(e(dE,n||void 0),n||null==t.description)for(const r in wE)e(wE[r],void 0);else{const n=t.mark.marktype;e(hE,t.description),e(pE,t.ariaRole||("group"===n?gE:yE)),e(mE,t.ariaRoleDescription||`${n} mark`)}}function _E(e){return!1===e.aria?{[dE]:!0}:bE[e.role]?null:xE[e.role]?function(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return vE(t.role||yE,t.desc,n.description||r(n))}catch(n){return null}}(e,xE[e.role]):function(e){const t=e.marktype,n="group"===t||"text"===t||e.items.some((e=>null!=e.description&&!1!==e.aria));return vE(n?gE:yE,`${t} mark container`,e.description)}(e)}function OE(e){return Ra(e.text).join(" ")}function EE(e){try{return Ra(ba(e.items).items[0].text).join(" ")}catch(t){return null}}const DE=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function jE(){let e="",t="",n="";const r=[],i=()=>t=n="",o=(e,n)=>{var r;return null!=n&&(t+=` ${e}="${r=n,DE(r).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")}"`),a},a={open(s){(o=>{t&&(e+=`${t}>${n}`,i()),r.push(o)})(s),t="<"+s;for(var l=arguments.length,u=new Array(l>1?l-1:0),c=1;c<l;c++)u[c-1]=arguments[c];for(const e of u)for(const t in e)o(t,e[t]);return a},close(){const o=r.pop();return e+=t?t+(n?`>${n}</${o}>`:"/>"):`</${o}>`,i(),a},attr:o,text:e=>(n+=DE(e),a),toString:()=>e};return a}const NE=e=>SE(jE(),e)+"";function SE(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let t=0;t<r;++t)e.attr(n[t].name,n[t].value)}if(t.hasChildNodes()){const n=t.childNodes;for(const t of n)3===t.nodeType?e.text(t.nodeValue):SE(e,t)}return e.close()}const AE={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},$E={blend:"mix-blend-mode"},CE={fill:"none","stroke-miterlimit":10},ME="http://www.w3.org/2000/xmlns/",PE=B_.xmlns;function FE(e){IO.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const TE=IO.prototype;function zE(e,t){for(;e&&e.dirty!==t;e=e.mark.group){if(e.dirty=t,!e.mark||e.mark.dirty===t)return;e.mark.dirty=t}}function RE(e,t,n){let r,i,o;if("radial"===t.gradient){let r=FO(e,n++,"pattern",PE);HE(r,{id:Dw+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),r=FO(r,0,"rect",PE),HE(r,{width:1,height:1,fill:`url(${VE()}#${t.id})`}),HE(e=FO(e,n++,"radialGradient",PE),{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else HE(e=FO(e,n++,"linearGradient",PE),{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)o=FO(e,r,"stop",PE),o.setAttribute("offset",t.stops[r].offset),o.setAttribute("stop-color",t.stops[r].color);return TO(e,r),n}function LE(e,t,n){let r;return(e=FO(e,n,"clipPath",PE)).setAttribute("id",t.id),t.path?(r=FO(e,0,"path",PE),r.setAttribute("d",t.path)):(r=FO(e,0,"rect",PE),HE(r,{x:0,y:0,width:t.width,height:t.height})),TO(e,1),n+1}function BE(e,t,n,r,i){let o,a=e._svg;if(!a&&(o=t.ownerDocument,a=MO(o,r,PE),e._svg=a,e.mark&&(a.__data__=e,a.__values__={fill:"default"},"g"===r))){const t=MO(o,"path",PE);a.appendChild(t),t.__data__=e;const n=MO(o,"g",PE);a.appendChild(n),n.__data__=e;const r=MO(o,"path",PE);a.appendChild(r),r.__data__=e,r.__values__={fill:"default"}}return(a.ownerSVGElement!==i||function(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}(a,n))&&t.insertBefore(a,n?n.nextSibling:t.firstChild),a}rs(FE,IO,{initialize(e,t,n,r,i){return this._defs={},this._clearDefs(),e&&(this._svg=FO(e,0,"svg",PE),this._svg.setAttributeNS(ME,"xmlns",PE),this._svg.setAttributeNS(ME,"xmlns:xlink",B_["xmlns:xlink"]),this._svg.setAttribute("version",B_.version),this._svg.setAttribute("class","marks"),TO(e,1),this._root=FO(this._svg,0,"g",PE),HE(this._root,CE),TO(this._svg,1)),this.background(this._bgcolor),TE.initialize.call(this,e,t,n,r,i)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),TE.background.apply(this,arguments)},resize(e,t,n,r){return TE.resize.call(this,e,t,n,r),this._svg&&(HE(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=FO(e,0,"rect",PE),HE(n,{width:this._width,height:this._height,fill:t}));const r=NE(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),r},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),TO(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||!e._svg.ownerSVGElement||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,r,i,o,a,s,l;for(a=0,s=e.length;a<s;++a)n=e[a],r=n.mark,r.marktype!==i&&(i=r.marktype,o=_O[i]),r.zdirty&&r.dirty!==t&&(this._dirtyAll=!1,zE(n,t),r.items.forEach((e=>{e.dirty=t}))),r.zdirty||(n.exit?(o.nested&&r.items.length?(l=r.items[0],l._svg&&this._update(o,l._svg,l)):n._svg&&(l=n._svg.parentNode,l&&l.removeChild(n._svg)),n._svg=null):(n=o.nested?r.items[0]:n,n._update!==t&&(n._svg&&n._svg.ownerSVGElement?this._update(o,n._svg,n):(this._dirtyAll=!1,zE(n,t)),n._update=t)));return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const r=this._svg,i=_O[t.marktype],o=!1===t.interactive?"none":null,a="g"===i.tag,s=BE(t,e,n,"g",r);s.setAttribute("class",zO(t));const l=_E(t);for(const d in l)GE(s,d,l[d]);a||GE(s,"pointer-events",o),GE(s,"clip-path",t.clip?Ek(this,t,t.group):null);let u=null,c=0;const f=e=>{const t=this.isDirty(e),n=BE(e,s,u,i.tag,r);t&&(this._update(i,n,e),a&&function(e,t,n){t=t.lastChild.previousSibling;let r,i=0;y_(n,(n=>{r=e.mark(t,n,r),++i})),TO(t,1+i)}(this,n,e)),u=n,++c};return i.nested?t.items.length&&f(t.items[0]):y_(t,f),TO(s,c),s},_update(e,t,n){IE=t,UE=t.__values__,kE(WE,n),e.attr(WE,n,this);const r=qE[e.type];r&&r.call(this,e,t,n),IE&&this.style(IE,n)},style(e,t){if(null!=t){for(const n in AE){let r="font"===n?pO(t):t[n];if(r===UE[n])continue;const i=AE[n];null==r?e.removeAttribute(i):(jw(r)&&(r=Nw(r,this._defs.gradient,VE())),e.setAttribute(i,r+"")),UE[n]=r}for(const n in $E)ZE(e,$E[n],t[n])}},defs(){const e=this._svg,t=this._defs;let n=t.el,r=0;for(const i in t.gradient)n||(t.el=n=FO(e,1,"defs",PE)),r=RE(n,t.gradient[i],r);for(const i in t.clipping)n||(t.el=n=FO(e,1,"defs",PE)),r=LE(n,t.clipping[i],r);n&&(0===r?(e.removeChild(n),t.el=null):TO(n,r))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});let IE=null,UE=null;const qE={group(e,t,n){const r=IE=t.childNodes[2];UE=r.__values__,e.foreground(WE,n,this),UE=t.__values__,IE=t.childNodes[1],e.content(WE,n,this);const i=IE=t.childNodes[0];e.background(WE,n,this);const o=!1===n.mark.interactive?"none":null;if(o!==UE.events&&(GE(r,"pointer-events",o),GE(i,"pointer-events",o),UE.events=o),n.strokeForeground&&n.stroke){const e=n.fill;GE(r,"display",null),this.style(i,n),GE(i,"stroke",null),e&&(n.fill=null),UE=r.__values__,this.style(r,n),e&&(n.fill=e),IE=null}else GE(r,"display","none")},image(e,t,n){!1===n.smooth?(ZE(t,"image-rendering","optimizeSpeed"),ZE(t,"image-rendering","pixelated")):ZE(t,"image-rendering",null)},text(e,t,n){const r=fO(n);let i,o,a,s;ha(r)?(o=r.map((e=>hO(n,e))),i=o.join("\n"),i!==UE.text&&(TO(t,0),a=t.ownerDocument,s=cO(n),o.forEach(((e,r)=>{const i=MO(a,"tspan",PE);i.__data__=n,i.textContent=e,r&&(i.setAttribute("x",0),i.setAttribute("dy",s)),t.appendChild(i)})),UE.text=i)):(o=hO(n,r),o!==UE.text&&(t.textContent=o,UE.text=o)),GE(t,"font-family",pO(n)),GE(t,"font-size",uO(n)+"px"),GE(t,"font-style",n.fontStyle),GE(t,"font-variant",n.fontVariant),GE(t,"font-weight",n.fontWeight)}};function WE(e,t,n){t!==UE[e]&&(n?function(e,t,n,r){null!=n?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}(IE,e,t,n):GE(IE,e,t),UE[e]=t)}function ZE(e,t,n){n!==UE[t]&&(null==n?e.style.removeProperty(t):e.style.setProperty(t,n+""),UE[t]=n)}function HE(e,t){for(const n in t)GE(e,n,t[n])}function GE(e,t,n){null!=n?e.setAttribute(t,n):e.removeAttribute(t)}function VE(){let e;return"undefined"==typeof window?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function YE(e){IO.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}rs(YE,IO,{svg(){return this._text},_render(e){const t=jE();t.open("svg",Ya({},B_,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",CE,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=_O[t.marktype],r=n.tag,i=[kE,n.attr];e.open("g",{class:zO(t),"clip-path":t.clip?Ek(this,t,t.group):null},_E(t),{"pointer-events":"g"!==r&&!1===t.interactive?"none":null});const o=o=>{const a=this.href(o);if(a&&e.open("a",a),e.open(r,this.attr(t,o,i,"g"!==r?r:null)),"text"===r){const t=fO(o);if(ha(t)){const n={x:0,dy:cO(o)};for(let r=0;r<t.length;++r)e.open("tspan",r?n:null).text(hO(o,t[r])).close()}else e.text(hO(o,t))}else if("g"===r){const r=o.strokeForeground,i=o.fill,a=o.stroke;r&&a&&(o.stroke=null),e.open("path",this.attr(t,o,n.background,"bgrect")).close(),e.open("g",this.attr(t,o,n.content)),y_(o,(t=>this.mark(e,t))),e.close(),r&&a?(i&&(o.fill=null),o.stroke=a,e.open("path",this.attr(t,o,n.foreground,"bgrect")).close(),i&&(o.fill=i)):e.open("path",this.attr(t,o,n.foreground,"bgfore")).close()}e.close(),a&&e.close()};return n.nested?t.items&&t.items.length&&o(t.items[0]):y_(t,o),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then((e=>{e["xlink:href"]=e.href,e.href=null,(this._hrefs||(this._hrefs={}))[t]=e}))}return null},attr(e,t,n,r){const i={},o=(e,t,n,r)=>{i[r||e]=t};return Array.isArray(n)?n.forEach((e=>e(o,t,this))):n(o,t,this),r&&function(e,t,n,r,i){let o;if(null==t)return e;"bgrect"===r&&!1===n.interactive&&(e["pointer-events"]="none");if("bgfore"===r&&(!1===n.interactive&&(e["pointer-events"]="none"),e.display="none",null!==t.fill))return e;"image"===r&&!1===t.smooth&&(o=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]);"text"===r&&(e["font-family"]=pO(t),e["font-size"]=uO(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const a in AE){let n=t[a];const r=AE[a];("transparent"!==n||"fill"!==r&&"stroke"!==r)&&null!=n&&(jw(n)&&(n=Nw(n,i.gradient,"")),e[r]=n)}for(const a in $E){const e=t[a];null!=e&&(o=o||[],o.push(`${$E[a]}: ${e};`))}o&&(e.style=o.join(" "))}(i,t,e,r,this._defs),i},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(t).length+Object.keys(n).length){e.open("defs");for(const n in t){const r=t[n],i=r.stops;"radial"===r.gradient?(e.open("pattern",{id:Dw+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),e.close(),e.open("radialGradient",{id:n,fx:r.x1,fy:r.y1,fr:r.r1,cx:r.x2,cy:r.y2,r:r.r2})):e.open("linearGradient",{id:n,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2});for(let t=0;t<i.length;++t)e.open("stop",{offset:i[t].offset,"stop-color":i[t].color}).close();e.close()}for(const t in n){const r=n[t];e.open("clipPath",{id:t}),r.path?e.open("path",{d:r.path}).close():e.open("rect",{x:0,y:0,width:r.width,height:r.height}).close(),e.close()}e.close()}}});const XE="canvas",JE="none",QE={Canvas:XE,PNG:"png",SVG:"svg",None:JE},KE={};function eD(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(KE[e]=t,this):KE[e]}function tD(e,t,n){const r=[],i=(new Dk).union(t),o=e.marktype;return o?nD(e,i,n,r):"group"===o?rD(e,i,n,r):Jo("Intersect scene must be mark node or group item.")}function nD(e,t,n,r){if(function(e,t,n){return e.bounds&&t.intersects(e.bounds)&&("group"===e.marktype||!1!==e.interactive&&(!n||n(e)))}(e,t,n)){const i=e.items,o=e.marktype,a=i.length;let s=0;if("group"===o)for(;s<a;++s)rD(i[s],t,n,r);else for(const e=_O[o].isect;s<a;++s){const n=i[s];iD(n,t,e)&&r.push(n)}}return r}function rD(e,t,n,r){n&&n(e.mark)&&iD(e,t,_O.group.isect)&&r.push(e);const i=e.items,o=i&&i.length;if(o){const a=e.x||0,s=e.y||0;t.translate(-a,-s);for(let e=0;e<o;++e)nD(i[e],t,n,r);t.translate(a,s)}return r}function iD(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}KE[XE]=KE.png={renderer:lE,headless:lE,handler:rE},KE.svg={renderer:FE,headless:YE,handler:cE},KE[JE]={};const oD=new Dk;function aD(e){const t=e.clip;if(Ba(t))t(Xk(oD.clear()));else{if(!t)return;oD.set(0,0,e.group.width,e.group.height)}e.bounds.intersect(oD)}const sD=1e-9;function lD(e,t,n){return e===t||("path"===n?uD(e,t):e instanceof Date&&t instanceof Date?+e==+t:ls(e)&&ls(t)?Math.abs(e-t)<=sD:e&&t&&(pa(e)||pa(t))?function(e,t){var n,r,i=Object.keys(e),o=Object.keys(t);if(i.length!==o.length)return!1;for(i.sort(),o.sort(),r=i.length-1;r>=0;r--)if(i[r]!=o[r])return!1;for(r=i.length-1;r>=0;r--)if(!lD(e[n=i[r]],t[n],n))return!1;return typeof e==typeof t}(e,t):e==t)}function uD(e,t){return lD(Rw(e),Rw(t))}const cD="top",fD="left",dD="right",hD="bottom",pD="top-left",mD="top-right",gD="bottom-left",yD="bottom-right",vD="start",bD="middle",xD="end",wD="x",kD="y",_D="group",OD="axis",ED="title",DD="frame",jD="scope",ND="legend",SD="row-header",AD="row-footer",$D="row-title",CD="column-header",MD="column-footer",PD="column-title",FD="padding",TD="symbol",zD="fit",RD="fit-x",LD="fit-y",BD="pad",ID="none",UD="all",qD="each",WD="flush",ZD="column",HD="row";function GD(e){Lh.call(this,null,e)}function VD(e,t,n){return t(e.bounds.clear(),e,n)}rs(GD,Lh,{transform(e,t){const n=t.dataflow,r=e.mark,i=r.marktype,o=_O[i],a=o.bound;let s,l=r.bounds;if(o.nested)r.items.length&&n.dirty(r.items[0]),l=VD(r,a),r.items.forEach((e=>{e.bounds.clear().union(l)}));else if(i===_D||e.modified())switch(t.visit(t.MOD,(e=>n.dirty(e))),l.clear(),r.items.forEach((e=>l.union(VD(e,a)))),r.role){case OD:case ND:case ED:t.reflow()}else s=t.changed(t.REM),t.visit(t.ADD,(e=>{l.union(VD(e,a))})),t.visit(t.MOD,(e=>{s=s||l.alignsWith(e.bounds),n.dirty(e),l.union(VD(e,a))})),s&&(l.clear(),r.items.forEach((e=>l.union(e.bounds))));return aD(r),t.modifies("bounds")}});const YD=":vega_identifier:";function XD(e){Lh.call(this,0,e)}function JD(e){Lh.call(this,null,e)}function QD(e){Lh.call(this,null,e)}XD.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},rs(XD,Lh,{transform(e,t){const n=(i=t.dataflow)._signals[YD]||(i._signals[YD]=i.add(0)),r=e.as;var i;let o=n.value;return t.visit(t.ADD,(e=>e[r]=e[r]||++o)),n.set(this.value=o),t}}),rs(JD,Lh,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,function(e){const t=e.groups,n=e.parent;return t&&1===t.size?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const r=n.marktype===_D?Nk:jk;return t.visit(t.ADD,(e=>r.call(e,n))),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});const KD={parity:e=>e.filter(((e,t)=>t%2?e.opacity=0:1)),greedy:(e,t)=>{let n;return e.filter(((e,r)=>r&&ej(n.bounds,e.bounds,t)?e.opacity=0:(n=e,1)))}},ej=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),tj=(e,t)=>{for(var n,r=1,i=e.length,o=e[0].bounds;r<i;o=n,++r)if(ej(o,n=e[r].bounds,t))return!0},nj=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},rj=e=>(e.forEach((e=>e.opacity=1)),e),ij=(e,t)=>e.reflow(t.modified()).modifies("opacity");function oj(e){Lh.call(this,null,e)}rs(QD,Lh,{transform(e,t){const n=KD[e.method]||KD.parity,r=e.separation||0;let i,o,a=t.materialize(t.SOURCE).source;if(!a||!a.length)return;if(!e.method)return e.modified("method")&&(rj(a),t=ij(t,e)),t;if(a=a.filter(nj),!a.length)return;if(e.sort&&(a=a.slice().sort(e.sort)),i=rj(a),t=ij(t,e),i.length>=3&&tj(i,r)){do{i=n(i,r)}while(i.length>=3&&tj(i,r));i.length<3&&!ba(a).opacity&&(i.length>1&&(ba(i).opacity=0),ba(a).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(o=((e,t,n)=>{var r=e.range(),i=new Dk;return t===cD||t===hD?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),e=>i.encloses(e.bounds)})(e.boundScale,e.boundOrient,+e.boundTolerance),a.forEach((e=>{o(e)||(e.opacity=0)})));const s=i[0].mark.bounds.clear();return a.forEach((e=>{e.opacity&&s.union(e.bounds)})),t}}),rs(oj,Lh,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,(e=>n.dirty(e))),t.fields&&t.fields.zindex){const e=t.source&&t.source[0];e&&(e.mark.zdirty=!0)}}});const aj=new Dk;function sj(e,t,n){return e[t]===n?0:(e[t]=n,1)}function lj(e){var t=e.items[0].orient;return t===fD||t===dD}function uj(e,t,n,r){var i,o,a=t.items[0],s=a.datum,l=null!=a.translate?a.translate:.5,u=a.orient,c=function(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}(s),f=a.range,d=a.offset,h=a.position,p=a.minExtent,m=a.maxExtent,g=s.title&&a.items[c[2]].items[0],y=a.titlePadding,v=a.bounds,b=g&&dO(g),x=0,w=0;switch(aj.clear().union(v),v.clear(),(i=c[0])>-1&&v.union(a.items[i].bounds),(i=c[1])>-1&&v.union(a.items[i].bounds),u){case cD:x=h||0,w=-d,o=Math.max(p,Math.min(m,-v.y1)),v.add(0,-o).add(f,0),g&&cj(e,g,o,y,b,0,-1,v);break;case fD:x=-d,w=h||0,o=Math.max(p,Math.min(m,-v.x1)),v.add(-o,0).add(0,f),g&&cj(e,g,o,y,b,1,-1,v);break;case dD:x=n+d,w=h||0,o=Math.max(p,Math.min(m,v.x2)),v.add(0,0).add(o,f),g&&cj(e,g,o,y,b,1,1,v);break;case hD:x=h||0,w=r+d,o=Math.max(p,Math.min(m,v.y2)),v.add(0,0).add(f,o),g&&cj(e,g,o,y,0,0,1,v);break;default:x=a.x,w=a.y}return Ck(v.translate(x,w),a),sj(a,"x",x+l)|sj(a,"y",w+l)&&(a.bounds=aj,e.dirty(a),a.bounds=v,e.dirty(a)),a.mark.bounds.clear().union(v)}function cj(e,t,n,r,i,o,a,s){const l=t.bounds;if(t.auto){const s=a*(n+i+r);let u=0,c=0;e.dirty(t),o?u=(t.x||0)-(t.x=s):c=(t.y||0)-(t.y=s),t.mark.bounds.clear().union(l.translate(-u,-c)),e.dirty(t)}s.union(l)}const fj=(e,t)=>Math.floor(Math.min(e,t)),dj=(e,t)=>Math.ceil(Math.max(e,t));function hj(e){return(new Dk).set(0,0,e.width||0,e.height||0)}function pj(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function mj(e,t,n){const r=pa(e)?e[t]:e;return null!=r?r:void 0!==n?n:0}function gj(e){return e<0?Math.ceil(-e):0}function yj(e,t,n){var r,i,o,a,s,l,u,c,f,d,h,p=!n.nodirty,m=n.bounds===WD?hj:pj,g=aj.set(0,0,0,0),y=mj(n.align,ZD),v=mj(n.align,HD),b=mj(n.padding,ZD),x=mj(n.padding,HD),w=n.columns||t.length,k=w<=0?1:Math.ceil(t.length/w),_=t.length,O=Array(_),E=Array(w),D=0,j=Array(_),N=Array(k),S=0,A=Array(_),$=Array(_),C=Array(_);for(i=0;i<w;++i)E[i]=0;for(i=0;i<k;++i)N[i]=0;for(i=0;i<_;++i)l=t[i],s=C[i]=m(l),l.x=l.x||0,A[i]=0,l.y=l.y||0,$[i]=0,o=i%w,a=~~(i/w),D=Math.max(D,u=Math.ceil(s.x2)),S=Math.max(S,c=Math.ceil(s.y2)),E[o]=Math.max(E[o],u),N[a]=Math.max(N[a],c),O[i]=b+gj(s.x1),j[i]=x+gj(s.y1),p&&e.dirty(t[i]);for(i=0;i<_;++i)i%w==0&&(O[i]=0),i<w&&(j[i]=0);if(y===qD)for(o=1;o<w;++o){for(h=0,i=o;i<_;i+=w)h<O[i]&&(h=O[i]);for(i=o;i<_;i+=w)O[i]=h+E[o-1]}else if(y===UD){for(h=0,i=0;i<_;++i)i%w&&h<O[i]&&(h=O[i]);for(i=0;i<_;++i)i%w&&(O[i]=h+D)}else for(y=!1,o=1;o<w;++o)for(i=o;i<_;i+=w)O[i]+=E[o-1];if(v===qD)for(a=1;a<k;++a){for(h=0,r=(i=a*w)+w;i<r;++i)h<j[i]&&(h=j[i]);for(i=a*w;i<r;++i)j[i]=h+N[a-1]}else if(v===UD){for(h=0,i=w;i<_;++i)h<j[i]&&(h=j[i]);for(i=w;i<_;++i)j[i]=h+S}else for(v=!1,a=1;a<k;++a)for(r=(i=a*w)+w;i<r;++i)j[i]+=N[a-1];for(f=0,i=0;i<_;++i)f=O[i]+(i%w?f:0),A[i]+=f-t[i].x;for(o=0;o<w;++o)for(d=0,i=o;i<_;i+=w)d+=j[i],$[i]+=d-t[i].y;if(y&&mj(n.center,ZD)&&k>1)for(i=0;i<_;++i)(f=(s=y===UD?D:E[i%w])-C[i].x2-t[i].x-A[i])>0&&(A[i]+=f/2);if(v&&mj(n.center,HD)&&1!==w)for(i=0;i<_;++i)(d=(s=v===UD?S:N[~~(i/w)])-C[i].y2-t[i].y-$[i])>0&&($[i]+=d/2);for(i=0;i<_;++i)g.union(C[i].translate(A[i],$[i]));switch(f=mj(n.anchor,wD),d=mj(n.anchor,kD),mj(n.anchor,ZD)){case xD:f-=g.width();break;case bD:f-=g.width()/2}switch(mj(n.anchor,HD)){case xD:d-=g.height();break;case bD:d-=g.height()/2}for(f=Math.round(f),d=Math.round(d),g.clear(),i=0;i<_;++i)t[i].mark.bounds.clear();for(i=0;i<_;++i)(l=t[i]).x+=A[i]+=f,l.y+=$[i]+=d,g.union(l.mark.bounds.union(l.bounds.translate(A[i],$[i]))),p&&e.dirty(l);return g}function vj(e,t,n){var r,i,o,a,s,l,u,c=function(e){var t,n,r=e.items,i=r.length,o=0;const a={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;o<i;++o)if(n=(t=r[o]).items,t.marktype===_D)switch(t.role){case OD:case ND:case ED:break;case SD:a.rowheaders.push(...n);break;case AD:a.rowfooters.push(...n);break;case CD:a.colheaders.push(...n);break;case MD:a.colfooters.push(...n);break;case $D:a.rowtitle=n[0];break;case PD:a.coltitle=n[0];break;default:a.marks.push(...n)}return a}(t),f=c.marks,d=n.bounds===WD?bj:xj,h=n.offset,p=n.columns||f.length,m=p<=0?1:Math.ceil(f.length/p),g=m*p;const y=yj(e,f,n);y.empty()&&y.set(0,0,0,0),c.rowheaders&&(l=mj(n.headerBand,HD,null),r=wj(e,c.rowheaders,f,p,m,-mj(h,"rowHeader"),fj,0,d,"x1",0,p,1,l)),c.colheaders&&(l=mj(n.headerBand,ZD,null),i=wj(e,c.colheaders,f,p,p,-mj(h,"columnHeader"),fj,1,d,"y1",0,1,p,l)),c.rowfooters&&(l=mj(n.footerBand,HD,null),o=wj(e,c.rowfooters,f,p,m,mj(h,"rowFooter"),dj,0,d,"x2",p-1,p,1,l)),c.colfooters&&(l=mj(n.footerBand,ZD,null),a=wj(e,c.colfooters,f,p,p,mj(h,"columnFooter"),dj,1,d,"y2",g-p,1,p,l)),c.rowtitle&&(s=mj(n.titleAnchor,HD),u=mj(h,"rowTitle"),u=s===xD?o+u:r-u,l=mj(n.titleBand,HD,.5),kj(e,c.rowtitle,u,0,y,l)),c.coltitle&&(s=mj(n.titleAnchor,ZD),u=mj(h,"columnTitle"),u=s===xD?a+u:i-u,l=mj(n.titleBand,ZD,.5),kj(e,c.coltitle,u,1,y,l))}function bj(e,t){return"x1"===t?e.x||0:"y1"===t?e.y||0:"x2"===t?(e.x||0)+(e.width||0):"y2"===t?(e.y||0)+(e.height||0):void 0}function xj(e,t){return e.bounds[t]}function wj(e,t,n,r,i,o,a,s,l,u,c,f,d,h){var p,m,g,y,v,b,x,w,k,_=n.length,O=0,E=0;if(!_)return O;for(p=c;p<_;p+=f)n[p]&&(O=a(O,l(n[p],u)));if(!t.length)return O;for(t.length>i&&(e.warn("Grid headers exceed limit: "+i),t=t.slice(0,i)),O+=o,m=0,y=t.length;m<y;++m)e.dirty(t[m]),t[m].mark.bounds.clear();for(p=c,m=0,y=t.length;m<y;++m,p+=f){for(v=(b=t[m]).mark.bounds,g=p;g>=0&&null==(x=n[g]);g-=d);s?(w=null==h?x.x:Math.round(x.bounds.x1+h*x.bounds.width()),k=O):(w=O,k=null==h?x.y:Math.round(x.bounds.y1+h*x.bounds.height())),v.union(b.bounds.translate(w-(b.x||0),k-(b.y||0))),b.x=w,b.y=k,e.dirty(b),E=a(E,v[u])}return E}function kj(e,t,n,r,i,o){if(t){e.dirty(t);var a=n,s=n;r?a=Math.round(i.x1+o*i.width()):s=Math.round(i.y1+o*i.height()),t.bounds.translate(a-(t.x||0),s-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=a,t.y=s,e.dirty(t)}}function _j(e,t,n,r,i,o,a){const s=function(e,t){const n=e[t]||{};return(t,r)=>null!=n[t]?n[t]:null!=e[t]?e[t]:r}(n,t),l=function(e,t){let n=-1/0;return e.forEach((e=>{null!=e.offset&&(n=Math.max(n,e.offset))})),n>-1/0?n:t}(e,s("offset",0)),u=s("anchor",vD),c=u===xD?1:u===bD?.5:0,f={align:qD,bounds:s("bounds",WD),columns:"vertical"===s("direction")?1:e.length,padding:s("margin",8),center:s("center"),nodirty:!0};switch(t){case fD:f.anchor={x:Math.floor(r.x1)-l,column:xD,y:c*(a||r.height()+2*r.y1),row:u};break;case dD:f.anchor={x:Math.ceil(r.x2)+l,y:c*(a||r.height()+2*r.y1),row:u};break;case cD:f.anchor={y:Math.floor(i.y1)-l,row:xD,x:c*(o||i.width()+2*i.x1),column:u};break;case hD:f.anchor={y:Math.ceil(i.y2)+l,x:c*(o||i.width()+2*i.x1),column:u};break;case pD:f.anchor={x:l,y:l};break;case mD:f.anchor={x:o-l,y:l,column:xD};break;case gD:f.anchor={x:l,y:a-l,row:xD};break;case yD:f.anchor={x:o-l,y:a-l,column:xD,row:xD}}return f}function Oj(e,t){var n,r,i=t.items[0],o=i.datum,a=i.orient,s=i.bounds,l=i.x,u=i.y;return i._bounds?i._bounds.clear().union(s):i._bounds=s.clone(),s.clear(),function(e,t,n){var r=t.padding,i=r-n.x,o=r-n.y;if(t.datum.title){var a=t.items[1].items[0],s=a.anchor,l=t.titlePadding||0,u=r-a.x,c=r-a.y;switch(a.orient){case fD:i+=Math.ceil(a.bounds.width())+l;break;case dD:case hD:break;default:o+=a.bounds.height()+l}switch((i||o)&&Dj(e,n,i,o),a.orient){case fD:c+=Ej(t,n,a,s,1,1);break;case dD:u+=Ej(t,n,a,xD,0,0)+l,c+=Ej(t,n,a,s,1,1);break;case hD:u+=Ej(t,n,a,s,0,0),c+=Ej(t,n,a,xD,-1,0,1)+l;break;default:u+=Ej(t,n,a,s,0,0)}(u||c)&&Dj(e,a,u,c),(u=Math.round(a.bounds.x1-r))<0&&(Dj(e,n,-u,0),Dj(e,a,-u,0))}else(i||o)&&Dj(e,n,i,o)}(e,i,i.items[0].items[0]),s=function(e,t){return e.items.forEach((e=>t.union(e.bounds))),t.x1=e.padding,t.y1=e.padding,t}(i,s),n=2*i.padding,r=2*i.padding,s.empty()||(n=Math.ceil(s.width()+n),r=Math.ceil(s.height()+r)),o.type===TD&&function(e){const t=e.reduce(((e,t)=>(e[t.column]=Math.max(t.bounds.x2-t.x,e[t.column]||0),e)),{});e.forEach((e=>{e.width=t[e.column],e.height=e.bounds.y2-e.y}))}(i.items[0].items[0].items[0].items),a!==ID&&(i.x=l=0,i.y=u=0),i.width=n,i.height=r,Ck(s.set(l,u,l+n,u+r),i),i.mark.bounds.clear().union(s),i}function Ej(e,t,n,r,i,o,a){const s="symbol"!==e.datum.type,l=n.datum.vgrad,u=(!s||!o&&l||a?t:t.items[0]).bounds[i?"y2":"x2"]-e.padding,c=l&&o?u:0,f=l&&o?0:u,d=i<=0?0:dO(n);return Math.round(r===vD?c:r===xD?f-d:.5*(u-d))}function Dj(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function jj(e){Lh.call(this,null,e)}rs(jj,Lh,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach((t=>{e.layout&&vj(n,t,e.layout),function(e,t,n){var r,i,o,a,s,l=t.items,u=Math.max(0,t.width||0),c=Math.max(0,t.height||0),f=(new Dk).set(0,0,u,c),d=f.clone(),h=f.clone(),p=[];for(a=0,s=l.length;a<s;++a)switch((i=l[a]).role){case OD:(lj(i)?d:h).union(uj(e,i,u,c));break;case ED:r=i;break;case ND:p.push(Oj(e,i));break;case DD:case jD:case SD:case AD:case $D:case CD:case MD:case PD:d.union(i.bounds),h.union(i.bounds);break;default:f.union(i.bounds)}if(p.length){const t={};p.forEach((e=>{(o=e.orient||dD)!==ID&&(t[o]||(t[o]=[])).push(e)}));for(const r in t){const i=t[r];yj(e,i,_j(i,r,n.legends,d,h,u,c))}p.forEach((t=>{const r=t.bounds;if(r.equals(t._bounds)||(t.bounds=t._bounds,e.dirty(t),t.bounds=r,e.dirty(t)),!n.autosize||n.autosize.type!==zD&&n.autosize.type!==RD&&n.autosize.type!==LD)f.union(r);else switch(t.orient){case fD:case dD:f.add(r.x1,0).add(r.x2,0);break;case cD:case hD:f.add(0,r.y1).add(0,r.y2)}}))}f.union(d).union(h),r&&f.union(function(e,t,n,r,i){var o,a=t.items[0],s=a.frame,l=a.orient,u=a.anchor,c=a.offset,f=a.padding,d=a.items[0].items[0],h=a.items[1]&&a.items[1].items[0],p=l===fD||l===dD?r:n,m=0,g=0,y=0,v=0,b=0;if(s!==_D?l===fD?(m=i.y2,p=i.y1):l===dD?(m=i.y1,p=i.y2):(m=i.x1,p=i.x2):l===fD&&(m=r,p=0),o=u===vD?m:u===xD?p:(m+p)/2,h&&h.text){switch(l){case cD:case hD:b=d.bounds.height()+f;break;case fD:v=d.bounds.width()+f;break;case dD:v=-d.bounds.width()-f}aj.clear().union(h.bounds),aj.translate(v-(h.x||0),b-(h.y||0)),sj(h,"x",v)|sj(h,"y",b)&&(e.dirty(h),h.bounds.clear().union(aj),h.mark.bounds.clear().union(aj),e.dirty(h)),aj.clear().union(h.bounds)}else aj.clear();switch(aj.union(d.bounds),l){case cD:g=o,y=i.y1-aj.height()-c;break;case fD:g=i.x1-aj.width()-c,y=o;break;case dD:g=i.x2+aj.width()+c,y=o;break;case hD:g=o,y=i.y2+c;break;default:g=a.x,y=a.y}return sj(a,"x",g)|sj(a,"y",y)&&(aj.translate(g,y),e.dirty(a),a.bounds.clear().union(aj),t.bounds.clear().union(aj),e.dirty(a)),a.bounds}(e,r,u,c,f));t.clip&&f.set(0,0,t.width||0,t.height||0);!function(e,t,n,r){const i=r.autosize||{},o=i.type;if(e._autosize<1||!o)return;let a=e._width,s=e._height,l=Math.max(0,t.width||0),u=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-l)),h=Math.max(0,Math.ceil(n.y2-c));if(i.contains===FD){const t=e.padding();a-=t.left+t.right,s-=t.top+t.bottom}o===ID?(u=0,f=0,l=a,c=s):o===zD?(l=Math.max(0,a-u-d),c=Math.max(0,s-f-h)):o===RD?(l=Math.max(0,a-u-d),s=c+f+h):o===LD?(a=l+u+d,c=Math.max(0,s-f-h)):o===BD&&(a=l+u+d,s=c+f+h);e._resizeView(a,s,l,c,[u,f],i.resize)}(e,t,f,n)}(n,t,e)})),function(e){return e&&"legend-entry"!==e.mark.role}(e.mark.group)?t.reflow():t}});var Nj=Object.freeze({__proto__:null,bound:GD,identifier:XD,mark:JD,overlap:QD,render:oj,viewlayout:jj});function Sj(e){Lh.call(this,null,e)}function Aj(e){Lh.call(this,null,e)}function $j(){return lh({})}function Cj(e){Lh.call(this,null,e)}function Mj(e){Lh.call(this,[],e)}rs(Sj,Lh,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,o=e.scale,a=lw(o,null==e.count?e.values?e.values.length:10:e.count,e.minstep),s=e.format||fw(n,o,a,e.formatSpecifier,e.formatType,!!e.values),l=e.values?uw(o,e.values,a):cw(o,a);return i&&(r.rem=i),i=l.map(((e,t)=>lh({index:t/(l.length-1||1),value:e,label:s(e)}))),e.extra&&i.length&&i.push(lh({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}}),rs(Aj,Lh,{transform(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||$j,o=e.key||ah,a=this.value;return ha(r.encode)&&(r.encode=null),a&&(e.modified("key")||t.modified(o))&&Jo("DataJoin does not support modified key function or fields."),a||(t=t.addAll(),this.value=a=function(e){const t=ts().test((e=>e.exit));return t.lookup=n=>t.get(e(n)),t}(o)),t.visit(t.ADD,(e=>{const t=o(e);let n=a.get(t);n?n.exit?(a.empty--,r.add.push(n)):r.mod.push(n):(n=i(e),a.set(t,n),r.add.push(n)),n.datum=e,n.exit=!1})),t.visit(t.MOD,(e=>{const t=o(e),n=a.get(t);n&&(n.datum=e,r.mod.push(n))})),t.visit(t.REM,(e=>{const t=o(e),n=a.get(t);e!==n.datum||n.exit||(r.rem.push(n),n.exit=!0,++a.empty)})),t.changed(t.ADD_MOD)&&r.modifies("datum"),(t.clean()||e.clean&&a.empty>n.cleanThreshold)&&n.runAfter(a.clean),r}}),rs(Cj,Lh,{transform(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,i=e.encoders,o=t.encode;if(ha(o)){if(!n.changed()&&!o.every((e=>i[e])))return t.StopPropagation;o=o[0],n.encode=null}var a="enter"===o,s=i.update||oa,l=i.enter||oa,u=i.exit||oa,c=(o&&!a?i[o]:s)||oa;if(t.changed(t.ADD)&&(t.visit(t.ADD,(t=>{l(t,e),s(t,e)})),n.modifies(l.output),n.modifies(s.output),c!==oa&&c!==s&&(t.visit(t.ADD,(t=>{c(t,e)})),n.modifies(c.output))),t.changed(t.REM)&&u!==oa&&(t.visit(t.REM,(t=>{u(t,e)})),n.modifies(u.output)),a||c!==oa){const i=t.MOD|(e.modified()?t.REFLOW:0);a?(t.visit(i,(t=>{const i=l(t,e)||r;(c(t,e)||i)&&n.mod.push(t)})),n.mod.length&&n.modifies(l.output)):t.visit(i,(t=>{(c(t,e)||r)&&n.mod.push(t)})),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}}),rs(Mj,Lh,{transform(e,t){if(null!=this.value&&!e.modified())return t.StopPropagation;var n,r,i,o,a,s=t.dataflow.locale(),l=t.fork(t.NO_SOURCE|t.NO_FIELDS),u=this.value,c=e.type||rw,f=e.scale,d=+e.limit,h=lw(f,null==e.count?5:e.count,e.minstep),p=!!e.values||c===rw,m=e.format||yw(s,f,h,c,e.formatSpecifier,e.formatType,p),g=e.values||mw(f,h);return u&&(l.rem=u),c===rw?(d&&g.length>d?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),u=g.slice(0,d-1),a=!0):u=g,Ba(i=e.size)?(e.values||0!==f(u[0])||(u=u.slice(1)),o=u.reduce(((t,n)=>Math.max(t,i(n,e))),0)):i=Ga(o=i||8),u=u.map(((t,n)=>lh({index:n,label:m(t,n,u),value:t,offset:o,size:i(t,e)}))),a&&(a=g[u.length],u.push(lh({index:u.length,label:`\u2026${g.length-u.length} entries`,value:a,offset:o,size:i(a,e)})))):"gradient"===c?(n=f.domain(),r=Jx(f,n[0],ba(n)),g.length<3&&!e.values&&n[0]!==ba(n)&&(g=[n[0],ba(n)]),u=g.map(((e,t)=>lh({index:t,label:m(e,t,g),value:e,perc:r(e)})))):(i=g.length-1,r=function(e){const t=e.domain(),n=t.length-1;let r=+t[0],i=+ba(t),o=i-r;if(e.type===wx){const e=n?o/n:.1;r-=e,i+=e,o=i-r}return e=>(e-r)/o}(f),u=g.map(((e,t)=>lh({index:t,label:m(e,t,g),value:e,perc:t?r(e):0,perc2:t===i?1:r(g[t+1])})))),l.source=u,l.add=u,this.value=u,l}});const Pj=e=>e.source.x,Fj=e=>e.source.y,Tj=e=>e.target.x,zj=e=>e.target.y;function Rj(e){Lh.call(this,{},e)}Rj.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},rs(Rj,Lh,{transform(e,t){var n=e.sourceX||Pj,r=e.sourceY||Fj,i=e.targetX||Tj,o=e.targetY||zj,a=e.as||"path",s=e.orient||"vertical",l=e.shape||"line",u=Uj.get(l+"-"+s)||Uj.get(l);return u||Jo("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,(e=>{e[a]=u(n(e),r(e),i(e),o(e))})),t.reflow(e.modified()).modifies(a)}});const Lj=(e,t,n,r)=>"M"+e+","+t+"L"+n+","+r,Bj=(e,t,n,r)=>{var i=n-e,o=r-t,a=Math.hypot(i,o)/2;return"M"+e+","+t+"A"+a+","+a+" "+180*Math.atan2(o,i)/Math.PI+" 0 1 "+n+","+r},Ij=(e,t,n,r)=>{const i=n-e,o=r-t,a=.2*(i+o),s=.2*(o-i);return"M"+e+","+t+"C"+(e+a)+","+(t+s)+" "+(n+s)+","+(r-a)+" "+n+","+r},Uj=ts({line:Lj,"line-radial":(e,t,n,r)=>Lj(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),arc:Bj,"arc-radial":(e,t,n,r)=>Bj(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),curve:Ij,"curve-radial":(e,t,n,r)=>Ij(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),"orthogonal-horizontal":(e,t,n,r)=>"M"+e+","+t+"V"+r+"H"+n,"orthogonal-vertical":(e,t,n,r)=>"M"+e+","+t+"H"+n+"V"+r,"orthogonal-radial":(e,t,n,r)=>{const i=Math.cos(e),o=Math.sin(e),a=Math.cos(n),s=Math.sin(n);return"M"+t*i+","+t*o+"A"+t+","+t+" 0 0,"+((Math.abs(n-e)>Math.PI?n<=e:n>e)?1:0)+" "+t*a+","+t*s+"L"+r*a+","+r*s},"diagonal-horizontal":(e,t,n,r)=>{const i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r},"diagonal-vertical":(e,t,n,r)=>{const i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r},"diagonal-radial":(e,t,n,r)=>{const i=Math.cos(e),o=Math.sin(e),a=Math.cos(n),s=Math.sin(n),l=(t+r)/2;return"M"+t*i+","+t*o+"C"+l*i+","+l*o+" "+l*a+","+l*s+" "+r*a+","+r*s}});function qj(e){Lh.call(this,null,e)}qj.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},rs(qj,Lh,{transform(e,t){var n,r,i,o=e.as||["startAngle","endAngle"],a=o[0],s=o[1],l=e.field||ra,u=e.startAngle||0,c=null!=e.endAngle?e.endAngle:2*Math.PI,f=t.source,d=f.map(l),h=d.length,p=u,m=(c-u)/kl(d),g=wl(h);for(e.sort&&g.sort(((e,t)=>d[e]-d[t])),n=0;n<h;++n)i=d[g[n]],(r=f[g[n]])[a]=p,r[s]=p+=i*m;return this.value=d,t.reflow(e.modified()).modifies(o)}});const Wj=5;function Zj(e){return Ix(e)&&e!==yx}const Hj=_s(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function Gj(e){Lh.call(this,null,e),this.modified(!0)}function Vj(e,t,n){Wx(e)&&(Math.abs(t.reduce(((e,t)=>e+(t<0?-1:t>0?1:0)),0))!==t.length&&n.warn("Log scale domain includes zero: "+vs(t)));return t}function Yj(e,t,n){return Ba(e)&&(t||n)?Vx(e,Xj(t||[0,1],n)):e}function Xj(e,t){return t?e.slice().reverse():e}function Jj(e){Lh.call(this,null,e)}rs(Gj,Lh,{transform(e,t){var n=t.dataflow,r=this.value,i=function(e){var t,n=e.type,r="";if(n===yx)return yx+"-"+cx;(function(e){const t=e.type;return Ix(t)&&t!==mx&&t!==gx&&(e.scheme||e.range&&e.range.length&&e.range.every(cs))})(e)&&(r=2===(t=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(null!=e.domainMid):0)?yx+"-":3===t?vx+"-":"");return(r+n||cx).toLowerCase()}(e);for(i in r&&i===r.type||(this.value=r=Rx(i)()),e)if(!Hj[i]){if("padding"===i&&Zj(r.type))continue;Ba(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}return function(e,t,n){var r=e.type,i=t.round||!1,o=t.range;if(null!=t.rangeStep)o=function(e,t,n){e!==Ox&&e!==_x&&Jo("Only band and point scales support rangeStep.");var r=(null!=t.paddingOuter?t.paddingOuter:t.padding)||0,i=e===_x?1:(null!=t.paddingInner?t.paddingInner:t.padding)||0;return[0,t.rangeStep*ux(n,i,r)]}(r,t,n);else if(t.scheme&&(o=function(e,t,n){var r,i=t.schemeExtent;ha(t.scheme)?r=Yx(t.scheme,t.interpolate,t.interpolateGamma):(r=nw(t.scheme.toLowerCase()))||Jo(`Unrecognized scheme name: ${t.scheme}`);return n=e===wx?n+1:e===Ex?n-1:e===bx||e===xx?+t.schemeCount||Wj:n,Zx(e)?Yj(r,i,t.reverse):Ba(r)?Xx(Yj(r,i),n):e===kx?r:r.slice(0,n)}(r,t,n),Ba(o))){if(e.interpolator)return e.interpolator(o);Jo(`Scale type ${r} does not support interpolating color schemes.`)}if(o&&Zx(r))return e.interpolator(Yx(Xj(o,t.reverse),t.interpolate,t.interpolateGamma));o&&t.interpolate&&e.interpolate?e.interpolate(Qx(t.interpolate,t.interpolateGamma)):Ba(e.round)?e.round(i):Ba(e.rangeRound)&&e.interpolate(i?ab:ob);o&&e.range(Xj(o,t.reverse))}(r,e,function(e,t,n){let r=t.bins;if(r&&!ha(r)){const t=e.domain(),n=t[0],i=ba(t),o=r.step;let a=null==r.start?n:r.start,s=null==r.stop?i:r.stop;o||Jo("Scale bins parameter missing step property."),a<n&&(a=o*Math.ceil(n/o)),s>i&&(s=o*Math.floor(i/o)),r=wl(a,s+o/2,o)}r?e.bins=r:e.bins&&delete e.bins;e.type===Ex&&(r?t.domain||t.domainRaw||(e.domain(r),n=r.length):e.bins=e.domain());return n}(r,e,function(e,t,n){const r=function(e,t,n){return t?(e.domain(Vj(e.type,t,n)),t.length):-1}(e,t.domainRaw,n);if(r>-1)return r;var i,o,a=t.domain,s=e.type,l=t.zero||void 0===t.zero&&function(e){const t=e.type;return!e.bins&&(t===cx||t===dx||t===hx)}(e);if(!a)return 0;Zj(s)&&t.padding&&a[0]!==ba(a)&&(a=function(e,t,n,r,i,o){var a=Math.abs(ba(n)-n[0]),s=a/(a-2*r),l=e===fx?Ma(t,null,s):e===hx?Pa(t,null,s,.5):e===dx?Pa(t,null,s,i||1):e===px?Fa(t,null,s,o||1):Ca(t,null,s);return t=t.slice(),t[0]=l[0],t[t.length-1]=l[1],t}(s,a,t.range,t.padding,t.exponent,t.constant));if((l||null!=t.domainMin||null!=t.domainMax||null!=t.domainMid)&&(i=(a=a.slice()).length-1||1,l&&(a[0]>0&&(a[0]=0),a[i]<0&&(a[i]=0)),null!=t.domainMin&&(a[0]=t.domainMin),null!=t.domainMax&&(a[i]=t.domainMax),null!=t.domainMid)){const e=(o=t.domainMid)>a[i]?i+1:o<a[0]?0:i;e!==i&&n.warn("Scale domainMid exceeds domain min or max.",o),a.splice(e,0,o)}e.domain(Vj(s,a,n)),s===kx&&e.unknown(t.domainImplicit?Ey:void 0);t.nice&&e.nice&&e.nice(!0!==t.nice&&lw(e,t.nice)||null);return a.length}(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),rs(Jj,Lh,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(dh(e.sort)),this.modified(n),t}});const Qj="zero",Kj="center",eN="normalize",tN=["y0","y1"];function nN(e){Lh.call(this,null,e)}function rN(e,t,n,r,i){for(var o,a=(t-e.sum)/2,s=e.length,l=0;l<s;++l)(o=e[l])[r]=a,o[i]=a+=Math.abs(n(o))}function iN(e,t,n,r,i){for(var o,a=1/e.sum,s=0,l=e.length,u=0,c=0;u<l;++u)(o=e[u])[r]=s,o[i]=s=a*(c+=Math.abs(n(o)))}function oN(e,t,n,r,i){for(var o,a,s=0,l=0,u=e.length,c=0;c<u;++c)(o=+n(a=e[c]))<0?(a[r]=l,a[i]=l+=o):(a[r]=s,a[i]=s+=o)}nN.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:Qj,values:[Qj,Kj,eN]},{name:"as",type:"string",array:!0,length:2,default:tN}]},rs(nN,Lh,{transform(e,t){var n,r,i,o,a=e.as||tN,s=a[0],l=a[1],u=dh(e.sort),c=e.field||ra,f=e.offset===Kj?rN:e.offset===eN?iN:oN;for(n=function(e,t,n,r){var i,o,a,s,l,u,c,f,d,h=[],p=e=>e(l);if(null==t)h.push(e.slice());else for(i={},o=0,a=e.length;o<a;++o)l=e[o],(c=i[u=t.map(p)])||(i[u]=c=[],h.push(c)),c.push(l);for(u=0,d=0,s=h.length;u<s;++u){for(o=0,f=0,a=(c=h[u]).length;o<a;++o)f+=Math.abs(r(c[o]));c.sum=f,f>d&&(d=f),n&&c.sort(n)}return h.max=d,h}(t.source,e.groupby,u,c),r=0,i=n.length,o=n.max;r<i;++r)f(n[r],o,c,s,l);return t.reflow(e.modified()).modifies(a)}});var aN=Object.freeze({__proto__:null,axisticks:Sj,datajoin:Aj,encode:Cj,legendentries:Mj,linkpath:Rj,pie:qj,scale:Gj,sortitems:Jj,stack:nN}),sN=1e-6,lN=1e-12,uN=Math.PI,cN=uN/2,fN=uN/4,dN=2*uN,hN=180/uN,pN=uN/180,mN=Math.abs,gN=Math.atan,yN=Math.atan2,vN=Math.cos,bN=Math.ceil,xN=Math.exp,wN=Math.hypot,kN=Math.log,_N=Math.pow,ON=Math.sin,EN=Math.sign||function(e){return e>0?1:e<0?-1:0},DN=Math.sqrt,jN=Math.tan;function NN(e){return e>1?0:e<-1?uN:Math.acos(e)}function SN(e){return e>1?cN:e<-1?-cN:Math.asin(e)}function AN(){}function $N(e,t){e&&MN.hasOwnProperty(e.type)&&MN[e.type](e,t)}var CN={Feature:function(e,t){$N(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)$N(n[r].geometry,t)}},MN={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){PN(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)PN(n[r],t,0)},Polygon:function(e,t){FN(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)FN(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)$N(n[r],t)}};function PN(e,t,n){var r,i=-1,o=e.length-n;for(t.lineStart();++i<o;)r=e[i],t.point(r[0],r[1],r[2]);t.lineEnd()}function FN(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)PN(e[n],t,1);t.polygonEnd()}function TN(e,t){e&&CN.hasOwnProperty(e.type)?CN[e.type](e,t):$N(e,t)}var zN,RN,LN,BN,IN,UN,qN,WN,ZN,HN,GN,VN,YN,XN,JN,QN,KN=new Qs,eS=new Qs,tS={point:AN,lineStart:AN,lineEnd:AN,polygonStart:function(){KN=new Qs,tS.lineStart=nS,tS.lineEnd=rS},polygonEnd:function(){var e=+KN;eS.add(e<0?dN+e:e),this.lineStart=this.lineEnd=this.point=AN},sphere:function(){eS.add(dN)}};function nS(){tS.point=iS}function rS(){oS(zN,RN)}function iS(e,t){tS.point=oS,zN=e,RN=t,LN=e*=pN,BN=vN(t=(t*=pN)/2+fN),IN=ON(t)}function oS(e,t){var n=(e*=pN)-LN,r=n>=0?1:-1,i=r*n,o=vN(t=(t*=pN)/2+fN),a=ON(t),s=IN*a,l=BN*o+s*vN(i),u=s*r*ON(i);KN.add(yN(u,l)),LN=e,BN=o,IN=a}function aS(e){return[yN(e[1],e[0]),SN(e[2])]}function sS(e){var t=e[0],n=e[1],r=vN(n);return[r*vN(t),r*ON(t),ON(n)]}function lS(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function uS(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function cS(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function fS(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function dS(e){var t=DN(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var hS,pS,mS,gS,yS,vS,bS,xS,wS,kS,_S,OS,ES,DS,jS,NS,SS={point:AS,lineStart:CS,lineEnd:MS,polygonStart:function(){SS.point=PS,SS.lineStart=FS,SS.lineEnd=TS,XN=new Qs,tS.polygonStart()},polygonEnd:function(){tS.polygonEnd(),SS.point=AS,SS.lineStart=CS,SS.lineEnd=MS,KN<0?(UN=-(WN=180),qN=-(ZN=90)):XN>sN?ZN=90:XN<-sN&&(qN=-90),QN[0]=UN,QN[1]=WN},sphere:function(){UN=-(WN=180),qN=-(ZN=90)}};function AS(e,t){JN.push(QN=[UN=e,WN=e]),t<qN&&(qN=t),t>ZN&&(ZN=t)}function $S(e,t){var n=sS([e*pN,t*pN]);if(YN){var r=uS(YN,n),i=uS([r[1],-r[0],0],r);dS(i),i=aS(i);var o,a=e-HN,s=a>0?1:-1,l=i[0]*hN*s,u=mN(a)>180;u^(s*HN<l&&l<s*e)?(o=i[1]*hN)>ZN&&(ZN=o):u^(s*HN<(l=(l+360)%360-180)&&l<s*e)?(o=-i[1]*hN)<qN&&(qN=o):(t<qN&&(qN=t),t>ZN&&(ZN=t)),u?e<HN?zS(UN,e)>zS(UN,WN)&&(WN=e):zS(e,WN)>zS(UN,WN)&&(UN=e):WN>=UN?(e<UN&&(UN=e),e>WN&&(WN=e)):e>HN?zS(UN,e)>zS(UN,WN)&&(WN=e):zS(e,WN)>zS(UN,WN)&&(UN=e)}else JN.push(QN=[UN=e,WN=e]);t<qN&&(qN=t),t>ZN&&(ZN=t),YN=n,HN=e}function CS(){SS.point=$S}function MS(){QN[0]=UN,QN[1]=WN,SS.point=AS,YN=null}function PS(e,t){if(YN){var n=e-HN;XN.add(mN(n)>180?n+(n>0?360:-360):n)}else GN=e,VN=t;tS.point(e,t),$S(e,t)}function FS(){tS.lineStart()}function TS(){PS(GN,VN),tS.lineEnd(),mN(XN)>sN&&(UN=-(WN=180)),QN[0]=UN,QN[1]=WN,YN=null}function zS(e,t){return(t-=e)<0?t+360:t}function RS(e,t){return e[0]-t[0]}function LS(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var BS={sphere:AN,point:IS,lineStart:qS,lineEnd:HS,polygonStart:function(){BS.lineStart=GS,BS.lineEnd=VS},polygonEnd:function(){BS.lineStart=qS,BS.lineEnd=HS}};function IS(e,t){e*=pN;var n=vN(t*=pN);US(n*vN(e),n*ON(e),ON(t))}function US(e,t,n){++hS,mS+=(e-mS)/hS,gS+=(t-gS)/hS,yS+=(n-yS)/hS}function qS(){BS.point=WS}function WS(e,t){e*=pN;var n=vN(t*=pN);DS=n*vN(e),jS=n*ON(e),NS=ON(t),BS.point=ZS,US(DS,jS,NS)}function ZS(e,t){e*=pN;var n=vN(t*=pN),r=n*vN(e),i=n*ON(e),o=ON(t),a=yN(DN((a=jS*o-NS*i)*a+(a=NS*r-DS*o)*a+(a=DS*i-jS*r)*a),DS*r+jS*i+NS*o);pS+=a,vS+=a*(DS+(DS=r)),bS+=a*(jS+(jS=i)),xS+=a*(NS+(NS=o)),US(DS,jS,NS)}function HS(){BS.point=IS}function GS(){BS.point=YS}function VS(){XS(OS,ES),BS.point=IS}function YS(e,t){OS=e,ES=t,e*=pN,t*=pN,BS.point=XS;var n=vN(t);DS=n*vN(e),jS=n*ON(e),NS=ON(t),US(DS,jS,NS)}function XS(e,t){e*=pN;var n=vN(t*=pN),r=n*vN(e),i=n*ON(e),o=ON(t),a=jS*o-NS*i,s=NS*r-DS*o,l=DS*i-jS*r,u=wN(a,s,l),c=SN(u),f=u&&-c/u;wS.add(f*a),kS.add(f*s),_S.add(f*l),pS+=c,vS+=c*(DS+(DS=r)),bS+=c*(jS+(jS=i)),xS+=c*(NS+(NS=o)),US(DS,jS,NS)}function JS(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,r){return(n=t.invert(n,r))&&e.invert(n[0],n[1])}),n}function QS(e,t){return mN(e)>uN&&(e-=Math.round(e/dN)*dN),[e,t]}function KS(e,t,n){return(e%=dN)?t||n?JS(tA(e),nA(t,n)):tA(e):t||n?nA(t,n):QS}function eA(e){return function(t,n){return mN(t+=e)>uN&&(t-=Math.round(t/dN)*dN),[t,n]}}function tA(e){var t=eA(e);return t.invert=eA(-e),t}function nA(e,t){var n=vN(e),r=ON(e),i=vN(t),o=ON(t);function a(e,t){var a=vN(t),s=vN(e)*a,l=ON(e)*a,u=ON(t),c=u*n+s*r;return[yN(l*i-c*o,s*n-u*r),SN(c*i+l*o)]}return a.invert=function(e,t){var a=vN(t),s=vN(e)*a,l=ON(e)*a,u=ON(t),c=u*i-l*o;return[yN(l*i+u*o,s*n+c*r),SN(c*n-s*r)]},a}function rA(e,t){(t=sS(t))[0]-=e,dS(t);var n=NN(-t[1]);return((-t[2]<0?-n:n)+dN-sN)%dN}function iA(){var e,t=[];return{point:function(t,n,r){e.push([t,n,r])},lineStart:function(){t.push(e=[])},lineEnd:AN,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function oA(e,t){return mN(e[0]-t[0])<sN&&mN(e[1]-t[1])<sN}function aA(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function sA(e,t,n,r,i){var o,a,s=[],l=[];if(e.forEach((function(e){if(!((t=e.length-1)<=0)){var t,n,r=e[0],a=e[t];if(oA(r,a)){if(!r[2]&&!a[2]){for(i.lineStart(),o=0;o<t;++o)i.point((r=e[o])[0],r[1]);return void i.lineEnd()}a[0]+=2*sN}s.push(n=new aA(r,e,null,!0)),l.push(n.o=new aA(r,null,n,!1)),s.push(n=new aA(a,e,null,!1)),l.push(n.o=new aA(a,null,n,!0))}})),s.length){for(l.sort(t),lA(s),lA(l),o=0,a=l.length;o<a;++o)l[o].e=n=!n;for(var u,c,f=s[0];;){for(var d=f,h=!0;d.v;)if((d=d.n)===f)return;u=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(o=0,a=u.length;o<a;++o)i.point((c=u[o])[0],c[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(u=d.p.z,o=u.length-1;o>=0;--o)i.point((c=u[o])[0],c[1]);else r(d.x,d.p.x,-1,i);d=d.p}u=(d=d.o).z,h=!h}while(!d.v);i.lineEnd()}}}function lA(e){if(t=e.length){for(var t,n,r=0,i=e[0];++r<t;)i.n=n=e[r],n.p=i,i=n;i.n=n=e[0],n.p=i}}function uA(e){return mN(e[0])<=uN?e[0]:EN(e[0])*((mN(e[0])+uN)%dN-uN)}function cA(e,t,n,r){return function(i){var o,a,s,l=t(i),u=iA(),c=t(u),f=!1,d={point:h,lineStart:m,lineEnd:g,polygonStart:function(){d.point=y,d.lineStart=v,d.lineEnd=b,a=[],o=[]},polygonEnd:function(){d.point=h,d.lineStart=m,d.lineEnd=g,a=xl(a);var e=function(e,t){var n=uA(t),r=t[1],i=ON(r),o=[ON(n),-vN(n),0],a=0,s=0,l=new Qs;1===i?r=cN+sN:-1===i&&(r=-cN-sN);for(var u=0,c=e.length;u<c;++u)if(d=(f=e[u]).length)for(var f,d,h=f[d-1],p=uA(h),m=h[1]/2+fN,g=ON(m),y=vN(m),v=0;v<d;++v,p=x,g=k,y=_,h=b){var b=f[v],x=uA(b),w=b[1]/2+fN,k=ON(w),_=vN(w),O=x-p,E=O>=0?1:-1,D=E*O,j=D>uN,N=g*k;if(l.add(yN(N*E*ON(D),y*_+N*vN(D))),a+=j?O+E*dN:O,j^p>=n^x>=n){var S=uS(sS(h),sS(b));dS(S);var A=uS(o,S);dS(A);var $=(j^O>=0?-1:1)*SN(A[2]);(r>$||r===$&&(S[0]||S[1]))&&(s+=j^O>=0?1:-1)}}return(a<-sN||a<sN&&l<-lN)^1&s}(o,r);a.length?(f||(i.polygonStart(),f=!0),sA(a,dA,e,n,i)):e&&(f||(i.polygonStart(),f=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),f&&(i.polygonEnd(),f=!1),a=o=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(t,n){e(t,n)&&i.point(t,n)}function p(e,t){l.point(e,t)}function m(){d.point=p,l.lineStart()}function g(){d.point=h,l.lineEnd()}function y(e,t){s.push([e,t]),c.point(e,t)}function v(){c.lineStart(),s=[]}function b(){y(s[0][0],s[0][1]),c.lineEnd();var e,t,n,r,l=c.clean(),d=u.result(),h=d.length;if(s.pop(),o.push(s),s=null,h)if(1&l){if((t=(n=d[0]).length-1)>0){for(f||(i.polygonStart(),f=!0),i.lineStart(),e=0;e<t;++e)i.point((r=n[e])[0],r[1]);i.lineEnd()}}else h>1&&2&l&&d.push(d.pop().concat(d.shift())),a.push(d.filter(fA))}return d}}function fA(e){return e.length>1}function dA(e,t){return((e=e.x)[0]<0?e[1]-cN-sN:cN-e[1])-((t=t.x)[0]<0?t[1]-cN-sN:cN-t[1])}QS.invert=QS;var hA=cA((function(){return!0}),(function(e){var t,n=NaN,r=NaN,i=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(o,a){var s=o>0?uN:-uN,l=mN(o-n);mN(l-uN)<sN?(e.point(n,r=(r+a)/2>0?cN:-cN),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(s,r),e.point(o,r),t=0):i!==s&&l>=uN&&(mN(n-i)<sN&&(n-=i*sN),mN(o-s)<sN&&(o-=s*sN),r=function(e,t,n,r){var i,o,a=ON(e-n);return mN(a)>sN?gN((ON(t)*(o=vN(r))*ON(n)-ON(r)*(i=vN(t))*ON(e))/(i*o*a)):(t+r)/2}(n,r,o,a),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(s,r),t=0),e.point(n=o,r=a),i=s},lineEnd:function(){e.lineEnd(),n=r=NaN},clean:function(){return 2-t}}}),(function(e,t,n,r){var i;if(null==e)i=n*cN,r.point(-uN,i),r.point(0,i),r.point(uN,i),r.point(uN,0),r.point(uN,-i),r.point(0,-i),r.point(-uN,-i),r.point(-uN,0),r.point(-uN,i);else if(mN(e[0]-t[0])>sN){var o=e[0]<t[0]?uN:-uN;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(t[0],t[1])}),[-uN,-cN]);function pA(e){var t=vN(e),n=6*pN,r=t>0,i=mN(t)>sN;function o(e,n){return vN(e)*vN(n)>t}function a(e,n,r){var i=[1,0,0],o=uS(sS(e),sS(n)),a=lS(o,o),s=o[0],l=a-s*s;if(!l)return!r&&e;var u=t*a/l,c=-t*s/l,f=uS(i,o),d=fS(i,u);cS(d,fS(o,c));var h=f,p=lS(d,h),m=lS(h,h),g=p*p-m*(lS(d,d)-1);if(!(g<0)){var y=DN(g),v=fS(h,(-p-y)/m);if(cS(v,d),v=aS(v),!r)return v;var b,x=e[0],w=n[0],k=e[1],_=n[1];w<x&&(b=x,x=w,w=b);var O=w-x,E=mN(O-uN)<sN;if(!E&&_<k&&(b=k,k=_,_=b),E||O<sN?E?k+_>0^v[1]<(mN(v[0]-x)<sN?k:_):k<=v[1]&&v[1]<=_:O>uN^(x<=v[0]&&v[0]<=w)){var D=fS(h,(-p+y)/m);return cS(D,d),[v,aS(D)]}}}function s(t,n){var i=r?e:uN-e,o=0;return t<-i?o|=1:t>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return cA(o,(function(e){var t,n,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(f,d){var h,p=[f,d],m=o(f,d),g=r?m?0:s(f,d):m?s(f+(f<0?uN:-uN),d):0;if(!t&&(u=l=m)&&e.lineStart(),m!==l&&(!(h=a(t,p))||oA(t,h)||oA(p,h))&&(p[2]=1),m!==l)c=0,m?(e.lineStart(),h=a(p,t),e.point(h[0],h[1])):(h=a(t,p),e.point(h[0],h[1],2),e.lineEnd()),t=h;else if(i&&t&&r^m){var y;g&n||!(y=a(p,t,!0))||(c=0,r?(e.lineStart(),e.point(y[0][0],y[0][1]),e.point(y[1][0],y[1][1]),e.lineEnd()):(e.point(y[1][0],y[1][1]),e.lineEnd(),e.lineStart(),e.point(y[0][0],y[0][1],3)))}!m||t&&oA(t,p)||e.point(p[0],p[1]),t=p,l=m,n=g},lineEnd:function(){l&&e.lineEnd(),t=null},clean:function(){return c|(u&&l)<<1}}}),(function(t,r,i,o){!function(e,t,n,r,i,o){if(n){var a=vN(t),s=ON(t),l=r*n;null==i?(i=t+r*dN,o=t-l/2):(i=rA(a,i),o=rA(a,o),(r>0?i<o:i>o)&&(i+=r*dN));for(var u,c=i;r>0?c>o:c<o;c-=l)u=aS([a,-s*vN(c),-s*ON(c)]),e.point(u[0],u[1])}}(o,e,n,i,t,r)}),r?[0,-e]:[-uN,e-uN])}var mA=1e9,gA=-mA;function yA(e,t,n,r){function i(i,o){return e<=i&&i<=n&&t<=o&&o<=r}function o(i,o,s,u){var c=0,f=0;if(null==i||(c=a(i,s))!==(f=a(o,s))||l(i,o)<0^s>0)do{u.point(0===c||3===c?e:n,c>1?r:t)}while((c=(c+s+4)%4)!==f);else u.point(o[0],o[1])}function a(r,i){return mN(r[0]-e)<sN?i>0?0:3:mN(r[0]-n)<sN?i>0?2:1:mN(r[1]-t)<sN?i>0?1:0:i>0?3:2}function s(e,t){return l(e.x,t.x)}function l(e,t){var n=a(e,1),r=a(t,1);return n!==r?n-r:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}return function(a){var l,u,c,f,d,h,p,m,g,y,v,b=a,x=iA(),w={point:k,lineStart:function(){w.point=_,u&&u.push(c=[]);y=!0,g=!1,p=m=NaN},lineEnd:function(){l&&(_(f,d),h&&g&&x.rejoin(),l.push(x.result()));w.point=k,g&&b.lineEnd()},polygonStart:function(){b=x,l=[],u=[],v=!0},polygonEnd:function(){var t=function(){for(var t=0,n=0,i=u.length;n<i;++n)for(var o,a,s=u[n],l=1,c=s.length,f=s[0],d=f[0],h=f[1];l<c;++l)o=d,a=h,d=(f=s[l])[0],h=f[1],a<=r?h>r&&(d-o)*(r-a)>(h-a)*(e-o)&&++t:h<=r&&(d-o)*(r-a)<(h-a)*(e-o)&&--t;return t}(),n=v&&t,i=(l=xl(l)).length;(n||i)&&(a.polygonStart(),n&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),i&&sA(l,s,t,o,a),a.polygonEnd());b=a,l=u=c=null}};function k(e,t){i(e,t)&&b.point(e,t)}function _(o,a){var s=i(o,a);if(u&&c.push([o,a]),y)f=o,d=a,h=s,y=!1,s&&(b.lineStart(),b.point(o,a));else if(s&&g)b.point(o,a);else{var l=[p=Math.max(gA,Math.min(mA,p)),m=Math.max(gA,Math.min(mA,m))],x=[o=Math.max(gA,Math.min(mA,o)),a=Math.max(gA,Math.min(mA,a))];!function(e,t,n,r,i,o){var a,s=e[0],l=e[1],u=0,c=1,f=t[0]-s,d=t[1]-l;if(a=n-s,f||!(a>0)){if(a/=f,f<0){if(a<u)return;a<c&&(c=a)}else if(f>0){if(a>c)return;a>u&&(u=a)}if(a=i-s,f||!(a<0)){if(a/=f,f<0){if(a>c)return;a>u&&(u=a)}else if(f>0){if(a<u)return;a<c&&(c=a)}if(a=r-l,d||!(a>0)){if(a/=d,d<0){if(a<u)return;a<c&&(c=a)}else if(d>0){if(a>c)return;a>u&&(u=a)}if(a=o-l,d||!(a<0)){if(a/=d,d<0){if(a>c)return;a>u&&(u=a)}else if(d>0){if(a<u)return;a<c&&(c=a)}return u>0&&(e[0]=s+u*f,e[1]=l+u*d),c<1&&(t[0]=s+c*f,t[1]=l+c*d),!0}}}}}(l,x,e,t,n,r)?s&&(b.lineStart(),b.point(o,a),v=!1):(g||(b.lineStart(),b.point(l[0],l[1])),b.point(x[0],x[1]),s||b.lineEnd(),v=!1)}p=o,m=a,g=s}return w}}function vA(e,t,n){var r=wl(e,t-sN,n).concat(t);return function(e){return r.map((function(t){return[e,t]}))}}function bA(e,t,n){var r=wl(e,t-sN,n).concat(t);return function(e){return r.map((function(t){return[t,e]}))}}var xA,wA,kA,_A,OA=e=>e,EA=new Qs,DA=new Qs,jA={point:AN,lineStart:AN,lineEnd:AN,polygonStart:function(){jA.lineStart=NA,jA.lineEnd=$A},polygonEnd:function(){jA.lineStart=jA.lineEnd=jA.point=AN,EA.add(mN(DA)),DA=new Qs},result:function(){var e=EA/2;return EA=new Qs,e}};function NA(){jA.point=SA}function SA(e,t){jA.point=AA,xA=kA=e,wA=_A=t}function AA(e,t){DA.add(_A*e-kA*t),kA=e,_A=t}function $A(){AA(xA,wA)}var CA=jA,MA=1/0,PA=MA,FA=-MA,TA=FA,zA={point:function(e,t){e<MA&&(MA=e);e>FA&&(FA=e);t<PA&&(PA=t);t>TA&&(TA=t)},lineStart:AN,lineEnd:AN,polygonStart:AN,polygonEnd:AN,result:function(){var e=[[MA,PA],[FA,TA]];return FA=TA=-(PA=MA=1/0),e}};var RA,LA,BA,IA,UA=zA,qA=0,WA=0,ZA=0,HA=0,GA=0,VA=0,YA=0,XA=0,JA=0,QA={point:KA,lineStart:e$,lineEnd:r$,polygonStart:function(){QA.lineStart=i$,QA.lineEnd=o$},polygonEnd:function(){QA.point=KA,QA.lineStart=e$,QA.lineEnd=r$},result:function(){var e=JA?[YA/JA,XA/JA]:VA?[HA/VA,GA/VA]:ZA?[qA/ZA,WA/ZA]:[NaN,NaN];return qA=WA=ZA=HA=GA=VA=YA=XA=JA=0,e}};function KA(e,t){qA+=e,WA+=t,++ZA}function e$(){QA.point=t$}function t$(e,t){QA.point=n$,KA(BA=e,IA=t)}function n$(e,t){var n=e-BA,r=t-IA,i=DN(n*n+r*r);HA+=i*(BA+e)/2,GA+=i*(IA+t)/2,VA+=i,KA(BA=e,IA=t)}function r$(){QA.point=KA}function i$(){QA.point=a$}function o$(){s$(RA,LA)}function a$(e,t){QA.point=s$,KA(RA=BA=e,LA=IA=t)}function s$(e,t){var n=e-BA,r=t-IA,i=DN(n*n+r*r);HA+=i*(BA+e)/2,GA+=i*(IA+t)/2,VA+=i,YA+=(i=IA*e-BA*t)*(BA+e),XA+=i*(IA+t),JA+=3*i,KA(BA=e,IA=t)}var l$=QA;function u$(e){this._context=e}u$.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._context.moveTo(e,t),this._point=1;break;case 1:this._context.lineTo(e,t);break;default:this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,dN)}},result:AN};var c$,f$,d$,h$,p$,m$=new Qs,g$={point:AN,lineStart:function(){g$.point=y$},lineEnd:function(){c$&&v$(f$,d$),g$.point=AN},polygonStart:function(){c$=!0},polygonEnd:function(){c$=null},result:function(){var e=+m$;return m$=new Qs,e}};function y$(e,t){g$.point=v$,f$=h$=e,d$=p$=t}function v$(e,t){h$-=e,p$-=t,m$.add(DN(h$*h$+p$*p$)),h$=e,p$=t}var b$=g$;let x$,w$,k$,_$;class O${constructor(e){this._append=null==e?E$:function(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return E$;if(t!==x$){const e=10**t;x$=t,w$=function(t){let n=1;this._+=t[0];for(const r=t.length;n<r;++n)this._+=Math.round(arguments[n]*e)/e+t[n]}}return w$}(e),this._radius=4.5,this._=""}pointRadius(e){return this._radius=+e,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){0===this._line&&(this._+="Z"),this._point=NaN}point(e,t){switch(this._point){case 0:this._append`M${e},${t}`,this._point=1;break;case 1:this._append`L${e},${t}`;break;default:if(this._append`M${e},${t}`,this._radius!==k$||this._append!==w$){const e=this._radius,t=this._;this._="",this._append`m0,${e}a${e},${e} 0 1,1 0,${-2*e}a${e},${e} 0 1,1 0,${2*e}z`,k$=e,w$=this._append,_$=this._,this._=t}this._+=_$}}result(){const e=this._;return this._="",e.length?e:null}}function E$(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function D$(e,t){let n,r,i=3,o=4.5;function a(e){return e&&("function"==typeof o&&r.pointRadius(+o.apply(this,arguments)),TN(e,n(r))),r.result()}return a.area=function(e){return TN(e,n(CA)),CA.result()},a.measure=function(e){return TN(e,n(b$)),b$.result()},a.bounds=function(e){return TN(e,n(UA)),UA.result()},a.centroid=function(e){return TN(e,n(l$)),l$.result()},a.projection=function(t){return arguments.length?(n=null==t?(e=null,OA):(e=t).stream,a):e},a.context=function(e){return arguments.length?(r=null==e?(t=null,new O$(i)):new u$(t=e),"function"!=typeof o&&r.pointRadius(o),a):t},a.pointRadius=function(e){return arguments.length?(o="function"==typeof e?e:(r.pointRadius(+e),+e),a):o},a.digits=function(e){if(!arguments.length)return i;if(null==e)i=null;else{const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);i=t}return null===t&&(r=new O$(i)),a},a.projection(e).digits(i).context(t)}function j$(e){return function(t){var n=new N$;for(var r in e)n[r]=e[r];return n.stream=t,n}}function N$(){}function S$(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=r&&e.clipExtent(null),TN(n,e.stream(UA)),t(UA.result()),null!=r&&e.clipExtent(r),e}function A$(e,t,n){return S$(e,(function(n){var r=t[1][0]-t[0][0],i=t[1][1]-t[0][1],o=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),a=+t[0][0]+(r-o*(n[1][0]+n[0][0]))/2,s=+t[0][1]+(i-o*(n[1][1]+n[0][1]))/2;e.scale(150*o).translate([a,s])}),n)}function $$(e,t,n){return A$(e,[[0,0],t],n)}function C$(e,t,n){return S$(e,(function(n){var r=+t,i=r/(n[1][0]-n[0][0]),o=(r-i*(n[1][0]+n[0][0]))/2,a=-i*n[0][1];e.scale(150*i).translate([o,a])}),n)}function M$(e,t,n){return S$(e,(function(n){var r=+t,i=r/(n[1][1]-n[0][1]),o=-i*n[0][0],a=(r-i*(n[1][1]+n[0][1]))/2;e.scale(150*i).translate([o,a])}),n)}N$.prototype={constructor:N$,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var P$=16,F$=vN(30*pN);function T$(e,t){return+t?function(e,t){function n(r,i,o,a,s,l,u,c,f,d,h,p,m,g){var y=u-r,v=c-i,b=y*y+v*v;if(b>4*t&&m--){var x=a+d,w=s+h,k=l+p,_=DN(x*x+w*w+k*k),O=SN(k/=_),E=mN(mN(k)-1)<sN||mN(o-f)<sN?(o+f)/2:yN(w,x),D=e(E,O),j=D[0],N=D[1],S=j-r,A=N-i,$=v*S-y*A;($*$/b>t||mN((y*S+v*A)/b-.5)>.3||a*d+s*h+l*p<F$)&&(n(r,i,o,a,s,l,j,N,E,x/=_,w/=_,k,m,g),g.point(j,N),n(j,N,E,x,w,k,u,c,f,d,h,p,m,g))}}return function(t){var r,i,o,a,s,l,u,c,f,d,h,p,m={point:g,lineStart:y,lineEnd:b,polygonStart:function(){t.polygonStart(),m.lineStart=x},polygonEnd:function(){t.polygonEnd(),m.lineStart=y}};function g(n,r){n=e(n,r),t.point(n[0],n[1])}function y(){c=NaN,m.point=v,t.lineStart()}function v(r,i){var o=sS([r,i]),a=e(r,i);n(c,f,u,d,h,p,c=a[0],f=a[1],u=r,d=o[0],h=o[1],p=o[2],P$,t),t.point(c,f)}function b(){m.point=g,t.lineEnd()}function x(){y(),m.point=w,m.lineEnd=k}function w(e,t){v(r=e,t),i=c,o=f,a=d,s=h,l=p,m.point=v}function k(){n(c,f,u,d,h,p,i,o,r,a,s,l,P$,t),m.lineEnd=b,b()}return m}}(e,t):function(e){return j$({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}(e)}var z$=j$({point:function(e,t){this.stream.point(e*pN,t*pN)}});function R$(e,t,n,r,i,o){if(!o)return function(e,t,n,r,i){function o(o,a){return[t+e*(o*=r),n-e*(a*=i)]}return o.invert=function(o,a){return[(o-t)/e*r,(n-a)/e*i]},o}(e,t,n,r,i);var a=vN(o),s=ON(o),l=a*e,u=s*e,c=a/e,f=s/e,d=(s*n-a*t)/e,h=(s*t+a*n)/e;function p(e,o){return[l*(e*=r)-u*(o*=i)+t,n-u*e-l*o]}return p.invert=function(e,t){return[r*(c*e-f*t+d),i*(h-f*e-c*t)]},p}function L$(e){return B$((function(){return e}))()}function B$(e){var t,n,r,i,o,a,s,l,u,c,f=150,d=480,h=250,p=0,m=0,g=0,y=0,v=0,b=0,x=1,w=1,k=null,_=hA,O=null,E=OA,D=.5;function j(e){return l(e[0]*pN,e[1]*pN)}function N(e){return(e=l.invert(e[0],e[1]))&&[e[0]*hN,e[1]*hN]}function S(){var e=R$(f,0,0,x,w,b).apply(null,t(p,m)),r=R$(f,d-e[0],h-e[1],x,w,b);return n=KS(g,y,v),s=JS(t,r),l=JS(n,s),a=T$(s,D),A()}function A(){return u=c=null,j}return j.stream=function(e){return u&&c===e?u:u=z$(function(e){return j$({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}(n)(_(a(E(c=e)))))},j.preclip=function(e){return arguments.length?(_=e,k=void 0,A()):_},j.postclip=function(e){return arguments.length?(E=e,O=r=i=o=null,A()):E},j.clipAngle=function(e){return arguments.length?(_=+e?pA(k=e*pN):(k=null,hA),A()):k*hN},j.clipExtent=function(e){return arguments.length?(E=null==e?(O=r=i=o=null,OA):yA(O=+e[0][0],r=+e[0][1],i=+e[1][0],o=+e[1][1]),A()):null==O?null:[[O,r],[i,o]]},j.scale=function(e){return arguments.length?(f=+e,S()):f},j.translate=function(e){return arguments.length?(d=+e[0],h=+e[1],S()):[d,h]},j.center=function(e){return arguments.length?(p=e[0]%360*pN,m=e[1]%360*pN,S()):[p*hN,m*hN]},j.rotate=function(e){return arguments.length?(g=e[0]%360*pN,y=e[1]%360*pN,v=e.length>2?e[2]%360*pN:0,S()):[g*hN,y*hN,v*hN]},j.angle=function(e){return arguments.length?(b=e%360*pN,S()):b*hN},j.reflectX=function(e){return arguments.length?(x=e?-1:1,S()):x<0},j.reflectY=function(e){return arguments.length?(w=e?-1:1,S()):w<0},j.precision=function(e){return arguments.length?(a=T$(s,D=e*e),A()):DN(D)},j.fitExtent=function(e,t){return A$(j,e,t)},j.fitSize=function(e,t){return $$(j,e,t)},j.fitWidth=function(e,t){return C$(j,e,t)},j.fitHeight=function(e,t){return M$(j,e,t)},function(){return t=e.apply(this,arguments),j.invert=t.invert&&N,S()}}function I$(e){var t=0,n=uN/3,r=B$(e),i=r(t,n);return i.parallels=function(e){return arguments.length?r(t=e[0]*pN,n=e[1]*pN):[t*hN,n*hN]},i}function U$(e,t){var n=ON(e),r=(n+ON(t))/2;if(mN(r)<sN)return function(e){var t=vN(e);function n(e,n){return[e*t,ON(n)/t]}return n.invert=function(e,n){return[e/t,SN(n*t)]},n}(e);var i=1+n*(2*r-n),o=DN(i)/r;function a(e,t){var n=DN(i-2*r*ON(t))/r;return[n*ON(e*=r),o-n*vN(e)]}return a.invert=function(e,t){var n=o-t,a=yN(e,mN(n))*EN(n);return n*r<0&&(a-=uN*EN(e)*EN(n)),[a/r,SN((i-(e*e+n*n)*r*r)/(2*r))]},a}function q$(){return I$(U$).scale(155.424).center([0,33.6442])}function W$(){return q$().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Z$(e){return function(t,n){var r=vN(t),i=vN(n),o=e(r*i);return o===1/0?[2,0]:[o*i*ON(t),o*ON(n)]}}function H$(e){return function(t,n){var r=DN(t*t+n*n),i=e(r),o=ON(i),a=vN(i);return[yN(t*o,r*a),SN(r&&n*o/r)]}}var G$=Z$((function(e){return DN(2/(1+e))}));G$.invert=H$((function(e){return 2*SN(e/2)}));var V$=Z$((function(e){return(e=NN(e))&&e/ON(e)}));function Y$(e,t){return[e,kN(jN((cN+t)/2))]}function X$(e){var t,n,r,i=L$(e),o=i.center,a=i.scale,s=i.translate,l=i.clipExtent,u=null;function c(){var o=uN*a(),s=i(function(e){function t(t){return(t=e(t[0]*pN,t[1]*pN))[0]*=hN,t[1]*=hN,t}return e=KS(e[0]*pN,e[1]*pN,e.length>2?e[2]*pN:0),t.invert=function(t){return(t=e.invert(t[0]*pN,t[1]*pN))[0]*=hN,t[1]*=hN,t},t}(i.rotate()).invert([0,0]));return l(null==u?[[s[0]-o,s[1]-o],[s[0]+o,s[1]+o]]:e===Y$?[[Math.max(s[0]-o,u),t],[Math.min(s[0]+o,n),r]]:[[u,Math.max(s[1]-o,t)],[n,Math.min(s[1]+o,r)]])}return i.scale=function(e){return arguments.length?(a(e),c()):a()},i.translate=function(e){return arguments.length?(s(e),c()):s()},i.center=function(e){return arguments.length?(o(e),c()):o()},i.clipExtent=function(e){return arguments.length?(null==e?u=t=n=r=null:(u=+e[0][0],t=+e[0][1],n=+e[1][0],r=+e[1][1]),c()):null==u?null:[[u,t],[n,r]]},c()}function J$(e){return jN((cN+e)/2)}function Q$(e,t){var n=vN(e),r=e===t?ON(e):kN(n/vN(t))/kN(J$(t)/J$(e)),i=n*_N(J$(e),r)/r;if(!r)return Y$;function o(e,t){i>0?t<-cN+sN&&(t=-cN+sN):t>cN-sN&&(t=cN-sN);var n=i/_N(J$(t),r);return[n*ON(r*e),i-n*vN(r*e)]}return o.invert=function(e,t){var n=i-t,o=EN(r)*DN(e*e+n*n),a=yN(e,mN(n))*EN(n);return n*r<0&&(a-=uN*EN(e)*EN(n)),[a/r,2*gN(_N(i/o,1/r))-cN]},o}function K$(e,t){return[e,t]}function eC(e,t){var n=vN(e),r=e===t?ON(e):(n-vN(t))/(t-e),i=n/r+e;if(mN(r)<sN)return K$;function o(e,t){var n=i-t,o=r*e;return[n*ON(o),i-n*vN(o)]}return o.invert=function(e,t){var n=i-t,o=yN(e,mN(n))*EN(n);return n*r<0&&(o-=uN*EN(e)*EN(n)),[o/r,i-EN(r)*DN(e*e+n*n)]},o}V$.invert=H$((function(e){return e})),Y$.invert=function(e,t){return[e,2*gN(xN(t))-cN]},K$.invert=K$;var tC=1.340264,nC=-.081106,rC=893e-6,iC=.003796,oC=DN(3)/2;function aC(e,t){var n=SN(oC*ON(t)),r=n*n,i=r*r*r;return[e*vN(n)/(oC*(tC+3*nC*r+i*(7*rC+9*iC*r))),n*(tC+nC*r+i*(rC+iC*r))]}function sC(e,t){var n=vN(t),r=vN(e)*n;return[n*ON(e)/r,ON(t)/r]}function lC(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),t*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function uC(e,t){return[vN(t)*ON(e),ON(t)]}function cC(e,t){var n=vN(t),r=1+vN(e)*n;return[n*ON(e)/r,ON(t)/r]}function fC(e,t){return[kN(jN((cN+t)/2)),-e]}aC.invert=function(e,t){for(var n,r=t,i=r*r,o=i*i*i,a=0;a<12&&(o=(i=(r-=n=(r*(tC+nC*i+o*(rC+iC*i))-t)/(tC+3*nC*i+o*(7*rC+9*iC*i)))*r)*i*i,!(mN(n)<lN));++a);return[oC*e*(tC+3*nC*i+o*(7*rC+9*iC*i))/vN(r),SN(ON(r)/oC)]},sC.invert=H$(gN),lC.invert=function(e,t){var n,r=t,i=25;do{var o=r*r,a=o*o;r-=n=(r*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))-t)/(1.007226+o*(.045255+a*(.259866*o-.311325-.005916*11*a)))}while(mN(n)>sN&&--i>0);return[e/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]},uC.invert=H$(SN),cC.invert=H$((function(e){return 2*gN(e)})),fC.invert=function(e,t){return[-t,2*gN(xN(e))-cN]};var dC=Math.abs,hC=Math.cos,pC=Math.sin,mC=1e-6,gC=Math.PI,yC=gC/2,vC=function(e){return e>0?Math.sqrt(e):0}(2);function bC(e){return e>1?yC:e<-1?-yC:Math.asin(e)}function xC(e,t){var n,r=e*pC(t),i=30;do{t-=n=(t+pC(t)-r)/(1+hC(t))}while(dC(n)>mC&&--i>0);return t/2}var wC=function(e,t,n){function r(r,i){return[e*r*hC(i=xC(n,i)),t*pC(i)]}return r.invert=function(r,i){return i=bC(i/t),[r/(e*hC(i)),bC((2*i+pC(2*i))/n)]},r}(vC/yC,vC,gC);const kC=D$(),_C=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function OC(e,t){if(!e||"string"!=typeof e)throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(DC[e]=function(e,t){return function n(){const r=t();return r.type=e,r.path=D$().projection(r),r.copy=r.copy||function(){const e=n();return _C.forEach((t=>{r[t]&&e[t](r[t]())})),e.path.pointRadius(r.path.pointRadius()),e},zx(r)}}(e,t),this):DC[e]||null}function EC(e){return e&&e.path||kC}const DC={albers:W$,albersusa:function(){var e,t,n,r,i,o,a=W$(),s=q$().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=q$().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(e,t){o=[e,t]}};function c(e){var t=e[0],a=e[1];return o=null,n.point(t,a),o||(r.point(t,a),o)||(i.point(t,a),o)}function f(){return e=t=null,c}return c.invert=function(e){var t=a.scale(),n=a.translate(),r=(e[0]-n[0])/t,i=(e[1]-n[1])/t;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?s:i>=.166&&i<.234&&r>=-.214&&r<-.115?l:a).invert(e)},c.stream=function(n){return e&&t===n?e:(r=[a.stream(t=n),s.stream(n),l.stream(n)],i=r.length,e={point:function(e,t){for(var n=-1;++n<i;)r[n].point(e,t)},sphere:function(){for(var e=-1;++e<i;)r[e].sphere()},lineStart:function(){for(var e=-1;++e<i;)r[e].lineStart()},lineEnd:function(){for(var e=-1;++e<i;)r[e].lineEnd()},polygonStart:function(){for(var e=-1;++e<i;)r[e].polygonStart()},polygonEnd:function(){for(var e=-1;++e<i;)r[e].polygonEnd()}});var r,i},c.precision=function(e){return arguments.length?(a.precision(e),s.precision(e),l.precision(e),f()):a.precision()},c.scale=function(e){return arguments.length?(a.scale(e),s.scale(.35*e),l.scale(e),c.translate(a.translate())):a.scale()},c.translate=function(e){if(!arguments.length)return a.translate();var t=a.scale(),o=+e[0],c=+e[1];return n=a.translate(e).clipExtent([[o-.455*t,c-.238*t],[o+.455*t,c+.238*t]]).stream(u),r=s.translate([o-.307*t,c+.201*t]).clipExtent([[o-.425*t+sN,c+.12*t+sN],[o-.214*t-sN,c+.234*t-sN]]).stream(u),i=l.translate([o-.205*t,c+.212*t]).clipExtent([[o-.214*t+sN,c+.166*t+sN],[o-.115*t-sN,c+.234*t-sN]]).stream(u),f()},c.fitExtent=function(e,t){return A$(c,e,t)},c.fitSize=function(e,t){return $$(c,e,t)},c.fitWidth=function(e,t){return C$(c,e,t)},c.fitHeight=function(e,t){return M$(c,e,t)},c.scale(1070)},azimuthalequalarea:function(){return L$(G$).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return L$(V$).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return I$(Q$).scale(109.5).parallels([30,30])},conicequalarea:q$,conicequidistant:function(){return I$(eC).scale(131.154).center([0,13.9389])},equalEarth:function(){return L$(aC).scale(177.158)},equirectangular:function(){return L$(K$).scale(152.63)},gnomonic:function(){return L$(sC).scale(144.049).clipAngle(60)},identity:function(){var e,t,n,r,i,o,a,s=1,l=0,u=0,c=1,f=1,d=0,h=null,p=1,m=1,g=j$({point:function(e,t){var n=b([e,t]);this.stream.point(n[0],n[1])}}),y=OA;function v(){return p=s*c,m=s*f,o=a=null,b}function b(n){var r=n[0]*p,i=n[1]*m;if(d){var o=i*e-r*t;r=r*e+i*t,i=o}return[r+l,i+u]}return b.invert=function(n){var r=n[0]-l,i=n[1]-u;if(d){var o=i*e+r*t;r=r*e-i*t,i=o}return[r/p,i/m]},b.stream=function(e){return o&&a===e?o:o=g(y(a=e))},b.postclip=function(e){return arguments.length?(y=e,h=n=r=i=null,v()):y},b.clipExtent=function(e){return arguments.length?(y=null==e?(h=n=r=i=null,OA):yA(h=+e[0][0],n=+e[0][1],r=+e[1][0],i=+e[1][1]),v()):null==h?null:[[h,n],[r,i]]},b.scale=function(e){return arguments.length?(s=+e,v()):s},b.translate=function(e){return arguments.length?(l=+e[0],u=+e[1],v()):[l,u]},b.angle=function(n){return arguments.length?(t=ON(d=n%360*pN),e=vN(d),v()):d*hN},b.reflectX=function(e){return arguments.length?(c=e?-1:1,v()):c<0},b.reflectY=function(e){return arguments.length?(f=e?-1:1,v()):f<0},b.fitExtent=function(e,t){return A$(b,e,t)},b.fitSize=function(e,t){return $$(b,e,t)},b.fitWidth=function(e,t){return C$(b,e,t)},b.fitHeight=function(e,t){return M$(b,e,t)},b},mercator:function(){return X$(Y$).scale(961/dN)},mollweide:function(){return L$(wC).scale(169.529)},naturalEarth1:function(){return L$(lC).scale(175.295)},orthographic:function(){return L$(uC).scale(249.5).clipAngle(90+sN)},stereographic:function(){return L$(cC).scale(250).clipAngle(142)},transversemercator:function(){var e=X$(fC),t=e.center,n=e.rotate;return e.center=function(e){return arguments.length?t([-e[1],e[0]]):[(e=t())[1],-e[0]]},e.rotate=function(e){return arguments.length?n([e[0],e[1],e.length>2?e[2]+90:90]):[(e=n())[0],e[1],e[2]-90]},n([0,0,90]).scale(159.155)}};for(const zee in DC)OC(zee,DC[zee]);function jC(){}const NC=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function SC(){var e=1,t=1,n=a;function r(e,t){return t.map((t=>i(e,t)))}function i(r,i){var a=[],s=[];return function(n,r,i){var a,s,l,u,c,f,d=new Array,h=new Array;a=s=-1,u=n[0]>=r,NC[u<<1].forEach(p);for(;++a<e-1;)l=u,u=n[a+1]>=r,NC[l|u<<1].forEach(p);NC[u<<0].forEach(p);for(;++s<t-1;){for(a=-1,u=n[s*e+e]>=r,c=n[s*e]>=r,NC[u<<1|c<<2].forEach(p);++a<e-1;)l=u,u=n[s*e+e+a+1]>=r,f=c,c=n[s*e+a+1]>=r,NC[l|u<<1|c<<2|f<<3].forEach(p);NC[u|c<<3].forEach(p)}a=-1,c=n[s*e]>=r,NC[c<<2].forEach(p);for(;++a<e-1;)f=c,c=n[s*e+a+1]>=r,NC[c<<2|f<<3].forEach(p);function p(e){var t,n,r=[e[0][0]+a,e[0][1]+s],l=[e[1][0]+a,e[1][1]+s],u=o(r),c=o(l);(t=h[u])?(n=d[c])?(delete h[t.end],delete d[n.start],t===n?(t.ring.push(l),i(t.ring)):d[t.start]=h[n.end]={start:t.start,end:n.end,ring:t.ring.concat(n.ring)}):(delete h[t.end],t.ring.push(l),h[t.end=c]=t):(t=d[c])?(n=h[u])?(delete d[t.start],delete h[n.end],t===n?(t.ring.push(l),i(t.ring)):d[n.start]=h[t.end]={start:n.start,end:t.end,ring:n.ring.concat(t.ring)}):(delete d[t.start],t.ring.unshift(r),d[t.start=u]=t):d[u]=h[c]={start:u,end:c,ring:[r,l]}}NC[c<<3].forEach(p)}(r,i,(e=>{n(e,r,i),function(e){var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];for(;++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}(e)>0?a.push([e]):s.push(e)})),s.forEach((e=>{for(var t,n=0,r=a.length;n<r;++n)if(-1!==AC((t=a[n])[0],e))return void t.push(e)})),{type:"MultiPolygon",value:i,coordinates:a}}function o(t){return 2*t[0]+t[1]*(e+1)*4}function a(n,r,i){n.forEach((n=>{var o,a=n[0],s=n[1],l=0|a,u=0|s,c=r[u*e+l];a>0&&a<e&&l===a&&(o=r[u*e+l-1],n[0]=a+(i-o)/(c-o)-.5),s>0&&s<t&&u===s&&(o=r[(u-1)*e+l],n[1]=s+(i-o)/(c-o)-.5)}))}return r.contour=i,r.size=function(n){if(!arguments.length)return[e,t];var i=Math.floor(n[0]),o=Math.floor(n[1]);return i>=0&&o>=0||Jo("invalid size"),e=i,t=o,r},r.smooth=function(e){return arguments.length?(n=e?a:jC,r):n===a},r}function AC(e,t){for(var n,r=-1,i=t.length;++r<i;)if(n=$C(e,t[r]))return n;return 0}function $C(e,t){for(var n=t[0],r=t[1],i=-1,o=0,a=e.length,s=a-1;o<a;s=o++){var l=e[o],u=l[0],c=l[1],f=e[s],d=f[0],h=f[1];if(CC(l,f,t))return 0;c>r!=h>r&&n<(d-u)*(r-c)/(h-c)+u&&(i=-i)}return i}function CC(e,t,n){var r,i,o,a;return function(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}(e,t,n)&&(i=e[r=+(e[0]===t[0])],o=n[r],a=t[r],i<=o&&o<=a||a<=o&&o<=i)}function MC(e,t,n){return function(r){var i=Xa(r),o=n?Math.min(i[0],0):i[0],a=i[1],s=a-o,l=t?dl(o,a,e):s/(e+1);return wl(o+l,a,l)}}function PC(e){Lh.call(this,null,e)}function FC(e,t,n,r,i){const o=e.x1||0,a=e.y1||0,s=t*n<0;function l(e){e.forEach(u)}function u(e){s&&e.reverse(),e.forEach(c)}function c(e){e[0]=(e[0]-o)*t+r,e[1]=(e[1]-a)*n+i}return function(e){return e.coordinates.forEach(l),e}}function TC(e,t,n){const r=e>=0?e:Hh(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function zC(e){return Ba(e)?e:Ga(+e)}function RC(){var e=e=>e[0],t=e=>e[1],n=ra,r=[-1,-1],i=960,o=500,a=2;function s(s,l){const u=TC(r[0],s,e)>>a,c=TC(r[1],s,t)>>a,f=u?u+2:0,d=c?c+2:0,h=2*f+(i>>a),p=2*d+(o>>a),m=new Float32Array(h*p),g=new Float32Array(h*p);let y=m;s.forEach((r=>{const i=f+(+e(r)>>a),o=d+(+t(r)>>a);i>=0&&i<h&&o>=0&&o<p&&(m[i+o*h]+=+n(r))})),u>0&&c>0?(LC(h,p,m,g,u),BC(h,p,g,m,c),LC(h,p,m,g,u),BC(h,p,g,m,c),LC(h,p,m,g,u),BC(h,p,g,m,c)):u>0?(LC(h,p,m,g,u),LC(h,p,g,m,u),LC(h,p,m,g,u),y=g):c>0&&(BC(h,p,m,g,c),BC(h,p,g,m,c),BC(h,p,m,g,c),y=g);const v=l?Math.pow(2,-2*a):1/kl(y);for(let e=0,t=h*p;e<t;++e)y[e]*=v;return{values:y,scale:1<<a,width:h,height:p,x1:f,y1:d,x2:f+(i>>a),y2:d+(o>>a)}}return s.x=function(t){return arguments.length?(e=zC(t),s):e},s.y=function(e){return arguments.length?(t=zC(e),s):t},s.weight=function(e){return arguments.length?(n=zC(e),s):n},s.size=function(e){if(!arguments.length)return[i,o];var t=+e[0],n=+e[1];return t>=0&&n>=0||Jo("invalid size"),i=t,o=n,s},s.cellSize=function(e){return arguments.length?((e=+e)>=1||Jo("invalid cell size"),a=Math.floor(Math.log(e)/Math.LN2),s):1<<a},s.bandwidth=function(e){return arguments.length?(1===(e=Ra(e)).length&&(e=[+e[0],+e[0]]),2!==e.length&&Jo("invalid bandwidth"),r=e,s):r},s}function LC(e,t,n,r,i){const o=1+(i<<1);for(let a=0;a<t;++a)for(let t=0,s=0;t<e+i;++t)t<e&&(s+=n[t+a*e]),t>=i&&(t>=o&&(s-=n[t-o+a*e]),r[t-i+a*e]=s/Math.min(t+1,e-1+o-t,o))}function BC(e,t,n,r,i){const o=1+(i<<1);for(let a=0;a<e;++a)for(let s=0,l=0;s<t+i;++s)s<t&&(l+=n[a+s*e]),s>=i&&(s>=o&&(l-=n[a+(s-o)*e]),r[a+(s-i)*e]=l/Math.min(s+1,t-1+o-s,o))}function IC(e){Lh.call(this,null,e)}PC.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},rs(PC,Lh,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=e.field||ta,o=SC().smooth(!1!==e.smooth),a=e.thresholds||function(e,t,n){const r=MC(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?r:r(e.map((e=>hl(t(e).values))))}(r,i,e),s=null===e.as?null:e.as||"contour",l=[];return r.forEach((t=>{const n=i(t),r=o.size([n.width,n.height])(n.values,ha(a)?a:a(n.values));!function(e,t,n,r){let i=r.scale||t.scale,o=r.translate||t.translate;Ba(i)&&(i=i(n,r));Ba(o)&&(o=o(n,r));if((1===i||null==i)&&!o)return;const a=(ls(i)?i:i[0])||1,s=(ls(i)?i:i[1])||1,l=o&&o[0]||0,u=o&&o[1]||0;e.forEach(FC(t,a,s,l,u))}(r,n,t,e),r.forEach((e=>{l.push(ch(t,lh(null!=s?{[s]:e}:e)))}))})),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}}),IC.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const UC=["x","y","weight","size","cellSize","bandwidth"];function qC(e,t){return UC.forEach((n=>null!=t[n]?e[n](t[n]):0)),e}function WC(e){Lh.call(this,null,e)}rs(IC,Lh,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=function(e,t){var n,r,i,o,a,s,l=[],u=e=>e(o);if(null==t)l.push(e);else for(n={},r=0,i=e.length;r<i;++r)o=e[r],(s=n[a=t.map(u)])||(n[a]=s=[],s.dims=a,l.push(s)),s.push(o);return l}(t.materialize(t.SOURCE).source,e.groupby),o=(e.groupby||[]).map(Ho),a=qC(RC(),e),s=e.as||"grid";return n=i.map((t=>lh(function(e,t){for(let n=0;n<o.length;++n)e[o[n]]=t[n];return e}({[s]:a(t,e.counts)},t.dims)))),this.value&&(r.rem=this.value),this.value=r.source=r.add=n,r}}),WC.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},rs(WC,Lh,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n,r,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),o=SC().smooth(!1!==e.smooth),a=e.values,s=e.thresholds||MC(e.count||10,e.nice,!!a),l=e.size;return a||(a=t.materialize(t.SOURCE).source,r=FC(n=qC(RC(),e)(a,!0),n.scale||1,n.scale||1,0,0),l=[n.width,n.height],a=n.values),s=ha(s)?s:s(a),a=o.size(l)(a,s),r&&a.forEach(r),this.value&&(i.rem=this.value),this.value=i.source=i.add=(a||[]).map(lh),i}});const ZC="Feature",HC="FeatureCollection";function GC(e){Lh.call(this,null,e)}function VC(e){Lh.call(this,null,e)}function YC(e){Lh.call(this,null,e)}function XC(e){Lh.call(this,null,e)}function JC(e){Lh.call(this,[],e),this.generator=function(){var e,t,n,r,i,o,a,s,l,u,c,f,d=10,h=d,p=90,m=360,g=2.5;function y(){return{type:"MultiLineString",coordinates:v()}}function v(){return wl(bN(r/p)*p,n,p).map(c).concat(wl(bN(s/m)*m,a,m).map(f)).concat(wl(bN(t/d)*d,e,d).filter((function(e){return mN(e%p)>sN})).map(l)).concat(wl(bN(o/h)*h,i,h).filter((function(e){return mN(e%m)>sN})).map(u))}return y.lines=function(){return v().map((function(e){return{type:"LineString",coordinates:e}}))},y.outline=function(){return{type:"Polygon",coordinates:[c(r).concat(f(a).slice(1),c(n).reverse().slice(1),f(s).reverse().slice(1))]}},y.extent=function(e){return arguments.length?y.extentMajor(e).extentMinor(e):y.extentMinor()},y.extentMajor=function(e){return arguments.length?(r=+e[0][0],n=+e[1][0],s=+e[0][1],a=+e[1][1],r>n&&(e=r,r=n,n=e),s>a&&(e=s,s=a,a=e),y.precision(g)):[[r,s],[n,a]]},y.extentMinor=function(n){return arguments.length?(t=+n[0][0],e=+n[1][0],o=+n[0][1],i=+n[1][1],t>e&&(n=t,t=e,e=n),o>i&&(n=o,o=i,i=n),y.precision(g)):[[t,o],[e,i]]},y.step=function(e){return arguments.length?y.stepMajor(e).stepMinor(e):y.stepMinor()},y.stepMajor=function(e){return arguments.length?(p=+e[0],m=+e[1],y):[p,m]},y.stepMinor=function(e){return arguments.length?(d=+e[0],h=+e[1],y):[d,h]},y.precision=function(d){return arguments.length?(g=+d,l=vA(o,i,90),u=bA(t,e,g),c=vA(s,a,90),f=bA(r,n,g),y):g},y.extentMajor([[-180,-90+sN],[180,90-sN]]).extentMinor([[-180,-80-sN],[180,80+sN]])}()}function QC(e){Lh.call(this,null,e)}function KC(e){if(!Ba(e))return!1;const t=_s(Go(e));return t.$x||t.$y||t.$value||t.$max}function eM(e){Lh.call(this,null,e),this.modified(!0)}function tM(e,t,n){Ba(e[t])&&e[t](n)}GC.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},rs(GC,Lh,{transform(e,t){var n,r=this._features,i=this._points,o=e.fields,a=o&&o[0],s=o&&o[1],l=e.geojson||!o&&ta,u=t.ADD;n=e.modified()||t.changed(t.REM)||t.modified(Go(l))||a&&t.modified(Go(a))||s&&t.modified(Go(s)),this.value&&!n||(u=t.SOURCE,this._features=r=[],this._points=i=[]),l&&t.visit(u,(e=>r.push(l(e)))),a&&s&&(t.visit(u,(e=>{var t=a(e),n=s(e);null!=t&&null!=n&&(t=+t)===t&&(n=+n)===n&&i.push([t,n])})),r=r.concat({type:ZC,geometry:{type:"MultiPoint",coordinates:i}})),this.value={type:HC,features:r}}}),VC.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},rs(VC,Lh,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||ta,o=e.as||"path",a=n.SOURCE;!r||e.modified()?(this.value=r=EC(e.projection),n.materialize().reflow()):a=i===ta||t.modified(i.fields)?n.ADD_MOD:n.ADD;const s=function(e,t){const n=e.pointRadius();e.context(null),null!=t&&e.pointRadius(t);return n}(r,e.pointRadius);return n.visit(a,(e=>e[o]=r(i(e)))),r.pointRadius(s),n.modifies(o)}}),YC.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},rs(YC,Lh,{transform(e,t){var n,r=e.projection,i=e.fields[0],o=e.fields[1],a=e.as||["x","y"],s=a[0],l=a[1];function u(e){const t=r([i(e),o(e)]);t?(e[s]=t[0],e[l]=t[1]):(e[s]=void 0,e[l]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,u):(n=t.modified(i.fields)||t.modified(o.fields),t.visit(n?t.ADD_MOD:t.ADD,u)),t.modifies(a)}}),XC.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},rs(XC,Lh,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.as||"shape",o=n.ADD;return r&&!e.modified()||(this.value=r=function(e,t,n){const r=null==n?n=>e(t(n)):r=>{var i=e.pointRadius(),o=e.pointRadius(n)(t(r));return e.pointRadius(i),o};return r.context=t=>(e.context(t),r),r}(EC(e.projection),e.field||Ko("datum"),e.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,(e=>e[i]=r)),n.modifies(i)}}),JC.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},rs(JC,Lh,{transform(e,t){var n,r=this.value,i=this.generator;if(!r.length||e.modified())for(const o in e)Ba(i[o])&&i[o](e[o]);return n=i(),r.length?t.mod.push(fh(r[0],n)):t.add.push(lh(n)),r[0]=n,t}}),QC.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},rs(QC,Lh,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r="shared"===e.resolve,i=e.field||ta,o=function(e,t){let n;Ba(e)?(n=n=>e(n,t),n.dep=KC(e)):e?n=Ga(e):(n=e=>e.$value/e.$max||0,n.dep=!0);return n}(e.opacity,e),a=function(e,t){let n;Ba(e)?(n=n=>Yy(e(n,t)),n.dep=KC(e)):n=Ga(Yy(e||"#888"));return n}(e.color,e),s=e.as||"image",l={$x:0,$y:0,$value:0,$max:r?hl(n.map((e=>hl(i(e).values)))):0};return n.forEach((e=>{const t=i(e),n=Ya({},e,l);r||(n.$max=hl(t.values||[])),e[s]=function(e,t,n,r){const i=e.width,o=e.height,a=e.x1||0,s=e.y1||0,l=e.x2||i,u=e.y2||o,c=e.values,f=c?e=>c[e]:na,d=wy(l-a,u-s),h=d.getContext("2d"),p=h.getImageData(0,0,l-a,u-s),m=p.data;for(let g=s,y=0;g<u;++g){t.$y=g-s;for(let e=a,o=g*i;e<l;++e,y+=4){t.$x=e-a,t.$value=f(e+o);const i=n(t);m[y+0]=i.r,m[y+1]=i.g,m[y+2]=i.b,m[y+3]=~~(255*r(t))}}return h.putImageData(p,0,0),d}(t,n,a.dep?a:Ga(a(n)),o.dep?o:Ga(o(n)))})),t.reflow(!0).modifies(s)}}),rs(eM,Lh,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=function(e){const t=OC((e||"mercator").toLowerCase());t||Jo("Unrecognized projection type: "+e);return t()}(e.type),_C.forEach((t=>{null!=e[t]&&tM(n,t,e[t])}))):_C.forEach((t=>{e.modified(t)&&tM(n,t,e[t])})),null!=e.pointRadius&&n.path.pointRadius(e.pointRadius),e.fit&&function(e,t){const n=function(e){return e=Ra(e),1===e.length?e[0]:{type:HC,features:e.reduce(((e,t)=>e.concat(function(e){return e.type===HC?e.features:Ra(e).filter((e=>null!=e)).map((e=>e.type===ZC?e:{type:ZC,geometry:e}))}(t))),[])}}(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});var nM=Object.freeze({__proto__:null,contour:WC,geojson:GC,geopath:VC,geopoint:YC,geoshape:XC,graticule:JC,heatmap:QC,isocontour:PC,kde2d:IC,projection:eM});function rM(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,o,a,s,l,u,c,f,d,h=e._root,p={data:r},m=e._x0,g=e._y0,y=e._x1,v=e._y1;if(!h)return e._root=p,e;for(;h.length;)if((u=t>=(o=(m+y)/2))?m=o:y=o,(c=n>=(a=(g+v)/2))?g=a:v=a,i=h,!(h=h[f=c<<1|u]))return i[f]=p,e;if(s=+e._x.call(null,h.data),l=+e._y.call(null,h.data),t===s&&n===l)return p.next=h,i?i[f]=p:e._root=p,e;do{i=i?i[f]=new Array(4):e._root=new Array(4),(u=t>=(o=(m+y)/2))?m=o:y=o,(c=n>=(a=(g+v)/2))?g=a:v=a}while((f=c<<1|u)==(d=(l>=a)<<1|s>=o));return i[d]=h,i[f]=p,e}function iM(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function oM(e){return e[0]}function aM(e){return e[1]}function sM(e,t,n){var r=new lM(null==t?oM:t,null==n?aM:n,NaN,NaN,NaN,NaN);return null==e?r:r.addAll(e)}function lM(e,t,n,r,i,o){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function uM(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var cM=sM.prototype=lM.prototype;function fM(e){return function(){return e}}function dM(e){return 1e-6*(e()-.5)}function hM(e){return e.x+e.vx}function pM(e){return e.y+e.vy}function mM(e){return e.index}function gM(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}cM.copy=function(){var e,t,n=new lM(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=uM(r),n;for(e=[{source:r,target:n._root=new Array(4)}];r=e.pop();)for(var i=0;i<4;++i)(t=r.source[i])&&(t.length?e.push({source:t,target:r.target[i]=new Array(4)}):r.target[i]=uM(t));return n},cM.add=function(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return rM(this.cover(t,n),t,n,e)},cM.addAll=function(e){var t,n,r,i,o=e.length,a=new Array(o),s=new Array(o),l=1/0,u=1/0,c=-1/0,f=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(i=+this._y.call(null,t))||(a[n]=r,s[n]=i,r<l&&(l=r),r>c&&(c=r),i<u&&(u=i),i>f&&(f=i));if(l>c||u>f)return this;for(this.cover(l,u).cover(c,f),n=0;n<o;++n)rM(this,a[n],s[n],e[n]);return this},cM.cover=function(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,o=(r=Math.floor(t))+1;else{for(var a,s,l=i-n||1,u=this._root;n>e||e>=i||r>t||t>=o;)switch(s=(t<r)<<1|e<n,(a=new Array(4))[s]=u,u=a,l*=2,s){case 0:i=n+l,o=r+l;break;case 1:n=i-l,o=r+l;break;case 2:i=n+l,r=o-l;break;case 3:n=i-l,r=o-l}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},cM.data=function(){var e=[];return this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)})),e},cM.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},cM.find=function(e,t,n){var r,i,o,a,s,l,u,c=this._x0,f=this._y0,d=this._x1,h=this._y1,p=[],m=this._root;for(m&&p.push(new iM(m,c,f,d,h)),null==n?n=1/0:(c=e-n,f=t-n,d=e+n,h=t+n,n*=n);l=p.pop();)if(!(!(m=l.node)||(i=l.x0)>d||(o=l.y0)>h||(a=l.x1)<c||(s=l.y1)<f))if(m.length){var g=(i+a)/2,y=(o+s)/2;p.push(new iM(m[3],g,y,a,s),new iM(m[2],i,y,g,s),new iM(m[1],g,o,a,y),new iM(m[0],i,o,g,y)),(u=(t>=y)<<1|e>=g)&&(l=p[p.length-1],p[p.length-1]=p[p.length-1-u],p[p.length-1-u]=l)}else{var v=e-+this._x.call(null,m.data),b=t-+this._y.call(null,m.data),x=v*v+b*b;if(x<n){var w=Math.sqrt(n=x);c=e-w,f=t-w,d=e+w,h=t+w,r=m.data}}return r},cM.remove=function(e){if(isNaN(o=+this._x.call(null,e))||isNaN(a=+this._y.call(null,e)))return this;var t,n,r,i,o,a,s,l,u,c,f,d,h=this._root,p=this._x0,m=this._y0,g=this._x1,y=this._y1;if(!h)return this;if(h.length)for(;;){if((u=o>=(s=(p+g)/2))?p=s:g=s,(c=a>=(l=(m+y)/2))?m=l:y=l,t=h,!(h=h[f=c<<1|u]))return this;if(!h.length)break;(t[f+1&3]||t[f+2&3]||t[f+3&3])&&(n=t,d=f)}for(;h.data!==e;)if(r=h,!(h=h.next))return this;return(i=h.next)&&delete h.next,r?(i?r.next=i:delete r.next,this):t?(i?t[f]=i:delete t[f],(h=t[0]||t[1]||t[2]||t[3])&&h===(t[3]||t[2]||t[1]||t[0])&&!h.length&&(n?n[d]=h:this._root=h),this):(this._root=i,this)},cM.removeAll=function(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},cM.root=function(){return this._root},cM.size=function(){var e=0;return this.visit((function(t){if(!t.length)do{++e}while(t=t.next)})),e},cM.visit=function(e){var t,n,r,i,o,a,s=[],l=this._root;for(l&&s.push(new iM(l,this._x0,this._y0,this._x1,this._y1));t=s.pop();)if(!e(l=t.node,r=t.x0,i=t.y0,o=t.x1,a=t.y1)&&l.length){var u=(r+o)/2,c=(i+a)/2;(n=l[3])&&s.push(new iM(n,u,c,o,a)),(n=l[2])&&s.push(new iM(n,r,c,u,a)),(n=l[1])&&s.push(new iM(n,u,i,o,c)),(n=l[0])&&s.push(new iM(n,r,i,u,c))}return this},cM.visitAfter=function(e){var t,n=[],r=[];for(this._root&&n.push(new iM(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var i=t.node;if(i.length){var o,a=t.x0,s=t.y0,l=t.x1,u=t.y1,c=(a+l)/2,f=(s+u)/2;(o=i[0])&&n.push(new iM(o,a,s,c,f)),(o=i[1])&&n.push(new iM(o,c,s,l,f)),(o=i[2])&&n.push(new iM(o,a,f,c,u)),(o=i[3])&&n.push(new iM(o,c,f,l,u))}r.push(t)}for(;t=r.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this},cM.x=function(e){return arguments.length?(this._x=e,this):this._x},cM.y=function(e){return arguments.length?(this._y=e,this):this._y};var yM={value:()=>{}};function vM(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new bM(r)}function bM(e){this._=e}function xM(e,t){for(var n,r=0,i=e.length;r<i;++r)if((n=e[r]).name===t)return n.value}function wM(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=yM,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}bM.prototype=vM.prototype={constructor:bM,on:function(e,t){var n,r=this._,i=function(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}(e+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++o<a;)if(n=(e=i[o]).type)r[n]=wM(r[n],e.name,t);else if(null==t)for(n in r)r[n]=wM(r[n],e.name,null);return this}for(;++o<a;)if((n=(e=i[o]).type)&&(n=xM(r[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new bM(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=0,n=(r=this._[e]).length;o<n;++o)r[o].value.apply(t,i)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};var kM,_M,OM=0,EM=0,DM=0,jM=1e3,NM=0,SM=0,AM=0,$M="object"==typeof performance&&performance.now?performance:Date,CM="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function MM(){return SM||(CM(PM),SM=$M.now()+AM)}function PM(){SM=0}function FM(){this._call=this._time=this._next=null}function TM(e,t,n){var r=new FM;return r.restart(e,t,n),r}function zM(){SM=(NM=$M.now())+AM,OM=EM=0;try{!function(){MM(),++OM;for(var e,t=kM;t;)(e=SM-t._time)>=0&&t._call.call(void 0,e),t=t._next;--OM}()}finally{OM=0,function(){var e,t,n=kM,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:kM=t);_M=e,LM(r)}(),SM=0}}function RM(){var e=$M.now(),t=e-NM;t>jM&&(AM-=t,NM=e)}function LM(e){OM||(EM&&(EM=clearTimeout(EM)),e-SM>24?(e<1/0&&(EM=setTimeout(zM,e-$M.now()-AM)),DM&&(DM=clearInterval(DM))):(DM||(NM=$M.now(),DM=setInterval(RM,jM)),OM=1,CM(zM)))}FM.prototype=TM.prototype={constructor:FM,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?MM():+n)+(null==t?0:+t),this._next||_M===this||(_M?_M._next=this:kM=this,_M=this),this._call=e,this._time=n,LM()},stop:function(){this._call&&(this._call=null,this._time=1/0,LM())}};const BM=1664525,IM=1013904223,UM=4294967296;function qM(e){return e.x}function WM(e){return e.y}var ZM=10,HM=Math.PI*(3-Math.sqrt(5));function GM(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=new Map,l=TM(f),u=vM("tick","end"),c=function(){let e=1;return()=>(e=(BM*e+IM)%UM)/UM}();function f(){d(),u.call("tick",t),n<r&&(l.stop(),u.call("end",t))}function d(r){var l,u,c=e.length;void 0===r&&(r=1);for(var f=0;f<r;++f)for(n+=(o-n)*i,s.forEach((function(e){e(n)})),l=0;l<c;++l)null==(u=e[l]).fx?u.x+=u.vx*=a:(u.x=u.fx,u.vx=0),null==u.fy?u.y+=u.vy*=a:(u.y=u.fy,u.vy=0);return t}function h(){for(var t,n=0,r=e.length;n<r;++n){if((t=e[n]).index=n,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),isNaN(t.x)||isNaN(t.y)){var i=ZM*Math.sqrt(.5+n),o=n*HM;t.x=i*Math.cos(o),t.y=i*Math.sin(o)}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0)}}function p(t){return t.initialize&&t.initialize(e,c),t}return null==e&&(e=[]),h(),t={tick:d,restart:function(){return l.restart(f),t},stop:function(){return l.stop(),t},nodes:function(n){return arguments.length?(e=n,h(),s.forEach(p),t):e},alpha:function(e){return arguments.length?(n=+e,t):n},alphaMin:function(e){return arguments.length?(r=+e,t):r},alphaDecay:function(e){return arguments.length?(i=+e,t):+i},alphaTarget:function(e){return arguments.length?(o=+e,t):o},velocityDecay:function(e){return arguments.length?(a=1-e,t):1-a},randomSource:function(e){return arguments.length?(c=e,s.forEach(p),t):c},force:function(e,n){return arguments.length>1?(null==n?s.delete(e):s.set(e,p(n)),t):s.get(e)},find:function(t,n,r){var i,o,a,s,l,u=0,c=e.length;for(null==r?r=1/0:r*=r,u=0;u<c;++u)(a=(i=t-(s=e[u]).x)*i+(o=n-s.y)*o)<r&&(l=s,r=a);return l},on:function(e,n){return arguments.length>1?(u.on(e,n),t):u.on(e)}}}const VM={center:function(e,t){var n,r=1;function i(){var i,o,a=n.length,s=0,l=0;for(i=0;i<a;++i)s+=(o=n[i]).x,l+=o.y;for(s=(s/a-e)*r,l=(l/a-t)*r,i=0;i<a;++i)(o=n[i]).x-=s,o.y-=l}return null==e&&(e=0),null==t&&(t=0),i.initialize=function(e){n=e},i.x=function(t){return arguments.length?(e=+t,i):e},i.y=function(e){return arguments.length?(t=+e,i):t},i.strength=function(e){return arguments.length?(r=+e,i):r},i},collide:function(e){var t,n,r,i=1,o=1;function a(){for(var e,a,l,u,c,f,d,h=t.length,p=0;p<o;++p)for(a=sM(t,hM,pM).visitAfter(s),e=0;e<h;++e)l=t[e],f=n[l.index],d=f*f,u=l.x+l.vx,c=l.y+l.vy,a.visit(m);function m(e,t,n,o,a){var s=e.data,h=e.r,p=f+h;if(!s)return t>u+p||o<u-p||n>c+p||a<c-p;if(s.index>l.index){var m=u-s.x-s.vx,g=c-s.y-s.vy,y=m*m+g*g;y<p*p&&(0===m&&(y+=(m=dM(r))*m),0===g&&(y+=(g=dM(r))*g),y=(p-(y=Math.sqrt(y)))/y*i,l.vx+=(m*=y)*(p=(h*=h)/(d+h)),l.vy+=(g*=y)*p,s.vx-=m*(p=1-p),s.vy-=g*p)}}}function s(e){if(e.data)return e.r=n[e.data.index];for(var t=e.r=0;t<4;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function l(){if(t){var r,i,o=t.length;for(n=new Array(o),r=0;r<o;++r)i=t[r],n[i.index]=+e(i,r,t)}}return"function"!=typeof e&&(e=fM(null==e?1:+e)),a.initialize=function(e,n){t=e,r=n,l()},a.iterations=function(e){return arguments.length?(o=+e,a):o},a.strength=function(e){return arguments.length?(i=+e,a):i},a.radius=function(t){return arguments.length?(e="function"==typeof t?t:fM(+t),l(),a):e},a},nbody:function(){var e,t,n,r,i,o=fM(-30),a=1,s=1/0,l=.81;function u(n){var i,o=e.length,a=sM(e,qM,WM).visitAfter(f);for(r=n,i=0;i<o;++i)t=e[i],a.visit(d)}function c(){if(e){var t,n,r=e.length;for(i=new Array(r),t=0;t<r;++t)n=e[t],i[n.index]=+o(n,t,e)}}function f(e){var t,n,r,o,a,s=0,l=0;if(e.length){for(r=o=a=0;a<4;++a)(t=e[a])&&(n=Math.abs(t.value))&&(s+=t.value,l+=n,r+=n*t.x,o+=n*t.y);e.x=r/l,e.y=o/l}else{(t=e).x=t.data.x,t.y=t.data.y;do{s+=i[t.data.index]}while(t=t.next)}e.value=s}function d(e,o,u,c){if(!e.value)return!0;var f=e.x-t.x,d=e.y-t.y,h=c-o,p=f*f+d*d;if(h*h/l<p)return p<s&&(0===f&&(p+=(f=dM(n))*f),0===d&&(p+=(d=dM(n))*d),p<a&&(p=Math.sqrt(a*p)),t.vx+=f*e.value*r/p,t.vy+=d*e.value*r/p),!0;if(!(e.length||p>=s)){(e.data!==t||e.next)&&(0===f&&(p+=(f=dM(n))*f),0===d&&(p+=(d=dM(n))*d),p<a&&(p=Math.sqrt(a*p)));do{e.data!==t&&(h=i[e.data.index]*r/p,t.vx+=f*h,t.vy+=d*h)}while(e=e.next)}}return u.initialize=function(t,r){e=t,n=r,c()},u.strength=function(e){return arguments.length?(o="function"==typeof e?e:fM(+e),c(),u):o},u.distanceMin=function(e){return arguments.length?(a=e*e,u):Math.sqrt(a)},u.distanceMax=function(e){return arguments.length?(s=e*e,u):Math.sqrt(s)},u.theta=function(e){return arguments.length?(l=e*e,u):Math.sqrt(l)},u},link:function(e){var t,n,r,i,o,a,s=mM,l=function(e){return 1/Math.min(i[e.source.index],i[e.target.index])},u=fM(30),c=1;function f(r){for(var i=0,s=e.length;i<c;++i)for(var l,u,f,d,h,p,m,g=0;g<s;++g)u=(l=e[g]).source,d=(f=l.target).x+f.vx-u.x-u.vx||dM(a),h=f.y+f.vy-u.y-u.vy||dM(a),d*=p=((p=Math.sqrt(d*d+h*h))-n[g])/p*r*t[g],h*=p,f.vx-=d*(m=o[g]),f.vy-=h*m,u.vx+=d*(m=1-m),u.vy+=h*m}function d(){if(r){var a,l,u=r.length,c=e.length,f=new Map(r.map(((e,t)=>[s(e,t,r),e])));for(a=0,i=new Array(u);a<c;++a)(l=e[a]).index=a,"object"!=typeof l.source&&(l.source=gM(f,l.source)),"object"!=typeof l.target&&(l.target=gM(f,l.target)),i[l.source.index]=(i[l.source.index]||0)+1,i[l.target.index]=(i[l.target.index]||0)+1;for(a=0,o=new Array(c);a<c;++a)l=e[a],o[a]=i[l.source.index]/(i[l.source.index]+i[l.target.index]);t=new Array(c),h(),n=new Array(c),p()}}function h(){if(r)for(var n=0,i=e.length;n<i;++n)t[n]=+l(e[n],n,e)}function p(){if(r)for(var t=0,i=e.length;t<i;++t)n[t]=+u(e[t],t,e)}return null==e&&(e=[]),f.initialize=function(e,t){r=e,a=t,d()},f.links=function(t){return arguments.length?(e=t,d(),f):e},f.id=function(e){return arguments.length?(s=e,f):s},f.iterations=function(e){return arguments.length?(c=+e,f):c},f.strength=function(e){return arguments.length?(l="function"==typeof e?e:fM(+e),h(),f):l},f.distance=function(e){return arguments.length?(u="function"==typeof e?e:fM(+e),p(),f):u},f},x:function(e){var t,n,r,i=fM(.1);function o(e){for(var i,o=0,a=t.length;o<a;++o)(i=t[o]).vx+=(r[o]-i.x)*n[o]*e}function a(){if(t){var o,a=t.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+e(t[o],o,t))?0:+i(t[o],o,t)}}return"function"!=typeof e&&(e=fM(null==e?0:+e)),o.initialize=function(e){t=e,a()},o.strength=function(e){return arguments.length?(i="function"==typeof e?e:fM(+e),a(),o):i},o.x=function(t){return arguments.length?(e="function"==typeof t?t:fM(+t),a(),o):e},o},y:function(e){var t,n,r,i=fM(.1);function o(e){for(var i,o=0,a=t.length;o<a;++o)(i=t[o]).vy+=(r[o]-i.y)*n[o]*e}function a(){if(t){var o,a=t.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+e(t[o],o,t))?0:+i(t[o],o,t)}}return"function"!=typeof e&&(e=fM(null==e?0:+e)),o.initialize=function(e){t=e,a()},o.strength=function(e){return arguments.length?(i="function"==typeof e?e:fM(+e),a(),o):i},o.y=function(t){return arguments.length?(e="function"==typeof t?t:fM(+t),a(),o):e},o}},YM="forces",XM=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],JM=["static","iterations"],QM=["x","y","vx","vy"];function KM(e){Lh.call(this,null,e)}function eP(e,t,n,r){var i,o,a,s,l=Ra(t.forces);for(i=0,o=XM.length;i<o;++i)(a=XM[i])!==YM&&t.modified(a)&&e[a](t[a]);for(i=0,o=l.length;i<o;++i)s=YM+i,(a=n||t.modified(YM,i)?nP(l[i]):r&&tP(l[i],r)?e.force(s):null)&&e.force(s,a);for(o=e.numForces||0;i<o;++i)e.force(YM+i,null);return e.numForces=l.length,e}function tP(e,t){var n,r;for(n in e)if(Ba(r=e[n])&&t.modified(Go(r)))return 1;return 0}function nP(e){var t,n;for(n in Ka(VM,e.force)||Jo("Unrecognized force: "+e.force),t=VM[e.force](),e)Ba(t[n])&&rP(t[n],e[n],e);return t}function rP(e,t,n){e(Ba(t)?e=>t(e,n):t)}KM.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30,expr:!0},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:QM}]},rs(KM,Lh,{transform(e,t){var n,r,i=this.value,o=t.changed(t.ADD_REM),a=e.modified(XM),s=e.iterations||300;if(i?(o&&(t.modifies("index"),i.nodes(t.source)),(a||t.changed(t.MOD))&&eP(i,e,0,t)):(this.value=i=function(e,t){const n=GM(e),r=n.stop,i=n.restart;let o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,i()),n.stop=()=>(o=!0,r()),eP(n,t,!0).on("end",(()=>o=!0))}(t.source,e),i.on("tick",(n=t.dataflow,r=this,()=>n.touch(r).run())),e.static||(o=!0,i.tick()),t.modifies("index")),a||o||e.modified(JM)||t.changed()&&e.restart)if(i.alpha(Math.max(i.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(i.alphaMin(),1/s)),e.static)for(i.stop();--s>=0;)i.tick();else if(i.stopped()&&i.restart(),!o)return t.StopPropagation;return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let s,l=this._argops,u=0,c=l.length;u<c;++u)if(s=l[u],s.name===YM&&"link"===s.op._argval.force)for(var r,i=s.op._argops,o=0,a=i.length;o<a;++o)if("links"===i[o].name&&(r=i[o].op.source)){n.pulse(r,n.changeset().reflow());break}return t.reflow(e.modified()).modifies(QM)}});var iP=Object.freeze({__proto__:null,force:KM});function oP(e,t){return e.parent===t.parent?1:2}function aP(e,t){return e+t.x}function sP(e,t){return Math.max(e,t.y)}function lP(e){var t=0,n=e.children,r=n&&n.length;if(r)for(;--r>=0;)t+=n[r].value;else t=1;e.value=t}function uP(e,t){e instanceof Map?(e=[void 0,e],void 0===t&&(t=fP)):void 0===t&&(t=cP);for(var n,r,i,o,a,s=new pP(e),l=[s];n=l.pop();)if((i=t(n.data))&&(a=(i=Array.from(i)).length))for(n.children=i,o=a-1;o>=0;--o)l.push(r=i[o]=new pP(i[o])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(hP)}function cP(e){return e.children}function fP(e){return Array.isArray(e)?e[1]:null}function dP(e){void 0!==e.data.value&&(e.value=e.data.value),e.data=e.data.data}function hP(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function pP(e){this.data=e,this.depth=this.height=0,this.parent=null}function mP(e){return null==e?null:gP(e)}function gP(e){if("function"!=typeof e)throw new Error;return e}function yP(){return 0}function vP(e){return function(){return e}}pP.prototype=uP.prototype={constructor:pP,count:function(){return this.eachAfter(lP)},each:function(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this},eachAfter:function(e,t){for(var n,r,i,o=this,a=[o],s=[],l=-1;o=a.pop();)if(s.push(o),n=o.children)for(r=0,i=n.length;r<i;++r)a.push(n[r]);for(;o=s.pop();)e.call(t,o,++l,this);return this},eachBefore:function(e,t){for(var n,r,i=this,o=[i],a=-1;i=o.pop();)if(e.call(t,i,++a,this),n=i.children)for(r=n.length-1;r>=0;--r)o.push(n[r]);return this},find:function(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r},sum:function(e){return this.eachAfter((function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n}))},sort:function(e){return this.eachBefore((function(t){t.children&&t.children.sort(e)}))},path:function(e){for(var t=this,n=function(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;e=n.pop(),t=r.pop();for(;e===t;)i=e,e=n.pop(),t=r.pop();return i}(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){return Array.from(this)},leaves:function(){var e=[];return this.eachBefore((function(t){t.children||e.push(t)})),e},links:function(){var e=this,t=[];return e.each((function(n){n!==e&&t.push({source:n.parent,target:n})})),t},copy:function(){return uP(this).eachBefore(dP)},[Symbol.iterator]:function*(){var e,t,n,r,i=this,o=[i];do{for(e=o.reverse(),o=[];i=e.pop();)if(yield i,t=i.children)for(n=0,r=t.length;n<r;++n)o.push(t[n])}while(o.length)}};const bP=1664525,xP=1013904223,wP=4294967296;function kP(e,t){var n,r;if(EP(t,e))return[t];for(n=0;n<e.length;++n)if(_P(t,e[n])&&EP(jP(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(_P(jP(e[n],e[r]),t)&&_P(jP(e[n],t),e[r])&&_P(jP(e[r],t),e[n])&&EP(NP(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function _P(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function OP(e,t){var n=e.r-t.r+1e-9*Math.max(e.r,t.r,1),r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function EP(e,t){for(var n=0;n<t.length;++n)if(!OP(e,t[n]))return!1;return!0}function DP(e){switch(e.length){case 1:return function(e){return{x:e.x,y:e.y,r:e.r}}(e[0]);case 2:return jP(e[0],e[1]);case 3:return NP(e[0],e[1],e[2])}}function jP(e,t){var n=e.x,r=e.y,i=e.r,o=t.x,a=t.y,s=t.r,l=o-n,u=a-r,c=s-i,f=Math.sqrt(l*l+u*u);return{x:(n+o+l/f*c)/2,y:(r+a+u/f*c)/2,r:(f+i+s)/2}}function NP(e,t,n){var r=e.x,i=e.y,o=e.r,a=t.x,s=t.y,l=t.r,u=n.x,c=n.y,f=n.r,d=r-a,h=r-u,p=i-s,m=i-c,g=l-o,y=f-o,v=r*r+i*i-o*o,b=v-a*a-s*s+l*l,x=v-u*u-c*c+f*f,w=h*p-d*m,k=(p*x-m*b)/(2*w)-r,_=(m*g-p*y)/w,O=(h*b-d*x)/(2*w)-i,E=(d*y-h*g)/w,D=_*_+E*E-1,j=2*(o+k*_+O*E),N=k*k+O*O-o*o,S=-(Math.abs(D)>1e-6?(j+Math.sqrt(j*j-4*D*N))/(2*D):N/j);return{x:r+k+_*S,y:i+O+E*S,r:S}}function SP(e,t,n){var r,i,o,a,s=e.x-t.x,l=e.y-t.y,u=s*s+l*l;u?(i=t.r+n.r,i*=i,a=e.r+n.r,i>(a*=a)?(r=(u+a-i)/(2*u),o=Math.sqrt(Math.max(0,a/u-r*r)),n.x=e.x-r*s-o*l,n.y=e.y-r*l+o*s):(r=(u+i-a)/(2*u),o=Math.sqrt(Math.max(0,i/u-r*r)),n.x=t.x+r*s-o*l,n.y=t.y+r*l+o*s)):(n.x=t.x+n.r,n.y=t.y)}function AP(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function $P(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,o=(t.y*n.r+n.y*t.r)/r;return i*i+o*o}function CP(e){this._=e,this.next=null,this.previous=null}function MP(e,t){if(!(o=(e=function(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}(e)).length))return 0;var n,r,i,o,a,s,l,u,c,f,d;if((n=e[0]).x=0,n.y=0,!(o>1))return n.r;if(r=e[1],n.x=-r.r,r.x=n.r,r.y=0,!(o>2))return n.r+r.r;SP(r,n,i=e[2]),n=new CP(n),r=new CP(r),i=new CP(i),n.next=i.previous=r,r.next=n.previous=i,i.next=r.previous=n;e:for(l=3;l<o;++l){SP(n._,r._,i=e[l]),i=new CP(i),u=r.next,c=n.previous,f=r._.r,d=n._.r;do{if(f<=d){if(AP(u._,i._)){r=u,n.next=r,r.previous=n,--l;continue e}f+=u._.r,u=u.next}else{if(AP(c._,i._)){(n=c).next=r,r.previous=n,--l;continue e}d+=c._.r,c=c.previous}}while(u!==c.next);for(i.previous=n,i.next=r,n.next=r.previous=r=i,a=$P(n);(i=i.next)!==r;)(s=$P(i))<a&&(n=i,a=s);r=n.next}for(n=[r._],i=r;(i=i.next)!==r;)n.push(i._);for(i=function(e,t){for(var n,r,i=0,o=(e=function(e,t){let n,r,i=e.length;for(;i;)r=t()*i--|0,n=e[i],e[i]=e[r],e[r]=n;return e}(Array.from(e),t)).length,a=[];i<o;)n=e[i],r&&OP(r,n)?++i:(r=DP(a=kP(a,n)),i=0);return r}(n,t),l=0;l<o;++l)(n=e[l]).x-=i.x,n.y-=i.y;return i.r}function PP(e){return Math.sqrt(e.value)}function FP(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function TP(e,t,n){return function(r){if(i=r.children){var i,o,a,s=i.length,l=e(r)*t||0;if(l)for(o=0;o<s;++o)i[o].r+=l;if(a=MP(i,n),l)for(o=0;o<s;++o)i[o].r-=l;r.r=a+l}}}function zP(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function RP(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function LP(e,t,n,r,i){for(var o,a=e.children,s=-1,l=a.length,u=e.value&&(r-t)/e.value;++s<l;)(o=a[s]).y0=n,o.y1=i,o.x0=t,o.x1=t+=o.value*u}var BP={depth:-1},IP={},UP={};function qP(e){return e.id}function WP(e){return e.parentId}function ZP(){var e,t=qP,n=WP;function r(r){var i,o,a,s,l,u,c,f,d=Array.from(r),h=t,p=n,m=new Map;if(null!=e){const t=d.map(((t,n)=>function(e){e=`${e}`;let t=e.length;GP(e,t-1)&&!GP(e,t-2)&&(e=e.slice(0,-1));return"/"===e[0]?e:`/${e}`}(e(t,n,r)))),n=t.map(HP),i=new Set(t).add("");for(const e of n)i.has(e)||(i.add(e),t.push(e),n.push(HP(e)),d.push(UP));h=(e,n)=>t[n],p=(e,t)=>n[t]}for(a=0,i=d.length;a<i;++a)o=d[a],u=d[a]=new pP(o),null!=(c=h(o,a,r))&&(c+="")&&(f=u.id=c,m.set(f,m.has(f)?IP:u)),null!=(c=p(o,a,r))&&(c+="")&&(u.parent=c);for(a=0;a<i;++a)if(c=(u=d[a]).parent){if(!(l=m.get(c)))throw new Error("missing: "+c);if(l===IP)throw new Error("ambiguous: "+c);l.children?l.children.push(u):l.children=[u],u.parent=l}else{if(s)throw new Error("multiple roots");s=u}if(!s)throw new Error("no root");if(null!=e){for(;s.data===UP&&1===s.children.length;)s=s.children[0],--i;for(let e=d.length-1;e>=0&&(u=d[e]).data===UP;--e)u.data=null}if(s.parent=BP,s.eachBefore((function(e){e.depth=e.parent.depth+1,--i})).eachBefore(hP),s.parent=null,i>0)throw new Error("cycle");return s}return r.id=function(e){return arguments.length?(t=mP(e),r):t},r.parentId=function(e){return arguments.length?(n=mP(e),r):n},r.path=function(t){return arguments.length?(e=mP(t),r):e},r}function HP(e){let t=e.length;if(t<2)return"";for(;--t>1&&!GP(e,t););return e.slice(0,t)}function GP(e,t){if("/"===e[t]){let n=0;for(;t>0&&"\\"===e[--t];)++n;if(0==(1&n))return!0}return!1}function VP(e,t){return e.parent===t.parent?1:2}function YP(e){var t=e.children;return t?t[0]:e.t}function XP(e){var t=e.children;return t?t[t.length-1]:e.t}function JP(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function QP(e,t,n){return e.a.parent===t.parent?e.a:n}function KP(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}function eF(e,t,n,r,i){for(var o,a=e.children,s=-1,l=a.length,u=e.value&&(i-n)/e.value;++s<l;)(o=a[s]).x0=t,o.x1=r,o.y0=n,o.y1=n+=o.value*u}KP.prototype=Object.create(pP.prototype);var tF=(1+Math.sqrt(5))/2;function nF(e,t,n,r,i,o){for(var a,s,l,u,c,f,d,h,p,m,g,y=[],v=t.children,b=0,x=0,w=v.length,k=t.value;b<w;){l=i-n,u=o-r;do{c=v[x++].value}while(!c&&x<w);for(f=d=c,g=c*c*(m=Math.max(u/l,l/u)/(k*e)),p=Math.max(d/g,g/f);x<w;++x){if(c+=s=v[x].value,s<f&&(f=s),s>d&&(d=s),g=c*c*m,(h=Math.max(d/g,g/f))>p){c-=s;break}p=h}y.push(a={value:c,dice:l<u,children:v.slice(b,x)}),a.dice?LP(a,n,r,i,k?r+=u*c/k:o):eF(a,n,r,k?n+=l*c/k:i,o),k-=c,b=x}return y}var rF=function e(t){function n(e,n,r,i,o){nF(t,e,n,r,i,o)}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(tF);var iF=function e(t){function n(e,n,r,i,o){if((a=e._squarify)&&a.ratio===t)for(var a,s,l,u,c,f=-1,d=a.length,h=e.value;++f<d;){for(l=(s=a[f]).children,u=s.value=0,c=l.length;u<c;++u)s.value+=l[u].value;s.dice?LP(s,n,r,i,h?r+=(o-r)*s.value/h:o):eF(s,n,r,h?n+=(i-n)*s.value/h:i,o),h-=s.value}else e._squarify=a=nF(t,e,n,r,i,o),a.ratio=t}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(tF);function oF(e,t,n){const r={};return e.each((e=>{const i=e.data;n(i)&&(r[t(i)]=e)})),e.lookup=r,e}function aF(e){Lh.call(this,null,e)}aF.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const sF=e=>e.values;function lF(){const e=[],t={entries:e=>r(n(e,0),0),key:n=>(e.push(n),t)};function n(t,r){if(r>=e.length)return t;const i=t.length,o=e[r++],a={},s={};let l,u,c,f=-1;for(;++f<i;)l=o(u=t[f])+"",(c=a[l])?c.push(u):a[l]=[u];for(l in a)s[l]=n(a[l],r);return s}function r(t,n){if(++n>e.length)return t;const i=[];for(const e in t)i.push({key:e,values:r(t[e],n)});return i}return t}function uF(e){Lh.call(this,null,e)}rs(aF,Lh,{transform(e,t){t.source||Jo("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),i=t.clone(),o=this.value;return(!o||r||t.changed())&&(o&&o.each((e=>{e.children&&oh(e.data)&&i.rem.push(e.data)})),this.value=o=uP({values:Ra(e.keys).reduce(((e,t)=>(e.key(t),e)),lF()).entries(i.source)},sF),n&&o.each((e=>{e.children&&(e=lh(e.data),i.add.push(e),i.source.push(e))})),oF(o,ah,ah)),i.source.root=o,i}});const cF=(e,t)=>e.parent===t.parent?1:2;rs(uF,Lh,{transform(e,t){t.source&&t.source.root||Jo(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),r=this.fields,i=t.source.root,o=e.as||r;e.field?i.sum(e.field):i.count(),e.sort&&i.sort(dh(e.sort,(e=>e.data))),function(e,t,n){for(let r,i=0,o=t.length;i<o;++i)r=t[i],r in n&&e[r](n[r])}(n,this.params,e),n.separation&&n.separation(!1!==e.separation?cF:ra);try{this.value=n(i)}catch(a){Jo(a)}return i.each((e=>function(e,t,n){const r=e.data,i=t.length-1;for(let o=0;o<i;++o)r[n[o]]=e[t[o]];r[n[i]]=e.children?e.children.length:0}(e,r,o))),t.reflow(e.modified()).modifies(o).modifies("leaf")}});const fF=["x","y","r","depth","children"];function dF(e){uF.call(this,e)}dF.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:fF.length,default:fF}]},rs(dF,uF,{layout:function(){var e=null,t=1,n=1,r=yP;function i(i){const o=function(){let e=1;return()=>(e=(bP*e+xP)%wP)/wP}();return i.x=t/2,i.y=n/2,e?i.eachBefore(FP(e)).eachAfter(TP(r,.5,o)).eachBefore(zP(1)):i.eachBefore(FP(PP)).eachAfter(TP(yP,1,o)).eachAfter(TP(r,i.r/Math.min(t,n),o)).eachBefore(zP(Math.min(t,n)/(2*i.r))),i}return i.radius=function(t){return arguments.length?(e=mP(t),i):e},i.size=function(e){return arguments.length?(t=+e[0],n=+e[1],i):[t,n]},i.padding=function(e){return arguments.length?(r="function"==typeof e?e:vP(+e),i):r},i},params:["radius","size","padding"],fields:fF});const hF=["x0","y0","x1","y1","depth","children"];function pF(e){uF.call(this,e)}function mF(e){Lh.call(this,null,e)}pF.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:hF.length,default:hF}]},rs(pF,uF,{layout:function(){var e=1,t=1,n=0,r=!1;function i(i){var o=i.height+1;return i.x0=i.y0=n,i.x1=e,i.y1=t/o,i.eachBefore(function(e,t){return function(r){r.children&&LP(r,r.x0,e*(r.depth+1)/t,r.x1,e*(r.depth+2)/t);var i=r.x0,o=r.y0,a=r.x1-n,s=r.y1-n;a<i&&(i=a=(i+a)/2),s<o&&(o=s=(o+s)/2),r.x0=i,r.y0=o,r.x1=a,r.y1=s}}(t,o)),r&&i.eachBefore(RP),i}return i.round=function(e){return arguments.length?(r=!!e,i):r},i.size=function(n){return arguments.length?(e=+n[0],t=+n[1],i):[e,t]},i.padding=function(e){return arguments.length?(n=+e,i):n},i},params:["size","round","padding"],fields:hF}),mF.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},rs(mF,Lh,{transform(e,t){t.source||Jo("Stratify transform requires an upstream data source.");let n=this.value;const r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),o=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return i.source=i.source.slice(),o&&(n=i.source.length?oF(ZP().id(e.key).parentId(e.parentKey)(i.source),e.key,ia):oF(ZP()([{}]),e.key,e.key)),i.source.root=this.value=n,i}});const gF={tidy:function(){var e=VP,t=1,n=1,r=null;function i(i){var l=function(e){for(var t,n,r,i,o,a=new KP(e,0),s=[a];t=s.pop();)if(r=t._.children)for(t.children=new Array(o=r.length),i=o-1;i>=0;--i)s.push(n=t.children[i]=new KP(r[i],i)),n.parent=t;return(a.parent=new KP(null,0)).children=[a],a}(i);if(l.eachAfter(o),l.parent.m=-l.z,l.eachBefore(a),r)i.eachBefore(s);else{var u=i,c=i,f=i;i.eachBefore((function(e){e.x<u.x&&(u=e),e.x>c.x&&(c=e),e.depth>f.depth&&(f=e)}));var d=u===c?1:e(u,c)/2,h=d-u.x,p=t/(c.x+d+h),m=n/(f.depth||1);i.eachBefore((function(e){e.x=(e.x+h)*p,e.y=e.depth*m}))}return i}function o(t){var n=t.children,r=t.parent.children,i=t.i?r[t.i-1]:null;if(n){!function(e){for(var t,n=0,r=0,i=e.children,o=i.length;--o>=0;)(t=i[o]).z+=n,t.m+=n,n+=t.s+(r+=t.c)}(t);var o=(n[0].z+n[n.length-1].z)/2;i?(t.z=i.z+e(t._,i._),t.m=t.z-o):t.z=o}else i&&(t.z=i.z+e(t._,i._));t.parent.A=function(t,n,r){if(n){for(var i,o=t,a=t,s=n,l=o.parent.children[0],u=o.m,c=a.m,f=s.m,d=l.m;s=XP(s),o=YP(o),s&&o;)l=YP(l),(a=XP(a)).a=t,(i=s.z+f-o.z-u+e(s._,o._))>0&&(JP(QP(s,t,r),t,i),u+=i,c+=i),f+=s.m,u+=o.m,d+=l.m,c+=a.m;s&&!XP(a)&&(a.t=s,a.m+=f-c),o&&!YP(l)&&(l.t=o,l.m+=u-d,r=t)}return r}(t,i,t.parent.A||r[0])}function a(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function s(e){e.x*=t,e.y=e.depth*n}return i.separation=function(t){return arguments.length?(e=t,i):e},i.size=function(e){return arguments.length?(r=!1,t=+e[0],n=+e[1],i):r?null:[t,n]},i.nodeSize=function(e){return arguments.length?(r=!0,t=+e[0],n=+e[1],i):r?[t,n]:null},i},cluster:function(){var e=oP,t=1,n=1,r=!1;function i(i){var o,a=0;i.eachAfter((function(t){var n=t.children;n?(t.x=function(e){return e.reduce(aP,0)/e.length}(n),t.y=function(e){return 1+e.reduce(sP,0)}(n)):(t.x=o?a+=e(t,o):0,t.y=0,o=t)}));var s=function(e){for(var t;t=e.children;)e=t[0];return e}(i),l=function(e){for(var t;t=e.children;)e=t[t.length-1];return e}(i),u=s.x-e(s,l)/2,c=l.x+e(l,s)/2;return i.eachAfter(r?function(e){e.x=(e.x-i.x)*t,e.y=(i.y-e.y)*n}:function(e){e.x=(e.x-u)/(c-u)*t,e.y=(1-(i.y?e.y/i.y:1))*n})}return i.separation=function(t){return arguments.length?(e=t,i):e},i.size=function(e){return arguments.length?(r=!1,t=+e[0],n=+e[1],i):r?null:[t,n]},i.nodeSize=function(e){return arguments.length?(r=!0,t=+e[0],n=+e[1],i):r?[t,n]:null},i}},yF=["x","y","depth","children"];function vF(e){uF.call(this,e)}function bF(e){Lh.call(this,[],e)}vF.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:yF.length,default:yF}]},rs(vF,uF,{layout(e){const t=e||"tidy";if(Ka(gF,t))return gF[t]();Jo("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:yF}),bF.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},rs(bF,Lh,{transform(e,t){const n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),o={};return r||Jo("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(i.rem=n,t.visit(t.SOURCE,(e=>o[ah(e)]=1)),r.each((e=>{const t=e.data,n=e.parent&&e.parent.data;n&&o[ah(t)]&&o[ah(n)]&&i.add.push(lh({source:n,target:t}))})),this.value=i.add):t.changed(t.MOD)&&(t.visit(t.MOD,(e=>o[ah(e)]=1)),n.forEach((e=>{(o[ah(e.source)]||o[ah(e.target)])&&i.mod.push(e)}))),i}});const xF={binary:function(e,t,n,r,i){var o,a,s=e.children,l=s.length,u=new Array(l+1);for(u[0]=a=o=0;o<l;++o)u[o+1]=a+=s[o].value;!function e(t,n,r,i,o,a,l){if(t>=n-1){var c=s[t];return c.x0=i,c.y0=o,c.x1=a,void(c.y1=l)}var f=u[t],d=r/2+f,h=t+1,p=n-1;for(;h<p;){var m=h+p>>>1;u[m]<d?h=m+1:p=m}d-u[h-1]<u[h]-d&&t+1<h&&--h;var g=u[h]-f,y=r-g;if(a-i>l-o){var v=r?(i*y+a*g)/r:a;e(t,h,g,i,o,v,l),e(h,n,y,v,o,a,l)}else{var b=r?(o*y+l*g)/r:l;e(t,h,g,i,o,a,b),e(h,n,y,i,b,a,l)}}(0,l,e.value,t,n,r,i)},dice:LP,slice:eF,slicedice:function(e,t,n,r,i){(1&e.depth?eF:LP)(e,t,n,r,i)},squarify:rF,resquarify:iF},wF=["x0","y0","x1","y1","depth","children"];function kF(e){uF.call(this,e)}kF.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:wF.length,default:wF}]},rs(kF,uF,{layout(){const e=function(){var e=rF,t=!1,n=1,r=1,i=[0],o=yP,a=yP,s=yP,l=yP,u=yP;function c(e){return e.x0=e.y0=0,e.x1=n,e.y1=r,e.eachBefore(f),i=[0],t&&e.eachBefore(RP),e}function f(t){var n=i[t.depth],r=t.x0+n,c=t.y0+n,f=t.x1-n,d=t.y1-n;f<r&&(r=f=(r+f)/2),d<c&&(c=d=(c+d)/2),t.x0=r,t.y0=c,t.x1=f,t.y1=d,t.children&&(n=i[t.depth+1]=o(t)/2,r+=u(t)-n,c+=a(t)-n,(f-=s(t)-n)<r&&(r=f=(r+f)/2),(d-=l(t)-n)<c&&(c=d=(c+d)/2),e(t,r,c,f,d))}return c.round=function(e){return arguments.length?(t=!!e,c):t},c.size=function(e){return arguments.length?(n=+e[0],r=+e[1],c):[n,r]},c.tile=function(t){return arguments.length?(e=gP(t),c):e},c.padding=function(e){return arguments.length?c.paddingInner(e).paddingOuter(e):c.paddingInner()},c.paddingInner=function(e){return arguments.length?(o="function"==typeof e?e:vP(+e),c):o},c.paddingOuter=function(e){return arguments.length?c.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):c.paddingTop()},c.paddingTop=function(e){return arguments.length?(a="function"==typeof e?e:vP(+e),c):a},c.paddingRight=function(e){return arguments.length?(s="function"==typeof e?e:vP(+e),c):s},c.paddingBottom=function(e){return arguments.length?(l="function"==typeof e?e:vP(+e),c):l},c.paddingLeft=function(e){return arguments.length?(u="function"==typeof e?e:vP(+e),c):u},c}();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{Ka(xF,t)?e.tile(xF[t]):Jo("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:wF});var _F=Object.freeze({__proto__:null,nest:aF,pack:dF,partition:pF,stratify:mF,tree:vF,treelinks:bF,treemap:kF});const OF=4278190080;function EF(e,t,n){return new Uint32Array(e.getImageData(0,0,t,n).data.buffer)}function DF(e,t,n){if(!t.length)return;const r=t[0].mark.marktype;"group"===r?t.forEach((t=>{t.items.forEach((t=>DF(e,t.items,n)))})):_O[r].draw(e,{items:n?t.map(jF):t})}function jF(e){const t=ch(e,{});return t.stroke&&0!==t.strokeOpacity||t.fill&&0!==t.fillOpacity?{...t,strokeOpacity:1,stroke:"#000",fillOpacity:0}:t}const NF=5,SF=31,AF=32,$F=new Uint32Array(AF+1),CF=new Uint32Array(AF+1);CF[0]=0,$F[0]=~CF[0];for(let zee=1;zee<=AF;++zee)CF[zee]=CF[zee-1]<<1|1,$F[zee]=~CF[zee];function MF(e,t,n){const r=Math.max(1,Math.sqrt(e*t/1e6)),i=~~((e+2*n+r)/r),o=~~((t+2*n+r)/r),a=e=>~~((e+n)/r);return a.invert=e=>e*r-n,a.bitmap=()=>function(e,t){const n=new Uint32Array(~~((e*t+AF)/AF));function r(e,t){n[e]|=t}function i(e,t){n[e]&=t}return{array:n,get:(t,r)=>{const i=r*e+t;return n[i>>>NF]&1<<(i&SF)},set:(t,n)=>{const i=n*e+t;r(i>>>NF,1<<(i&SF))},clear:(t,n)=>{const r=n*e+t;i(r>>>NF,~(1<<(r&SF)))},getRange:(t,r,i,o)=>{let a,s,l,u,c=o;for(;c>=r;--c)if(a=c*e+t,s=c*e+i,l=a>>>NF,u=s>>>NF,l===u){if(n[l]&$F[a&SF]&CF[1+(s&SF)])return!0}else{if(n[l]&$F[a&SF])return!0;if(n[u]&CF[1+(s&SF)])return!0;for(let e=l+1;e<u;++e)if(n[e])return!0}return!1},setRange:(t,n,i,o)=>{let a,s,l,u,c;for(;n<=o;++n)if(a=n*e+t,s=n*e+i,l=a>>>NF,u=s>>>NF,l===u)r(l,$F[a&SF]&CF[1+(s&SF)]);else for(r(l,$F[a&SF]),r(u,CF[1+(s&SF)]),c=l+1;c<u;++c)r(c,4294967295)},clearRange:(t,n,r,o)=>{let a,s,l,u,c;for(;n<=o;++n)if(a=n*e+t,s=n*e+r,l=a>>>NF,u=s>>>NF,l===u)i(l,CF[a&SF]|$F[1+(s&SF)]);else for(i(l,CF[a&SF]),i(u,$F[1+(s&SF)]),c=l+1;c<u;++c)i(c,0)},outOfBounds:(n,r,i,o)=>n<0||r<0||o>=t||i>=e}}(i,o),a.ratio=r,a.padding=n,a.width=e,a.height=t,a}function PF(e,t,n,r,i,o){let a=n/2;return e-a<0||e+a>i||t-(a=r/2)<0||t+a>o}function FF(e,t,n,r,i,o,a,s){const l=i*o/(2*r),u=e(t-l),c=e(t+l),f=e(n-(o/=2)),d=e(n+o);return a.outOfBounds(u,f,c,d)||a.getRange(u,f,c,d)||s&&s.getRange(u,f,c,d)}const TF=[-1,-1,1,1],zF=[-1,1,-1,1];const RF=["right","center","left"],LF=["bottom","middle","top"];function BF(e,t,n,r,i,o,a,s,l,u,c,f){return!(i.outOfBounds(e,n,t,r)||(f&&o||i).getRange(e,n,t,r))}const IF={"top-left":0,top:1,"top-right":2,left:4,middle:5,right:6,"bottom-left":8,bottom:9,"bottom-right":10},UF={naive:function(e,t,n,r){const i=e.width,o=e.height;return function(e){const t=e.datum.datum.items[r].items,n=t.length,a=e.datum.fontSize,s=rO.width(e.datum,e.datum.text);let l,u,c,f,d,h,p,m=0;for(let r=0;r<n;++r)l=t[r].x,c=t[r].y,u=void 0===t[r].x2?l:t[r].x2,f=void 0===t[r].y2?c:t[r].y2,d=(l+u)/2,h=(c+f)/2,p=Math.abs(u-l+f-c),p>=m&&(m=p,e.x=d,e.y=h);return d=s/2,h=a/2,l=e.x-d,u=e.x+d,c=e.y-h,f=e.y+h,e.align="center",l<0&&u<=i?e.align="left":0<=l&&i<u&&(e.align="right"),e.baseline="middle",c<0&&f<=o?e.baseline="top":0<=c&&o<f&&(e.baseline="bottom"),!0}},"reduced-search":function(e,t,n,r){const i=e.width,o=e.height,a=t[0],s=t[1];function l(t,n,r,l,u){const c=e.invert(t),f=e.invert(n);let d,h=r,p=o;if(!PF(c,f,l,u,i,o)&&!FF(e,c,f,u,l,h,a,s)&&!FF(e,c,f,u,l,u,a,null)){for(;p-h>=1;)d=(h+p)/2,FF(e,c,f,u,l,d,a,s)?p=d:h=d;if(h>r)return[c,f,h,!0]}}return function(t){const s=t.datum.datum.items[r].items,u=s.length,c=t.datum.fontSize,f=rO.width(t.datum,t.datum.text);let d,h,p,m,g,y,v,b,x,w,k,_,O,E,D,j,N,S=n?c:0,A=!1,$=!1,C=0;for(let r=0;r<u;++r){for(d=s[r].x,p=s[r].y,h=void 0===s[r].x2?d:s[r].x2,m=void 0===s[r].y2?p:s[r].y2,d>h&&(N=d,d=h,h=N),p>m&&(N=p,p=m,m=N),x=e(d),k=e(h),w=~~((x+k)/2),_=e(p),E=e(m),O=~~((_+E)/2),v=w;v>=x;--v)for(b=O;b>=_;--b)j=l(v,b,S,f,c),j&&([t.x,t.y,S,A]=j);for(v=w;v<=k;++v)for(b=O;b<=E;++b)j=l(v,b,S,f,c),j&&([t.x,t.y,S,A]=j);A||n||(D=Math.abs(h-d+m-p),g=(d+h)/2,y=(p+m)/2,D>=C&&!PF(g,y,f,c,i,o)&&!FF(e,g,y,c,f,c,a,null)&&(C=D,t.x=g,t.y=y,$=!0))}return!(!A&&!$)&&(g=f/2,y=c/2,a.setRange(e(t.x-g),e(t.y-y),e(t.x+g),e(t.y+y)),t.align="center",t.baseline="middle",!0)}},floodfill:function(e,t,n,r){const i=e.width,o=e.height,a=t[0],s=t[1],l=e.bitmap();return function(t){const u=t.datum.datum.items[r].items,c=u.length,f=t.datum.fontSize,d=rO.width(t.datum,t.datum.text),h=[];let p,m,g,y,v,b,x,w,k,_,O,E,D=n?f:0,j=!1,N=!1,S=0;for(let r=0;r<c;++r){for(p=u[r].x,g=u[r].y,m=void 0===u[r].x2?p:u[r].x2,y=void 0===u[r].y2?g:u[r].y2,h.push([e((p+m)/2),e((g+y)/2)]);h.length;)if([x,w]=h.pop(),!(a.get(x,w)||s.get(x,w)||l.get(x,w))){l.set(x,w);for(let e=0;e<4;++e)v=x+TF[e],b=w+zF[e],l.outOfBounds(v,b,v,b)||h.push([v,b]);if(v=e.invert(x),b=e.invert(w),k=D,_=o,!PF(v,b,d,f,i,o)&&!FF(e,v,b,f,d,k,a,s)&&!FF(e,v,b,f,d,f,a,null)){for(;_-k>=1;)O=(k+_)/2,FF(e,v,b,f,d,O,a,s)?_=O:k=O;k>D&&(t.x=v,t.y=b,D=k,j=!0)}}j||n||(E=Math.abs(m-p+y-g),v=(p+m)/2,b=(g+y)/2,E>=S&&!PF(v,b,d,f,i,o)&&!FF(e,v,b,f,d,f,a,null)&&(S=E,t.x=v,t.y=b,N=!0))}return!(!j&&!N)&&(v=d/2,b=f/2,a.setRange(e(t.x-v),e(t.y-b),e(t.x+v),e(t.y+b)),t.align="center",t.baseline="middle",!0)}}};function qF(e,t,n,r,i,o,a,s,l,u,c){if(!e.length)return e;const f=Math.max(r.length,i.length),d=function(e,t){const n=new Float64Array(t),r=e.length;for(let i=0;i<r;++i)n[i]=e[i]||0;for(let i=r;i<t;++i)n[i]=n[r-1];return n}(r,f),h=function(e,t){const n=new Int8Array(t),r=e.length;for(let i=0;i<r;++i)n[i]|=IF[e[i]];for(let i=r;i<t;++i)n[i]=n[r-1];return n}(i,f),p=(x=e[0].datum)&&x.mark&&x.mark.marktype,m="group"===p&&e[0].datum.items[l].marktype,g="area"===m,y=function(e,t,n,r){const i=e=>[e.x,e.x,e.x,e.y,e.y,e.y];return e?"line"===e||"area"===e?e=>i(e.datum):"line"===t?e=>{const t=e.datum.items[r].items;return i(t.length?t["start"===n?0:t.length-1]:{x:NaN,y:NaN})}:e=>{const t=e.datum.bounds;return[t.x1,(t.x1+t.x2)/2,t.x2,t.y1,(t.y1+t.y2)/2,t.y2]}:i}(p,m,s,l),v=null===u||u===1/0,b=g&&"naive"===c;var x;let w=-1,k=-1;const _=e.map((e=>{const t=v?rO.width(e,e.text):void 0;return w=Math.max(w,t),k=Math.max(k,e.fontSize),{datum:e,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(e),textWidth:t}}));u=null===u||u===1/0?Math.max(w,k)+Math.max(...r):u;const O=MF(t[0],t[1],u);let E;if(!b){n&&_.sort(((e,t)=>n(e.datum,t.datum)));let t=!1;for(let e=0;e<h.length&&!t;++e)t=5===h[e]||d[e]<0;const r=(p&&a||g)&&e.map((e=>e.datum));E=o.length||r?function(e,t,n,r,i){const o=e.width,a=e.height,s=r||i,l=wy(o,a).getContext("2d"),u=wy(o,a).getContext("2d"),c=s&&wy(o,a).getContext("2d");n.forEach((e=>DF(l,e,!1))),DF(u,t,!1),s&&DF(c,t,!0);const f=EF(l,o,a),d=EF(u,o,a),h=s&&EF(c,o,a),p=e.bitmap(),m=s&&e.bitmap();let g,y,v,b,x,w,k,_;for(y=0;y<a;++y)for(g=0;g<o;++g)x=y*o+g,w=f[x]&OF,_=d[x]&OF,k=s&&h[x]&OF,(w||k||_)&&(v=e(g),b=e(y),i||!w&&!_||p.set(v,b),s&&(w||k)&&m.set(v,b));return[p,m]}(O,r||[],o,t,g):function(e,t){const n=e.bitmap();return(t||[]).forEach((t=>n.set(e(t.boundary[0]),e(t.boundary[3])))),[n,void 0]}(O,a&&_)}const D=g?UF[c](O,E,a,l):function(e,t,n,r){const i=e.width,o=e.height,a=t[0],s=t[1],l=r.length;return function(t){const u=t.boundary,c=t.datum.fontSize;if(u[2]<0||u[5]<0||u[0]>i||u[3]>o)return!1;let f,d,h,p,m,g,y,v,b,x,w,k,_,O,E,D=t.textWidth??0;for(let i=0;i<l;++i){if(f=(3&n[i])-1,d=(n[i]>>>2&3)-1,h=0===f&&0===d||r[i]<0,p=f&&d?Math.SQRT1_2:1,m=r[i]<0?-1:1,g=u[1+f]+r[i]*f*p,w=u[4+d]+m*c*d/2+r[i]*d*p,v=w-c/2,b=w+c/2,k=e(g),O=e(v),E=e(b),!D){if(!BF(k,k,O,E,a,s,0,0,0,0,0,h))continue;D=rO.width(t.datum,t.datum.text)}if(x=g+m*D*f/2,g=x-D/2,y=x+D/2,k=e(g),_=e(y),BF(k,_,O,E,a,s,0,0,0,0,0,h))return t.x=f?f*m<0?y:g:x,t.y=d?d*m<0?b:v:w,t.align=RF[f*m+1],t.baseline=LF[d*m+1],a.setRange(k,O,_,E),!0}return!1}}(O,E,h,d);return _.forEach((e=>e.opacity=+D(e))),_}const WF=["x","y","opacity","align","baseline"],ZF=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function HF(e){Lh.call(this,null,e)}HF.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:ZF},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:WF.length,default:WF}]},rs(HF,Lh,{transform(e,t){const n=e.modified();if(!(n||t.changed(t.ADD_REM)||function(n){const r=e[n];return Ba(r)&&t.modified(r.fields)}("sort")))return;e.size&&2===e.size.length||Jo("Size parameter should be specified as a [width, height] array.");const r=e.as||WF;return qF(t.materialize(t.SOURCE).source||[],e.size,e.sort,Ra(null==e.offset?1:e.offset),Ra(e.anchor||ZF),e.avoidMarks||[],!1!==e.avoidBaseMark,e.lineAnchor||"end",e.markIndex||0,void 0===e.padding?0:e.padding,e.method||"naive").forEach((e=>{const t=e.datum;t[r[0]]=e.x,t[r[1]]=e.y,t[r[2]]=e.opacity,t[r[3]]=e.align,t[r[4]]=e.baseline})),t.reflow(n).modifies(r)}});var GF=Object.freeze({__proto__:null,label:HF});function VF(e,t){var n,r,i,o,a,s,l=[],u=function(e){return e(o)};if(null==t)l.push(e);else for(n={},r=0,i=e.length;r<i;++r)o=e[r],(s=n[a=t.map(u)])||(n[a]=s=[],s.dims=a,l.push(s)),s.push(o);return l}function YF(e){Lh.call(this,null,e)}YF.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},rs(YF,Lh,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=VF(t.materialize(t.SOURCE).source,e.groupby),i=(e.groupby||[]).map(Ho),o=i.length,a=e.as||[Ho(e.x),Ho(e.y)],s=[];r.forEach((t=>{Sp(t,e.x,e.y,e.bandwidth||.3).forEach((e=>{const n={};for(let r=0;r<o;++r)n[i[r]]=t.dims[r];n[a[0]]=e[0],n[a[1]]=e[1],s.push(lh(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=s}return n}});const XF={constant:yp,linear:kp,log:_p,exp:Op,pow:Ep,quad:Dp,poly:jp};function JF(e){Lh.call(this,null,e)}JF.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(XF)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},rs(JF,Lh,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=VF(t.materialize(t.SOURCE).source,e.groupby),i=(e.groupby||[]).map(Ho),o=e.method||"linear",a=null==e.order?3:e.order,s=((e,t)=>"poly"===e?t:"quad"===e?2:1)(o,a),l=e.as||[Ho(e.x),Ho(e.y)],u=XF[o],c=[];let f=e.extent;Ka(XF,o)||Jo("Invalid regression method: "+o),null!=f&&"log"===o&&f[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),f=null),r.forEach((n=>{if(n.length<=s)return void t.dataflow.warn("Skipping regression with more parameters than data points.");const r=u(n,e.x,e.y,a);if(e.params)return void c.push(lh({keys:n.dims,coef:r.coef,rSquared:r.rSquared}));const d=f||Xa(n,e.x),h=e=>{const t={};for(let r=0;r<i.length;++r)t[i[r]]=n.dims[r];t[l[0]]=e[0],t[l[1]]=e[1],c.push(lh(t))};"linear"===o||"constant"===o?d.forEach((e=>h([e,r.predict(e)]))):Mp(r.predict,d,25,200).forEach(h)})),this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n}});var QF=Object.freeze({__proto__:null,loess:YF,regression:JF});const KF=134217729,eT=33306690738754706e-32;function tT(e,t,n,r,i){let o,a,s,l,u=t[0],c=r[0],f=0,d=0;c>u==c>-u?(o=u,u=t[++f]):(o=c,c=r[++d]);let h=0;if(f<e&&d<n)for(c>u==c>-u?(a=u+o,s=o-(a-u),u=t[++f]):(a=c+o,s=o-(a-c),c=r[++d]),o=a,0!==s&&(i[h++]=s);f<e&&d<n;)c>u==c>-u?(a=o+u,l=a-o,s=o-(a-l)+(u-l),u=t[++f]):(a=o+c,l=a-o,s=o-(a-l)+(c-l),c=r[++d]),o=a,0!==s&&(i[h++]=s);for(;f<e;)a=o+u,l=a-o,s=o-(a-l)+(u-l),u=t[++f],o=a,0!==s&&(i[h++]=s);for(;d<n;)a=o+c,l=a-o,s=o-(a-l)+(c-l),c=r[++d],o=a,0!==s&&(i[h++]=s);return 0===o&&0!==h||(i[h++]=o),h}function nT(e){return new Float64Array(e)}const rT=22204460492503146e-32,iT=11093356479670487e-47,oT=nT(4),aT=nT(8),sT=nT(12),lT=nT(16),uT=nT(4);function cT(e,t,n,r,i,o){const a=(t-o)*(n-i),s=(e-i)*(r-o),l=a-s,u=Math.abs(a+s);return Math.abs(l)>=33306690738754716e-32*u?l:-function(e,t,n,r,i,o,a){let s,l,u,c,f,d,h,p,m,g,y,v,b,x,w,k,_,O;const E=e-i,D=n-i,j=t-o,N=r-o;x=E*N,d=KF*E,h=d-(d-E),p=E-h,d=KF*N,m=d-(d-N),g=N-m,w=p*g-(x-h*m-p*m-h*g),k=j*D,d=KF*j,h=d-(d-j),p=j-h,d=KF*D,m=d-(d-D),g=D-m,_=p*g-(k-h*m-p*m-h*g),y=w-_,f=w-y,oT[0]=w-(y+f)+(f-_),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-k,f=b-y,oT[1]=b-(y+f)+(f-k),O=v+y,f=O-v,oT[2]=v-(O-f)+(y-f),oT[3]=O;let S=function(e,t){let n=t[0];for(let r=1;r<e;r++)n+=t[r];return n}(4,oT),A=rT*a;if(S>=A||-S>=A)return S;if(f=e-E,s=e-(E+f)+(f-i),f=n-D,u=n-(D+f)+(f-i),f=t-j,l=t-(j+f)+(f-o),f=r-N,c=r-(N+f)+(f-o),0===s&&0===l&&0===u&&0===c)return S;if(A=iT*a+eT*Math.abs(S),S+=E*c+N*s-(j*u+D*l),S>=A||-S>=A)return S;x=s*N,d=KF*s,h=d-(d-s),p=s-h,d=KF*N,m=d-(d-N),g=N-m,w=p*g-(x-h*m-p*m-h*g),k=l*D,d=KF*l,h=d-(d-l),p=l-h,d=KF*D,m=d-(d-D),g=D-m,_=p*g-(k-h*m-p*m-h*g),y=w-_,f=w-y,uT[0]=w-(y+f)+(f-_),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-k,f=b-y,uT[1]=b-(y+f)+(f-k),O=v+y,f=O-v,uT[2]=v-(O-f)+(y-f),uT[3]=O;const $=tT(4,oT,4,uT,aT);x=E*c,d=KF*E,h=d-(d-E),p=E-h,d=KF*c,m=d-(d-c),g=c-m,w=p*g-(x-h*m-p*m-h*g),k=j*u,d=KF*j,h=d-(d-j),p=j-h,d=KF*u,m=d-(d-u),g=u-m,_=p*g-(k-h*m-p*m-h*g),y=w-_,f=w-y,uT[0]=w-(y+f)+(f-_),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-k,f=b-y,uT[1]=b-(y+f)+(f-k),O=v+y,f=O-v,uT[2]=v-(O-f)+(y-f),uT[3]=O;const C=tT($,aT,4,uT,sT);x=s*c,d=KF*s,h=d-(d-s),p=s-h,d=KF*c,m=d-(d-c),g=c-m,w=p*g-(x-h*m-p*m-h*g),k=l*u,d=KF*l,h=d-(d-l),p=l-h,d=KF*u,m=d-(d-u),g=u-m,_=p*g-(k-h*m-p*m-h*g),y=w-_,f=w-y,uT[0]=w-(y+f)+(f-_),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-k,f=b-y,uT[1]=b-(y+f)+(f-k),O=v+y,f=O-v,uT[2]=v-(O-f)+(y-f),uT[3]=O;const M=tT(C,sT,4,uT,lT);return lT[M-1]}(e,t,n,r,i,o,u)}const fT=Math.pow(2,-52),dT=new Uint32Array(512);class hT{static from(e,t,n){void 0===t&&(t=bT),void 0===n&&(n=xT);const r=e.length,i=new Float64Array(2*r);for(let o=0;o<r;o++){const r=e[o];i[2*o]=t(r),i[2*o+1]=n(r)}return new hT(i)}constructor(e){const t=e.length>>1;if(t>0&&"number"!=typeof e[0])throw new Error("Expected coords to contain numbers.");this.coords=e;const n=Math.max(2*t-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(t)),this._hullPrev=new Uint32Array(t),this._hullNext=new Uint32Array(t),this._hullTri=new Uint32Array(t),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(t),this._dists=new Float64Array(t),this.update()}update(){const{coords:e,_hullPrev:t,_hullNext:n,_hullTri:r,_hullHash:i}=this,o=e.length>>1;let a=1/0,s=1/0,l=-1/0,u=-1/0;for(let E=0;E<o;E++){const t=e[2*E],n=e[2*E+1];t<a&&(a=t),n<s&&(s=n),t>l&&(l=t),n>u&&(u=n),this._ids[E]=E}const c=(a+l)/2,f=(s+u)/2;let d,h,p,m=1/0;for(let E=0;E<o;E++){const t=pT(c,f,e[2*E],e[2*E+1]);t<m&&(d=E,m=t)}const g=e[2*d],y=e[2*d+1];m=1/0;for(let E=0;E<o;E++){if(E===d)continue;const t=pT(g,y,e[2*E],e[2*E+1]);t<m&&t>0&&(h=E,m=t)}let v=e[2*h],b=e[2*h+1],x=1/0;for(let E=0;E<o;E++){if(E===d||E===h)continue;const t=gT(g,y,v,b,e[2*E],e[2*E+1]);t<x&&(p=E,x=t)}let w=e[2*p],k=e[2*p+1];if(x===1/0){for(let r=0;r<o;r++)this._dists[r]=e[2*r]-e[0]||e[2*r+1]-e[1];yT(this._ids,this._dists,0,o-1);const t=new Uint32Array(o);let n=0;for(let e=0,r=-1/0;e<o;e++){const i=this._ids[e];this._dists[i]>r&&(t[n++]=i,r=this._dists[i])}return this.hull=t.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(cT(g,y,v,b,w,k)<0){const e=h,t=v,n=b;h=p,v=w,b=k,p=e,w=t,k=n}const _=function(e,t,n,r,i,o){const a=n-e,s=r-t,l=i-e,u=o-t,c=a*a+s*s,f=l*l+u*u,d=.5/(a*u-s*l),h=e+(u*c-s*f)*d,p=t+(a*f-l*c)*d;return{x:h,y:p}}(g,y,v,b,w,k);this._cx=_.x,this._cy=_.y;for(let E=0;E<o;E++)this._dists[E]=pT(e[2*E],e[2*E+1],_.x,_.y);yT(this._ids,this._dists,0,o-1),this._hullStart=d;let O=3;n[d]=t[p]=h,n[h]=t[d]=p,n[p]=t[h]=d,r[d]=0,r[h]=1,r[p]=2,i.fill(-1),i[this._hashKey(g,y)]=d,i[this._hashKey(v,b)]=h,i[this._hashKey(w,k)]=p,this.trianglesLen=0,this._addTriangle(d,h,p,-1,-1,-1);for(let E,D,j=0;j<this._ids.length;j++){const o=this._ids[j],a=e[2*o],s=e[2*o+1];if(j>0&&Math.abs(a-E)<=fT&&Math.abs(s-D)<=fT)continue;if(E=a,D=s,o===d||o===h||o===p)continue;let l=0;for(let e=0,t=this._hashKey(a,s);e<this._hashSize&&(l=i[(t+e)%this._hashSize],-1===l||l===n[l]);e++);l=t[l];let u,c=l;for(;u=n[c],cT(a,s,e[2*c],e[2*c+1],e[2*u],e[2*u+1])>=0;)if(c=u,c===l){c=-1;break}if(-1===c)continue;let f=this._addTriangle(c,o,n[c],-1,-1,r[c]);r[o]=this._legalize(f+2),r[c]=f,O++;let m=n[c];for(;u=n[m],cT(a,s,e[2*m],e[2*m+1],e[2*u],e[2*u+1])<0;)f=this._addTriangle(m,o,u,r[o],-1,r[m]),r[o]=this._legalize(f+2),n[m]=m,O--,m=u;if(c===l)for(;u=t[c],cT(a,s,e[2*u],e[2*u+1],e[2*c],e[2*c+1])<0;)f=this._addTriangle(u,o,c,-1,r[c],r[u]),this._legalize(f+2),r[u]=f,n[c]=c,O--,c=u;this._hullStart=t[o]=c,n[c]=t[m]=o,n[o]=m,i[this._hashKey(a,s)]=o,i[this._hashKey(e[2*c],e[2*c+1])]=c}this.hull=new Uint32Array(O);for(let E=0,D=this._hullStart;E<O;E++)this.hull[E]=D,D=n[D];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,t){return Math.floor(function(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:t,_halfedges:n,coords:r}=this;let i=0,o=0;for(;;){const a=n[e],s=e-e%3;if(o=s+(e+2)%3,-1===a){if(0===i)break;e=dT[--i];continue}const l=a-a%3,u=s+(e+1)%3,c=l+(a+2)%3,f=t[o],d=t[e],h=t[u],p=t[c];if(mT(r[2*f],r[2*f+1],r[2*d],r[2*d+1],r[2*h],r[2*h+1],r[2*p],r[2*p+1])){t[e]=p,t[a]=f;const r=n[c];if(-1===r){let t=this._hullStart;do{if(this._hullTri[t]===c){this._hullTri[t]=e;break}t=this._hullPrev[t]}while(t!==this._hullStart)}this._link(e,r),this._link(a,n[o]),this._link(o,c);const s=l+(a+1)%3;i<dT.length&&(dT[i++]=s)}else{if(0===i)break;e=dT[--i]}}return o}_link(e,t){this._halfedges[e]=t,-1!==t&&(this._halfedges[t]=e)}_addTriangle(e,t,n,r,i,o){const a=this.trianglesLen;return this._triangles[a]=e,this._triangles[a+1]=t,this._triangles[a+2]=n,this._link(a,r),this._link(a+1,i),this._link(a+2,o),this.trianglesLen+=3,a}}function pT(e,t,n,r){const i=e-n,o=t-r;return i*i+o*o}function mT(e,t,n,r,i,o,a,s){const l=e-a,u=t-s,c=n-a,f=r-s,d=i-a,h=o-s,p=c*c+f*f,m=d*d+h*h;return l*(f*m-p*h)-u*(c*m-p*d)+(l*l+u*u)*(c*h-f*d)<0}function gT(e,t,n,r,i,o){const a=n-e,s=r-t,l=i-e,u=o-t,c=a*a+s*s,f=l*l+u*u,d=.5/(a*u-s*l),h=(u*c-s*f)*d,p=(a*f-l*c)*d;return h*h+p*p}function yT(e,t,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const r=e[i],o=t[r];let a=i-1;for(;a>=n&&t[e[a]]>o;)e[a+1]=e[a--];e[a+1]=r}else{let i=n+1,o=r;vT(e,n+r>>1,i),t[e[n]]>t[e[r]]&&vT(e,n,r),t[e[i]]>t[e[r]]&&vT(e,i,r),t[e[n]]>t[e[i]]&&vT(e,n,i);const a=e[i],s=t[a];for(;;){do{i++}while(t[e[i]]<s);do{o--}while(t[e[o]]>s);if(o<i)break;vT(e,i,o)}e[n+1]=e[o],e[o]=a,r-i+1>=o-n?(yT(e,t,i,r),yT(e,t,n,o-1)):(yT(e,t,n,o-1),yT(e,t,i,r))}}function vT(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function bT(e){return e[0]}function xT(e){return e[1]}const wT=1e-6;class kT{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,t){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,t){this._+=`L${this._x1=+e},${this._y1=+t}`}arc(e,t,n){const r=(e=+e)+(n=+n),i=t=+t;if(n<0)throw new Error("negative radius");null===this._x1?this._+=`M${r},${i}`:(Math.abs(this._x1-r)>wT||Math.abs(this._y1-i)>wT)&&(this._+="L"+r+","+i),n&&(this._+=`A${n},${n},0,1,1,${e-n},${t}A${n},${n},0,1,1,${this._x1=r},${this._y1=i}`)}rect(e,t,n,r){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${+n}v${+r}h${-n}Z`}value(){return this._||null}}class _T{constructor(){this._=[]}moveTo(e,t){this._.push([e,t])}closePath(){this._.push(this._[0].slice())}lineTo(e,t){this._.push([e,t])}value(){return this._.length?this._:null}}const OT=2*Math.PI,ET=Math.pow;function DT(e){return e[0]}function jT(e){return e[1]}function NT(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class ST{static from(e,t,n,r){return void 0===t&&(t=DT),void 0===n&&(n=jT),new ST("length"in e?function(e,t,n,r){const i=e.length,o=new Float64Array(2*i);for(let a=0;a<i;++a){const i=e[a];o[2*a]=t.call(r,i,a,e),o[2*a+1]=n.call(r,i,a,e)}return o}(e,t,n,r):Float64Array.from(function*(e,t,n,r){let i=0;for(const o of e)yield t.call(r,o,i,e),yield n.call(r,o,i,e),++i}(e,t,n,r)))}constructor(e){this._delaunator=new hT(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&function(e){const{triangles:t,coords:n}=e;for(let r=0;r<t.length;r+=3){const e=2*t[r],i=2*t[r+1],o=2*t[r+2];if((n[o]-n[e])*(n[i+1]-n[e+1])-(n[i]-n[e])*(n[o+1]-n[e+1])>1e-10)return!1}return!0}(e)){this.collinear=Int32Array.from({length:t.length/2},((e,t)=>t)).sort(((e,n)=>t[2*e]-t[2*n]||t[2*e+1]-t[2*n+1]));const e=this.collinear[0],n=this.collinear[this.collinear.length-1],r=[t[2*e],t[2*e+1],t[2*n],t[2*n+1]],i=1e-8*Math.hypot(r[3]-r[1],r[2]-r[0]);for(let o=0,a=t.length/2;o<a;++o){const e=NT(t[2*o],t[2*o+1],i);t[2*o]=e[0],t[2*o+1]=e[1]}this._delaunator=new hT(t)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,i=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let s=0,l=n.length;s<l;++s){const e=i[s%3==2?s-2:s+1];-1!==n[s]&&-1!==o[e]||(o[e]=s)}for(let s=0,l=r.length;s<l;++s)a[r[s]]=s;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],o[r[0]]=1,2===r.length&&(o[r[1]]=0,this.triangles[1]=r[1],this.triangles[2]=r[1]))}voronoi(e){return new class{constructor(e,t){let[n,r,i,o]=void 0===t?[0,0,960,500]:t;if(!((i=+i)>=(n=+n)&&(o=+o)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(2*e.points.length),this.vectors=new Float64Array(2*e.points.length),this.xmax=i,this.xmin=n,this.ymax=o,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:t,triangles:n},vectors:r}=this;let i,o;const a=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let p,m,g=0,y=0,v=n.length;g<v;g+=3,y+=2){const r=2*n[g],s=2*n[g+1],l=2*n[g+2],u=e[r],c=e[r+1],f=e[s],d=e[s+1],h=e[l],v=e[l+1],b=f-u,x=d-c,w=h-u,k=v-c,_=2*(b*k-x*w);if(Math.abs(_)<1e-9){if(void 0===i){i=o=0;for(const n of t)i+=e[2*n],o+=e[2*n+1];i/=t.length,o/=t.length}const n=1e9*Math.sign((i-u)*k-(o-c)*w);p=(u+h)/2-n*k,m=(c+v)/2+n*w}else{const e=1/_,t=b*b+x*x,n=w*w+k*k;p=u+(k*t-x*n)*e,m=c+(b*n-w*t)*e}a[y]=p,a[y+1]=m}let s,l,u,c=t[t.length-1],f=4*c,d=e[2*c],h=e[2*c+1];r.fill(0);for(let p=0;p<t.length;++p)c=t[p],s=f,l=d,u=h,f=4*c,d=e[2*c],h=e[2*c+1],r[s+2]=r[f]=u-h,r[s+3]=r[f+1]=d-l}render(e){const t=null==e?e=new kT:void 0,{delaunay:{halfedges:n,inedges:r,hull:i},circumcenters:o,vectors:a}=this;if(i.length<=1)return null;for(let u=0,c=n.length;u<c;++u){const t=n[u];if(t<u)continue;const r=2*Math.floor(u/3),i=2*Math.floor(t/3),a=o[r],s=o[r+1],l=o[i],c=o[i+1];this._renderSegment(a,s,l,c,e)}let s,l=i[i.length-1];for(let u=0;u<i.length;++u){s=l,l=i[u];const t=2*Math.floor(r[l]/3),n=o[t],c=o[t+1],f=4*s,d=this._project(n,c,a[f+2],a[f+3]);d&&this._renderSegment(n,c,d[0],d[1],e)}return t&&t.value()}renderBounds(e){const t=null==e?e=new kT:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}renderCell(e,t){const n=null==t?t=new kT:void 0,r=this._clip(e);if(null===r||!r.length)return;t.moveTo(r[0],r[1]);let i=r.length;for(;r[0]===r[i-2]&&r[1]===r[i-1]&&i>1;)i-=2;for(let o=2;o<i;o+=2)r[o]===r[o-2]&&r[o+1]===r[o-1]||t.lineTo(r[o],r[o+1]);return t.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let t=0,n=e.length/2;t<n;++t){const e=this.cellPolygon(t);e&&(e.index=t,yield e)}}cellPolygon(e){const t=new _T;return this.renderCell(e,t),t.value()}_renderSegment(e,t,n,r,i){let o;const a=this._regioncode(e,t),s=this._regioncode(n,r);0===a&&0===s?(i.moveTo(e,t),i.lineTo(n,r)):(o=this._clipSegment(e,t,n,r,a,s))&&(i.moveTo(o[0],o[1]),i.lineTo(o[2],o[3]))}contains(e,t,n){return(t=+t)==t&&(n=+n)==n&&this.delaunay._step(e,t,n)===e}*neighbors(e){const t=this._clip(e);if(t)for(const n of this.delaunay.neighbors(e)){const e=this._clip(n);if(e)e:for(let r=0,i=t.length;r<i;r+=2)for(let o=0,a=e.length;o<a;o+=2)if(t[r]===e[o]&&t[r+1]===e[o+1]&&t[(r+2)%i]===e[(o+a-2)%a]&&t[(r+3)%i]===e[(o+a-1)%a]){yield n;break e}}}_cell(e){const{circumcenters:t,delaunay:{inedges:n,halfedges:r,triangles:i}}=this,o=n[e];if(-1===o)return null;const a=[];let s=o;do{const n=Math.floor(s/3);if(a.push(t[2*n],t[2*n+1]),s=s%3==2?s-2:s+1,i[s]!==e)break;s=r[s]}while(s!==o&&-1!==s);return a}_clip(e){if(0===e&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const t=this._cell(e);if(null===t)return null;const{vectors:n}=this,r=4*e;return this._simplify(n[r]||n[r+1]?this._clipInfinite(e,t,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(e,t))}_clipFinite(e,t){const n=t.length;let r,i,o,a,s=null,l=t[n-2],u=t[n-1],c=this._regioncode(l,u),f=0;for(let d=0;d<n;d+=2)if(r=l,i=u,l=t[d],u=t[d+1],o=c,c=this._regioncode(l,u),0===o&&0===c)a=f,f=0,s?s.push(l,u):s=[l,u];else{let t,n,d,h,p;if(0===o){if(null===(t=this._clipSegment(r,i,l,u,o,c)))continue;[n,d,h,p]=t}else{if(null===(t=this._clipSegment(l,u,r,i,c,o)))continue;[h,p,n,d]=t,a=f,f=this._edgecode(n,d),a&&f&&this._edge(e,a,f,s,s.length),s?s.push(n,d):s=[n,d]}a=f,f=this._edgecode(h,p),a&&f&&this._edge(e,a,f,s,s.length),s?s.push(h,p):s=[h,p]}if(s)a=f,f=this._edgecode(s[0],s[1]),a&&f&&this._edge(e,a,f,s,s.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return s}_clipSegment(e,t,n,r,i,o){const a=i<o;for(a&&([e,t,n,r,i,o]=[n,r,e,t,o,i]);;){if(0===i&&0===o)return a?[n,r,e,t]:[e,t,n,r];if(i&o)return null;let s,l,u=i||o;8&u?(s=e+(n-e)*(this.ymax-t)/(r-t),l=this.ymax):4&u?(s=e+(n-e)*(this.ymin-t)/(r-t),l=this.ymin):2&u?(l=t+(r-t)*(this.xmax-e)/(n-e),s=this.xmax):(l=t+(r-t)*(this.xmin-e)/(n-e),s=this.xmin),i?(e=s,t=l,i=this._regioncode(e,t)):(n=s,r=l,o=this._regioncode(n,r))}}_clipInfinite(e,t,n,r,i,o){let a,s=Array.from(t);if((a=this._project(s[0],s[1],n,r))&&s.unshift(a[0],a[1]),(a=this._project(s[s.length-2],s[s.length-1],i,o))&&s.push(a[0],a[1]),s=this._clipFinite(e,s))for(let l,u=0,c=s.length,f=this._edgecode(s[c-2],s[c-1]);u<c;u+=2)l=f,f=this._edgecode(s[u],s[u+1]),l&&f&&(u=this._edge(e,l,f,s,u),c=s.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(e,t,n,r,i){for(;t!==n;){let n,o;switch(t){case 5:t=4;continue;case 4:t=6,n=this.xmax,o=this.ymin;break;case 6:t=2;continue;case 2:t=10,n=this.xmax,o=this.ymax;break;case 10:t=8;continue;case 8:t=9,n=this.xmin,o=this.ymax;break;case 9:t=1;continue;case 1:t=5,n=this.xmin,o=this.ymin}r[i]===n&&r[i+1]===o||!this.contains(e,n,o)||(r.splice(i,0,n,o),i+=2)}return i}_project(e,t,n,r){let i,o,a,s=1/0;if(r<0){if(t<=this.ymin)return null;(i=(this.ymin-t)/r)<s&&(a=this.ymin,o=e+(s=i)*n)}else if(r>0){if(t>=this.ymax)return null;(i=(this.ymax-t)/r)<s&&(a=this.ymax,o=e+(s=i)*n)}if(n>0){if(e>=this.xmax)return null;(i=(this.xmax-e)/n)<s&&(o=this.xmax,a=t+(s=i)*r)}else if(n<0){if(e<=this.xmin)return null;(i=(this.xmin-e)/n)<s&&(o=this.xmin,a=t+(s=i)*r)}return[o,a]}_edgecode(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}_regioncode(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}_simplify(e){if(e&&e.length>4){for(let t=0;t<e.length;t+=2){const n=(t+2)%e.length,r=(t+4)%e.length;(e[t]===e[n]&&e[n]===e[r]||e[t+1]===e[n+1]&&e[n+1]===e[r+1])&&(e.splice(n,2),t-=2)}e.length||(e=null)}return e}}(this,e)}*neighbors(e){const{inedges:t,hull:n,_hullIndex:r,halfedges:i,triangles:o,collinear:a}=this;if(a){const t=a.indexOf(e);return t>0&&(yield a[t-1]),void(t<a.length-1&&(yield a[t+1]))}const s=t[e];if(-1===s)return;let l=s,u=-1;do{if(yield u=o[l],l=l%3==2?l-2:l+1,o[l]!==e)return;if(l=i[l],-1===l){const t=n[(r[e]+1)%n.length];return void(t!==u&&(yield t))}}while(l!==s)}find(e,t,n){if(void 0===n&&(n=0),(e=+e)!=e||(t=+t)!=t)return-1;const r=n;let i;for(;(i=this._step(n,e,t))>=0&&i!==n&&i!==r;)n=i;return i}_step(e,t,n){const{inedges:r,hull:i,_hullIndex:o,halfedges:a,triangles:s,points:l}=this;if(-1===r[e]||!l.length)return(e+1)%(l.length>>1);let u=e,c=ET(t-l[2*e],2)+ET(n-l[2*e+1],2);const f=r[e];let d=f;do{let r=s[d];const f=ET(t-l[2*r],2)+ET(n-l[2*r+1],2);if(f<c&&(c=f,u=r),d=d%3==2?d-2:d+1,s[d]!==e)break;if(d=a[d],-1===d){if(d=i[(o[e]+1)%i.length],d!==r&&ET(t-l[2*d],2)+ET(n-l[2*d+1],2)<c)return d;break}}while(d!==f);return u}render(e){const t=null==e?e=new kT:void 0,{points:n,halfedges:r,triangles:i}=this;for(let o=0,a=r.length;o<a;++o){const t=r[o];if(t<o)continue;const a=2*i[o],s=2*i[t];e.moveTo(n[a],n[a+1]),e.lineTo(n[s],n[s+1])}return this.renderHull(e),t&&t.value()}renderPoints(e,t){void 0!==t||e&&"function"==typeof e.moveTo||(t=e,e=null),t=null==t?2:+t;const n=null==e?e=new kT:void 0,{points:r}=this;for(let i=0,o=r.length;i<o;i+=2){const n=r[i],o=r[i+1];e.moveTo(n+t,o),e.arc(n,o,t,0,OT)}return n&&n.value()}renderHull(e){const t=null==e?e=new kT:void 0,{hull:n,points:r}=this,i=2*n[0],o=n.length;e.moveTo(r[i],r[i+1]);for(let a=1;a<o;++a){const t=2*n[a];e.lineTo(r[t],r[t+1])}return e.closePath(),t&&t.value()}hullPolygon(){const e=new _T;return this.renderHull(e),e.value()}renderTriangle(e,t){const n=null==t?t=new kT:void 0,{points:r,triangles:i}=this,o=2*i[e*=3],a=2*i[e+1],s=2*i[e+2];return t.moveTo(r[o],r[o+1]),t.lineTo(r[a],r[a+1]),t.lineTo(r[s],r[s+1]),t.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:e}=this;for(let t=0,n=e.length/3;t<n;++t)yield this.trianglePolygon(t)}trianglePolygon(e){const t=new _T;return this.renderTriangle(e,t),t.value()}}function AT(e){Lh.call(this,null,e)}AT.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const $T=[-1e5,-1e5,1e5,1e5];function CT(e){const t=e[0][0],n=e[0][1];let r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}rs(AT,Lh,{transform(e,t){const n=e.as||"path",r=t.source;if(!r||!r.length)return t;let i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:$T;const o=this.value=ST.from(r,e.x,e.y).voronoi(i);for(let a=0,s=r.length;a<s;++a){const e=o.cellPolygon(a);r[a][n]=e?CT(e):null}return t.reflow(e.modified()).modifies(n)}});var MT=Object.freeze({__proto__:null,voronoi:AT}),PT=Math.PI/180,FT=64,TT=2048;function zT(){var e,t,n,r,i,o,a,s=[256,256],l=UT,u=[],c=Math.random,f={};function d(e,t,n){for(var r,i,o,a=t.x,u=t.y,f=Math.sqrt(s[0]*s[0]+s[1]*s[1]),d=l(s),h=c()<.5?1:-1,p=-h;(r=d(p+=h))&&(i=~~r[0],o=~~r[1],!(Math.min(Math.abs(i),Math.abs(o))>=f));)if(t.x=a+i,t.y=u+o,!(t.x+t.x0<0||t.y+t.y0<0||t.x+t.x1>s[0]||t.y+t.y1>s[1])&&(!n||!LT(t,e,s[0]))&&(!n||IT(t,n))){for(var m,g=t.sprite,y=t.width>>5,v=s[0]>>5,b=t.x-(y<<4),x=127&b,w=32-x,k=t.y1-t.y0,_=(t.y+t.y0)*v+(b>>5),O=0;O<k;O++){m=0;for(var E=0;E<=y;E++)e[_+E]|=m<<w|(E<y?(m=g[O*y+E])>>>x:0);_+=v}return t.sprite=null,!0}return!1}return f.layout=function(){for(var l=function(e){e.width=e.height=1;var t=Math.sqrt(e.getContext("2d").getImageData(0,0,1,1).data.length>>2);e.width=(FT<<5)/t,e.height=TT/t;var n=e.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:t}}(wy()),f=function(e){var t=[],n=-1;for(;++n<e;)t[n]=0;return t}((s[0]>>5)*s[1]),h=null,p=u.length,m=-1,g=[],y=u.map((s=>({text:e(s),font:t(s),style:r(s),weight:i(s),rotate:o(s),size:~~(n(s)+1e-14),padding:a(s),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:s}))).sort(((e,t)=>t.size-e.size));++m<p;){var v=y[m];v.x=s[0]*(c()+.5)>>1,v.y=s[1]*(c()+.5)>>1,RT(l,v,y,m),v.hasText&&d(f,v,h)&&(g.push(v),h?BT(h,v):h=[{x:v.x+v.x0,y:v.y+v.y0},{x:v.x+v.x1,y:v.y+v.y1}],v.x-=s[0]>>1,v.y-=s[1]>>1)}return g},f.words=function(e){return arguments.length?(u=e,f):u},f.size=function(e){return arguments.length?(s=[+e[0],+e[1]],f):s},f.font=function(e){return arguments.length?(t=qT(e),f):t},f.fontStyle=function(e){return arguments.length?(r=qT(e),f):r},f.fontWeight=function(e){return arguments.length?(i=qT(e),f):i},f.rotate=function(e){return arguments.length?(o=qT(e),f):o},f.text=function(t){return arguments.length?(e=qT(t),f):e},f.spiral=function(e){return arguments.length?(l=WT[e]||e,f):l},f.fontSize=function(e){return arguments.length?(n=qT(e),f):n},f.padding=function(e){return arguments.length?(a=qT(e),f):a},f.random=function(e){return arguments.length?(c=e,f):c},f}function RT(e,t,n,r){if(!t.sprite){var i=e.context,o=e.ratio;i.clearRect(0,0,(FT<<5)/o,TT/o);var a,s,l,u,c,f=0,d=0,h=0,p=n.length;for(--r;++r<p;){if(t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/o)+"px "+t.font,a=i.measureText(t.text+"m").width*o,l=t.size<<1,t.rotate){var m=Math.sin(t.rotate*PT),g=Math.cos(t.rotate*PT),y=a*g,v=a*m,b=l*g,x=l*m;a=Math.max(Math.abs(y+x),Math.abs(y-x))+31>>5<<5,l=~~Math.max(Math.abs(v+b),Math.abs(v-b))}else a=a+31>>5<<5;if(l>h&&(h=l),f+a>=FT<<5&&(f=0,d+=h,h=0),d+l>=TT)break;i.translate((f+(a>>1))/o,(d+(l>>1))/o),t.rotate&&i.rotate(t.rotate*PT),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=a,t.height=l,t.xoff=f,t.yoff=d,t.x1=a>>1,t.y1=l>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,f+=a}for(var w=i.getImageData(0,0,(FT<<5)/o,TT/o).data,k=[];--r>=0;)if((t=n[r]).hasText){for(s=(a=t.width)>>5,l=t.y1-t.y0,u=0;u<l*s;u++)k[u]=0;if(null==(f=t.xoff))return;d=t.yoff;var _=0,O=-1;for(c=0;c<l;c++){for(u=0;u<a;u++){var E=s*c+(u>>5),D=w[(d+c)*(FT<<5)+(f+u)<<2]?1<<31-u%32:0;k[E]|=D,_|=D}_?O=c:(t.y0++,l--,c--,d++)}t.y1=t.y0+O,t.sprite=k.slice(0,(t.y1-t.y0)*s)}}}function LT(e,t,n){n>>=5;for(var r,i=e.sprite,o=e.width>>5,a=e.x-(o<<4),s=127&a,l=32-s,u=e.y1-e.y0,c=(e.y+e.y0)*n+(a>>5),f=0;f<u;f++){r=0;for(var d=0;d<=o;d++)if((r<<l|(d<o?(r=i[f*o+d])>>>s:0))&t[c+d])return!0;c+=n}return!1}function BT(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function IT(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function UT(e){var t=e[0]/e[1];return function(e){return[t*(e*=.1)*Math.cos(e),e*Math.sin(e)]}}function qT(e){return"function"==typeof e?e:function(){return e}}var WT={archimedean:UT,rectangular:function(e){var t=4*e[0]/e[1],n=0,r=0;return function(e){var i=e<0?-1:1;switch(Math.sqrt(1+4*i*e)-i&3){case 0:n+=t;break;case 1:r+=4;break;case 2:n-=t;break;default:r-=4}return[n,r]}}};const ZT=["x","y","font","fontSize","fontStyle","fontWeight","angle"],HT=["text","font","rotate","fontSize","fontStyle","fontWeight"];function GT(e){Lh.call(this,zT(),e)}GT.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:ZT}]},rs(GT,Lh,{transform(e,t){!e.size||e.size[0]&&e.size[1]||Jo("Wordcloud size dimensions must be non-zero.");const n=e.modified();if(!(n||t.changed(t.ADD_REM)||HT.some((function(n){const r=e[n];return Ba(r)&&t.modified(r.fields)}))))return;const r=t.materialize(t.SOURCE).source,i=this.value,o=e.as||ZT;let a,s=e.fontSize||14;if(Ba(s)?a=e.fontSizeRange:s=Ga(s),a){const e=s,t=Rx("sqrt")().domain(Xa(r,e)).range(a);s=n=>t(e(n))}r.forEach((e=>{e[o[0]]=NaN,e[o[1]]=NaN,e[o[3]]=0}));const l=i.words(r).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(s).random(Vh).layout(),u=i.size(),c=u[0]>>1,f=u[1]>>1,d=l.length;for(let h,p,m=0;m<d;++m)h=l[m],p=h.datum,p[o[0]]=h.x+c,p[o[1]]=h.y+f,p[o[2]]=h.font,p[o[3]]=h.size,p[o[4]]=h.style,p[o[5]]=h.weight,p[o[6]]=h.rotate;return t.reflow(n).modifies(o)}});var VT=Object.freeze({__proto__:null,wordcloud:GT});const YT=e=>new Uint8Array(e),XT=e=>new Uint16Array(e),JT=e=>new Uint32Array(e);function QT(e,t,n){const r=(t<257?YT:t<65537?XT:JT)(e);return n&&r.set(n),r}function KT(e,t,n){const r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(e,t){const n=this,i=n.bisect(n.range,e.value),o=e.index,a=i[0],s=i[1],l=o.length;let u;for(u=0;u<a;++u)t[o[u]]|=r;for(u=s;u<l;++u)t[o[u]]|=r;return n}}}function ez(){let e=JT(0),t=[],n=0;return{insert:function(r,i,o){if(!i.length)return[];const a=n,s=i.length,l=JT(s);let u,c,f,d=Array(s);for(f=0;f<s;++f)d[f]=r(i[f]),l[f]=f;if(d=function(e,t){return e.sort.call(t,((t,n)=>{const r=e[t],i=e[n];return r<i?-1:r>i?1:0})),function(e,t){return Array.from(t,(t=>e[t]))}(e,t)}(d,l),a)u=t,c=e,t=Array(a+s),e=JT(a+s),function(e,t,n,r,i,o,a,s,l){let u,c=0,f=0;for(u=0;c<r&&f<a;++u)t[c]<i[f]?(s[u]=t[c],l[u]=n[c++]):(s[u]=i[f],l[u]=o[f++]+e);for(;c<r;++c,++u)s[u]=t[c],l[u]=n[c];for(;f<a;++f,++u)s[u]=i[f],l[u]=o[f]+e}(o,u,c,a,d,l,s,t,e);else{if(o>0)for(f=0;f<s;++f)l[f]+=o;t=d,e=l}return n=a+s,{index:l,value:d}},remove:function(r,i){const o=n;let a,s,l;for(s=0;!i[e[s]]&&s<o;++s);for(l=s;s<o;++s)i[a=e[s]]||(e[l]=a,t[l]=t[s],++l);n=o-r},bisect:function(e,r){let i;return r?i=r.length:(r=t,i=n),[Xs(r,e[0],0,i),Ys(r,e[1],0,i)]},reindex:function(t){for(let r=0,i=n;r<i;++r)e[r]=t[e[r]]},index:()=>e,size:()=>n}}function tz(e){Lh.call(this,function(){let e=8,t=[],n=JT(0),r=QT(0,e),i=QT(0,e);return{data:()=>t,seen:()=>n=function(e,t,n){return e.length>=t?e:((n=n||new e.constructor(t)).set(e),n)}(n,t.length),add(e){for(let n,r=0,i=t.length,o=e.length;r<o;++r)n=e[r],n._index=i++,t.push(n)},remove(e,n){const o=t.length,a=Array(o-e),s=t;let l,u,c;for(u=0;!n[u]&&u<o;++u)a[u]=t[u],s[u]=u;for(c=u;u<o;++u)l=t[u],n[u]?s[u]=-1:(s[u]=c,r[c]=r[u],i[c]=i[u],a[c]=l,l._index=c++),r[u]=0;return t=a,s},size:()=>t.length,curr:()=>r,prev:()=>i,reset:e=>i[e]=r[e],all:()=>e<257?255:e<65537?65535:4294967295,set(e,t){r[e]|=t},clear(e,t){r[e]&=~t},resize(t,n){(t>r.length||n>e)&&(e=Math.max(n,e),r=QT(t,e,r),i=QT(t,e))}}}(),e),this._indices=null,this._dims=null}function nz(e){Lh.call(this,null,e)}tz.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},rs(tz,Lh,{transform(e,t){return this._dims?e.modified("fields")||e.fields.some((e=>t.modified(e.fields)))?this.reinit(e,t):this.eval(e,t):this.init(e,t)},init(e,t){const n=e.fields,r=e.query,i=this._indices={},o=this._dims=[],a=r.length;let s,l,u=0;for(;u<a;++u)s=n[u].fname,l=i[s]||(i[s]=ez()),o.push(KT(l,u,r[u]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),r=e.fields,i=e.query,o=this._indices,a=this._dims,s=this.value,l=s.curr(),u=s.prev(),c=s.all(),f=n.rem=n.add,d=n.mod,h=i.length,p={};let m,g,y,v,b,x,w,k,_;if(u.set(l),t.rem.length&&(b=this.remove(e,t,n)),t.add.length&&s.add(t.add),t.mod.length)for(x={},v=t.mod,w=0,k=v.length;w<k;++w)x[v[w]._index]=1;for(w=0;w<h;++w)_=r[w],(!a[w]||e.modified("fields",w)||t.modified(_.fields))&&(y=_.fname,(m=p[y])||(o[y]=g=ez(),p[y]=m=g.insert(_,t.source,0)),a[w]=KT(g,w,i[w]).onAdd(m,l));for(w=0,k=s.data().length;w<k;++w)b[w]||(u[w]!==l[w]?f.push(w):x[w]&&l[w]!==c&&d.push(w));return s.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),r=this._dims.length;let i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<r)-1),t.mod.length&&(this.modify(t,n),i|=(1<<r)-1),this.value.mask=i,n},insert(e,t,n){const r=t.add,i=this.value,o=this._dims,a=this._indices,s=e.fields,l={},u=n.add,c=i.size()+r.length,f=o.length;let d,h,p,m=i.size();i.resize(c,f),i.add(r);const g=i.curr(),y=i.prev(),v=i.all();for(d=0;d<f;++d)h=s[d].fname,p=l[h]||(l[h]=a[h].insert(s[d],r,m)),o[d].onAdd(p,g);for(;m<c;++m)y[m]=v,g[m]!==v&&u.push(m)},modify(e,t){const n=t.mod,r=this.value,i=r.curr(),o=r.all(),a=e.mod;let s,l,u;for(s=0,l=a.length;s<l;++s)u=a[s]._index,i[u]!==o&&n.push(u)},remove(e,t,n){const r=this._indices,i=this.value,o=i.curr(),a=i.prev(),s=i.all(),l={},u=n.rem,c=t.rem;let f,d,h,p;for(f=0,d=c.length;f<d;++f)h=c[f]._index,l[h]=1,a[h]=p=o[h],o[h]=s,p!==s&&u.push(h);for(h in r)r[h].remove(d,l);return this.reindex(t,d,l),l},reindex(e,t,n){const r=this._indices,i=this.value;e.runAfter((()=>{const e=i.remove(t,n);for(const t in r)r[t].reindex(e)}))},update(e,t,n){const r=this._dims,i=e.query,o=t.stamp,a=r.length;let s,l,u=0;for(n.filters=0,l=0;l<a;++l)e.modified("query",l)&&(s=l,++u);if(1===u)u=r[s].one,this.incrementOne(r[s],i[s],n.add,n.rem);else for(l=0,u=0;l<a;++l)e.modified("query",l)&&(u|=r[l].one,this.incrementAll(r[l],i[l],o,n.add),n.rem=n.add);return u},incrementAll(e,t,n,r){const i=this.value,o=i.seen(),a=i.curr(),s=i.prev(),l=e.index(),u=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=u[0],p=u[1],m=e.one;let g,y,v;if(f<h)for(g=f,y=Math.min(h,d);g<y;++g)v=l[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;else if(f>h)for(g=h,y=Math.min(f,p);g<y;++g)v=l[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;if(d>p)for(g=Math.max(f,p),y=d;g<y;++g)v=l[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;else if(d<p)for(g=Math.max(h,d),y=p;g<y;++g)v=l[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;e.range=t.slice()},incrementOne(e,t,n,r){const i=this.value.curr(),o=e.index(),a=e.bisect(e.range),s=e.bisect(t),l=s[0],u=s[1],c=a[0],f=a[1],d=e.one;let h,p,m;if(l<c)for(h=l,p=Math.min(c,u);h<p;++h)m=o[h],i[m]^=d,n.push(m);else if(l>c)for(h=c,p=Math.min(l,f);h<p;++h)m=o[h],i[m]^=d,r.push(m);if(u>f)for(h=Math.max(l,f),p=u;h<p;++h)m=o[h],i[m]^=d,n.push(m);else if(u<f)for(h=Math.max(c,u),p=f;h<p;++h)m=o[h],i[m]^=d,r.push(m);e.range=t.slice()}}),nz.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},rs(nz,Lh,{transform(e,t){const n=~(e.ignore||0),r=e.filter,i=r.mask;if(0==(i&n))return t.StopPropagation;const o=t.fork(t.ALL),a=r.data(),s=r.curr(),l=r.prev(),u=e=>s[e]&n?null:a[e];return o.filter(o.MOD,u),i&i-1?(o.filter(o.ADD,(e=>{const t=s[e]&n;return!t&&t^l[e]&n?a[e]:null})),o.filter(o.REM,(e=>{const t=s[e]&n;return t&&!(t^t^l[e]&n)?a[e]:null}))):(o.filter(o.ADD,u),o.filter(o.REM,(e=>(s[e]&n)===i?a[e]:null))),o.filter(o.SOURCE,(e=>u(e._index)))}});var rz=Object.freeze({__proto__:null,crossfilter:tz,resolvefilter:nz});const iz="Literal",oz="Property",az="ArrayExpression",sz="BinaryExpression",lz="CallExpression",uz="ConditionalExpression",cz="LogicalExpression",fz="MemberExpression",dz="ObjectExpression",hz="UnaryExpression";function pz(e){this.type=e}var mz,gz,yz,vz,bz;pz.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=function(e){switch(e.type){case az:return e.elements;case sz:case cz:return[e.left,e.right];case lz:return[e.callee].concat(e.arguments);case uz:return[e.test,e.consequent,e.alternate];case fz:return[e.object,e.property];case dz:return e.properties;case oz:return[e.key,e.value];case hz:return[e.argument];default:return[]}}(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};var xz=1,wz=2,kz=3,_z=4,Oz=5,Ez=6,Dz=7,jz=8;(mz={})[xz]="Boolean",mz[wz]="<end>",mz[kz]="Identifier",mz[_z]="Keyword",mz[Oz]="Null",mz[Ez]="Numeric",mz[Dz]="Punctuator",mz[jz]="String",mz[9]="RegularExpression";var Nz="ArrayExpression",Sz="BinaryExpression",Az="CallExpression",$z="ConditionalExpression",Cz="Identifier",Mz="Literal",Pz="LogicalExpression",Fz="MemberExpression",Tz="ObjectExpression",zz="Property",Rz="UnaryExpression",Lz="Unexpected token %0",Bz="Unexpected number",Iz="Unexpected string",Uz="Unexpected identifier",qz="Unexpected reserved word",Wz="Unexpected end of input",Zz="Invalid regular expression",Hz="Invalid regular expression: missing /",Gz="Octal literals are not allowed in strict mode.",Vz="Duplicate data property in object literal not allowed in strict mode",Yz="ILLEGAL",Xz="Disabled.",Jz=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),Qz=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function Kz(e,t){if(!e)throw new Error("ASSERT: "+t)}function eR(e){return e>=48&&e<=57}function tR(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function nR(e){return"01234567".indexOf(e)>=0}function rR(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function iR(e){return 10===e||13===e||8232===e||8233===e}function oR(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&Jz.test(String.fromCharCode(e))}function aR(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&Qz.test(String.fromCharCode(e))}const sR={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function lR(){for(;yz<vz;){const e=gz.charCodeAt(yz);if(!rR(e)&&!iR(e))break;++yz}}function uR(e){var t,n,r,i=0;for(n="u"===e?4:2,t=0;t<n;++t)yz<vz&&tR(gz[yz])?(r=gz[yz++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):ER({},Lz,Yz);return String.fromCharCode(i)}function cR(){var e,t,n,r;for(t=0,"}"===(e=gz[yz])&&ER({},Lz,Yz);yz<vz&&tR(e=gz[yz++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&ER({},Lz,Yz),t<=65535?String.fromCharCode(t):(n=55296+(t-65536>>10),r=56320+(t-65536&1023),String.fromCharCode(n,r))}function fR(){var e,t;for(e=gz.charCodeAt(yz++),t=String.fromCharCode(e),92===e&&(117!==gz.charCodeAt(yz)&&ER({},Lz,Yz),++yz,(e=uR("u"))&&"\\"!==e&&oR(e.charCodeAt(0))||ER({},Lz,Yz),t=e);yz<vz&&aR(e=gz.charCodeAt(yz));)++yz,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==gz.charCodeAt(yz)&&ER({},Lz,Yz),++yz,(e=uR("u"))&&"\\"!==e&&aR(e.charCodeAt(0))||ER({},Lz,Yz),t+=e);return t}function dR(){var e,t;return e=yz,t=92===gz.charCodeAt(yz)?fR():function(){var e,t;for(e=yz++;yz<vz;){if(92===(t=gz.charCodeAt(yz)))return yz=e,fR();if(!aR(t))break;++yz}return gz.slice(e,yz)}(),{type:1===t.length?kz:sR.hasOwnProperty(t)?_z:"null"===t?Oz:"true"===t||"false"===t?xz:kz,value:t,start:e,end:yz}}function hR(){var e,t,n,r,i=yz,o=gz.charCodeAt(yz),a=gz[yz];switch(o){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++yz,{type:Dz,value:String.fromCharCode(o),start:i,end:yz};default:if(61===(e=gz.charCodeAt(yz+1)))switch(o){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return yz+=2,{type:Dz,value:String.fromCharCode(o)+String.fromCharCode(e),start:i,end:yz};case 33:case 61:return yz+=2,61===gz.charCodeAt(yz)&&++yz,{type:Dz,value:gz.slice(i,yz),start:i,end:yz}}}return">>>="===(r=gz.substr(yz,4))?{type:Dz,value:r,start:i,end:yz+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:Dz,value:n,start:i,end:yz+=3}:a===(t=n.substr(0,2))[1]&&"+-<>&|".indexOf(a)>=0||"=>"===t?{type:Dz,value:t,start:i,end:yz+=2}:("//"===t&&ER({},Lz,Yz),"<>=!+-*%&|^/".indexOf(a)>=0?(++yz,{type:Dz,value:a,start:i,end:yz}):void ER({},Lz,Yz))}function pR(){var e,t,n;if(Kz(eR((n=gz[yz]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=yz,e="","."!==n){if(e=gz[yz++],n=gz[yz],"0"===e){if("x"===n||"X"===n)return++yz,function(e){let t="";for(;yz<vz&&tR(gz[yz]);)t+=gz[yz++];return 0===t.length&&ER({},Lz,Yz),oR(gz.charCodeAt(yz))&&ER({},Lz,Yz),{type:Ez,value:parseInt("0x"+t,16),start:e,end:yz}}(t);if(nR(n))return function(e){let t="0"+gz[yz++];for(;yz<vz&&nR(gz[yz]);)t+=gz[yz++];return(oR(gz.charCodeAt(yz))||eR(gz.charCodeAt(yz)))&&ER({},Lz,Yz),{type:Ez,value:parseInt(t,8),octal:!0,start:e,end:yz}}(t);n&&eR(n.charCodeAt(0))&&ER({},Lz,Yz)}for(;eR(gz.charCodeAt(yz));)e+=gz[yz++];n=gz[yz]}if("."===n){for(e+=gz[yz++];eR(gz.charCodeAt(yz));)e+=gz[yz++];n=gz[yz]}if("e"===n||"E"===n)if(e+=gz[yz++],"+"!==(n=gz[yz])&&"-"!==n||(e+=gz[yz++]),eR(gz.charCodeAt(yz)))for(;eR(gz.charCodeAt(yz));)e+=gz[yz++];else ER({},Lz,Yz);return oR(gz.charCodeAt(yz))&&ER({},Lz,Yz),{type:Ez,value:parseFloat(e),start:t,end:yz}}function mR(){var e,t,n,r;return bz=null,lR(),e=yz,t=function(){var e,t,n,r;for(Kz("/"===(e=gz[yz]),"Regular expression literal must start with a slash"),t=gz[yz++],n=!1,r=!1;yz<vz;)if(t+=e=gz[yz++],"\\"===e)iR((e=gz[yz++]).charCodeAt(0))&&ER({},Hz),t+=e;else if(iR(e.charCodeAt(0)))ER({},Hz);else if(n)"]"===e&&(n=!1);else{if("/"===e){r=!0;break}"["===e&&(n=!0)}return r||ER({},Hz),{value:t.substr(1,t.length-2),literal:t}}(),n=function(){var e,t,n;for(t="",n="";yz<vz&&aR((e=gz[yz]).charCodeAt(0));)++yz,"\\"===e&&yz<vz?ER({},Lz,Yz):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&ER({},Zz,n),{value:n,literal:t}}(),r=function(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,((e,t)=>{if(parseInt(t,16)<=1114111)return"x";ER({},Zz)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(x9){ER({},Zz)}try{return new RegExp(e,t)}catch(r){return null}}(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:yz}}function gR(){if(lR(),yz>=vz)return{type:wz,start:yz,end:yz};const e=gz.charCodeAt(yz);return oR(e)?dR():40===e||41===e||59===e?hR():39===e||34===e?function(){var e,t,n,r,i="",o=!1;for(Kz("'"===(e=gz[yz])||'"'===e,"String literal must starts with a quote"),t=yz,++yz;yz<vz;){if((n=gz[yz++])===e){e="";break}if("\\"===n)if((n=gz[yz++])&&iR(n.charCodeAt(0)))"\r"===n&&"\n"===gz[yz]&&++yz;else switch(n){case"u":case"x":"{"===gz[yz]?(++yz,i+=cR()):i+=uR(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:nR(n)?(0!==(r="01234567".indexOf(n))&&(o=!0),yz<vz&&nR(gz[yz])&&(o=!0,r=8*r+"01234567".indexOf(gz[yz++]),"0123".indexOf(n)>=0&&yz<vz&&nR(gz[yz])&&(r=8*r+"01234567".indexOf(gz[yz++]))),i+=String.fromCharCode(r)):i+=n}else{if(iR(n.charCodeAt(0)))break;i+=n}}return""!==e&&ER({},Lz,Yz),{type:jz,value:i,octal:o,start:t,end:yz}}():46===e?eR(gz.charCodeAt(yz+1))?pR():hR():eR(e)?pR():hR()}function yR(){const e=bz;return yz=e.end,bz=gR(),yz=e.end,e}function vR(){const e=yz;bz=gR(),yz=e}function bR(e,t,n){const r=new pz("||"===e||"&&"===e?Pz:Sz);return r.operator=e,r.left=t,r.right=n,r}function xR(e,t){const n=new pz(Az);return n.callee=e,n.arguments=t,n}function wR(e){const t=new pz(Cz);return t.name=e,t}function kR(e){const t=new pz(Mz);return t.value=e.value,t.raw=gz.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function _R(e,t,n){const r=new pz(Fz);return r.computed="["===e,r.object=t,r.property=n,r.computed||(n.member=!0),r}function OR(e,t,n){const r=new pz(zz);return r.key=t,r.value=n,r.kind=e,r}function ER(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,((e,t)=>(Kz(t<r.length,"Message reference must be in range"),r[t])));throw(n=new Error(i)).index=yz,n.description=i,n}function DR(e){e.type===wz&&ER(e,Wz),e.type===Ez&&ER(e,Bz),e.type===jz&&ER(e,Iz),e.type===kz&&ER(e,Uz),e.type===_z&&ER(e,qz),ER(e,Lz,e.value)}function jR(e){const t=yR();t.type===Dz&&t.value===e||DR(t)}function NR(e){return bz.type===Dz&&bz.value===e}function SR(e){return bz.type===_z&&bz.value===e}function AR(){const e=[];for(yz=bz.start,jR("[");!NR("]");)NR(",")?(yR(),e.push(null)):(e.push(UR()),NR("]")||jR(","));return yR(),function(e){const t=new pz(Nz);return t.elements=e,t}(e)}function $R(){yz=bz.start;const e=yR();return e.type===jz||e.type===Ez?(e.octal&&ER(e,Gz),kR(e)):wR(e.value)}function CR(){var e,t,n;return yz=bz.start,(e=bz).type===kz?(n=$R(),jR(":"),OR("init",n,UR())):e.type!==wz&&e.type!==Dz?(t=$R(),jR(":"),OR("init",t,UR())):void DR(e)}function MR(){var e,t,n=[],r={},i=String;for(yz=bz.start,jR("{");!NR("}");)t="$"+((e=CR()).key.type===Cz?e.key.name:i(e.key.value)),Object.prototype.hasOwnProperty.call(r,t)?ER({},Vz):r[t]=!0,n.push(e),NR("}")||jR(",");return jR("}"),function(e){const t=new pz(Tz);return t.properties=e,t}(n)}const PR={if:1};function FR(){var e,t,n;if(NR("("))return function(){jR("(");const e=qR();return jR(")"),e}();if(NR("["))return AR();if(NR("{"))return MR();if(e=bz.type,yz=bz.start,e===kz||PR[bz.value])n=wR(yR().value);else if(e===jz||e===Ez)bz.octal&&ER(bz,Gz),n=kR(yR());else{if(e===_z)throw new Error(Xz);e===xz?((t=yR()).value="true"===t.value,n=kR(t)):e===Oz?((t=yR()).value=null,n=kR(t)):NR("/")||NR("/=")?(n=kR(mR()),vR()):DR(yR())}return n}function TR(){const e=[];if(jR("("),!NR(")"))for(;yz<vz&&(e.push(UR()),!NR(")"));)jR(",");return jR(")"),e}function zR(){yz=bz.start;const e=yR();return function(e){return e.type===kz||e.type===_z||e.type===xz||e.type===Oz}(e)||DR(e),wR(e.value)}function RR(){jR("[");const e=qR();return jR("]"),e}function LR(){const e=function(){var e;for(e=FR();;)if(NR("."))jR("."),e=_R(".",e,zR());else if(NR("("))e=xR(e,TR());else{if(!NR("["))break;e=_R("[",e,RR())}return e}();if(bz.type===Dz&&(NR("++")||NR("--")))throw new Error(Xz);return e}function BR(){var e,t;if(bz.type!==Dz&&bz.type!==_z)t=LR();else{if(NR("++")||NR("--"))throw new Error(Xz);if(NR("+")||NR("-")||NR("~")||NR("!"))e=yR(),t=BR(),t=function(e,t){const n=new pz(Rz);return n.operator=e,n.argument=t,n.prefix=!0,n}(e.value,t);else{if(SR("delete")||SR("void")||SR("typeof"))throw new Error(Xz);t=LR()}}return t}function IR(e){let t=0;if(e.type!==Dz&&e.type!==_z)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function UR(){var e,t;return e=function(){var e,t,n,r,i,o,a,s,l,u;if(e=bz,l=BR(),0===(i=IR(r=bz)))return l;for(r.prec=i,yR(),t=[e,bz],o=[l,r,a=BR()];(i=IR(bz))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)a=o.pop(),s=o.pop().value,l=o.pop(),t.pop(),n=bR(s,l,a),o.push(n);(r=yR()).prec=i,o.push(r),t.push(bz),n=BR(),o.push(n)}for(n=o[u=o.length-1],t.pop();u>1;)t.pop(),n=bR(o[u-1].value,o[u-2],n),u-=2;return n}(),NR("?")&&(yR(),t=UR(),jR(":"),e=function(e,t,n){const r=new pz($z);return r.test=e,r.consequent=t,r.alternate=n,r}(e,t,UR())),e}function qR(){const e=UR();if(NR(","))throw new Error(Xz);return e}function WR(e){yz=0,vz=(gz=e).length,bz=null,vR();const t=qR();if(bz.type!==wz)throw new Error("Unexpect token after expression.");return t}var ZR={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function HR(e){function t(t,n,r){return i=>function(t,n,r,i){let o=e(n[0]);return r&&(o=r+"("+o+")",0===r.lastIndexOf("new ",0)&&(o="("+o+")")),o+"."+t+(i<0?"":0===i?"()":"("+n.slice(1).map(e).join(",")+")")}(t,i,n,r)}const n="new Date",r="String",i="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(t){t.length<3&&Jo("Missing arguments to clamp function."),t.length>3&&Jo("Too many arguments to clamp function.");const n=t.map(e);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:t("getDate",n,0),day:t("getDay",n,0),year:t("getFullYear",n,0),month:t("getMonth",n,0),hours:t("getHours",n,0),minutes:t("getMinutes",n,0),seconds:t("getSeconds",n,0),milliseconds:t("getMilliseconds",n,0),time:t("getTime",n,0),timezoneoffset:t("getTimezoneOffset",n,0),utcdate:t("getUTCDate",n,0),utcday:t("getUTCDay",n,0),utcyear:t("getUTCFullYear",n,0),utcmonth:t("getUTCMonth",n,0),utchours:t("getUTCHours",n,0),utcminutes:t("getUTCMinutes",n,0),utcseconds:t("getUTCSeconds",n,0),utcmilliseconds:t("getUTCMilliseconds",n,0),length:t("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:t("toUpperCase",r,0),lower:t("toLowerCase",r,0),substring:t("substring",r),split:t("split",r),trim:t("trim",r,0),regexp:i,test:t("test",i),if:function(t){t.length<3&&Jo("Missing arguments to if function."),t.length>3&&Jo("Too many arguments to if function.");const n=t.map(e);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}function GR(e){const t=(e=e||{}).allowed?_s(e.allowed):{},n=e.forbidden?_s(e.forbidden):{},r=e.constants||ZR,i=(e.functions||HR)(f),o=e.globalvar,a=e.fieldvar,s=Ba(o)?o:e=>`${o}["${e}"]`;let l={},u={},c=0;function f(e){if(cs(e))return e;const t=d[e.type];return null==t&&Jo("Unsupported type: "+e.type),t(e)}const d={Literal:e=>e.raw,Identifier:e=>{const i=e.name;return c>0?i:Ka(n,i)?Jo("Illegal identifier: "+i):Ka(r,i)?r[i]:Ka(t,i)?i:(l[i]=1,s(i))},MemberExpression:e=>{const t=!e.computed,n=f(e.object);t&&(c+=1);const r=f(e.property);return n===a&&(u[function(e){const t=e&&e.length-1;return t&&('"'===e[0]&&'"'===e[t]||"'"===e[0]&&"'"===e[t])?e.slice(1,-1):e}(r)]=1),t&&(c-=1),n+(t?"."+r:"["+r+"]")},CallExpression:e=>{"Identifier"!==e.callee.type&&Jo("Illegal callee type: "+e.callee.type);const t=e.callee.name,n=e.arguments,r=Ka(i,t)&&i[t];return r||Jo("Unrecognized function: "+t),Ba(r)?r(n):r+"("+n.map(f).join(",")+")"},ArrayExpression:e=>"["+e.elements.map(f).join(",")+"]",BinaryExpression:e=>"("+f(e.left)+" "+e.operator+" "+f(e.right)+")",UnaryExpression:e=>"("+e.operator+f(e.argument)+")",ConditionalExpression:e=>"("+f(e.test)+"?"+f(e.consequent)+":"+f(e.alternate)+")",LogicalExpression:e=>"("+f(e.left)+e.operator+f(e.right)+")",ObjectExpression:e=>"{"+e.properties.map(f).join(",")+"}",Property:e=>{c+=1;const t=f(e.key);return c-=1,t+":"+f(e.value)}};function h(e){const t={code:f(e),globals:Object.keys(l),fields:Object.keys(u)};return l={},u={},t}return h.functions=i,h.constants=r,h}function VR(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function YR(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function XR(){return 0}function JR(e){return e instanceof el?e:new el(e)}const QR="intersect",KR="union",eL="_vgsid_",tL=Ko(eL),nL="E",rL="R",iL="R-E",oL="R-LE",aL="R-RE",sL="index:unit";function lL(e,t){for(var n,r,i=t.fields,o=t.values,a=i.length,s=0;s<a;++s)if((r=i[s]).getter=Ko.getter||Ko(r.field),as(n=r.getter(e))&&(n=xa(n)),as(o[s])&&(o[s]=xa(o[s])),as(o[s][0])&&(o[s]=o[s].map(xa)),r.type===nL){if(ha(o[s])?o[s].indexOf(n)<0:n!==o[s])return!1}else if(r.type===rL){if(!is(n,o[s]))return!1}else if(r.type===aL){if(!is(n,o[s],!0,!1))return!1}else if(r.type===iL){if(!is(n,o[s],!1,!1))return!1}else if(r.type===oL&&!is(n,o[s],!1,!0))return!1;return!0}const uL=function(e){let t,n,r;function i(e,r,i,o){if(void 0===i&&(i=0),void 0===o&&(o=e.length),i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<0?i=t+1:o=t}while(i<o)}return i}return 2!==e.length?(t=VR,n=(t,n)=>VR(e(t),n),r=(t,n)=>e(t)-n):(t=e===VR||e===YR?e:XR,n=e,r=e),{left:i,center:function(e,t,n,o){void 0===n&&(n=0),void 0===o&&(o=e.length);const a=i(e,t,n,o-1);return a>n&&r(e[a-1],t)>-r(e[a],t)?a-1:a},right:function(e,r,i,o){if(void 0===i&&(i=0),void 0===o&&(o=e.length),i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<=0?i=t+1:o=t}while(i<o)}return i}}}(tL),cL=uL.left,fL=uL.right;var dL={[`${eL}_union`]:function(){const e=new el;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)for(const t of i)e.add(t);return e},[`${eL}_intersect`]:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e=new el(e),n=n.map(JR);e:for(const i of e)for(const t of n)if(!t.has(i)){e.delete(i);continue e}return e},E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter((e=>t.indexOf(e)>=0)):t},R_union:function(e,t){var n=xa(t[0]),r=xa(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]},R_intersect:function(e,t){var n=xa(t[0]),r=xa(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]}};function hL(e,t,n,r){t[0].type!==iz&&Jo("First argument to selection functions must be a string literal.");const i=t[0].value,o="unit",a="@"+o,s=":"+i;(t.length>=2&&ba(t).value)!==QR||Ka(r,a)||(r[a]=n.getData(i).indataRef(n,o)),Ka(r,s)||(r[s]=n.getData(i).tuplesRef())}function pL(e){const t=this.context.data[e];return t?t.values.value:[]}const mL=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},gL=mL("format"),yL=mL("timeFormat"),vL=mL("utcFormat"),bL=mL("timeParse"),xL=mL("utcParse"),wL=new Date(2e3,0,1);function kL(e,t,n){return Number.isInteger(e)&&Number.isInteger(t)?(wL.setYear(2e3),wL.setMonth(e),wL.setDate(t),yL.call(this,wL,n)):""}const _L="%",OL="$";function EL(e,t,n,r){t[0].type!==iz&&Jo("First argument to data functions must be a string literal.");const i=t[0].value,o=":"+i;if(!Ka(o,r))try{r[o]=n.getData(i).tuplesRef()}catch(a){}}function DL(e,t,n,r){if(t[0].type===iz)jL(n,r,t[0].value);else for(e in n.scales)jL(n,r,e)}function jL(e,t,n){const r=_L+n;if(!Ka(t,r))try{t[r]=e.scaleRef(n)}catch(i){}}function NL(e,t){if(Ba(e))return e;if(cs(e)){const n=t.scales[e];return n&&function(e){return e&&!0===e[Tx]}(n.value)?n.value:void 0}}function SL(e,t,n){t.__bandwidth=e=>e&&e.bandwidth?e.bandwidth():0,n._bandwidth=DL,n._range=DL,n._scale=DL;const r=t=>"_["+(t.type===iz?vs(_L+t.value):vs(_L)+"+"+e(t))+"]";return{_bandwidth:e=>`this.__bandwidth(${r(e[0])})`,_range:e=>`${r(e[0])}.range()`,_scale:t=>`${r(t[0])}(${e(t[1])})`}}function AL(e,t){return function(n,r,i){if(n){const t=NL(n,(i||this).context);return t&&t.path[e](r)}return t(r)}}const $L=AL("area",(function(e){return eS=new Qs,TN(e,tS),2*eS})),CL=AL("bounds",(function(e){var t,n,r,i,o,a,s;if(ZN=WN=-(UN=qN=1/0),JN=[],TN(e,SS),n=JN.length){for(JN.sort(RS),t=1,o=[r=JN[0]];t<n;++t)LS(r,(i=JN[t])[0])||LS(r,i[1])?(zS(r[0],i[1])>zS(r[0],r[1])&&(r[1]=i[1]),zS(i[0],r[1])>zS(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(a=-1/0,t=0,r=o[n=o.length-1];t<=n;r=i,++t)i=o[t],(s=zS(r[1],i[0]))>a&&(a=s,UN=i[0],WN=r[1])}return JN=QN=null,UN===1/0||qN===1/0?[[NaN,NaN],[NaN,NaN]]:[[UN,qN],[WN,ZN]]})),ML=AL("centroid",(function(e){hS=pS=mS=gS=yS=vS=bS=xS=0,wS=new Qs,kS=new Qs,_S=new Qs,TN(e,BS);var t=+wS,n=+kS,r=+_S,i=wN(t,n,r);return i<lN&&(t=vS,n=bS,r=xS,pS<sN&&(t=mS,n=gS,r=yS),(i=wN(t,n,r))<lN)?[NaN,NaN]:[yN(n,t)*hN,SN(r/i)*hN]}));function PL(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function FL(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function TL(e){const t=Yy(e);return.2126*FL(t.r)+.7152*FL(t.g)+.0722*FL(t.b)}function zL(e,t){return e===t||e!=e&&t!=t||(ha(e)?!(!ha(t)||e.length!==t.length)&&function(e,t){for(let n=0,r=e.length;n<r;++n)if(!zL(e[n],t[n]))return!1;return!0}(e,t):!(!pa(e)||!pa(t))&&RL(e,t))}function RL(e,t){for(const n in e)if(!zL(e[n],t[n]))return!1;return!0}function LL(e){return t=>RL(e,t)}const BL={};function IL(e){return ha(e)||ArrayBuffer.isView(e)?e:null}function UL(e){return IL(e)||(cs(e)?e:null)}const qL=e=>e.data;function WL(e,t){const n=pL.call(t,e);return n.root&&n.root.lookup||{}}const ZL=()=>"undefined"!=typeof window&&window||null;function HL(e,t,n){if(!e)return[];const[r,i]=e,o=(new Dk).set(r[0],r[1],i[0],i[1]);return tD(n||this.context.dataflow.scenegraph().root,o,function(e){let t=null;if(e){const n=Ra(e.marktype),r=Ra(e.markname);t=e=>(!n.length||n.some((t=>e.marktype===t)))&&(!r.length||r.some((t=>e.name===t)))}return t}(t))}const GL={random:()=>Vh(),cumulativeNormal:np,cumulativeLogNormal:lp,cumulativeUniform:pp,densityNormal:tp,densityLogNormal:sp,densityUniform:hp,quantileNormal:rp,quantileLogNormal:up,quantileUniform:mp,sampleNormal:ep,sampleLogNormal:ap,sampleUniform:dp,isArray:ha,isBoolean:os,isDate:as,isDefined:e=>void 0!==e,isNumber:ls,isObject:pa,isRegExp:us,isString:cs,isTuple:oh,isValid:e=>null!=e&&e==e,toBoolean:bs,toDate:e=>ws(e),toNumber:xa,toString:ks,indexof:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return UL(e).indexOf(...n)},join:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return IL(e).join(...n)},lastindexof:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return UL(e).lastIndexOf(...n)},replace:function(e,t,n){return Ba(n)&&Jo("Function argument passed to replace."),String(e).replace(t,n)},reverse:function(e){return IL(e).slice().reverse()},slice:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return UL(e).slice(...n)},flush:ns,lerp:ds,merge:function(){const e=[].slice.call(arguments);return e.unshift({}),Ya(...e)},pad:gs,peek:ba,pluck:function(e,t){const n=BL[t]||(BL[t]=Ko(t));return ha(e)?e.map(n):n(e)},span:ys,inrange:is,truncate:Os,rgb:Yy,lab:bv,hcl:Ev,hsl:iv,luminance:TL,contrast:function(e,t){const n=TL(e),r=TL(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},sequence:wl,format:gL,utcFormat:vL,utcParse:xL,utcOffset:wc,utcSequence:Oc,timeFormat:yL,timeParse:bL,timeOffset:xc,timeSequence:_c,timeUnitSpecifier:Hu,monthFormat:function(e){return kL.call(this,e,1,"%B")},monthAbbrevFormat:function(e){return kL.call(this,e,1,"%b")},dayFormat:function(e){return kL.call(this,0,2+e,"%A")},dayAbbrevFormat:function(e){return kL.call(this,0,2+e,"%a")},quarter:Ta,utcquarter:za,week:Xu,utcweek:nc,dayofyear:Yu,utcdayofyear:tc,warn:function(){return PL(this.context.dataflow,"warn",arguments)},info:function(){return PL(this.context.dataflow,"info",arguments)},debug:function(){return PL(this.context.dataflow,"debug",arguments)},extent:e=>Xa(e),inScope:function(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n},intersect:HL,clampRange:La,pinchDistance:function(e){const t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.hypot(n,r)},pinchAngle:function(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)},screen:function(){const e=ZL();return e?e.screen:{}},containerSize:function(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]},windowSize:function(){const e=ZL();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]},bandspace:function(e,t,n){return ux(e||0,t||0,n||0)},setdata:function(e,t){const n=this.context.dataflow,r=this.context.data[e].input;return n.pulse(r,n.changeset().remove(ia).insert(t)),1},pathShape:function(e){let t=null;return function(n){return n?Yw(n,t=t||Rw(e)):e}},panLinear:ja,panLog:Na,panPow:Sa,panSymlog:Aa,zoomLinear:Ca,zoomLog:Ma,zoomPow:Pa,zoomSymlog:Fa,encode:function(e,t,n){if(e){const n=this.context.dataflow,r=e.mark.source;n.pulse(r,n.changeset().encode(e,t))}return void 0!==n?n:e},modify:function(e,t,n,r,i,o){const a=this.context.dataflow,s=this.context.data[e],l=s.input,u=a.stamp();let c,f,d=s.changes;if(!1===a._trigger||!(l.value.length||t||r))return 0;if((!d||d.stamp<u)&&(s.changes=d=a.changeset(),d.stamp=u,a.runAfter((()=>{s.modified=!0,a.pulse(l,d).run()}),!0,1)),n&&(c=!0===n?ia:ha(n)||oh(n)?n:LL(n),d.remove(c)),t&&d.insert(t),r&&(c=LL(r),l.value.some(c)?d.remove(c):d.insert(r)),i)for(f in o)d.modify(i,f,o[f]);return 1},lassoAppend:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;const i=(e=Ra(e))[e.length-1];return void 0===i||Math.hypot(i[0]-t,i[1]-n)>r?[...e,[t,n]]:e},lassoPath:function(e){return Ra(e).reduce(((t,n,r)=>{let[i,o]=n;return t+(0==r?`M ${i},${o} `:r===e.length-1?" Z":`L ${i},${o} `)}),"")},intersectLasso:function(e,t,n){const{x:r,y:i,mark:o}=n,a=(new Dk).set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[s,l]of t)s<a.x1&&(a.x1=s),s>a.x2&&(a.x2=s),l<a.y1&&(a.y1=l),l>a.y2&&(a.y2=l);return a.translate(r,i),HL([[a.x1,a.y1],[a.x2,a.y2]],e,o).filter((e=>function(e,t,n){let r=0;for(let i=0,o=n.length-1;i<n.length;o=i++){const[a,s]=n[o],[l,u]=n[i];u>t!=s>t&&e<(a-l)*(t-u)/(s-u)+l&&r++}return 1&r}(e.x,e.y,t)))}},VL=["view","item","group","xy","x","y"],YL="this.",XL={},JL={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${vs(OL+e)}]`,functions:function(e){const t=HR(e);VL.forEach((e=>t[e]="event.vega."+e));for(const n in GL)t[n]=YL+n;return Ya(t,SL(e,GL,XL)),t},constants:ZR,visitors:XL},QL=GR(JL);function KL(e,t,n){return 1===arguments.length?GL[e]:(GL[e]=t,n&&(XL[e]=n),QL&&(QL.functions[e]=YL+e),this)}function eB(e,t){const n={};let r;try{r=WR(e=cs(e)?e:vs(e)+"")}catch(o){Jo("Expression parse error: "+e)}r.visit((e=>{if(e.type!==lz)return;const r=e.callee.name,i=JL.visitors[r];i&&i(r,e.arguments,t,n)}));const i=QL(r);return i.globals.forEach((e=>{const r=OL+e;!Ka(n,r)&&t.getSignal(e)&&(n[r]=t.signalRef(e))})),{$expr:Ya({code:i.code},t.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}KL("bandwidth",(function(e,t){const n=NL(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}),DL),KL("copy",(function(e,t){const n=NL(e,(t||this).context);return n?n.copy():void 0}),DL),KL("domain",(function(e,t){const n=NL(e,(t||this).context);return n?n.domain():[]}),DL),KL("range",(function(e,t){const n=NL(e,(t||this).context);return n&&n.range?n.range():[]}),DL),KL("invert",(function(e,t,n){const r=NL(e,(n||this).context);return r?ha(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}),DL),KL("scale",(function(e,t,n){const r=NL(e,(n||this).context);return r?r(t):void 0}),DL),KL("gradient",(function(e,t,n,r,i){e=NL(e,(i||this).context);const o=Aw(t,n);let a=e.domain(),s=a[0],l=ba(a),u=ta;return l-s?u=Jx(e,s,l):e=(e.interpolator?Rx("sequential")().interpolator(e.interpolator()):Rx("linear")().interpolate(e.interpolate()).range(e.range())).domain([s=0,l=1]),e.ticks&&(a=e.ticks(+r||15),s!==a[0]&&a.unshift(s),l!==ba(a)&&a.push(l)),a.forEach((t=>o.stop(u(t),e(t)))),o}),DL),KL("geoArea",$L,DL),KL("geoBounds",CL,DL),KL("geoCentroid",ML,DL),KL("geoShape",(function(e,t,n){const r=NL(e,(n||this).context);return function(e){return r?r.path.context(e)(t):""}}),DL),KL("indata",(function(e,t,n){const r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i?i.count:i}),(function(e,t,n,r){t[0].type!==iz&&Jo("First argument to indata must be a string literal."),t[1].type!==iz&&Jo("Second argument to indata must be a string literal.");const i=t[0].value,o=t[1].value,a="@"+o;Ka(a,r)||(r[a]=n.getData(i).indataRef(n,o))})),KL("data",pL,EL),KL("treePath",(function(e,t,n){const r=WL(e,this),i=r[t],o=r[n];return i&&o?i.path(o).map(qL):void 0}),EL),KL("treeAncestors",(function(e,t){const n=WL(e,this)[t];return n?n.ancestors().map(qL):void 0}),EL),KL("vlSelectionTest",(function(e,t,n){for(var r,i,o,a,s,l=this.context.data[e],u=l?l.values.value:[],c=l?l[sL]&&l[sL].value:void 0,f=n===QR,d=u.length,h=0;h<d;++h)if(r=u[h],c&&f){if(-1===(o=(i=i||{})[a=r.unit]||0))continue;if(s=lL(t,r),i[a]=s?-1:++o,s&&1===c.size)return!0;if(!s&&o===c.get(a).count)return!1}else if(f^(s=lL(t,r)))return s;return d&&f}),hL),KL("vlSelectionIdTest",(function(e,t,n){const r=this.context.data[e],i=r?r.values.value:[],o=r?r[sL]&&r[sL].value:void 0,a=n===QR,s=tL(t),l=cL(i,s);if(l===i.length)return!1;if(tL(i[l])!==s)return!1;if(o&&a){if(1===o.size)return!0;if(fL(i,s)-l<o.size)return!1}return!0}),hL),KL("vlSelectionResolve",(function(e,t,n,r){for(var i,o,a,s,l,u,c,f,d,h,p,m,g=this.context.data[e],y=g?g.values.value:[],v={},b={},x={},w=y.length,k=0;k<w;++k)if(s=(i=y[k]).unit,o=i.fields,a=i.values,o&&a){for(p=0,m=o.length;p<m;++p)l=o[p],f=(c=v[l.field]||(v[l.field]={}))[s]||(c[s]=[]),x[l.field]=d=l.type.charAt(0),h=dL[`${d}_union`],c[s]=h(f,Ra(a[p]));n&&(f=b[s]||(b[s]=[])).push(Ra(a).reduce(((e,t,n)=>(e[o[n].field]=t,e)),{}))}else l=eL,u=tL(i),(f=(c=v[l]||(v[l]={}))[s]||(c[s]=[])).push(u),n&&(f=b[s]||(b[s]=[])).push({[eL]:u});if(t=t||KR,v[eL]?v[eL]=dL[`${eL}_${t}`](...Object.values(v[eL])):Object.keys(v).forEach((e=>{v[e]=Object.keys(v[e]).map((t=>v[e][t])).reduce(((n,r)=>void 0===n?r:dL[`${x[e]}_${t}`](n,r)))})),y=Object.keys(b),n&&y.length){v[r?"vlPoint":"vlMulti"]=t===KR?{or:y.reduce(((e,t)=>(e.push(...b[t]),e)),[])}:{and:y.map((e=>({or:b[e]})))}}return v}),hL),KL("vlSelectionTuples",(function(e,t){return e.map((e=>Ya(t.fields?{values:t.fields.map((t=>(t.getter||(t.getter=Ko(t.field)))(e.datum)))}:{[eL]:tL(e.datum)},t)))}));const tB=_s(["rule"]),nB=_s(["group","image","rect"]);function rB(e){return(e+"").toLowerCase()}function iB(e,t,n){n.endsWith(";")||(n="return("+n+");");const r=Function(...t.concat(n));return e&&e.functions?r.bind(e.functions):r}var oB={operator:(e,t)=>iB(e,["_"],t.code),parameter:(e,t)=>iB(e,["datum","_"],t.code),event:(e,t)=>iB(e,["event"],t.code),handler:(e,t)=>iB(e,["_","event"],`var datum=event.item&&event.item.datum;return ${t.code};`),encode:(e,t)=>{const{marktype:n,channels:r}=t;let i="var o=item,datum=o.datum,m=0,$;";for(const o in r){const e="o["+vs(o)+"]";i+=`$=${r[o].code};if(${e}!==$)${e}=$,m=1;`}return i+=function(e,t){let n="";return tB[t]||(e.x2&&(e.x?(nB[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(nB[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}(r,n),i+="return m;",iB(e,["item","_"],i)},codegen:{get(e){const t=`[${e.map(vs).join("][")}]`,n=Function("_",`return _${t};`);return n.path=t,n},comparator(e,t){let n;const r=Function("a","b","var u, v; return "+e.map(((e,r)=>{const i=t[r];let o,a;return e.path?(o=`a${e.path}`,a=`b${e.path}`):((n=n||{})["f"+r]=e,o=`this.f${r}(a)`,a=`this.f${r}(b)`),function(e,t,n,r){return`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n}\n  : (u > v || v == null) && u != null ? ${r}\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}\n  : v !== v && u === u ? ${r} : `}(o,a,-i,i)})).join("")+"0;");return n?r.bind(n):r}}};function aB(e,t,n){if(!e||!pa(e))return e;for(let r,i=0,o=sB.length;i<o;++i)if(r=sB[i],Ka(e,r.key))return r.parse(e,t,n);return e}var sB=[{key:"$ref",parse:function(e,t){return t.get(e.$ref)||Jo("Operator not defined: "+e.$ref)}},{key:"$key",parse:function(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=fs(e.$key,e.$flat,t.expr.codegen))}},{key:"$expr",parse:function(e,t,n){e.$params&&t.parseParameters(e.$params,n);const r="e:"+e.$expr.code;return t.fn[r]||(t.fn[r]=Zo(t.parameterExpression(e.$expr),e.$fields))}},{key:"$field",parse:function(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Ko(e.$field,e.$name,t.expr.codegen))}},{key:"$encode",parse:function(e,t){const n=e.$encode,r={};for(const i in n){const e=n[i];r[i]=Zo(t.encodeExpression(e.$expr),e.$fields),r[i].output=e.$output}return r}},{key:"$compare",parse:function(e,t){const n="c:"+e.$compare+"_"+e.$order,r=Ra(e.$compare).map((e=>e&&e.$tupleid?ah:e));return t.fn[n]||(t.fn[n]=Ua(r,e.$order,t.expr.codegen))}},{key:"$context",parse:function(e,t){return t}},{key:"$subflow",parse:function(e,t){const n=e.$subflow;return function(e,r,i){const o=t.fork().parse(n),a=o.get(n.operators[0].id),s=o.signals.parent;return s&&s.set(i),a.detachSubflow=()=>t.detach(o),a}}},{key:"$tupleid",parse:function(){return ah}}];const lB={skip:!0};function uB(e,t,n,r){return new cB(e,t,n,r)}function cB(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||oB,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function fB(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}function dB(e,t){e&&(null==t?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}cB.prototype=fB.prototype={fork(){const e=new fB(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter((t=>t!==e));const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,r=n.dataflow,i=e.value;if(n.set(e.id,t),function(e){return"collect"===rB(e)}(e.type)&&i&&(i.$ingest?r.ingest(t,i.$ingest,i.$format):i.$request?r.preload(t,i.$request,i.$format):r.pulse(t,r.changeset().insert(i))),e.root&&(n.root=t),e.parent){let i=n.get(e.parent.$ref);i?(r.connect(i,[t]),t.targets().add(i)):(n.unresolved=n.unresolved||[]).push((()=>{i=n.get(e.parent.$ref),r.connect(i,[t]),t.targets().add(i)}))}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const o in e.data){const r=n.data[o]||(n.data[o]={});e.data[o].forEach((e=>r[e]=t))}},resolve(){return(this.unresolved||[]).forEach((e=>e())),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[rB(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:function(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach((e=>t.parseOperator(e))),n.forEach((e=>t.parseOperatorParameters(e))),(e.streams||[]).forEach((e=>t.parseStream(e))),(e.updates||[]).forEach((e=>t.parseUpdate(e))),t.resolve()},parseOperator:function(e){const t=this;!function(e){return"operator"===rB(e)}(e.type)&&e.type?t.transform(e,e.type):t.operator(e,e.update?t.operatorExpression(e.update):null)},parseOperatorParameters:function(e){const t=this;if(e.params){const n=t.get(e.id);n||Jo("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}},parseParameters:function(e,t){t=t||{};const n=this;for(const r in e){const i=e[r];t[r]=ha(i)?i.map((e=>aB(e,n,t))):aB(i,n,t)}return t},parseStream:function(e){var t,n=this,r=null!=e.filter?n.eventExpression(e.filter):void 0,i=null!=e.stream?n.get(e.stream):void 0;e.source?i=n.events(e.source,e.type,r):e.merge&&(i=(t=e.merge.map((e=>n.get(e))))[0].merge.apply(t[0],t.slice(1))),e.between&&(t=e.between.map((e=>n.get(e))),i=i.between(t[0],t[1])),e.filter&&(i=i.filter(r)),null!=e.throttle&&(i=i.throttle(+e.throttle)),null!=e.debounce&&(i=i.debounce(+e.debounce)),null==i&&Jo("Invalid stream definition: "+JSON.stringify(e)),e.consume&&i.consume(!0),n.stream(e,i)},parseUpdate:function(e){var t,n=this,r=pa(r=e.source)?r.$ref:r,i=n.get(r),o=e.update,a=void 0;i||Jo("Source not defined: "+e.source),t=e.target&&e.target.$expr?n.eventExpression(e.target.$expr):n.get(e.target),o&&o.$expr&&(o.$params&&(a=n.parseParameters(o.$params)),o=n.handlerExpression(o.$expr)),n.update(e,i,t,o,a)},getState:function(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach((n=>{const i=t.signals[n];e.signals(n,i)&&(r[n]=i.value)}))}if(e.data){var i=n.data={};Object.keys(t.data).forEach((n=>{const r=t.data[n];e.data(n,r)&&(i[n]=r.input.value)}))}return t.subcontext&&!1!==e.recurse&&(n.subcontext=t.subcontext.map((t=>t.getState(e)))),n},setState:function(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach((e=>{n.update(t.signals[e],i[e],lB)})),Object.keys(r||{}).forEach((e=>{n.pulse(t.data[e].input,n.changeset().remove(ia).insert(r[e]))})),(e.subcontext||[]).forEach(((e,n)=>{const r=t.subcontext[n];r&&r.setState(e)}))}};const hB="default";function pB(e,t){const n=e.globalCursor()?"undefined"!=typeof document&&document.body:e.container();if(n)return null==t?n.style.removeProperty("cursor"):n.style.cursor=t}function mB(e,t){var n=e._runtime.data;return Ka(n,t)||Jo("Unrecognized data set: "+t),n[t]}function gB(e,t){hh(t)||Jo("Second argument to changes must be a changeset.");const n=mB(this,e);return n.modified=!0,this.pulse(n.input,t)}function yB(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function vB(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function bB(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function xB(e,t,n){var r,i,o=e._renderer,a=o&&o.canvas();return a&&(i=bB(e),(r=RO(t.changedTouches?t.changedTouches[0]:t,a))[0]-=i[0],r[1]-=i[1]),t.dataflow=e,t.item=n,t.vega=function(e,t,n){const r=t?"group"===t.mark.marktype?t:t.mark.group:null;function i(e){var n,i=r;if(e)for(n=t;n;n=n.mark.group)if(n.mark.name===e){i=n;break}return i&&i.mark&&i.mark.interactive?i:{}}function o(e){if(!e)return n;cs(e)&&(e=i(e));const t=n.slice();for(;e;)t[0]-=e.x||0,t[1]-=e.y||0,e=e.mark&&e.mark.group;return t}return{view:Ga(e),item:Ga(t||{}),group:i,xy:o,x:e=>o(e)[0],y:e=>o(e)[1]}}(e,n,r),t}const wB="view",kB={trap:!1};function _B(e,t,n,r){e._eventListeners.push({type:n,sources:Ra(t),handler:r})}function OB(e,t,n){const r=e._eventConfig&&e._eventConfig[t];return!(!1===r||pa(r)&&!r[n])||(e.warn(`Blocked ${t} ${n} event listener.`),!1)}function EB(e){return e.item}function DB(e){return e.item.mark.source}function jB(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function NB(e,t,n){const r=document.createElement(e);for(const i in t)r.setAttribute(i,t[i]);return null!=n&&(r.textContent=n),r}const SB="vega-bind",AB="vega-bind-name",$B="vega-bind-radio";function CB(e,t,n,r){const i=n.event||"input",o=()=>e.update(t.value);r.signal(n.signal,t.value),t.addEventListener(i,o),_B(r,t,i,o),e.set=e=>{t.value=e,t.dispatchEvent(function(e){return"undefined"!=typeof Event?new Event(e):{type:e}}(i))}}function MB(e,t,n,r){const i=r.signal(n.signal),o=NB("div",{class:SB}),a="radio"===n.input?o:o.appendChild(NB("label"));a.appendChild(NB("span",{class:AB},n.name||n.signal)),t.appendChild(o);let s=PB;switch(n.input){case"checkbox":s=FB;break;case"select":s=TB;break;case"radio":s=zB;break;case"range":s=RB}s(e,a,n,i)}function PB(e,t,n,r){const i=NB("input");for(const o in n)"signal"!==o&&"element"!==o&&i.setAttribute("input"===o?"type":o,n[o]);i.setAttribute("name",n.signal),i.value=r,t.appendChild(i),i.addEventListener("input",(()=>e.update(i.value))),e.elements=[i],e.set=e=>i.value=e}function FB(e,t,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const o=NB("input",i);t.appendChild(o),o.addEventListener("change",(()=>e.update(o.checked))),e.elements=[o],e.set=e=>o.checked=!!e||null}function TB(e,t,n,r){const i=NB("select",{name:n.signal}),o=n.labels||[];n.options.forEach(((e,t)=>{const n={value:e};LB(e,r)&&(n.selected=!0),i.appendChild(NB("option",n,(o[t]||e)+""))})),t.appendChild(i),i.addEventListener("change",(()=>{e.update(n.options[i.selectedIndex])})),e.elements=[i],e.set=e=>{for(let t=0,r=n.options.length;t<r;++t)if(LB(n.options[t],e))return void(i.selectedIndex=t)}}function zB(e,t,n,r){const i=NB("span",{class:$B}),o=n.labels||[];t.appendChild(i),e.elements=n.options.map(((t,a)=>{const s={type:"radio",name:n.signal,value:t};LB(t,r)&&(s.checked=!0);const l=NB("input",s);l.addEventListener("change",(()=>e.update(t)));const u=NB("label",{},(o[a]||t)+"");return u.prepend(l),i.appendChild(u),l})),e.set=t=>{const n=e.elements,r=n.length;for(let e=0;e<r;++e)LB(n[e].value,t)&&(n[e].checked=!0)}}function RB(e,t,n,r){r=void 0!==r?r:(+n.max+ +n.min)/2;const i=null!=n.max?n.max:Math.max(100,+r)||100,o=n.min||Math.min(0,i,+r)||0,a=n.step||dl(o,i,100),s=NB("input",{type:"range",name:n.signal,min:o,max:i,step:a});s.value=r;const l=NB("span",{},+r);t.appendChild(s),t.appendChild(l);const u=()=>{l.textContent=s.value,e.update(+s.value)};s.addEventListener("input",u),s.addEventListener("change",u),e.elements=[s],e.set=e=>{s.value=e,l.textContent=e}}function LB(e,t){return e===t||e+""==t+""}function BB(e,t,n,r,i,o){return(t=t||new r(e.loader())).initialize(n,yB(e),vB(e),bB(e),i,o).background(e.background())}function IB(e,t){return t?function(){try{t.apply(this,arguments)}catch(Jo){e.error(Jo)}}:null}function UB(e,t,n){if("string"==typeof t){if("undefined"==typeof document)return e.error("DOM document instance not found."),null;if(!(t=document.querySelector(t)))return e.error("Signal bind element not found: "+t),null}if(t&&n)try{t.textContent=""}catch(x9){t=null,e.error(x9)}return t}const qB=e=>+e||0;function WB(e){return pa(e)?{top:qB(e.top),bottom:qB(e.bottom),left:qB(e.left),right:qB(e.right)}:(e=>({top:e,bottom:e,left:e,right:e}))(qB(e))}async function ZB(e,t,n,r){const i=eD(t),o=i&&i.headless;return o||Jo("Unrecognized renderer type: "+t),await e.runAsync(),BB(e,null,null,o,n,r).renderAsync(e._scenegraph.root)}var HB="width",GB="height",VB="padding",YB={skip:!0};function XB(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===VB?r.left+r.right:0)}function JB(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===VB?r.top+r.bottom:0)}function QB(e,t){return t.modified&&ha(t.input.value)&&e.indexOf("_:vega:_")}function KB(e,t){return!("parent"===e||t instanceof Bh.proxy)}function eI(e,t,n,r){const i=e.element();i&&i.setAttribute("title",function(e){return null==e?"":ha(e)?tI(e):pa(e)&&!as(e)?(t=e,Object.keys(t).map((e=>{const n=t[e];return e+": "+(ha(n)?tI(n):nI(n))})).join("\n")):e+"";var t}(r))}function tI(e){return"["+e.map(nI).join(", ")+"]"}function nI(e){return ha(e)?"[\u2026]":pa(e)&&!as(e)?"{\u2026}":e}function rI(e,t){const n=this;if(t=t||{},zh.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),null!=t.logLevel&&n.logLevel(t.logLevel),t.locale||e.locale){const r=Ya({},e.locale,t.locale);n.locale(Dd(r.number,r.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||QE.Canvas,n._scenegraph=new $O;const r=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||eI,n._redraw=!0,n._handler=(new rE).scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=function(e){const t=Ya({defaults:{}},e),n=(e,t)=>{t.forEach((t=>{ha(e[t])&&(e[t]=_s(e[t]))}))};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=function(e,t,n){return uB(e,Bh,GL,n).parse(t)}(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map((e=>({state:null,param:Ya({},e)}))),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=XB(n,n._width),n._viewHeight=JB(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,function(e){var t=e._signals,n=t[HB],r=t[GB],i=t[VB];function o(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,(t=>{e._width=t.size,e._viewWidth=XB(e,t.size),o()}),{size:n}),e._resizeHeight=e.add(null,(t=>{e._height=t.size,e._viewHeight=JB(e,t.size),o()}),{size:r});const a=e.add(null,o,{pad:i});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,a.rank=i.rank+1}(n),function(e){e.add(null,(t=>(e._background=t.bg,e._resize=1,t.bg)),{bg:e._signals.background})}(n),function(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:hB,item:null}));e.on(e.events("view","mousemove"),t,((e,n)=>{const r=t.value,i=r?cs(r)?r:r.user:hB,o=n.item&&n.item.cursor||null;return r&&i===r.user&&o==r.item?r:{user:i,item:o}})),e.add(null,(function(t){let n=t.cursor,r=this.value;return cs(n)||(r=n.item,n=n.user),pB(e,n&&n!==hB?n:r||n),r}),{cursor:t})}(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function iI(e,t){return Ka(e._signals,t)?e._signals[t]:Jo("Unrecognized signal name: "+vs(t))}function oI(e,t){const n=(e._targets||[]).filter((e=>e._update&&e._update.handler===t));return n.length?n[0]:null}function aI(e,t,n,r){let i=oI(n,r);return i||(i=IB(e,(()=>r(t,n.value))),i.handler=r,e.on(n,null,i)),e}function sI(e,t,n){const r=oI(t,n);return r&&t._targets.remove(r),e}rs(rI,zh,{async evaluate(e,t,n){if(await zh.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,function(e){var t=bB(e),n=yB(e),r=vB(e);e._renderer.background(e.background()),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach((t=>{try{t(n,r)}catch(Jo){e.error(Jo)}}))}(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(x9){this.error(x9)}return n&&nh(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=null!=e?e+"":null;return t!==this._desc&&dB(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const r=iI(this,e);return 1===arguments.length?r.value:this.update(r,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",WB(e)):WB(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(eD(e)||Jo("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(zh.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(iI(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:function(e,t,n,r,i,o){this.runAfter((a=>{let s=0;a._autosize=0,a.width()!==n&&(s=1,a.signal(HB,n,YB),a._resizeWidth.skip(!0)),a.height()!==r&&(s=1,a.signal(GB,r,YB),a._resizeHeight.skip(!0)),a._viewWidth!==e&&(a._resize=1,a._viewWidth=e),a._viewHeight!==t&&(a._resize=1,a._viewHeight=t),a._origin[0]===i[0]&&a._origin[1]===i[1]||(a._resize=1,a._origin=i),s&&a.run("enter"),o&&a.runAfter((e=>e.resize()))}),!1,1)},addEventListener(e,t,n){let r=t;return n&&!1===n.trap||(r=IB(this,t),r.raw=t),this._handler.on(e,r),this},removeEventListener(e,t){for(var n,r,i=this._handler.handlers(e),o=i.length;--o>=0;)if(r=i[o].type,n=i[o].handler,e===r&&(t===n||t===n.raw)){this._handler.off(r,n);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return aI(this,e,iI(this,e),t)},removeSignalListener(e,t){return sI(this,iI(this,e),t)},addDataListener(e,t){return aI(this,e,mB(this,e).values,t)},removeDataListener(e,t){return sI(this,mB(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=pB(this,null);this._globalCursor=!!e,t&&pB(this,t)}return this}return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:function(e,t){this._timers.push(function(e,t,n){var r=new FM,i=t;return null==t?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(e,t,n){t=+t,n=null==n?MM():+n,r._restart((function o(a){a+=i,r._restart(o,i+=t,n),e(a)}),t,n)},r.restart(e,t,n),r)}((function(t){e({timestamp:Date.now(),elapsed:t})}),t))},events:function(e,t,n){var r,i=this,o=new kh(n),a=function(n,r){i.runAsync(null,(()=>{e===wB&&function(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return!1!==r&&!0!==i&&(!0===r||!1===i||(r?r[t]:i?!i[t]:e.preventDefault()))}(i,t)&&n.preventDefault(),o.receive(xB(i,n,r))}))};if("timer"===e)OB(i,"timer",t)&&i.timer(a,t);else if(e===wB)OB(i,"view",t)&&i.addEventListener(t,a,kB);else if("window"===e?OB(i,"window",t)&&"undefined"!=typeof window&&(r=[window]):"undefined"!=typeof document&&OB(i,"selector",t)&&(r=Array.from(document.querySelectorAll(e))),r){for(var s=0,l=r.length;s<l;++s)r[s].addEventListener(t,a);_B(i,r,t,a)}else i.warn("Can not resolve event source: "+e);return o},finalize:function(){var e,t,n,r=this._tooltip,i=this._timers,o=this._eventListeners;for(e=i.length;--e>=0;)i[e].stop();for(e=o.length;--e>=0;)for(t=(n=o[e]).sources.length;--t>=0;)n.sources[t].removeEventListener(n.type,n.handler);return r&&r.call(this,this._handler,null,null,null),this},hover:function(e,t){return t=[t||"update",(e=[e||"hover"])[0]],this.on(this.events("view","mouseover",EB),DB,jB(e)),this.on(this.events("view","mouseout",EB),DB,jB(t)),this},data:function(e,t){return arguments.length<2?mB(this,e).values.value:gB.call(this,e,ph().remove(ia).insert(t))},change:gB,insert:function(e,t){return gB.call(this,e,ph().insert(t))},remove:function(e,t){return gB.call(this,e,ph().remove(t))},scale:function(e){var t=this._runtime.scales;return Ka(t,e)||Jo("Unrecognized scale or projection: "+e),t[e].value},initialize:function(e,t){const n=this,r=n._renderType,i=n._eventConfig.bind,o=eD(r);e=n._el=e?UB(n,e,!0):null,function(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),dB(t,e.description()))}(n),o||n.error("Unrecognized renderer type: "+r);const a=o.handler||rE,s=e?o.renderer:o.headless;return n._renderer=s?BB(n,n._renderer,e,s):null,n._handler=function(e,t,n,r){const i=new r(e.loader(),IB(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,bB(e),e);return t&&t.handlers().forEach((e=>{i.on(e.type,e.handler)})),i}(n,n._handler,e,a),n._redraw=!0,e&&"none"!==i&&(t=t?n._elBind=UB(n,t,!0):e.appendChild(NB("form",{class:"vega-bindings"})),n._bind.forEach((e=>{e.param.element&&"container"!==i&&(e.element=UB(n,e.param.element,!!e.param.input))})),n._bind.forEach((e=>{!function(e,t,n){if(!t)return;const r=n.param;let i=n.state;i||(i=n.state={elements:null,active:!1,set:null,update:t=>{t!=e.signal(r.signal)&&e.runAsync(null,(()=>{i.source=!0,e.signal(r.signal,t)}))}},r.debounce&&(i.update=Va(r.debounce,i.update))),(null==r.input&&r.element?CB:MB)(i,t,r,e),i.active||(e.on(e._signals[r.signal],null,(()=>{i.source?i.source=!1:i.set(e.signal(r.signal))})),i.active=!0)}(n,e.element||t,e)}))),n},toImageURL:async function(e,t){e!==QE.Canvas&&e!==QE.SVG&&e!==QE.PNG&&Jo("Unrecognized image type: "+e);const n=await ZB(this,e,t);return e===QE.SVG?function(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")},toCanvas:async function(e,t){return(await ZB(this,QE.Canvas,e,t)).canvas()},toSVG:async function(e){return(await ZB(this,QE.SVG,e)).svg()},getState:function(e){return this._runtime.getState(e||{data:QB,signals:KB,recurse:!0})},setState:function(e){return this.runAsync(null,(t=>{t._trigger=!1,t._runtime.setState(e)}),(e=>{e._trigger=!0})),this}});const lI="view",uI="[",cI="]",fI="{",dI="}",hI=":",pI=",",mI="@",gI=">",yI=/[[\]{}]/,vI={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let bI,xI;function wI(e,t,n){return bI=t||lI,xI=n||vI,_I(e.trim()).map(OI)}function kI(e,t,n,r,i){const o=e.length;let a,s=0;for(;t<o;++t){if(a=e[t],!s&&a===n)return t;i&&i.indexOf(a)>=0?--s:r&&r.indexOf(a)>=0&&++s}return t}function _I(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=kI(e,i,pI,uI+fI,cI+dI),t.push(e.substring(r,i).trim()),r=++i;if(0===t.length)throw"Empty event selector: "+e;return t}function OI(e){return"["===e[0]?function(e){const t=e.length;let n,r=1;if(r=kI(e,r,cI,uI,cI),r===t)throw"Empty between selector: "+e;if(n=_I(e.substring(1,r)),2!==n.length)throw"Between selector must have two elements: "+e;if(e=e.slice(r+1).trim(),e[0]!==gI)throw"Expected '>' after between selector: "+e;n=n.map(OI);const i=OI(e.slice(1).trim());if(i.between)return{between:n,stream:i};i.between=n;return i}(e):function(e){const t={source:bI},n=[];let r,i,o=[0,0],a=0,s=0,l=e.length,u=0;if(e[l-1]===dI){if(u=e.lastIndexOf(fI),!(u>=0))throw"Unmatched right brace: "+e;try{o=function(e){const t=e.split(pI);if(!e.length||t.length>2)throw e;return t.map((t=>{const n=+t;if(n!=n)throw e;return n}))}(e.substring(u+1,l-1))}catch(x9){throw"Invalid throttle specification: "+e}l=(e=e.slice(0,u).trim()).length,u=0}if(!l)throw e;e[0]===mI&&(a=++u);r=kI(e,u,hI),r<l&&(n.push(e.substring(s,r).trim()),s=u=++r);if(u=kI(e,u,uI),u===l)n.push(e.substring(s,l).trim());else if(n.push(e.substring(s,u).trim()),i=[],s=++u,s===l)throw"Unmatched left bracket: "+e;for(;u<l;){if(u=kI(e,u,cI),u===l)throw"Unmatched left bracket: "+e;if(i.push(e.substring(s,u).trim()),u<l-1&&e[++u]!==uI)throw"Expected left bracket: "+e;s=++u}if(!(l=n.length)||yI.test(n[l-1]))throw"Invalid event selector: "+e;l>1?(t.type=n[1],a?t.markname=n[0].slice(1):!function(e){return xI[e]}(n[0])?t.source=n[0]:t.marktype=n[0]):t.type=n[0];"!"===t.type.slice(-1)&&(t.consume=!0,t.type=t.type.slice(0,-1));null!=i&&(t.filter=i);o[0]&&(t.throttle=o[0]);o[1]&&(t.debounce=o[1]);return t}(e)}function EI(e){return pa(e)?e:{type:e||"pad"}}const DI=e=>+e||0,jI=e=>({top:e,bottom:e,left:e,right:e});function NI(e){return pa(e)?e.signal?e:{top:DI(e.top),bottom:DI(e.bottom),left:DI(e.left),right:DI(e.right)}:jI(DI(e))}const SI=e=>pa(e)&&!ha(e)?Ya({},e):{value:e};function AI(e,t,n,r){if(null!=n){return pa(n)&&!ha(n)||ha(n)&&n.length&&pa(n[0])?e.update[t]=n:e[r||"enter"][t]={value:n},1}return 0}function $I(e,t,n){for(const r in t)AI(e,r,t[r]);for(const r in n)AI(e,r,n[r],"update")}function CI(e,t,n){for(const r in t)n&&Ka(n,r)||(e[r]=Ya(e[r]||{},t[r]));return e}function MI(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const PI="mark",FI="frame",TI="scope",zI="axis",RI="axis-domain",LI="axis-grid",BI="axis-label",II="axis-tick",UI="axis-title",qI="legend",WI="legend-band",ZI="legend-entry",HI="legend-gradient",GI="legend-label",VI="legend-symbol",YI="legend-title",XI="title",JI="title-text",QI="title-subtitle";function KI(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const eU=e=>cs(e)?vs(e):e.signal?`(${e.signal})`:iU(e);function tU(e){if(null!=e.gradient)return function(e){const t=[e.start,e.stop,e.count].map((e=>null==e?null:vs(e)));for(;t.length&&null==ba(t);)t.pop();return t.unshift(eU(e.gradient)),`gradient(${t.join(",")})`}(e);let t=e.signal?`(${e.signal})`:e.color?function(e){return e.c?nU("hcl",e.h,e.c,e.l):e.h||e.s?nU("hsl",e.h,e.s,e.l):e.l||e.a?nU("lab",e.l,e.a,e.b):e.r||e.g||e.b?nU("rgb",e.r,e.g,e.b):null}(e.color):null!=e.field?iU(e.field):void 0!==e.value?vs(e.value):void 0;return null!=e.scale&&(t=function(e,t){const n=eU(e.scale);null!=e.range?t=`lerp(_range(${n}), ${+e.range})`:(void 0!==t&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(1==+e.band?"":"*"+rU(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),null==t&&(t="0"));return t}(e,t)),void 0===t&&(t=null),null!=e.exponent&&(t=`pow(${t},${rU(e.exponent)})`),null!=e.mult&&(t+=`*${rU(e.mult)}`),null!=e.offset&&(t+=`+${rU(e.offset)}`),e.round&&(t=`round(${t})`),t}const nU=(e,t,n,r)=>`(${e}(${[t,n,r].map(tU).join(",")})+'')`;function rU(e){return pa(e)?"("+tU(e)+")":e}function iU(e){return oU(pa(e)?e:{datum:e})}function oU(e){let t,n,r;if(e.signal)t="datum",r=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(r=e.parent,t+=".datum"):r=e.group}else e.datum?(t="datum",r=e.datum):Jo("Invalid field reference: "+vs(e));return e.signal||(r=cs(r)?Qo(r).map(vs).join("]["):oU(r)),t+"["+r+"]"}function aU(e,t,n,r,i,o){const a={};(o=o||{}).encoders={$encode:a},e=function(e,t,n,r,i){const o={},a={};let s,l,u,c;for(l in l="lineBreak","text"!==t||null==i[l]||MI(l,e)||KI(o,l,i[l]),("legend"==n||String(n).startsWith("axis"))&&(n=null),c=n===FI?i.group:n===PI?Ya({},i.mark,i[t]):null,c)u=MI(l,e)||("fill"===l||"stroke"===l)&&(MI("fill",e)||MI("stroke",e)),u||KI(o,l,c[l]);for(l in Ra(r).forEach((t=>{const n=i.style&&i.style[t];for(const r in n)MI(r,e)||KI(o,r,n[r])})),e=Ya({},e),o)c=o[l],c.signal?(s=s||{})[l]=c:a[l]=c;return e.enter=Ya(a,e.enter),s&&(e.update=Ya(s,e.update)),e}(e,t,n,r,i.config);for(const s in e)a[s]=sU(e[s],t,o,i);return o}function sU(e,t,n,r){const i={},o={};for(const s in e)null!=e[s]&&(i[s]=lU((a=e[s],ha(a)?function(e){let t="";return e.forEach((e=>{const n=tU(e);t+=e.test?`(${e.test})?${n}:`:n})),":"===ba(t)&&(t+="null"),t}(a):tU(a)),r,n,o));var a;return{$expr:{marktype:t,channels:i},$fields:Object.keys(o),$output:Object.keys(e)}}function lU(e,t,n,r){const i=eB(e,t);return i.$fields.forEach((e=>r[e]=1)),Ya(n,i.$params),i.$expr}const uU="outer",cU=["value","update","init","react","bind"];function fU(e,t){Jo(e+' for "outer" push: '+vs(t))}function dU(e,t){const n=e.name;if(e.push===uU)t.signals[n]||fU("No prior signal definition",n),cU.forEach((t=>{void 0!==e[t]&&fU("Invalid property ",t)}));else{const r=t.addSignal(n,e.value);!1===e.react&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function hU(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function pU(e,t,n,r){return new hU(e,t,n,r)}function mU(e,t){return pU("operator",e,t)}function gU(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function yU(e,t){return t?{$field:e,$name:t}:{$field:e}}const vU=yU("key");function bU(e,t){return{$compare:e,$order:t}}const xU="descending";function wU(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const kU="scope",_U="view";function OU(e){return e&&e.signal}function EU(e){if(OU(e))return!0;if(pa(e))for(const t in e)if(EU(e[t]))return!0;return!1}function DU(e,t){return null!=e?e:t}function jU(e){return e&&e.signal||e}const NU="timer";function SU(e,t){return(e.merge?AU:e.stream?$U:e.type?CU:Jo("Invalid stream specification: "+vs(e)))(e,t)}function AU(e,t){const n=MU({merge:e.merge.map((e=>SU(e,t)))},e,t);return t.addStream(n).id}function $U(e,t){const n=MU({stream:SU(e.stream,t)},e,t);return t.addStream(n).id}function CU(e,t){let n;e.type===NU?(n=t.event(NU,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(function(e){return e===kU?_U:e||_U}(e.source),e.type);const r=MU({stream:n},e,t);return 1===Object.keys(r).length?n:t.addStream(r).id}function MU(e,t,n){let r=t.between;return r&&(2!==r.length&&Jo('Stream "between" parameter must have 2 entries: '+vs(t)),e.between=[SU(r[0],n),SU(r[1],n)]),r=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push(function(e,t,n){const r="event.item";return r+(e&&"*"!==e?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}(t.marktype,t.markname,t.markrole)),t.source===kU&&r.push("inScope(event.item)"),r.length&&(e.filter=eB("("+r.join(")&&(")+")",n).$expr),null!=(r=t.throttle)&&(e.throttle=+r),null!=(r=t.debounce)&&(e.debounce=+r),t.consume&&(e.consume=!0),e}const PU={code:"_.$value",ast:{type:"Identifier",value:"value"}};function FU(e,t,n){const r=e.encode,i={target:n};let o=e.events,a=e.update,s=[];o||Jo("Signal update missing events specification."),cs(o)&&(o=wI(o,t.isSubscope()?kU:_U)),o=Ra(o).filter((e=>e.signal||e.scale?(s.push(e),0):1)),s.length>1&&(s=[TU(s)]),o.length&&s.push(o.length>1?{merge:o}:o[0]),null!=r&&(a&&Jo("Signal encode and update are mutually exclusive."),a="encode(item(),"+vs(r)+")"),i.update=cs(a)?eB(a,t):null!=a.expr?eB(a.expr,t):null!=a.value?a.value:null!=a.signal?{$expr:PU,$params:{$value:t.signalRef(a.signal)}}:Jo("Invalid signal update specification."),e.force&&(i.options={force:!0}),s.forEach((e=>t.addUpdate(Ya(function(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):SU(e,t)}}(e,t),i))))}function TU(e){return{signal:"["+e.map((e=>e.scale?'scale("'+e.scale+'")':e.signal))+"]"}}const zU=e=>(t,n,r)=>pU(e,n,t||void 0,r),RU=zU("aggregate"),LU=zU("axisticks"),BU=zU("bound"),IU=zU("collect"),UU=zU("compare"),qU=zU("datajoin"),WU=zU("encode"),ZU=zU("expression"),HU=zU("facet"),GU=zU("field"),VU=zU("key"),YU=zU("legendentries"),XU=zU("load"),JU=zU("mark"),QU=zU("multiextent"),KU=zU("multivalues"),eq=zU("overlap"),tq=zU("params"),nq=zU("prefacet"),rq=zU("projection"),iq=zU("proxy"),oq=zU("relay"),aq=zU("render"),sq=zU("scale"),lq=zU("sieve"),uq=zU("sortitems"),cq=zU("viewlayout"),fq=zU("values");let dq=0;const hq={min:"min",max:"max",count:"sum"};function pq(e,t){const n=t.getScale(e.name).params;let r;for(r in n.domain=vq(e.domain,e,t),null!=e.range&&(n.range=Dq(e,t,n)),null!=e.interpolate&&function(e,t){t.interpolate=mq(e.type||e),null!=e.gamma&&(t.interpolateGamma=mq(e.gamma))}(e.interpolate,n),null!=e.nice&&(n.nice=function(e){return pa(e)?{interval:mq(e.interval),step:mq(e.step)}:mq(e)}(e.nice)),null!=e.bins&&(n.bins=function(e,t){return e.signal||ha(e)?gq(e,t):t.objectProperty(e)}(e.bins,t)),e)Ka(n,r)||"name"===r||(n[r]=mq(e[r],t))}function mq(e,t){return pa(e)?e.signal?t.signalRef(e.signal):Jo("Unsupported object: "+vs(e)):e}function gq(e,t){return e.signal?t.signalRef(e.signal):e.map((e=>mq(e,t)))}function yq(e){Jo("Can not find data set: "+vs(e))}function vq(e,t,n){if(e)return e.signal?n.signalRef(e.signal):(ha(e)?bq:e.fields?wq:xq)(e,t,n);null==t.domainMin&&null==t.domainMax||Jo("No scale domain defined for domainMin/domainMax to override.")}function bq(e,t,n){return e.map((e=>mq(e,n)))}function xq(e,t,n){const r=n.getData(e.data);return r||yq(e.data),Ux(t.type)?r.valuesRef(n,e.field,_q(e.sort,!1)):Hx(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function wq(e,t,n){const r=e.data,i=e.fields.reduce(((e,t)=>(t=cs(t)?{data:r,field:t}:ha(t)||t.signal?function(e,t){const n="_:vega:_"+dq++,r=IU({});if(ha(e))r.value={$ingest:e};else if(e.signal){const i="setdata("+vs(n)+","+e.signal+")";r.params.input=t.signalRef(i)}return t.addDataPipeline(n,[r,lq({})]),{data:n,field:"data"}}(t,n):t,e.push(t),e)),[]);return(Ux(t.type)?kq:Hx(t.type)?Oq:Eq)(e,n,i)}function kq(e,t,n){const r=_q(e.sort,!0);let i,o;const a=n.map((e=>{const n=t.getData(e.data);return n||yq(e.data),n.countsRef(t,e.field,r)})),s={groupby:vU,pulse:a};r&&(i=r.op||"count",o=r.field?wU(i,r.field):"count",s.ops=[hq[i]],s.fields=[t.fieldRef(o)],s.as=[o]),i=t.add(RU(s));const l=t.add(IU({pulse:gU(i)}));return o=t.add(fq({field:vU,sort:t.sortRef(r),pulse:gU(l)})),gU(o)}function _q(e,t){return e&&(e.field||e.op?e.field||"count"===e.op?t&&e.field&&e.op&&!hq[e.op]&&Jo("Multiple domain scales can not be sorted using "+e.op):Jo("No field provided for sort aggregate op: "+e.op):pa(e)?e.field="key":e={field:"key"}),e}function Oq(e,t,n){const r=n.map((e=>{const n=t.getData(e.data);return n||yq(e.data),n.domainRef(t,e.field)}));return gU(t.add(KU({values:r})))}function Eq(e,t,n){const r=n.map((e=>{const n=t.getData(e.data);return n||yq(e.data),n.extentRef(t,e.field)}));return gU(t.add(QU({extents:r})))}function Dq(e,t,n){const r=t.config.range;let i=e.range;if(i.signal)return t.signalRef(i.signal);if(cs(i)){if(r&&Ka(r,i))return Dq(e=Ya({},e,{range:r[i]}),t,n);"width"===i?i=[0,{signal:"width"}]:"height"===i?i=Ux(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:Jo("Unrecognized scale range value: "+vs(i))}else{if(i.scheme)return n.scheme=ha(i.scheme)?gq(i.scheme,t):mq(i.scheme,t),i.extent&&(n.schemeExtent=gq(i.extent,t)),void(i.count&&(n.schemeCount=mq(i.count,t)));if(i.step)return void(n.rangeStep=mq(i.step,t));if(Ux(e.type)&&!ha(i))return vq(i,e,t);ha(i)||Jo("Unsupported range type: "+vs(i))}return i.map((e=>(ha(e)?gq:mq)(e,t)))}function jq(e,t,n){return ha(e)?e.map((e=>jq(e,t,n))):pa(e)?e.signal?n.signalRef(e.signal):"fit"===t?e:Jo("Unsupported parameter object: "+vs(e)):e}const Nq="top",Sq="left",Aq="right",$q="bottom",Cq="center",Mq="vertical",Pq="start",Fq="end",Tq="index",zq="label",Rq="offset",Lq="perc",Bq="perc2",Iq="value",Uq="guide-label",qq="guide-title",Wq="group-title",Zq="group-subtitle",Hq="symbol",Gq="gradient",Vq="discrete",Yq="size",Xq=[Yq,"shape","fill","stroke","strokeWidth","strokeDash","opacity"],Jq={name:1,style:1,interactive:1},Qq={value:0},Kq={value:1},eW="group",tW="rect",nW="rule",rW="symbol",iW="text";function oW(e){return e.type=eW,e.interactive=e.interactive||!1,e}function aW(e,t){const n=(n,r)=>DU(e[n],DU(t[n],r));return n.isVertical=n=>Mq===DU(e.direction,t.direction||(n?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>DU(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>DU(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>DU(e.columns,DU(t.columns,+n.isVertical(!0))),n}function sW(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function lW(e,t,n){return`item.anchor === '${Pq}' ? ${e} : item.anchor === '${Fq}' ? ${t} : ${n}`}const uW=lW(vs(Sq),vs(Aq),vs(Cq));function cW(e,t){return t?e?pa(e)?Object.assign({},e,{offset:cW(e.offset,t)}):{value:e,offset:t}:t:e}function fW(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=CI(e.encode,t,Jq)):e.interactive=!1,e}function dW(e,t,n,r){const i=aW(e,n),o=i.isVertical(),a=i.gradientThickness(),s=i.gradientLength();let l,u,c,f,d;o?(u=[0,1],c=[0,0],f=a,d=s):(u=[0,0],c=[1,0],f=s,d=a);const h={enter:l={opacity:Qq,x:Qq,y:Qq,width:SI(f),height:SI(d)},update:Ya({},l,{opacity:Kq,fill:{gradient:t,start:u,stop:c}}),exit:{opacity:Qq}};return $I(h,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),fW({type:tW,role:HI,encode:h},r)}function hW(e,t,n,r,i){const o=aW(e,n),a=o.isVertical(),s=o.gradientThickness(),l=o.gradientLength();let u,c,f,d,h="";a?(u="y",f="y2",c="x",d="width",h="1-"):(u="x",f="x2",c="y",d="height");const p={opacity:Qq,fill:{scale:t,field:Iq}};p[u]={signal:h+"datum."+Lq,mult:l},p[c]=Qq,p[f]={signal:h+"datum."+Bq,mult:l},p[d]=SI(s);const m={enter:p,update:Ya({},p,{opacity:Kq}),exit:{opacity:Qq}};return $I(m,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")}),fW({type:tW,role:WI,key:Iq,from:i,encode:m},r)}const pW=`datum.${Lq}<=0?"${Sq}":datum.${Lq}>=1?"${Aq}":"${Cq}"`,mW=`datum.${Lq}<=0?"${$q}":datum.${Lq}>=1?"${Nq}":"middle"`;function gW(e,t,n,r){const i=aW(e,t),o=i.isVertical(),a=SI(i.gradientThickness()),s=i.gradientLength();let l,u,c,f,d=i("labelOverlap"),h="";const p={enter:l={opacity:Qq},update:u={opacity:Kq,text:{field:zq}},exit:{opacity:Qq}};return $I(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:DU(e.labelLimit,t.gradientLabelLimit)}),o?(l.align={value:"left"},l.baseline=u.baseline={signal:mW},c="y",f="x",h="1-"):(l.align=u.align={signal:pW},l.baseline={value:"top"},c="x",f="y"),l[c]=u[c]={signal:h+"datum."+Lq,mult:s},l[f]=u[f]=a,a.offset=DU(e.labelOffset,t.gradientLabelOffset)||0,d=d?{separation:i("labelSeparation"),method:d,order:"datum."+Tq}:void 0,fW({type:iW,role:GI,style:Uq,key:Iq,from:r,encode:p,overlap:d},n)}function yW(e,t,n,r,i){const o=aW(e,t),a=n.entries,s=!(!a||!a.interactive),l=a?a.name:void 0,u=o("clipHeight"),c=o("symbolOffset"),f={data:"value"},d=`(${i}) ? datum.${Rq} : datum.${Yq}`,h=u?SI(u):{field:Yq},p=`datum.${Tq}`,m=`max(1, ${i})`;let g,y,v,b,x;h.mult=.5,g={enter:y={opacity:Qq,x:{signal:d,mult:.5,offset:c},y:h},update:v={opacity:Kq,x:y.x,y:y.y},exit:{opacity:Qq}};let w=null,k=null;e.fill||(w=t.symbolBaseFillColor,k=t.symbolBaseStrokeColor),$I(g,{fill:o("symbolFillColor",w),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",k),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")}),Xq.forEach((t=>{e[t]&&(v[t]=y[t]={scale:e[t],field:Iq})}));const _=fW({type:rW,role:VI,key:Iq,from:f,clip:!!u||void 0,encode:g},n.symbols),O=SI(c);O.offset=o("labelOffset"),g={enter:y={opacity:Qq,x:{signal:d,offset:O},y:h},update:v={opacity:Kq,text:{field:zq},x:y.x,y:y.y},exit:{opacity:Qq}},$I(g,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});const E=fW({type:iW,role:GI,style:Uq,key:Iq,from:f,encode:g},n.labels);return g={enter:{noBound:{value:!u},width:Qq,height:u?SI(u):Qq,opacity:Qq},exit:{opacity:Qq},update:v={opacity:Kq,row:{signal:null},column:{signal:null}}},o.isVertical(!0)?(b=`ceil(item.mark.items.length / ${m})`,v.row.signal=`${p}%${b}`,v.column.signal=`floor(${p} / ${b})`,x={field:["row",p]}):(v.row.signal=`floor(${p} / ${m})`,v.column.signal=`${p} % ${m}`,x={field:p}),v.column.signal=`(${i})?${v.column.signal}:${p}`,oW({role:TI,from:r={facet:{data:r,name:"value",groupby:Tq}},encode:CI(g,a,Jq),marks:[_,E],name:l,interactive:s,sort:x})}const vW='item.orient === "left"',bW='item.orient === "right"',xW=`(${vW} || ${bW})`,wW=`datum.vgrad && ${xW}`,kW=lW('"top"','"bottom"','"middle"'),_W=`datum.vgrad && ${bW} ? (${lW('"right"','"left"','"center"')}) : (${xW} && !(datum.vgrad && ${vW})) ? "left" : ${uW}`,OW=`item._anchor || (${xW} ? "middle" : "start")`,EW=`${wW} ? (${vW} ? -90 : 90) : 0`,DW=`${xW} ? (datum.vgrad ? (${bW} ? "bottom" : "top") : ${kW}) : "top"`;function jW(e,t){let n;return pa(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+NW(e.path)+")":e.sphere&&(n="geoShape("+NW(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function NW(e){return pa(e)&&e.signal?e.signal:vs(e)}function SW(e){const t=e.role||"";return t.indexOf("axis")&&t.indexOf("legend")&&t.indexOf("title")?e.type===eW?TI:t||PI:t}function AW(e){return{marktype:e.type,name:e.name||void 0,role:e.role||SW(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function $W(e,t){return e&&e.signal?t.signalRef(e.signal):!1!==e}function CW(e,t){const n=Ih(e.type);n||Jo("Unrecognized transform type: "+vs(e.type));const r=pU(n.type.toLowerCase(),null,MW(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function MW(e,t,n){const r={},i=e.params.length;for(let o=0;o<i;++o){const i=e.params[o];r[i.name]=PW(i,t,n)}return r}function PW(e,t,n){const r=e.type,i=t[e.name];return"index"===r?function(e,t,n){cs(t.from)||Jo('Lookup "from" parameter must be a string literal.');return n.getData(t.from).lookupRef(n,t.key)}(0,t,n):void 0!==i?"param"===r?function(e,t,n){const r=t[e.name];return e.array?(ha(r)||Jo("Expected an array of sub-parameters. Instead: "+vs(r)),r.map((t=>TW(e,t,n)))):TW(e,r,n)}(e,t,n):"projection"===r?n.projectionRef(t[e.name]):e.array&&!OU(i)?i.map((t=>FW(e,t,n))):FW(e,i,n):void(e.required&&Jo("Missing required "+vs(t.type)+" parameter: "+vs(e.name)))}function FW(e,t,n){const r=e.type;if(OU(t))return BW(r)?Jo("Expression references can not be signals."):IW(r)?n.fieldRef(t):UW(r)?n.compareRef(t):n.signalRef(t.signal);{const i=e.expr||IW(r);return i&&zW(t)?n.exprRef(t.expr,t.as):i&&RW(t)?yU(t.field,t.as):BW(r)?eB(t,n):LW(r)?gU(n.getData(t).values):IW(r)?yU(t):UW(r)?n.compareRef(t):t}}function TW(e,t,n){const r=e.params.length;let i;for(let a=0;a<r;++a){i=e.params[a];for(const e in i.key)if(i.key[e]!==t[e]){i=null;break}if(i)break}i||Jo("Unsupported parameter: "+vs(t));const o=Ya(MW(i,t,n),i.key);return gU(n.add(tq(o)))}const zW=e=>e&&e.expr,RW=e=>e&&e.field,LW=e=>"data"===e,BW=e=>"expr"===e,IW=e=>"field"===e,UW=e=>"compare"===e;function qW(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:gU(t.getData(e.data).output)}function WW(e,t,n,r,i){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=i,this.index={}}function ZW(e){return cs(e)?e:null}function HW(e,t,n){const r=wU(n.op,n.field);let i;if(t.ops){for(let o=0,a=t.as.length;o<a;++o)if(t.as[o]===r)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((i=n.op.signal)?e.signalRef(i):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(r))}function GW(e,t,n,r,i,o,a){const s=t[n]||(t[n]={}),l=function(e){return pa(e)?(e.order===xU?"-":"+")+wU(e.op,e.field):""}(o);let u,c,f=ZW(i);if(null!=f&&(e=t.scope,f+=l?"|"+l:"",u=s[f]),!u){const n=o?{field:vU,pulse:t.countsRef(e,i,o)}:{field:e.fieldRef(i),pulse:gU(t.output)};l&&(n.sort=e.sortRef(o)),c=e.add(pU(r,void 0,n)),a&&(t.index[i]=c),u=gU(c),null!=f&&(s[f]=u)}return u}function VW(e,t,n){const r=e.remove,i=e.insert,o=e.toggle,a=e.modify,s=e.values,l=t.add(mU()),u=eB("if("+e.trigger+',modify("'+n+'",'+[i,r,o,a,s].map((e=>null==e?"null":e)).join(",")+"),0)",t);l.update=u.$expr,l.params=u.$params}function YW(e,t){const n=SW(e),r=e.type===eW,i=e.from&&e.from.facet,o=e.overlap;let a,s,l,u,c,f,d,h=e.layout||n===TI||n===FI;const p=n===PI||h||i,m=function(e,t,n){let r,i,o,a,s;return e?(r=e.facet)&&(t||Jo("Only group marks can be faceted."),null!=r.field?a=s=qW(r,n):(e.data?s=gU(n.getData(e.data).aggregate):(o=CW(Ya({type:"aggregate",groupby:Ra(r.groupby)},r.aggregate),n),o.params.key=n.keyRef(r.groupby),o.params.pulse=qW(r,n),a=s=gU(n.add(o))),i=n.keyRef(r.groupby,!0))):a=gU(n.add(IU(null,[{}]))),a||(a=qW(e,n)),{key:i,pulse:a,parent:s}}(e.from,r,t);s=t.add(qU({key:m.key||(e.key?yU(e.key):void 0),pulse:m.pulse,clean:!r}));const g=gU(s);s=l=t.add(IU({pulse:g})),s=t.add(JU({markdef:AW(e),interactive:$W(e.interactive,t),clip:jW(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:gU(s)}));const y=gU(s);s=u=t.add(WU(aU(e.encode,e.type,n,e.style,t,{mod:!1,pulse:y}))),s.params.parent=t.encode(),e.transform&&e.transform.forEach((e=>{const n=CW(e,t),r=n.metadata;(r.generates||r.changes)&&Jo("Mark transforms should not generate new data."),r.nomod||(u.params.mod=!0),n.params.pulse=gU(s),t.add(s=n)})),e.sort&&(s=t.add(uq({sort:t.compareRef(e.sort),pulse:gU(s)})));const v=gU(s);(i||h)&&(h=t.add(cq({layout:t.objectProperty(e.layout),legends:t.legends,mark:y,pulse:v})),f=gU(h));const b=t.add(BU({mark:y,pulse:f||v}));d=gU(b),r&&(p&&(a=t.operators,a.pop(),h&&a.pop()),t.pushState(v,f||d,g),i?function(e,t,n){const r=e.from.facet,i=r.name,o=qW(r,t);let a;r.name||Jo("Facet must have a name: "+vs(r)),r.data||Jo("Facet must reference a data set: "+vs(r)),r.field?a=t.add(nq({field:t.fieldRef(r.field),pulse:o})):r.groupby?a=t.add(HU({key:t.keyRef(r.groupby),group:gU(t.proxy(n.parent)),pulse:o})):Jo("Facet must specify groupby or field: "+vs(r));const s=t.fork(),l=s.add(IU()),u=s.add(lq({pulse:gU(l)}));s.addData(i,new WW(s,l,l,u)),s.addSignal("parent",null),a.params.subflow={$subflow:s.parse(e).toRuntime()}}(e,t,m):p?function(e,t,n){const r=t.add(nq({pulse:n.pulse})),i=t.fork();i.add(lq()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(e).toRuntime()}}(e,t,m):t.parse(e),t.popState(),p&&(h&&a.push(h),a.push(b))),o&&(d=function(e,t,n){const r=e.method,i=e.bound,o=e.separation,a={separation:OU(o)?n.signalRef(o.signal):o,method:OU(r)?n.signalRef(r.signal):r,pulse:t};e.order&&(a.sort=n.compareRef({field:e.order}));if(i){const e=i.tolerance;a.boundTolerance=OU(e)?n.signalRef(e.signal):+e,a.boundScale=n.scaleRef(i.scale),a.boundOrient=i.orient}return gU(n.add(eq(a)))}(o,d,t));const x=t.add(aq({pulse:d})),w=t.add(lq({pulse:gU(x)},void 0,t.parent()));null!=e.name&&(c=e.name,t.addData(c,new WW(t,l,x,w)),e.on&&e.on.forEach((e=>{(e.insert||e.remove||e.toggle)&&Jo("Marks only support modify triggers."),VW(e,t,c)})))}function XW(e,t){const n=t.config.legend,r=e.encode||{},i=aW(e,n),o=r.legend||{},a=o.name||void 0,s=o.interactive,l=o.style,u={};let c,f,d,h=0;Xq.forEach((t=>e[t]?(u[t]=e[t],h=h||e[t]):0)),h||Jo("Missing valid scale for legend.");const p=function(e,t){let n=e.type||Hq;e.type||1!==function(e){return Xq.reduce(((t,n)=>t+(e[n]?1:0)),0)}(e)||!e.fill&&!e.stroke||(n=Ix(t)?Gq:qx(t)?Vq:Hq);return n!==Gq?n:qx(t)?Vq:Gq}(e,t.scaleType(h)),m={title:null!=e.title,scales:u,type:p,vgrad:"symbol"!==p&&i.isVertical()},g=gU(t.add(IU(null,[m]))),y=gU(t.add(YU(f={type:p,scale:t.scaleRef(h),count:t.objectProperty(i("tickCount")),limit:t.property(i("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return p===Gq?(d=[dW(e,h,n,r.gradient),gW(e,n,r.labels,y)],f.count=f.count||t.signalRef(`max(2,2*floor((${jU(i.gradientLength())})/100))`)):p===Vq?d=[hW(e,h,n,r.gradient,y),gW(e,n,r.labels,y)]:(c=function(e,t){const n=aW(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}(e,n),d=[yW(e,n,r,y,jU(c.columns))],f.size=function(e,t,n){const r=jU(QW("size",e,n)),i=jU(QW("strokeWidth",e,n)),o=jU(function(e,t,n){return sW("fontSize",e)||function(e,t,n){const r=t.config.style[n];return r&&r[e]}("fontSize",t,n)}(n[1].encode,t,Uq));return eB(`max(ceil(sqrt(${r})+${i}),${o})`,t)}(e,t,d[0].marks)),d=[oW({role:ZI,from:g,encode:{enter:{x:{value:0},y:{value:0}}},marks:d,layout:c,interactive:s})],m.title&&d.push(function(e,t,n,r){const i=aW(e,t),o={enter:{opacity:Qq},update:{opacity:Kq,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:Qq}};return $I(o,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:OW},angle:{signal:EW},align:{signal:_W},baseline:{signal:DW},text:e.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),fW({type:iW,role:YI,style:qq,from:r,encode:o},n)}(e,n,r.title,g)),YW(oW({role:qI,from:g,encode:CI(JW(i,e,n),o,Jq),marks:d,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:a,interactive:s,style:l}),t)}function JW(e,t,n){const r={enter:{},update:{}};return $I(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function QW(e,t,n){return t[e]?`scale("${t[e]}",datum)`:sW(e,n[0].encode)}WW.fromEntries=function(e,t){const n=t.length,r=t[n-1],i=t[n-2];let o=t[0],a=null,s=1;for(o&&"load"===o.type&&(o=t[1]),e.add(t[0]);s<n;++s)t[s].params.pulse=gU(t[s-1]),e.add(t[s]),"aggregate"===t[s].type&&(a=t[s]);return new WW(e,o,i,r,a)},WW.prototype={countsRef(e,t,n){const r=this,i=r.counts||(r.counts={}),o=ZW(t);let a,s,l;return null!=o&&(e=r.scope,a=i[o]),a?n&&n.field&&HW(e,a.agg.params,n):(l={groupby:e.fieldRef(t,"key"),pulse:gU(r.output)},n&&n.field&&HW(e,l,n),s=e.add(RU(l)),a=e.add(IU({pulse:gU(s)})),a={agg:s,ref:gU(a)},null!=o&&(i[o]=a)),a.ref},tuplesRef(){return gU(this.values)},extentRef(e,t){return GW(e,this,"extent","extent",t,!1)},domainRef(e,t){return GW(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return GW(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return GW(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return GW(e,this,"indata","tupleindex",t,!0,!0)}};const KW=`item.orient==="${Sq}"?-90:item.orient==="${Aq}"?90:0`;function eZ(e,t){const n=aW(e=cs(e)?{text:e}:e,t.config.title),r=e.encode||{},i=r.group||{},o=i.name||void 0,a=i.interactive,s=i.style,l=[],u=gU(t.add(IU(null,[{}])));return l.push(function(e,t,n,r){const i={value:0},o=e.text,a={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return $I(a,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),fW({type:iW,role:JI,style:Wq,from:r,encode:a},n)}(e,n,function(e){const t=e.encode;return t&&t.title||Ya({name:e.name,interactive:e.interactive,style:e.style},t)}(e),u)),e.subtitle&&l.push(function(e,t,n,r){const i={value:0},o=e.subtitle,a={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return $I(a,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),fW({type:iW,role:QI,style:Zq,from:r,encode:a},n)}(e,n,r.subtitle,u)),YW(oW({role:XI,from:u,encode:tZ(n,i),marks:l,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:a,style:s}),t)}function tZ(e,t){const n={enter:{},update:{}};return $I(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:uW},angle:{signal:KW},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),CI(n,t,Jq)}function nZ(e,t){const n=[];e.transform&&e.transform.forEach((e=>{n.push(CW(e,t))})),e.on&&e.on.forEach((n=>{VW(n,t,e.name)})),t.addDataPipeline(e.name,function(e,t,n){const r=[];let i,o,a,s,l,u=null,c=!1,f=!1;e.values?OU(e.values)||EU(e.format)?(r.push(iZ(t,e)),r.push(u=rZ())):r.push(u=rZ({$ingest:e.values,$format:e.format})):e.url?EU(e.url)||EU(e.format)?(r.push(iZ(t,e)),r.push(u=rZ())):r.push(u=rZ({$request:e.url,$format:e.format})):e.source&&(u=i=Ra(e.source).map((e=>gU(t.getData(e).output))),r.push(null));for(o=0,a=n.length;o<a;++o)s=n[o],l=s.metadata,u||l.source||r.push(u=rZ()),r.push(s),l.generates&&(f=!0),l.modifies&&!f&&(c=!0),l.source?u=s:l.changes&&(u=null);i&&(a=i.length-1,r[0]=oq({derive:c,pulse:a?i:i[0]}),(c||a)&&r.splice(1,0,rZ()));u||r.push(rZ());return r.push(lq({})),r}(e,t,n))}function rZ(e){const t=IU({},e);return t.metadata={source:!0},t}function iZ(e,t){return XU({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const oZ=e=>e===$q||e===Nq,aZ=(e,t,n)=>OU(e)?hZ(e.signal,t,n):e===Sq||e===Nq?t:n,sZ=(e,t,n)=>OU(e)?fZ(e.signal,t,n):oZ(e)?t:n,lZ=(e,t,n)=>OU(e)?dZ(e.signal,t,n):oZ(e)?n:t,uZ=(e,t,n)=>OU(e)?pZ(e.signal,t,n):e===Nq?{value:t}:{value:n},cZ=(e,t,n)=>OU(e)?mZ(e.signal,t,n):e===Aq?{value:t}:{value:n},fZ=(e,t,n)=>gZ(`${e} === '${Nq}' || ${e} === '${$q}'`,t,n),dZ=(e,t,n)=>gZ(`${e} !== '${Nq}' && ${e} !== '${$q}'`,t,n),hZ=(e,t,n)=>vZ(`${e} === '${Sq}' || ${e} === '${Nq}'`,t,n),pZ=(e,t,n)=>vZ(`${e} === '${Nq}'`,t,n),mZ=(e,t,n)=>vZ(`${e} === '${Aq}'`,t,n),gZ=(e,t,n)=>(t=null!=t?SI(t):t,n=null!=n?SI(n):n,yZ(t)&&yZ(n)?{signal:`${e} ? (${t=t?t.signal||vs(t.value):null}) : (${n=n?n.signal||vs(n.value):null})`}:[Ya({test:e},t)].concat(n||[])),yZ=e=>null==e||1===Object.keys(e).length,vZ=(e,t,n)=>({signal:`${e} ? (${xZ(t)}) : (${xZ(n)})`}),bZ=(e,t,n,r,i)=>({signal:(null!=r?`${e} === '${Sq}' ? (${xZ(r)}) : `:"")+(null!=n?`${e} === '${$q}' ? (${xZ(n)}) : `:"")+(null!=i?`${e} === '${Aq}' ? (${xZ(i)}) : `:"")+(null!=t?`${e} === '${Nq}' ? (${xZ(t)}) : `:"")+"(null)"}),xZ=e=>OU(e)?e.signal:null==e?null:vs(e),wZ=(e,t)=>0===t?0:OU(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},kZ=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function _Z(e,t,n,r){let i;if(t&&Ka(t,e))return t[e];if(Ka(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=e[5].toLowerCase()+e.slice(6)}return r[qq][i]}if(e.startsWith("label")){switch(e){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=e[5].toLowerCase()+e.slice(6)}return r[Uq][i]}return null}function OZ(e){const t={};for(const n of e)if(n)for(const e in n)t[e]=1;return Object.keys(t)}function EZ(e,t){return{scale:e.scale,range:t}}function DZ(e,t,n,r,i){const o=aW(e,t),a=e.orient,s=e.gridScale,l=aZ(a,1,-1),u=function(e,t){if(1===t);else if(pa(e)){let n=e=Ya({},e);for(;null!=n.mult;){if(!pa(n.mult))return n.mult=OU(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n=n.mult=Ya({},n.mult)}n.mult=t}else e=OU(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);return e}(e.offset,l);let c,f,d;const h={enter:c={opacity:Qq},update:d={opacity:Kq},exit:f={opacity:Qq}};$I(h,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});const p={scale:e.scale,field:Iq,band:i.band,extra:i.extra,offset:i.offset,round:o("tickRound")},m=sZ(a,{signal:"height"},{signal:"width"}),g=s?{scale:s,range:0,mult:l,offset:u}:{value:0,offset:u},y=s?{scale:s,range:1,mult:l,offset:u}:Ya(m,{mult:l,offset:u});return c.x=d.x=sZ(a,p,g),c.y=d.y=lZ(a,p,g),c.x2=d.x2=lZ(a,y),c.y2=d.y2=sZ(a,y),f.x=sZ(a,p),f.y=lZ(a,p),fW({type:nW,role:LI,key:Iq,from:r,encode:h},n)}function jZ(e,t,n,r,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function NZ(e,t,n,r){const i=aW(e,t),o=e.orient,a=aZ(o,-1,1);let s,l;const u={enter:s={opacity:Qq,anchor:SI(i("titleAnchor",null)),align:{signal:uW}},update:l=Ya({},s,{opacity:Kq,text:SI(e.title)}),exit:{opacity:Qq}},c={signal:`lerp(range("${e.scale}"), ${lW(0,1,.5)})`};return l.x=sZ(o,c),l.y=lZ(o,c),s.angle=sZ(o,Qq,wZ(a,90)),s.baseline=sZ(o,uZ(o,$q,Nq),{value:$q}),l.angle=s.angle,l.baseline=s.baseline,$I(u,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),function(e,t,n,r){const i=(e,t)=>null!=e?(n.update[t]=kZ(SI(e),n.update[t]),!1):!MI(t,r),o=i(e("titleX"),"x"),a=i(e("titleY"),"y");n.enter.auto=a===o?SI(a):sZ(t,SI(a),SI(o))}(i,o,u,n),u.update.align=kZ(u.update.align,s.align),u.update.angle=kZ(u.update.angle,s.angle),u.update.baseline=kZ(u.update.baseline,s.baseline),fW({type:iW,role:UI,style:qq,from:r,encode:u},n)}function SZ(e,t){const n=function(e,t){var n,r,i,o=t.config,a=o.style,s=o.axis,l="band"===t.scaleType(e.scale)&&o.axisBand,u=e.orient;if(OU(u)){const e=OZ([o.axisX,o.axisY]),t=OZ([o.axisTop,o.axisBottom,o.axisLeft,o.axisRight]);for(i of(n={},e))n[i]=sZ(u,_Z(i,o.axisX,s,a),_Z(i,o.axisY,s,a));for(i of(r={},t))r[i]=bZ(u.signal,_Z(i,o.axisTop,s,a),_Z(i,o.axisBottom,s,a),_Z(i,o.axisLeft,s,a),_Z(i,o.axisRight,s,a))}else n=u===Nq||u===$q?o.axisX:o.axisY,r=o["axis"+u[0].toUpperCase()+u.slice(1)];return n||r||l?Ya({},s,n,r,l):s}(e,t),r=e.encode||{},i=r.axis||{},o=i.name||void 0,a=i.interactive,s=i.style,l=aW(e,n),u=function(e){const t=e("tickBand");let n,r,i=e("tickOffset");return t?t.signal?(n={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},r={signal:`(${t.signal}) === 'extent'`},pa(i)||(i={signal:`(${t.signal}) === 'extent' ? 0 : ${i}`})):"extent"===t?(n=1,r=!0,i=0):(n=.5,r=!1):(n=e("bandPosition"),r=e("tickExtra")),{extra:r,band:n,offset:i}}(l),c={scale:e.scale,ticks:!!l("ticks"),labels:!!l("labels"),grid:!!l("grid"),domain:!!l("domain"),title:null!=e.title},f=gU(t.add(IU({},[c]))),d=gU(t.add(LU({scale:t.scaleRef(e.scale),extra:t.property(u.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let p;return c.grid&&h.push(DZ(e,n,r.grid,d,u)),c.ticks&&(p=l("tickSize"),h.push(function(e,t,n,r,i,o){const a=aW(e,t),s=e.orient,l=aZ(s,-1,1);let u,c,f;const d={enter:u={opacity:Qq},update:f={opacity:Kq},exit:c={opacity:Qq}};$I(d,{stroke:a("tickColor"),strokeCap:a("tickCap"),strokeDash:a("tickDash"),strokeDashOffset:a("tickDashOffset"),strokeOpacity:a("tickOpacity"),strokeWidth:a("tickWidth")});const h=SI(i);h.mult=l;const p={scale:e.scale,field:Iq,band:o.band,extra:o.extra,offset:o.offset,round:a("tickRound")};return f.y=u.y=sZ(s,Qq,p),f.y2=u.y2=sZ(s,h),c.x=sZ(s,p),f.x=u.x=lZ(s,Qq,p),f.x2=u.x2=lZ(s,h),c.y=lZ(s,p),fW({type:nW,role:II,key:Iq,from:r,encode:d},n)}(e,n,r.ticks,d,p,u))),c.labels&&(p=c.ticks?p:0,h.push(function(e,t,n,r,i,o){const a=aW(e,t),s=e.orient,l=e.scale,u=aZ(s,-1,1),c=jU(a("labelFlush")),f=jU(a("labelFlushOffset")),d=a("labelAlign"),h=a("labelBaseline");let p,m=0===c||!!c;const g=SI(i);g.mult=u,g.offset=SI(a("labelPadding")||0),g.offset.mult=u;const y={scale:l,field:Iq,band:.5,offset:cW(o.offset,a("labelOffset"))},v=sZ(s,m?jZ(l,c,'"left"','"right"','"center"'):{value:"center"},cZ(s,"left","right")),b=sZ(s,uZ(s,"bottom","top"),m?jZ(l,c,'"top"','"bottom"','"middle"'):{value:"middle"}),x=jZ(l,c,`-(${f})`,f,0);m=m&&f;const w={opacity:Qq,x:sZ(s,y,g),y:lZ(s,y,g)},k={enter:w,update:p={opacity:Kq,text:{field:zq},x:w.x,y:w.y,align:v,baseline:b},exit:{opacity:Qq,x:w.x,y:w.y}};$I(k,{dx:!d&&m?sZ(s,x):null,dy:!h&&m?lZ(s,x):null}),$I(k,{angle:a("labelAngle"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontWeight:a("labelFontWeight"),fontStyle:a("labelFontStyle"),limit:a("labelLimit"),lineHeight:a("labelLineHeight")},{align:d,baseline:h});const _=a("labelBound");let O=a("labelOverlap");return O=O||_?{separation:a("labelSeparation"),method:O,order:"datum.index",bound:_?{scale:l,orient:s,tolerance:_}:null}:void 0,p.align!==v&&(p.align=kZ(p.align,v)),p.baseline!==b&&(p.baseline=kZ(p.baseline,b)),fW({type:iW,role:BI,style:Uq,key:Iq,from:r,encode:k,overlap:O},n)}(e,n,r.labels,d,p,u))),c.domain&&h.push(function(e,t,n,r){const i=aW(e,t),o=e.orient;let a,s;const l={enter:a={opacity:Qq},update:s={opacity:Kq},exit:{opacity:Qq}};$I(l,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const u=EZ(e,0),c=EZ(e,1);return a.x=s.x=sZ(o,u,Qq),a.x2=s.x2=sZ(o,c),a.y=s.y=lZ(o,u,Qq),a.y2=s.y2=lZ(o,c),fW({type:nW,role:RI,from:r,encode:l},n)}(e,n,r.domain,f)),c.title&&h.push(NZ(e,n,r.title,f)),YW(oW({role:zI,from:f,encode:CI(AZ(l,e),i,Jq),marks:h,aria:l("aria"),description:l("description"),zindex:l("zindex"),name:o,interactive:a,style:s}),t)}function AZ(e,t){const n={enter:{},update:{}};return $I(n,{orient:e("orient"),offset:e("offset")||0,position:DU(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function $Z(e,t,n){const r=Ra(e.signals),i=Ra(e.scales);return n||r.forEach((e=>dU(e,t))),Ra(e.projections).forEach((e=>function(e,t){const n=t.config.projection||{},r={};for(const i in e)"name"!==i&&(r[i]=jq(e[i],i,t));for(const i in n)null==r[i]&&(r[i]=jq(n[i],i,t));t.addProjection(e.name,r)}(e,t))),i.forEach((e=>function(e,t){const n=e.type||"linear";Lx(n)||Jo("Unrecognized scale type: "+vs(n)),t.addScale(e.name,{type:n,domain:void 0})}(e,t))),Ra(e.data).forEach((e=>nZ(e,t))),i.forEach((e=>pq(e,t))),(n||r).forEach((e=>function(e,t){const n=t.getSignal(e.name);let r=e.update;e.init&&(r?Jo("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=eB(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach((e=>FU(e,t,n.id)))}(e,t))),Ra(e.axes).forEach((e=>SZ(e,t))),Ra(e.marks).forEach((e=>YW(e,t))),Ra(e.legends).forEach((e=>XW(e,t))),e.title&&eZ(e.title,t),t.parseLambdas(),t}const CZ=e=>CI({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function MZ(e,t){const n=t.config,r=gU(t.root=t.add(mU())),i=function(e,t){const n=n=>DU(e[n],t[n]),r=[PZ("background",n("background")),PZ("autosize",EI(n("autosize"))),PZ("padding",NI(n("padding"))),PZ("width",n("width")||0),PZ("height",n("height")||0)],i=r.reduce(((e,t)=>(e[t.name]=t,e)),{}),o={};return Ra(e.signals).forEach((e=>{Ka(i,e.name)?e=Ya(i[e.name],e):r.push(e),o[e.name]=e})),Ra(t.signals).forEach((e=>{Ka(o,e.name)||Ka(i,e.name)||r.push(e)})),r}(e,n);i.forEach((e=>dU(e,t))),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const o=t.add(IU()),a=t.add(WU(aU(CZ(e.encode),eW,FI,e.style,t,{pulse:gU(o)}))),s=t.add(cq({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:gU(a)}));t.operators.pop(),t.pushState(gU(a),gU(s),null),$Z(e,t,i),t.operators.push(s);let l=t.add(BU({mark:r,pulse:gU(s)}));return l=t.add(aq({pulse:gU(l)})),l=t.add(lq({pulse:gU(l)})),t.addData("root",new WW(t,o,o,l)),t}function PZ(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function FZ(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function TZ(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}function zZ(e){return(ha(e)?RZ:LZ)(e)}function RZ(e){const t=e.length;let n="[";for(let r=0;r<t;++r){const t=e[r];n+=(r>0?",":"")+(pa(t)?t.signal||zZ(t):vs(t))}return n+"]"}function LZ(e){let t,n,r="{",i=0;for(t in e)n=e[t],r+=(++i>1?",":"")+vs(t)+":"+(pa(n)?n.signal||zZ(n):vs(n));return r+"}"}FZ.prototype=TZ.prototype={parse(e){return $Z(e,this)},fork(){return new TZ(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach((t=>{t.$ref=e.id})),e.refs=null),e},proxy(e){const t=e instanceof hU?gU(e):e;return this.add(iq({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;for(e in this.root&&(this.root.root=!0),this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(e,t,n){let r,i;e&&(r=e.data||(e.data={}),i=r[t]||(r[t]=[]),i.push(n))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const r in t.index)n(t.index[r],e,"index:"+r)}return this},pushState(e,t,n){this._encode.push(gU(this.add(lq({pulse:e})))),this._parent.push(t),this._lookup.push(n?gU(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return ba(this._parent)},encode(){return ba(this._encode)},lookup(){return ba(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(cs(e))return yU(e,t);e.signal||Jo("Unsupported field reference: "+vs(e));const n=e.signal;let r=this.field[n];if(!r){const e={name:this.signalRef(n)};t&&(e.as=t),this.field[n]=r=gU(this.add(GU(e)))}return r},compareRef(e){let t=!1;const n=e=>OU(e)?(t=!0,this.signalRef(e.signal)):function(e){return e&&e.expr}(e)?(t=!0,this.exprRef(e.expr)):e,r=Ra(e.field).map(n),i=Ra(e.order).map(n);return t?gU(this.add(UU({fields:r,orders:i}))):bU(r,i)},keyRef(e,t){let n=!1;const r=this.signals;return e=Ra(e).map((e=>OU(e)?(n=!0,gU(r[e.signal])):e)),n?gU(this.add(VU({fields:e,flat:t}))):function(e,t){const n={$key:e};return t&&(n.$flat=!0),n}(e,t)},sortRef(e){if(!e)return e;const t=wU(e.op,e.field),n=e.order||"ascending";return n.signal?gU(this.add(UU({fields:t,orders:this.signalRef(n.signal)}))):bU(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal(e){return Ka(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&Jo("Duplicate signal name: "+vs(e));const n=t instanceof hU?t:this.add(mU(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||Jo("Unrecognized signal name: "+vs(e)),this.signals[e]},signalRef(e){return this.signals[e]?gU(this.signals[e]):(Ka(this.lambdas,e)||(this.lambdas[e]=this.add(mU(null))),gU(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const n=e[t],r=eB(n,this),i=this.lambdas[n];i.params=r.$params,i.update=r.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return e&&pa(e)?this.signalRef(e.signal||zZ(e)):e},exprRef(e,t){const n={expr:eB(e,this)};return t&&(n.expr.$name=t),gU(this.add(ZU(n)))},addBinding(e,t){this.bindings||Jo("Nested signals do not support binding: "+vs(e)),this.bindings.push(Ya({signal:e},t))},addScaleProj(e,t){Ka(this.scales,e)&&Jo("Duplicate scale or projection name: "+vs(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,sq(t))},addProjection(e,t){this.addScaleProj(e,rq(t))},getScale(e){return this.scales[e]||Jo("Unrecognized scale name: "+vs(e)),this.scales[e]},scaleRef(e){return gU(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return Ka(this.data,e)&&Jo("Duplicate data set name: "+vs(e)),this.data[e]=t},getData(e){return this.data[e]||Jo("Undefined data set name: "+vs(e)),this.data[e]},addDataPipeline(e,t){return Ka(this.data,e)&&Jo("Duplicate data set name: "+vs(e)),this.addData(e,WW.fromEntries(this,t))}};Ya(Bh,sg,Nj,aN,nM,iP,GF,_F,QF,MT,VT,rz);var BZ=Object.freeze({__proto__:null,Bounds:Dk,CanvasHandler:rE,CanvasRenderer:lE,DATE:Fu,DAY:Tu,DAYOFYEAR:zu,Dataflow:zh,Debug:fa,Error:la,EventStream:kh,Gradient:Aw,GroupItem:Nk,HOURS:Ru,Handler:LO,Info:ca,Item:jk,MILLISECONDS:Iu,MINUTES:Lu,MONTH:Mu,Marks:_O,MultiPulse:Ch,None:sa,Operator:bh,Parameters:gh,Pulse:Nh,QUARTER:Cu,RenderType:QE,Renderer:IO,ResourceLoader:Sk,SECONDS:Bu,SVGHandler:cE,SVGRenderer:FE,SVGStringRenderer:YE,Scenegraph:$O,TIME_UNITS:Uu,Transform:Lh,View:rI,WEEK:Pu,Warn:ua,YEAR:$u,accessor:Zo,accessorFields:Go,accessorName:Ho,array:Ra,ascending:qa,bandwidthNRD:Hh,bin:Gh,bootstrapCI:Yh,boundClip:aD,boundContext:Xk,boundItem:OO,boundMark:DO,boundStroke:Ck,changeset:ph,clampRange:La,codegenExpression:GR,compare:Ua,constant:Ga,cumulativeLogNormal:lp,cumulativeNormal:np,cumulativeUniform:pp,dayofyear:Yu,debounce:Va,defaultLocale:jd,definition:Ih,densityLogNormal:sp,densityNormal:tp,densityUniform:hp,domChild:FO,domClear:TO,domCreate:MO,domFind:PO,dotbin:Xh,error:Jo,expressionFunction:KL,extend:Ya,extent:Xa,extentIndex:Ja,falsy:oa,fastmap:ts,field:Ko,flush:ns,font:mO,fontFamily:pO,fontSize:uO,format:Xd,formatLocale:bd,formats:Jd,hasOwnProperty:Ka,id:ea,identity:ta,inferType:qd,inferTypes:Wd,ingest:lh,inherits:rs,inrange:is,interpolate:Qx,interpolateColors:Yx,interpolateRange:Vx,intersect:tD,intersectBoxLine:s_,intersectPath:r_,intersectPoint:i_,intersectRule:a_,isArray:ha,isBoolean:os,isDate:as,isFunction:Ba,isIterable:ss,isNumber:ls,isObject:pa,isRegExp:us,isString:cs,isTuple:oh,key:fs,lerp:ds,lineHeight:cO,loader:eh,locale:Dd,logger:da,lruCache:hs,markup:jE,merge:ps,mergeConfig:ga,multiLineOffset:dO,one:ra,pad:gs,panLinear:ja,panLog:Na,panPow:Sa,panSymlog:Aa,parse:function(e,t,n){return pa(e)||Jo("Input Vega specification must be an object."),t=ga(function(){const e="sans-serif",t="#4c78a8",n="#000",r="#888",i="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:t},area:{fill:t},image:null,line:{stroke:t,strokeWidth:2},path:{stroke:t},rect:{fill:t},rule:{stroke:n},shape:{stroke:t},symbol:{fill:t,size:64},text:{fill:n,font:e,fontSize:11},trail:{fill:t,size:2},style:{"guide-label":{fill:n,font:e,fontSize:10},"guide-title":{fill:n,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:n,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:n,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:i},view:{fill:"transparent"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:r,grid:!1,gridWidth:1,gridColor:i,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:r,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:i,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:r,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}(),t,e.config),MZ(e,new FZ(t,n)).toRuntime()},parseExpression:WR,parseSelector:wI,path:jg,pathCurves:Cw,pathEqual:uD,pathParse:Rw,pathRectangle:lk,pathRender:Yw,pathSymbols:Kw,pathTrail:uk,peek:ba,point:RO,projection:OC,quantileLogNormal:up,quantileNormal:rp,quantileUniform:mp,quantiles:Wh,quantizeInterpolator:Xx,quarter:Ta,quartiles:Zh,get random(){return Vh},randomInteger:function(e,t){let n,r,i;null==t&&(t=e,e=0);const o={min(e){return arguments.length?(n=e||0,i=r-n,o):n},max(e){return arguments.length?(r=e||0,i=r-n,o):r},sample:()=>n+Math.floor(i*Vh()),pdf:e=>e===Math.floor(e)&&e>=n&&e<r?1/i:0,cdf(e){const t=Math.floor(e);return t<n?0:t>=r?1:(t-n+1)/i},icdf:e=>e>=0&&e<=1?n-1+Math.floor(e*i):NaN};return o.min(e).max(t)},randomKDE:op,randomLCG:function(e){return function(){return(e=(1103515245*e+12345)%2147483647)/2147483647}},randomLogNormal:cp,randomMixture:fp,randomNormal:ip,randomUniform:gp,read:Kd,regressionConstant:yp,regressionExp:Op,regressionLinear:kp,regressionLoess:Sp,regressionLog:_p,regressionPoly:jp,regressionPow:Ep,regressionQuad:Dp,renderModule:eD,repeat:ms,resetDefaultLocale:function(){return yd(),kd(),jd()},resetSVGClipId:Ok,resetSVGDefIds:function(){Ok(),Ew=0},responseType:Qd,runtimeContext:uB,sampleCurve:Mp,sampleLogNormal:ap,sampleNormal:ep,sampleUniform:dp,scale:Rx,sceneEqual:lD,sceneFromJSON:SO,scenePickVisit:v_,sceneToJSON:NO,sceneVisit:y_,sceneZOrder:g_,scheme:nw,serializeXML:NE,setRandom:function(e){Vh=e},span:ys,splitAccessPath:Qo,stringValue:vs,textMetrics:rO,timeBin:Lc,timeFloor:fc,timeFormatLocale:Od,timeInterval:yc,timeOffset:xc,timeSequence:_c,timeUnitSpecifier:Hu,timeUnits:Wu,toBoolean:bs,toDate:ws,toNumber:xa,toSet:_s,toString:ks,transform:Uh,transforms:Bh,truncate:Os,truthy:ia,tupleid:ah,typeParsers:Bd,utcFloor:pc,utcInterval:vc,utcOffset:wc,utcSequence:Oc,utcdayofyear:tc,utcquarter:za,utcweek:nc,version:"5.25.0",visitArray:Es,week:Xu,writeConfig:ya,zero:na,zoomLinear:Ca,zoomLog:Ma,zoomPow:Pa,zoomSymlog:Fa});var IZ={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},UZ={"*":(e,t)=>e*t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,">":(e,t)=>e>t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"&":(e,t)=>e&t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t},qZ={"+":e=>+e,"-":e=>-e,"~":e=>~e,"!":e=>!e};const WZ=Array.prototype.slice,ZZ=(e,t,n)=>{const r=n?n(t[0]):t[0];return r[e].apply(r,WZ.call(t,1))};var HZ={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),now:Date.now,utc:Date.UTC,datetime:(e,t,n,r,i,o,a)=>new Date(e,t||0,null!=n?n:1,r||0,i||0,o||0,a||0),date:e=>new Date(e).getDate(),day:e=>new Date(e).getDay(),year:e=>new Date(e).getFullYear(),month:e=>new Date(e).getMonth(),hours:e=>new Date(e).getHours(),minutes:e=>new Date(e).getMinutes(),seconds:e=>new Date(e).getSeconds(),milliseconds:e=>new Date(e).getMilliseconds(),time:e=>new Date(e).getTime(),timezoneoffset:e=>new Date(e).getTimezoneOffset(),utcdate:e=>new Date(e).getUTCDate(),utcday:e=>new Date(e).getUTCDay(),utcyear:e=>new Date(e).getUTCFullYear(),utcmonth:e=>new Date(e).getUTCMonth(),utchours:e=>new Date(e).getUTCHours(),utcminutes:e=>new Date(e).getUTCMinutes(),utcseconds:e=>new Date(e).getUTCSeconds(),utcmilliseconds:e=>new Date(e).getUTCMilliseconds(),length:e=>e.length,join:function(){return ZZ("join",arguments)},indexof:function(){return ZZ("indexOf",arguments)},lastindexof:function(){return ZZ("lastIndexOf",arguments)},slice:function(){return ZZ("slice",arguments)},reverse:e=>e.slice().reverse(),parseFloat:parseFloat,parseInt:parseInt,upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),substring:function(){return ZZ("substring",arguments,String)},split:function(){return ZZ("split",arguments,String)},replace:function(){return ZZ("replace",arguments,String)},trim:e=>String(e).trim(),regexp:RegExp,test:(e,t)=>RegExp(e).test(t)};const GZ=["view","item","group","xy","x","y"],VZ=new Set([Function,eval,setTimeout,setInterval]);"function"==typeof setImmediate&&VZ.add(setImmediate);const YZ={Literal:(e,t)=>t.value,Identifier:(e,t)=>{const n=t.name;return e.memberDepth>0?n:"datum"===n?e.datum:"event"===n?e.event:"item"===n?e.item:IZ[n]||e.params["$"+n]},MemberExpression:(e,t)=>{const n=!t.computed,r=e(t.object);n&&(e.memberDepth+=1);const i=e(t.property);if(n&&(e.memberDepth-=1),!VZ.has(r[i]))return r[i];console.error(`Prevented interpretation of member "${i}" which could lead to insecure code execution`)},CallExpression:(e,t)=>{const n=t.arguments;let r=t.callee.name;return r.startsWith("_")&&(r=r.slice(1)),"if"===r?e(n[0])?e(n[1]):e(n[2]):(e.fn[r]||HZ[r]).apply(e.fn,n.map(e))},ArrayExpression:(e,t)=>t.elements.map(e),BinaryExpression:(e,t)=>UZ[t.operator](e(t.left),e(t.right)),UnaryExpression:(e,t)=>qZ[t.operator](e(t.argument)),ConditionalExpression:(e,t)=>e(t.test)?e(t.consequent):e(t.alternate),LogicalExpression:(e,t)=>"&&"===t.operator?e(t.left)&&e(t.right):e(t.left)||e(t.right),ObjectExpression:(e,t)=>t.properties.reduce(((t,n)=>{e.memberDepth+=1;const r=e(n.key);return e.memberDepth-=1,VZ.has(e(n.value))?console.error(`Prevented interpretation of property "${r}" which could lead to insecure code execution`):t[r]=e(n.value),t}),{})};function XZ(e,t,n,r,i,o){const a=e=>YZ[e.type](a,e);return a.memberDepth=0,a.fn=Object.create(t),a.params=n,a.datum=r,a.event=i,a.item=o,GZ.forEach((e=>a.fn[e]=function(){return i.vega[e](...arguments)})),a(e)}var JZ={operator(e,t){const n=t.ast,r=e.functions;return e=>XZ(n,r,e)},parameter(e,t){const n=t.ast,r=e.functions;return(e,t)=>XZ(n,r,t,e)},event(e,t){const n=t.ast,r=e.functions;return e=>XZ(n,r,void 0,void 0,e)},handler(e,t){const n=t.ast,r=e.functions;return(e,t)=>{const i=t.item&&t.item.datum;return XZ(n,r,e,i,t)}},encode(e,t){const{marktype:n,channels:r}=t,i=e.functions,o="group"===n||"image"===n||"rect"===n;return(e,t)=>{const a=e.datum;let s,l=0;for(const n in r)s=XZ(r[n].ast,i,t,a,void 0,e),e[n]!==s&&(e[n]=s,l=1);return"rule"!==n&&function(e,t,n){let r;t.x2&&(t.x?(n&&e.x>e.x2&&(r=e.x,e.x=e.x2,e.x2=r),e.width=e.x2-e.x):e.x=e.x2-(e.width||0)),t.xc&&(e.x=e.xc-(e.width||0)/2),t.y2&&(t.y?(n&&e.y>e.y2&&(r=e.y,e.y=e.y2,e.y2=r),e.height=e.y2-e.y):e.y=e.y2-(e.height||0)),t.yc&&(e.y=e.yc-(e.height||0)/2)}(e,r,o),l}}},QZ="5.14.1",KZ={exports:{}};!function(e){var t=function(){function e(e,t){return null!=t&&e instanceof t}var t,n,r;try{t=Map}catch(s){t=function(){}}try{n=Set}catch(s){n=function(){}}try{r=Promise}catch(s){r=function(){}}function i(o,s,l,u,c){"object"==typeof s&&(l=s.depth,u=s.prototype,c=s.includeNonEnumerable,s=s.circular);var f=[],d=[],h="undefined"!=typeof Buffer;return void 0===s&&(s=!0),void 0===l&&(l=1/0),function o(l,p){if(null===l)return null;if(0===p)return l;var m,g;if("object"!=typeof l)return l;if(e(l,t))m=new t;else if(e(l,n))m=new n;else if(e(l,r))m=new r((function(e,t){l.then((function(t){e(o(t,p-1))}),(function(e){t(o(e,p-1))}))}));else if(i.__isArray(l))m=[];else if(i.__isRegExp(l))m=new RegExp(l.source,a(l)),l.lastIndex&&(m.lastIndex=l.lastIndex);else if(i.__isDate(l))m=new Date(l.getTime());else{if(h&&Buffer.isBuffer(l))return m=Buffer.allocUnsafe?Buffer.allocUnsafe(l.length):new Buffer(l.length),l.copy(m),m;e(l,Error)?m=Object.create(l):void 0===u?(g=Object.getPrototypeOf(l),m=Object.create(g)):(m=Object.create(u),g=u)}if(s){var y=f.indexOf(l);if(-1!=y)return d[y];f.push(l),d.push(m)}for(var v in e(l,t)&&l.forEach((function(e,t){var n=o(t,p-1),r=o(e,p-1);m.set(n,r)})),e(l,n)&&l.forEach((function(e){var t=o(e,p-1);m.add(t)})),l){var b;g&&(b=Object.getOwnPropertyDescriptor(g,v)),b&&null==b.set||(m[v]=o(l[v],p-1))}if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(l);for(v=0;v<x.length;v++){var w=x[v];(!(_=Object.getOwnPropertyDescriptor(l,w))||_.enumerable||c)&&(m[w]=o(l[w],p-1),_.enumerable||Object.defineProperty(m,w,{enumerable:!1}))}}if(c){var k=Object.getOwnPropertyNames(l);for(v=0;v<k.length;v++){var _,O=k[v];(_=Object.getOwnPropertyDescriptor(l,O))&&_.enumerable||(m[O]=o(l[O],p-1),Object.defineProperty(m,O,{enumerable:!1}))}}return m}(o,l)}function o(e){return Object.prototype.toString.call(e)}function a(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}return i.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},i.__objToStr=o,i.__isDate=function(e){return"object"==typeof e&&"[object Date]"===o(e)},i.__isArray=function(e){return"object"==typeof e&&"[object Array]"===o(e)},i.__isRegExp=function(e){return"object"==typeof e&&"[object RegExp]"===o(e)},i.__getRegExpFlags=a,i}();e.exports&&(e.exports=t)}(KZ);var eH=no(KZ.exports),tH=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var r,i,o;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(i=r;0!=i--;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(o=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=r;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;0!=i--;){var a=o[i];if(!e(t[a],n[a]))return!1}return!0}return t!=t&&n!=n},nH=no(tH),rH=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var n,r="boolean"==typeof t.cycles&&t.cycles,i=t.cmp&&(n=t.cmp,function(e){return function(t,r){var i={key:t,value:e[t]},o={key:r,value:e[r]};return n(i,o)}}),o=[];return function e(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);var n,a;if(Array.isArray(t)){for(a="[",n=0;n<t.length;n++)n&&(a+=","),a+=e(t[n])||"null";return a+"]"}if(null===t)return"null";if(-1!==o.indexOf(t)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var s=o.push(t)-1,l=Object.keys(t).sort(i&&i(t));for(a="",n=0;n<l.length;n++){var u=l[n],c=e(t[u]);c&&(a&&(a+=","),a+=JSON.stringify(u)+":"+c)}return o.splice(s,1),"{"+a+"}"}}(e)},iH=no(rH);function oH(e){return!!e.or}function aH(e){return!!e.and}function sH(e){return!!e.not}function lH(e,t){if(sH(e))lH(e.not,t);else if(aH(e))for(const n of e.and)lH(n,t);else if(oH(e))for(const n of e.or)lH(n,t);else t(e)}function uH(e,t){return sH(e)?{not:uH(e.not,t)}:aH(e)?{and:e.and.map((e=>uH(e,t)))}:oH(e)?{or:e.or.map((e=>uH(e,t)))}:t(e)}const cH=nH,fH=eH;function dH(e){throw new Error(e)}function hH(e,t){const n={};for(const r of t)Ka(e,r)&&(n[r]=e[r]);return n}function pH(e,t){const n={...e};for(const r of t)delete n[r];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map((e=>iH(e))).join(",")})`};const mH=iH;function gH(e){if(ls(e))return e;const t=cs(e)?e:iH(e);if(t.length<250)return t;let n=0;for(let r=0;r<t.length;r++){n=(n<<5)-n+t.charCodeAt(r),n&=n}return n}function yH(e){return!1===e||null===e}function vH(e,t){return e.includes(t)}function bH(e,t){let n=0;for(const[r,i]of e.entries())if(t(i,r,n++))return!0;return!1}function xH(e,t){let n=0;for(const[r,i]of e.entries())if(!t(i,r,n++))return!1;return!0}function wH(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(const i of n)kH(e,i??{});return e}function kH(e,t){for(const n of SH(t))ya(e,n,t[n],!0)}function _H(e,t){const n=[],r={};let i;for(const o of e)i=t(o),i in r||(r[i]=1,n.push(o));return n}function OH(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function EH(e,t){for(const n of e)if(t.has(n))return!0;return!1}function DH(e){const t=new Set;for(const n of e){const e=Qo(n).map(((e,t)=>0===t?e:`[${e}]`)),r=e.map(((t,n)=>e.slice(0,n+1).join("")));for(const n of r)t.add(n)}return t}function jH(e,t){return void 0===e||void 0===t||EH(DH(e),DH(t))}function NH(e){return 0===SH(e).length}const SH=Object.keys,AH=Object.values,$H=Object.entries;function CH(e){return!0===e||!1===e}function MH(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function PH(e,t){return sH(e)?`!(${PH(e.not,t)})`:aH(e)?`(${e.and.map((e=>PH(e,t))).join(") && (")})`:oH(e)?`(${e.or.map((e=>PH(e,t))).join(") || (")})`:t(e)}function FH(e,t){if(0===t.length)return!0;const n=t.shift();return n in e&&FH(e[n],t)&&delete e[n],NH(e)}function TH(e){return e.charAt(0).toUpperCase()+e.substr(1)}function zH(e,t){void 0===t&&(t="datum");const n=Qo(e),r=[];for(let i=1;i<=n.length;i++){const e=`[${n.slice(0,i).map(vs).join("][")}]`;r.push(`${t}${e}`)}return r.join(" && ")}function RH(e,t){return void 0===t&&(t="datum"),`${t}[${vs(Qo(e).join("."))}]`}function LH(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function BH(e){return`${Qo(e).map(LH).join("\\.")}`}function IH(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function UH(e){return`${Qo(e).join(".")}`}function qH(e){return e?Qo(e).length:0}function WH(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const r of t)if(void 0!==r)return r}let ZH=42;function HH(e){const t=++ZH;return e?String(e)+t:t}function GH(e){return VH(e)?e:`__${e}`}function VH(e){return e.startsWith("__")}function YH(e){if(void 0!==e)return(e%360+360)%360}function XH(e){return!!ls(e)||!isNaN(e)&&!isNaN(parseFloat(e))}const JH="row",QH="column",KH="facet",eG="x",tG="y",nG="x2",rG="y2",iG="xOffset",oG="yOffset",aG="radius",sG="radius2",lG="theta",uG="theta2",cG="latitude",fG="longitude",dG="latitude2",hG="longitude2",pG="color",mG="fill",gG="stroke",yG="shape",vG="size",bG="angle",xG="opacity",wG="fillOpacity",kG="strokeOpacity",_G="strokeWidth",OG="strokeDash",EG="text",DG="order",jG="detail",NG="key",SG="tooltip",AG="href",$G="url",CG="description",MG={theta:1,theta2:1,radius:1,radius2:1};function PG(e){return e in MG}const FG={longitude:1,longitude2:1,latitude:1,latitude2:1};function TG(e){switch(e){case cG:return"y";case dG:return"y2";case fG:return"x";case hG:return"x2"}}function zG(e){return e in FG}const RG=SH(FG),LG={x:1,y:1,x2:1,y2:1,...MG,...FG,xOffset:1,yOffset:1,color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1};function BG(e){return e===pG||e===mG||e===gG}const IG={row:1,column:1,facet:1},UG=SH(IG),qG={...LG,...IG},WG=SH(qG),{order:ZG,detail:HG,tooltip:GG,...VG}=qG,{row:YG,column:XG,facet:JG,...QG}=VG;function KG(e){return!!qG[e]}const eV=[nG,rG,dG,hG,uG,sG];function tV(e){return nV(e)!==e}function nV(e){switch(e){case nG:return eG;case rG:return tG;case dG:return cG;case hG:return fG;case uG:return lG;case sG:return aG}return e}function rV(e){if(PG(e))switch(e){case lG:return"startAngle";case uG:return"endAngle";case aG:return"outerRadius";case sG:return"innerRadius"}return e}function iV(e){switch(e){case eG:return nG;case tG:return rG;case cG:return dG;case fG:return hG;case lG:return uG;case aG:return sG}}function oV(e){switch(e){case eG:case nG:return"width";case tG:case rG:return"height"}}function aV(e){switch(e){case eG:return"xOffset";case tG:return"yOffset";case nG:return"x2Offset";case rG:return"y2Offset";case lG:return"thetaOffset";case aG:return"radiusOffset";case uG:return"theta2Offset";case sG:return"radius2Offset"}}function sV(e){switch(e){case eG:return"xOffset";case tG:return"yOffset"}}function lV(e){switch(e){case"xOffset":return"x";case"yOffset":return"y"}}const uV=SH(LG),{x:cV,y:fV,x2:dV,y2:hV,xOffset:pV,yOffset:mV,latitude:gV,longitude:yV,latitude2:vV,longitude2:bV,theta:xV,theta2:wV,radius:kV,radius2:_V,...OV}=LG,EV=SH(OV),DV={x:1,y:1},jV=SH(DV);function NV(e){return e in DV}const SV={theta:1,radius:1},AV=SH(SV);function $V(e){return"width"===e?eG:tG}const CV={xOffset:1,yOffset:1};function MV(e){return e in CV}const{text:PV,tooltip:FV,href:TV,url:zV,description:RV,detail:LV,key:BV,order:IV,...UV}=OV,qV=SH(UV);const WV={...DV,...SV,...CV,...UV},ZV=SH(WV);function HV(e){return!!WV[e]}function GV(e,t){return function(e){switch(e){case pG:case mG:case gG:case CG:case jG:case NG:case SG:case AG:case DG:case xG:case wG:case kG:case _G:case KH:case JH:case QH:return VV;case eG:case tG:case iG:case oG:case cG:case fG:return XV;case nG:case rG:case dG:case hG:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case vG:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case OG:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case yG:return{point:"always",geoshape:"always"};case EG:return{text:"always"};case bG:return{point:"always",square:"always",text:"always"};case $G:return{image:"always"};case lG:case aG:return{text:"always",arc:"always"};case uG:case sG:return{arc:"always"}}}(e)[t]}const VV={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:YV,...XV}=VV;function JV(e){switch(e){case eG:case tG:case lG:case aG:case iG:case oG:case vG:case bG:case _G:case xG:case wG:case kG:case nG:case rG:case uG:case sG:return;case KH:case JH:case QH:case yG:case OG:case EG:case SG:case AG:case $G:case CG:return"discrete";case pG:case mG:case gG:return"flexible";case cG:case fG:case dG:case hG:case jG:case NG:case DG:return}}const QV={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},KV={count:1,min:1,max:1};function eY(e){return!!e&&!!e.argmin}function tY(e){return!!e&&!!e.argmax}function nY(e){return cs(e)&&!!QV[e]}const rY=new Set(["count","valid","missing","distinct"]);function iY(e){return cs(e)&&rY.has(e)}const oY=new Set(["count","sum","distinct","valid","missing"]),aY=new Set(["mean","average","median","q1","q3","min","max"]);function sY(e){return os(e)&&(e=vK(e,void 0)),"bin"+SH(e).map((t=>fY(e[t])?MH(`_${t}_${$H(e[t])}`):MH(`_${t}_${e[t]}`))).join("")}function lY(e){return!0===e||cY(e)&&!e.binned}function uY(e){return"binned"===e||cY(e)&&!0===e.binned}function cY(e){return pa(e)}function fY(e){return e?.param}function dY(e){switch(e){case JH:case QH:case vG:case pG:case mG:case gG:case _G:case xG:case wG:case kG:case yG:return 6;case OG:return 4;default:return 10}}function hY(e){return!!e?.expr}function pY(e){const t=SH(e||{}),n={};for(const r of t)n[r]=OY(e[r]);return n}function mY(e){const{anchor:t,frame:n,offset:r,orient:i,angle:o,limit:a,color:s,subtitleColor:l,subtitleFont:u,subtitleFontSize:c,subtitleFontStyle:f,subtitleFontWeight:d,subtitleLineHeight:h,subtitlePadding:p,...m}=e,g={...t?{anchor:t}:{},...n?{frame:n}:{},...r?{offset:r}:{},...i?{orient:i}:{},...void 0!==o?{angle:o}:{},...void 0!==a?{limit:a}:{}},y={...l?{subtitleColor:l}:{},...u?{subtitleFont:u}:{},...c?{subtitleFontSize:c}:{},...f?{subtitleFontStyle:f}:{},...d?{subtitleFontWeight:d}:{},...h?{subtitleLineHeight:h}:{},...p?{subtitlePadding:p}:{}};return{titleMarkConfig:{...m,...s?{fill:s}:{}},subtitleMarkConfig:hH(e,["align","baseline","dx","dy","limit"]),nonMarkTitleProperties:g,subtitle:y}}function gY(e){return cs(e)||ha(e)&&cs(e[0])}function yY(e){return!!e?.signal}function vY(e){return!!e.step}function bY(e){return!ha(e)&&("field"in e&&"data"in e)}const xY=SH({aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1}),wY={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},kY=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function _Y(e){const t=ha(e.condition)?e.condition.map(EY):EY(e.condition);return{...OY(e),condition:t}}function OY(e){if(hY(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function EY(e){if(hY(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function DY(e){if(hY(e)){const{expr:t,...n}=e;return{signal:t,...n}}return yY(e)?e:void 0!==e?{value:e}:void 0}function jY(e){return yY(e)?e.signal:vs(e)}function NY(e){return yY(e)?e.signal:vs(e.value)}function SY(e){return yY(e)?e.signal:null==e?null:vs(e)}function AY(e,t,n){for(const r of n){const n=MY(r,t.markDef,t.config);void 0!==n&&(e[r]=DY(n))}return e}function $Y(e){return[].concat(e.type,e.style??[])}function CY(e,t,n,r){void 0===r&&(r={});const{vgChannel:i,ignoreVgConfig:o}=r;return i&&void 0!==t[i]?t[i]:void 0!==t[e]?t[e]:!o||i&&i!==e?MY(e,t,n,r):void 0}function MY(e,t,n,r){let{vgChannel:i}=void 0===r?{}:r;return WH(i?PY(e,t,n.style):void 0,PY(e,t,n.style),i?n[t.type][i]:void 0,n[t.type][e],i?n.mark[i]:n.mark[e])}function PY(e,t,n){return FY(e,$Y(t),n)}function FY(e,t,n){let r;t=Ra(t);for(const i of t){const t=n[i];t&&void 0!==t[e]&&(r=t[e])}return r}function TY(e,t){return Ra(e).reduce(((e,n)=>(e.field.push(iK(n,t)),e.order.push(n.sort??"ascending"),e)),{field:[],order:[]})}function zY(e,t){const n=[...e];return t.forEach((e=>{for(const t of n)if(cH(t,e))return;n.push(e)})),n}function RY(e,t){return cH(e,t)||!t?e:e?[...Ra(e),...Ra(t)].join(", "):t}function LY(e,t){const n=e.value,r=t.value;if(null==n||null===r)return{explicit:e.explicit,value:null};if((gY(n)||yY(n))&&(gY(r)||yY(r)))return{explicit:e.explicit,value:RY(n,r)};if(gY(n)||yY(n))return{explicit:e.explicit,value:n};if(gY(r)||yY(r))return{explicit:e.explicit,value:r};if(!(gY(n)||yY(n)||gY(r)||yY(r)))return{explicit:e.explicit,value:zY(n,r)};throw new Error("It should never reach here")}function BY(e){return`Invalid specification ${mH(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const IY='Autosize "fit" only works for single views and layered views.';function UY(e){return`${"width"==e?"Width":"Height"} "container" only works for single views and layered views.`}function qY(e){return`${"width"==e?"Width":"Height"} "container" only works well with autosize "fit" or "fit-${"width"==e?"x":"y"}".`}function WY(e){return e?`Dropping "fit-${e}" because spec has discrete ${oV(e)}.`:'Dropping "fit" because spec has discrete size.'}function ZY(e){return`Unknown field for ${e}. Cannot calculate view size.`}function HY(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function GY(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function VY(e){return`Selection not supported for ${e} yet.`}const YY="The same selection must be used to override scale domains in a layered view.";function XY(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}function JY(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}function QY(e){return`Ignoring an invalid transform: ${mH(e)}.`}function KY(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function eX(e){return`${e}Offset dropped because ${e} is continuous`}function tX(e){return`There is no ${e} encoding. Replacing ${e}Offset encoding as ${e}.`}function nX(e){return`Invalid field type "${e}".`}function rX(e,t){const{fill:n,stroke:r}=t;return`Dropping color ${e} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function iX(e,t){return`Dropping ${mH(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}function oX(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function aX(e){return`${e} encoding has no scale, so specified scale is ignored.`}function sX(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function lX(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function uX(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${"ordinal"===t?"order":"magnitude"}.`}function cX(e){return`Using unaggregated domain with raw field has no effect (${mH(e)}).`}function fX(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function dX(e){return`Unaggregated domain is currently unsupported for log scale (${mH(e)}).`}function hX(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function pX(e){return`The step for "${e}" is dropped because the ${"width"===e?"x":"y"} is continuous.`}const mX="Domains that should be unioned has conflicting sort properties. Sort will be set to true.";function gX(e,t){return`Invalid ${e}: ${mH(t)}.`}function yX(e){return`1D error band does not support ${e}.`}function vX(e){return`Channel ${e} is required for "binned" bin.`}const bX=da(ua);let xX=bX;function wX(){xX.warn(...arguments)}function kX(e){if(e&&pa(e))for(const t of AX)if(t in e)return!0;return!1}const _X=["january","february","march","april","may","june","july","august","september","october","november","december"],OX=_X.map((e=>e.substr(0,3))),EX=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],DX=EX.map((e=>e.substr(0,3)));function jX(e,t){const n=[];if(t&&void 0!==e.day&&SH(e).length>1&&(wX(function(e){return`Dropping day from datetime ${mH(e)} as day cannot be combined with other units.`}(e)),delete(e=fH(e)).day),void 0!==e.year?n.push(e.year):n.push(2012),void 0!==e.month){const r=t?function(e){if(XH(e)&&(e=+e),ls(e))return e-1;{const t=e.toLowerCase(),n=_X.indexOf(t);if(-1!==n)return n;const r=t.substr(0,3),i=OX.indexOf(r);if(-1!==i)return i;throw new Error(gX("month",e))}}(e.month):e.month;n.push(r)}else if(void 0!==e.quarter){const r=t?function(e){if(XH(e)&&(e=+e),ls(e))return e>4&&wX(gX("quarter",e)),e-1;throw new Error(gX("quarter",e))}(e.quarter):e.quarter;n.push(ls(r)?3*r:`${r}*3`)}else n.push(0);if(void 0!==e.date)n.push(e.date);else if(void 0!==e.day){const r=t?function(e){if(XH(e)&&(e=+e),ls(e))return e%7;{const t=e.toLowerCase(),n=EX.indexOf(t);if(-1!==n)return n;const r=t.substr(0,3),i=DX.indexOf(r);if(-1!==i)return i;throw new Error(gX("day",e))}}(e.day):e.day;n.push(ls(r)?r+1:`${r}+1`)}else n.push(1);for(const r of["hours","minutes","seconds","milliseconds"]){const t=e[r];n.push(void 0===t?0:t)}return n}function NX(e){const t=jX(e,!0).join(", ");return e.utc?`utc(${t})`:`datetime(${t})`}const SX={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},AX=SH(SX);function $X(e){return pa(e)?e.binned:CX(e)}function CX(e){return e&&e.startsWith("binned")}function MX(e){return e.startsWith("utc")}const PX={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function FX(e){return AX.filter((t=>zX(e,t)))}function TX(e){const t=FX(e);return t[t.length-1]}function zX(e,t){const n=e.indexOf(t);return!(n<0)&&(!(n>0&&"seconds"===t&&"i"===e.charAt(n-1))&&(!(e.length>n+3&&"day"===t&&"o"===e.charAt(n+3))&&!(n>0&&"year"===t&&"f"===e.charAt(n-1))))}function RX(e,t,n){let{end:r}=void 0===n?{end:!1}:n;const i=zH(t),o=MX(e)?"utc":"";let a;const s={};for(const u of AX)zX(e,u)&&(s[u]="quarter"===(l=u)?`(${o}quarter(${i})-1)`:`${o}${l}(${i})`,a=u);var l;return r&&(s[a]+="+1"),function(e){const t=jX(e,!1).join(", ");return e.utc?`utc(${t})`:`datetime(${t})`}(s)}function LX(e){if(!e)return;const t=FX(e);return`timeUnitSpecifier(${mH(t)}, ${mH(PX)})`}function BX(e){if(!e)return;let t;return cs(e)?t=CX(e)?{unit:e.substring(6),binned:!0}:{unit:e}:pa(e)&&(t={...e,...e.unit?{unit:e.unit}:{}}),MX(t.unit)&&(t.utc=!0,t.unit=function(e){return e.substring(3)}(t.unit)),t}function IX(e,t){void 0===t&&(t=e=>e);const n=BX(e),r=TX(n.unit);if(r&&"day"!==r){const e={year:2001,month:1,date:1,hours:0,minutes:0,seconds:0,milliseconds:0},{step:i,part:o}=qX(r,n.step);return`${t(NX({...e,[o]:+e[o]+i}))} - ${t(NX(e))}`}}const UX={year:1,month:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1};function qX(e,t){if(void 0===t&&(t=1),function(e){return!!UX[e]}(e))return{part:e,step:t};switch(e){case"day":case"dayofyear":return{part:"date",step:t};case"quarter":return{part:"month",step:3*t};case"week":return{part:"date",step:7*t}}}function WX(e){return!!e?.field&&void 0!==e.equal}function ZX(e){return!!e?.field&&void 0!==e.lt}function HX(e){return!!e?.field&&void 0!==e.lte}function GX(e){return!!e?.field&&void 0!==e.gt}function VX(e){return!!e?.field&&void 0!==e.gte}function YX(e){if(e?.field){if(ha(e.range)&&2===e.range.length)return!0;if(yY(e.range))return!0}return!1}function XX(e){return!!e?.field&&(ha(e.oneOf)||ha(e.in))}function JX(e){return XX(e)||WX(e)||YX(e)||ZX(e)||GX(e)||HX(e)||VX(e)}function QX(e,t){return wK(e,{timeUnit:t,wrapTime:!0})}function KX(e,t){void 0===t&&(t=!0);const{field:n}=e,r=BX(e.timeUnit),{unit:i,binned:o}=r||{},a=iK(e,{expr:"datum"}),s=i?`time(${o?a:RX(i,n)})`:a;if(WX(e))return`${s}===${QX(e.equal,i)}`;if(ZX(e)){return`${s}<${QX(e.lt,i)}`}if(GX(e)){return`${s}>${QX(e.gt,i)}`}if(HX(e)){return`${s}<=${QX(e.lte,i)}`}if(VX(e)){return`${s}>=${QX(e.gte,i)}`}if(XX(e))return`indexof([${function(e,t){return e.map((e=>QX(e,t)))}(e.oneOf,i).join(",")}], ${s}) !== -1`;if(function(e){return!!e?.field&&void 0!==e.valid}(e))return eJ(s,e.valid);if(YX(e)){const{range:n}=e,r=yY(n)?{signal:`${n.signal}[0]`}:n[0],o=yY(n)?{signal:`${n.signal}[1]`}:n[1];if(null!==r&&null!==o&&t)return"inrange("+s+", ["+QX(r,i)+", "+QX(o,i)+"])";const a=[];return null!==r&&a.push(`${s} >= ${QX(r,i)}`),null!==o&&a.push(`${s} <= ${QX(o,i)}`),a.length>0?a.join(" && "):"true"}throw new Error(`Invalid field predicate: ${mH(e)}`)}function eJ(e,t){return void 0===t&&(t=!0),t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function tJ(e){return JX(e)&&e.timeUnit?{...e,timeUnit:BX(e.timeUnit)}:e}function nJ(e){return"quantitative"===e||"temporal"===e}function rJ(e){return"ordinal"===e||"nominal"===e}const iJ="quantitative",oJ="ordinal",aJ="temporal",sJ="nominal",lJ="geojson";const uJ={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},cJ={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function fJ(e,t){const n=cJ[e],r=cJ[t];return n===r||"ordinal-position"===n&&"time"===r||"ordinal-position"===r&&"time"===n}const dJ={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function hJ(e){return dJ[e]}const pJ=new Set(["linear","log","pow","sqrt","symlog"]),mJ=new Set([...pJ,"time","utc"]);function gJ(e){return pJ.has(e)}const yJ=new Set(["quantile","quantize","threshold"]),vJ=new Set([...mJ,...yJ,"sequential","identity"]),bJ=new Set(["ordinal","bin-ordinal","point","band"]);function xJ(e){return bJ.has(e)}function wJ(e){return vJ.has(e)}function kJ(e){return mJ.has(e)}function _J(e){return yJ.has(e)}function OJ(e){return e?.param}const{type:EJ,domain:DJ,range:jJ,rangeMax:NJ,rangeMin:SJ,scheme:AJ,...$J}={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,domainRaw:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},CJ=SH($J);function MJ(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return kJ(e)||"band"===e||"point"===e;case"padding":case"rangeMin":case"rangeMax":return kJ(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return"band"===e;case"domainMax":case"domainMid":case"domainMin":case"domainRaw":case"clamp":return kJ(e);case"nice":return kJ(e)||"quantize"===e||"threshold"===e;case"exponent":return"pow"===e;case"base":return"log"===e;case"constant":return"symlog"===e;case"zero":return wJ(e)&&!vH(["log","time","utc","threshold","quantile"],e)}}function PJ(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return BG(e)?void 0:`Cannot use the scale property "${t}" with non-color channel.`;case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"domainRaw":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}const FJ={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},TJ=FJ.arc,zJ=FJ.area,RJ=FJ.bar,LJ=FJ.image,BJ=FJ.line,IJ=FJ.point,UJ=FJ.rect,qJ=FJ.rule,WJ=FJ.text,ZJ=FJ.tick,HJ=FJ.trail,GJ=FJ.circle,VJ=FJ.square,YJ=FJ.geoshape;function XJ(e){return["line","area","trail"].includes(e)}function JJ(e){return["rect","bar","image","arc"].includes(e)}const QJ=new Set(SH(FJ));function KJ(e){return e.type}const eQ=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit","fill","fillOpacity"],tQ=SH({color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1}),nQ=SH({mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1});function rQ(e){return e&&null!=e.band}const iQ={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},oQ={binSpacing:1,continuousBandSize:5,minBandSize:.25,timeUnitBandPosition:.5},aQ={binSpacing:0,continuousBandSize:5,minBandSize:.25,timeUnitBandPosition:.5};function sQ(e){const{channel:t,channelDef:n,markDef:r,scale:i,config:o}=e,a=dQ(e);return WQ(n)&&!iY(n.aggregate)&&i&&kJ(i.get("type"))?function(e){let{fieldDef:t,channel:n,markDef:r,ref:i,config:o}=e;if(XJ(r.type))return i;const a=CY("invalid",r,o);if(null===a)return[lQ(t,n),i];return i}({fieldDef:n,channel:t,markDef:r,ref:a,config:o}):a}function lQ(e,t){return{test:uQ(e,!0),..."y"===nV(t)?{field:{group:"height"}}:{value:0}}}function uQ(e,t){return void 0===t&&(t=!0),eJ(cs(e)?e:iK(e,{expr:"datum"}),!t)}function cQ(e,t,n,r){const i={};if(t&&(i.scale=t),HQ(e)){const{datum:t}=e;kX(t)?i.signal=NX(t):yY(t)?i.signal=t.signal:hY(t)?i.signal=t.expr:i.value=t}else i.field=iK(e,n);if(r){const{offset:e,band:t}=r;e&&(i.offset=e),t&&(i.band=t)}return i}function fQ(e){let{scaleName:t,fieldOrDatumDef:n,fieldOrDatumDef2:r,offset:i,startSuffix:o,bandPosition:a=.5}=e;const s=0<a&&a<1?"datum":void 0,l=iK(n,{expr:s,suffix:o}),u=void 0!==r?iK(r,{expr:s}):iK(n,{suffix:"end",expr:s}),c={};if(0===a||1===a){c.scale=t;const e=0===a?l:u;c.field=e}else{const e=yY(a)?`${a.signal} * ${l} + (1-${a.signal}) * ${u}`:`${a} * ${l} + ${1-a} * ${u}`;c.signal=`scale("${t}", ${e})`}return i&&(c.offset=i),c}function dQ(e){let{channel:t,channelDef:n,channel2Def:r,markDef:i,config:o,scaleName:a,scale:s,stack:l,offset:u,defaultRef:c,bandPosition:f}=e;if(n){if(XQ(n)){const e=s?.get("type");if(JQ(n)){f??(f=zQ({fieldDef:n,fieldDef2:r,markDef:i,config:o}));const{bin:s,timeUnit:c,type:d}=n;if(lY(s)||f&&c&&d===aJ)return l?.impute?cQ(n,a,{binSuffix:"mid"},{offset:u}):f&&!xJ(e)?fQ({scaleName:a,fieldOrDatumDef:n,bandPosition:f,offset:u}):cQ(n,a,_K(n,t)?{binSuffix:"range"}:{},{offset:u});if(uY(s)){if(WQ(r))return fQ({scaleName:a,fieldOrDatumDef:n,fieldOrDatumDef2:r,bandPosition:f,offset:u});wX(vX(t===eG?nG:rG))}}return cQ(n,a,xJ(e)?{binSuffix:"range"}:{},{offset:u,band:"band"===e?f??n.bandPosition??.5:void 0})}if(QQ(n)){const e=u?{offset:u}:{};return{...hQ(t,n.value),...e}}}return Ba(c)&&(c=c()),c?{...c,...u?{offset:u}:{}}:c}function hQ(e,t){return vH(["x","x2"],e)&&"width"===t?{field:{group:"width"}}:vH(["y","y2"],e)&&"height"===t?{field:{group:"height"}}:DY(t)}function pQ(e){return e&&"number"!==e&&"time"!==e}function mQ(e,t,n){return`${e}(${t}${n?`, ${mH(n)}`:""})`}const gQ=" \u2013 ";function yQ(e){let{fieldOrDatumDef:t,format:n,formatType:r,expr:i,normalizeStack:o,config:a}=e;if(pQ(r))return bQ({fieldOrDatumDef:t,format:n,formatType:r,expr:i,config:a});const s=vQ(t,i,o),l=ZQ(t);if(void 0===n&&void 0===r&&a.customFormatTypes){if("quantitative"===l){if(o&&a.normalizedNumberFormatType)return bQ({fieldOrDatumDef:t,format:a.normalizedNumberFormat,formatType:a.normalizedNumberFormatType,expr:i,config:a});if(a.numberFormatType)return bQ({fieldOrDatumDef:t,format:a.numberFormat,formatType:a.numberFormatType,expr:i,config:a})}if("temporal"===l&&a.timeFormatType&&WQ(t)&&void 0===t.timeUnit)return bQ({fieldOrDatumDef:t,format:a.timeFormat,formatType:a.timeFormatType,expr:i,config:a})}if(xK(t)){const e=function(e){let{field:t,timeUnit:n,format:r,formatType:i,rawTimeFormat:o,isUTCScale:a}=e;return!n||r?!n&&i?`${i}(${t}, '${r}')`:(r=cs(r)?r:o,`${a?"utc":"time"}Format(${t}, '${r}')`):function(e,t,n){if(!e)return;const r=LX(e);return`${n||MX(e)?"utc":"time"}Format(${t}, ${r})`}(n,t,a)}({field:s,timeUnit:WQ(t)?BX(t.timeUnit)?.unit:void 0,format:n,formatType:a.timeFormatType,rawTimeFormat:a.timeFormat,isUTCScale:KQ(t)&&t.scale?.type===uJ.UTC});return e?{signal:e}:void 0}if(n=kQ({type:l,specifiedFormat:n,config:a,normalizeStack:o}),WQ(t)&&lY(t.bin)){return{signal:EQ(s,iK(t,{expr:i,binSuffix:"end"}),n,r,a)}}return n||"quantitative"===ZQ(t)?{signal:`${_Q(s,n)}`}:{signal:`isValid(${s}) ? ${s} : ""+${s}`}}function vQ(e,t,n){return WQ(e)?n?`${iK(e,{expr:t,suffix:"end"})}-${iK(e,{expr:t,suffix:"start"})}`:iK(e,{expr:t}):function(e){const{datum:t}=e;return kX(t)?NX(t):`${mH(t)}`}(e)}function bQ(e){let{fieldOrDatumDef:t,format:n,formatType:r,expr:i,normalizeStack:o,config:a,field:s}=e;if(s??(s=vQ(t,i,o)),"datum.value"!==s&&WQ(t)&&lY(t.bin)){return{signal:EQ(s,iK(t,{expr:i,binSuffix:"end"}),n,r,a)}}return{signal:mQ(r,s,n)}}function xQ(e,t,n,r,i,o){if(!cs(r)||!pQ(r)){if(void 0===n&&void 0===r&&i.customFormatTypes&&"quantitative"===ZQ(e)){if(i.normalizedNumberFormatType&&eK(e)&&"normalize"===e.stack)return;if(i.numberFormatType)return}if(eK(e)&&"normalize"===e.stack&&i.normalizedNumberFormat)return kQ({type:"quantitative",config:i,normalizeStack:!0});if(xK(e)){const t=WQ(e)?BX(e.timeUnit)?.unit:void 0;if(void 0===t&&i.customFormatTypes&&i.timeFormatType)return;return function(e){let{specifiedFormat:t,timeUnit:n,config:r,omitTimeFormatConfig:i}=e;if(t)return t;if(n)return{signal:LX(n)};return i?void 0:r.timeFormat}({specifiedFormat:n,timeUnit:t,config:i,omitTimeFormatConfig:o})}return kQ({type:t,specifiedFormat:n,config:i})}}function wQ(e,t,n){return e&&(yY(e)||"number"===e||"time"===e)?e:xK(t)&&"time"!==n&&"utc"!==n?WQ(t)&&BX(t?.timeUnit)?.utc?"utc":"time":void 0}function kQ(e){let{type:t,specifiedFormat:n,config:r,normalizeStack:i}=e;return cs(n)?n:t===iJ?i?r.normalizedNumberFormat:r.numberFormat:void 0}function _Q(e,t){return`format(${e}, "${t||""}")`}function OQ(e,t,n,r){return pQ(n)?mQ(n,e,t):_Q(e,(cs(t)?t:void 0)??r.numberFormat)}function EQ(e,t,n,r,i){if(void 0===n&&void 0===r&&i.customFormatTypes&&i.numberFormatType)return EQ(e,t,i.numberFormat,i.numberFormatType,i);const o=OQ(e,n,r,i),a=OQ(t,n,r,i);return`${eJ(e,!1)} ? "null" : ${o} + "${gQ}" + ${a}`}const DQ="min",jQ={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function NQ(e){return e in jQ}function SQ(e){return!!e?.encoding}function AQ(e){return e&&("count"===e.op||!!e.field)}function $Q(e){return e&&ha(e)}function CQ(e){return"row"in e||"column"in e}function MQ(e){return!!e&&"header"in e}function PQ(e){return"facet"in e}function FQ(e){const{field:t,timeUnit:n,bin:r,aggregate:i}=e;return{...n?{timeUnit:n}:{},...r?{bin:r}:{},...i?{aggregate:i}:{},field:t}}function TQ(e){return"sort"in e}function zQ(e){let{fieldDef:t,fieldDef2:n,markDef:r,config:i}=e;if(XQ(t)&&void 0!==t.bandPosition)return t.bandPosition;if(WQ(t)){const{timeUnit:e,bin:o}=t;if(e&&!n)return JJ(r.type)?0:MY("timeUnitBandPosition",r,i);if(lY(o))return.5}}function RQ(e){let{channel:t,fieldDef:n,fieldDef2:r,markDef:i,config:o,scaleType:a,useVlSizeChannel:s}=e;const l=oV(t),u=CY(s?"size":l,i,o,{vgChannel:l});if(void 0!==u)return u;if(WQ(n)){const{timeUnit:e,bin:t}=n;if(e&&!r)return{band:MY("timeUnitBandSize",i,o)};if(lY(t)&&!xJ(a))return{band:1}}return JJ(i.type)?a?xJ(a)?o[i.type]?.discreteBandSize||{band:1}:o[i.type]?.continuousBandSize:o[i.type]?.discreteBandSize:void 0}function LQ(e,t,n,r){return!!(lY(e.bin)||e.timeUnit&&JQ(e)&&"temporal"===e.type)&&void 0!==zQ({fieldDef:e,fieldDef2:t,markDef:n,config:r})}function BQ(e){return e&&!!e.sort&&!e.field}function IQ(e){return e&&"condition"in e}function UQ(e){const t=e?.condition;return!!t&&!ha(t)&&WQ(t)}function qQ(e){const t=e?.condition;return!!t&&!ha(t)&&XQ(t)}function WQ(e){return e&&(!!e.field||"count"===e.aggregate)}function ZQ(e){return e?.type}function HQ(e){return e&&"datum"in e}function GQ(e){return JQ(e)&&!oK(e)||YQ(e)}function VQ(e){return JQ(e)&&"quantitative"===e.type&&!e.bin||YQ(e)}function YQ(e){return HQ(e)&&ls(e.datum)}function XQ(e){return WQ(e)||HQ(e)}function JQ(e){return e&&("field"in e||"count"===e.aggregate)&&"type"in e}function QQ(e){return e&&"value"in e&&"value"in e}function KQ(e){return e&&("scale"in e||"sort"in e)}function eK(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function tK(e){return e&&"legend"in e}function nK(e){return e&&("format"in e||"formatType"in e)}function rK(e){return pH(e,["legend","axis","header","scale"])}function iK(e,t){void 0===t&&(t={});let n=e.field;const r=t.prefix;let i=t.suffix,o="";if(function(e){return"count"===e.aggregate}(e))n=GH("count");else{let r;if(!t.nofn)if(function(e){return"op"in e}(e))r=e.op;else{const{bin:a,aggregate:s,timeUnit:l}=e;lY(a)?(r=sY(a),i=(t.binSuffix??"")+(t.suffix??"")):s?tY(s)?(o=`["${n}"]`,n=`argmax_${s.argmax}`):eY(s)?(o=`["${n}"]`,n=`argmin_${s.argmin}`):r=String(s):l&&!$X(l)&&(r=function(e){const{utc:t,...n}=BX(e);return n.unit?(t?"utc":"")+SH(n).map((e=>MH(`${"unit"===e?"":`_${e}_`}${n[e]}`))).join(""):(t?"utc":"")+"timeunit"+SH(n).map((e=>MH(`_${e}_${n[e]}`))).join("")}(l),i=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+(t.suffix??""))}r&&(n=n?`${r}_${n}`:r)}return i&&(n=`${n}_${i}`),r&&(n=`${r}_${n}`),t.forAs?UH(n):t.expr?RH(n,t.expr)+o:BH(n)+o}function oK(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return WQ(e)&&!!e.bin;case"temporal":return!1}throw new Error(nX(e.type))}const aK=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return function(e){const{aggregate:t,bin:n,timeUnit:r,field:i}=e;if(tY(t))return`${i} for argmax(${t.argmax})`;if(eY(t))return`${i} for argmin(${t.argmin})`;const o=r&&!$X(r)?BX(r):void 0,a=t||o?.unit||o?.maxbins&&"timeunit"||lY(n)&&"bin";return a?`${a.toUpperCase()}(${i})`:i}(e);default:return function(e,t){const{field:n,bin:r,timeUnit:i,aggregate:o}=e;if("count"===o)return t.countTitle;if(lY(r))return`${n} (binned)`;if(i&&!$X(i)){const e=BX(i)?.unit;if(e)return`${n} (${FX(e).join("-")})`}else if(o)return tY(o)?`${n} for max ${o.argmax}`:eY(o)?`${n} for min ${o.argmin}`:`${TH(o)} of ${n}`;return n}(e,t)}};let sK=aK;function lK(e){sK=e}function uK(e,t,n){let{allowDisabling:r,includeDefault:i=!0}=n;const o=cK(e)?.title;if(!WQ(e))return o??e.title;const a=e,s=i?fK(a,t):void 0;return r?WH(o,a.title,s):o??a.title??s}function cK(e){return eK(e)&&e.axis?e.axis:tK(e)&&e.legend?e.legend:MQ(e)&&e.header?e.header:void 0}function fK(e,t){return sK(e,t)}function dK(e){if(nK(e)){const{format:t,formatType:n}=e;return{format:t,formatType:n}}{const t=cK(e)??{},{format:n,formatType:r}=t;return{format:n,formatType:r}}}function hK(e){return WQ(e)?e:UQ(e)?e.condition:void 0}function pK(e){return XQ(e)?e:qQ(e)?e.condition:void 0}function mK(e,t,n,r){if(void 0===r&&(r={}),cs(e)||ls(e)||os(e)){return wX(function(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${mH(n)}}.`}(t,cs(e)?"string":ls(e)?"number":"boolean",e)),{value:e}}return XQ(e)?gK(e,t,n,r):qQ(e)?{...e,condition:gK(e.condition,t,n,r)}:e}function gK(e,t,n,r){if(nK(e)){const{format:i,formatType:o,...a}=e;if(pQ(o)&&!n.customFormatTypes)return wX(KY(t)),gK(a,t,n,r)}else{const i=eK(e)?"axis":tK(e)?"legend":MQ(e)?"header":null;if(i&&e[i]){const{format:o,formatType:a,...s}=e[i];if(pQ(a)&&!n.customFormatTypes)return wX(KY(t)),gK({...e,[i]:s},t,n,r)}}return WQ(e)?yK(e,t,r):function(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=ls(n)?"quantitative":cs(n)?"nominal":kX(n)?"temporal":void 0,{...e,type:t}}(e)}function yK(e,t,n){let{compositeMark:r=!1}=void 0===n?{}:n;const{aggregate:i,timeUnit:o,bin:a,field:s}=e,l={...e};if(r||!i||nY(i)||tY(i)||eY(i)||(wX(function(e){return`Invalid aggregation operator "${e}".`}(i)),delete l.aggregate),o&&(l.timeUnit=BX(o)),s&&(l.field=`${s}`),lY(a)&&(l.bin=vK(a,t)),uY(a)&&!NV(t)&&wX(function(e){return`Channel ${e} should not be used with "binned" bin.`}(t)),JQ(l)){const{type:e}=l,t=function(e){if(e)switch(e=e.toLowerCase()){case"q":case iJ:return"quantitative";case"t":case aJ:return"temporal";case"o":case oJ:return"ordinal";case"n":case sJ:return"nominal";case lJ:return"geojson"}}(e);e!==t&&(l.type=t),"quantitative"!==e&&iY(i)&&(wX(function(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}(e,i)),l.type="quantitative")}else if(!tV(t)){const e=function(e,t){switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(TQ(e)&&ha(e.sort))return"ordinal";const{aggregate:n,bin:r,timeUnit:i}=e;if(i)return"temporal";if(r||n&&!tY(n)&&!eY(n))return"quantitative";if(KQ(e)&&e.scale?.type)switch(cJ[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}(l,t);l.type=e}if(JQ(l)){const{compatible:e,warning:n}=function(e,t){const n=e.type;if("geojson"===n&&"shape"!==t)return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case JH:case QH:case KH:return oK(e)?bK:{compatible:!1,warning:sX(t)};case eG:case tG:case iG:case oG:case pG:case mG:case gG:case EG:case jG:case NG:case SG:case AG:case $G:case bG:case lG:case aG:case CG:return bK;case fG:case hG:case cG:case dG:return n!==iJ?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:bK;case xG:case wG:case kG:case _G:case vG:case uG:case sG:case nG:case rG:return"nominal"!==n||e.sort?bK:{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`};case yG:case OG:return oK(e)||function(e){return KQ(e)&&_J(e.scale?.type)}(e)?bK:{compatible:!1,warning:lX(t)};case DG:return"nominal"!==e.type||"sort"in e?bK:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}(l,t)||{};!1===e&&wX(n)}if(TQ(l)&&cs(l.sort)){const{sort:e}=l;if(NQ(e))return{...l,sort:{encoding:e}};const t=e.substr(1);if("-"===e.charAt(0)&&NQ(t))return{...l,sort:{encoding:t,order:"descending"}}}if(MQ(l)){const{header:e}=l;if(e){const{orient:t,...n}=e;if(t)return{...l,header:{...n,labelOrient:e.labelOrient||t,titleOrient:e.titleOrient||t}}}}return l}function vK(e,t){return os(e)?{maxbins:dY(t)}:"binned"===e?{binned:!0}:e.maxbins||e.step?e:{...e,maxbins:dY(t)}}const bK={compatible:!0};function xK(e){const{formatType:t}=dK(e);return"time"===t||!t&&function(e){return e&&("temporal"===e.type||WQ(e)&&!!e.timeUnit)}(e)}function wK(e,t){let{timeUnit:n,type:r,wrapTime:i,undefinedIfExprNotRequired:o}=t;const a=n&&BX(n)?.unit;let s,l=a||"temporal"===r;return hY(e)?s=e.expr:yY(e)?s=e.signal:kX(e)?(l=!0,s=NX(e)):(cs(e)||ls(e))&&l&&(s=`datetime(${mH(e)})`,function(e){return!!SX[e]}(a)&&(ls(e)&&e<1e4||cs(e)&&isNaN(Date.parse(e)))&&(s=NX({[a]:e}))),s?i&&l?`time(${s})`:s:o?void 0:mH(e)}function kK(e,t){const{type:n}=e;return t.map((t=>{const r=wK(t,{timeUnit:WQ(e)&&!$X(e.timeUnit)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return void 0!==r?{signal:r}:t}))}function _K(e,t){return lY(e.bin)?HV(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const OK={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function EK(e){return e?.condition}const DK=["domain","grid","labels","ticks","title"],jK={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},NK={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},SK={...NK,style:1,labelExpr:1,encoding:1};function AK(e){return!!SK[e]}const $K=SH({axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1});function CK(e){return"mark"in e}class MK{constructor(e,t){this.name=e,this.run=t}hasMatchingType(e){return!!CK(e)&&function(e){return KJ(e)?e.type:e}(e.mark)===this.name}}function PK(e,t){const n=e&&e[t];return!!n&&(ha(n)?bH(n,(e=>!!e.field)):WQ(n)||UQ(n))}function FK(e,t){const n=e&&e[t];return!!n&&(ha(n)?bH(n,(e=>!!e.field)):WQ(n)||HQ(n)||qQ(n))}function TK(e,t){if(NV(t)){const n=e[t];if((WQ(n)||HQ(n))&&(rJ(n.type)||WQ(n)&&n.timeUnit)){return FK(e,sV(t))}}return!1}function zK(e){return bH(WG,(t=>{if(PK(e,t)){const n=e[t];if(ha(n))return bH(n,(e=>!!e.aggregate));{const e=hK(n);return e&&!!e.aggregate}}return!1}))}function RK(e,t){const n=[],r=[],i=[],o=[],a={};return IK(e,((s,l)=>{if(WQ(s)){const{field:u,aggregate:c,bin:f,timeUnit:d,...h}=s;if(c||d||f){const e=cK(s),p=e?.title;let m=iK(s,{forAs:!0});const g={...p?[]:{title:uK(s,t,{allowDisabling:!0})},...h,field:m};if(c){let e;if(tY(c)?(e="argmax",m=iK({op:"argmax",field:c.argmax},{forAs:!0}),g.field=`${m}.${u}`):eY(c)?(e="argmin",m=iK({op:"argmin",field:c.argmin},{forAs:!0}),g.field=`${m}.${u}`):"boxplot"!==c&&"errorbar"!==c&&"errorband"!==c&&(e=c),e){const t={op:e,as:m};u&&(t.field=u),o.push(t)}}else if(n.push(m),JQ(s)&&lY(f)){if(r.push({bin:f,field:u,as:m}),n.push(iK(s,{binSuffix:"end"})),_K(s,l)&&n.push(iK(s,{binSuffix:"range"})),NV(l)){const e={field:`${m}_end`};a[`${l}2`]=e}g.bin="binned",tV(l)||(g.type=iJ)}else if(d&&!$X(d)){i.push({timeUnit:d,field:u,as:m});const e=JQ(s)&&s.type!==aJ&&"time";e&&(l===EG||l===SG?g.formatType=e:!function(e){return!!OV[e]}(l)?NV(l)&&(g.axis={formatType:e,...g.axis}):g.legend={formatType:e,...g.legend})}a[l]=g}else n.push(u),a[l]=e[l]}else a[l]=e[l]})),{bins:r,timeUnits:i,aggregate:o,groupby:n,encoding:a}}function LK(e,t,n){const r=GV(t,n);if(!r)return!1;if("binned"===r){const n=e[t===nG?eG:tG];return!!(WQ(n)&&WQ(e[t])&&uY(n.bin))}return!0}function BK(e,t){const n={};for(const r of SH(e)){const i=mK(e[r],r,t,{compositeMark:!0});n[r]=i}return n}function IK(e,t,n){if(e)for(const r of SH(e)){const i=e[r];if(ha(i))for(const e of i)t.call(n,e,r);else t.call(n,i,r)}}function UK(e,t){return SH(t).reduce(((n,r)=>{switch(r){case eG:case tG:case AG:case CG:case $G:case nG:case rG:case iG:case oG:case lG:case uG:case aG:case sG:case cG:case fG:case dG:case hG:case EG:case yG:case bG:case SG:return n;case DG:if("line"===e||"trail"===e)return n;case jG:case NG:{const e=t[r];if(ha(e)||WQ(e))for(const t of Ra(e))t.aggregate||n.push(iK(t,{}));return n}case vG:if("trail"===e)return n;case pG:case mG:case gG:case xG:case wG:case kG:case OG:case _G:{const e=hK(t[r]);return e&&!e.aggregate&&n.push(iK(e,{})),n}}}),[])}function qK(e,t,n,r){if(void 0===r&&(r=!0),"tooltip"in n)return{tooltip:n.tooltip};const i=e.map((e=>{let{fieldPrefix:n,titlePrefix:i}=e;const o=r?` of ${WK(t)}`:"";return{field:n+t.field,type:t.type,title:yY(i)?{signal:`${i}"${escape(o)}"`}:i+o}})),o=function(e){const t=[];for(const n of SH(e))if(PK(e,n)){const r=Ra(e[n]);for(const e of r)WQ(e)?t.push(e):UQ(e)&&t.push(e.condition)}return t}(n).map(rK);return{tooltip:[...i,..._H(o,gH)]}}function WK(e){const{title:t,field:n}=e;return WH(t,n)}function ZK(e,t,n,r,i){const{scale:o,axis:a}=n;return s=>{let{partName:l,mark:u,positionPrefix:c,endPositionPrefix:f,extraEncoding:d={}}=s;const h=WK(n);return HK(e,l,i,{mark:u,encoding:{[t]:{field:`${c}_${n.field}`,type:n.type,...void 0!==h?{title:h}:{},...void 0!==o?{scale:o}:{},...void 0!==a?{axis:a}:{}},...cs(f)?{[`${t}2`]:{field:`${f}_${n.field}`}}:{},...r,...d}})}}function HK(e,t,n,r){const{clip:i,color:o,opacity:a}=e,s=e.type;return e[t]||void 0===e[t]&&n[t]?[{...r,mark:{...n[t],...i?{clip:i}:{},...o?{color:o}:{},...a?{opacity:a}:{},...KJ(r.mark)?r.mark:{type:r.mark},style:`${s}-${String(t)}`,...os(e[t])?{}:e[t]}}]:[]}function GK(e,t,n){const{encoding:r}=e,i="vertical"===t?"y":"x",o=r[i],a=r[`${i}2`],s=r[`${i}Error`],l=r[`${i}Error2`];return{continuousAxisChannelDef:VK(o,n),continuousAxisChannelDef2:VK(a,n),continuousAxisChannelDefError:VK(s,n),continuousAxisChannelDefError2:VK(l,n),continuousAxis:i}}function VK(e,t){if(e?.aggregate){const{aggregate:n,...r}=e;return n!==t&&wX(function(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}(n,t)),r}return e}function YK(e,t){const{mark:n,encoding:r}=e,{x:i,y:o}=r;if(KJ(n)&&n.orient)return n.orient;if(GQ(i)){if(GQ(o)){const e=WQ(i)&&i.aggregate,n=WQ(o)&&o.aggregate;if(e||n!==t){if(n||e!==t){if(e===t&&n===t)throw new Error("Both x and y cannot have aggregate");return xK(o)&&!xK(i)?"horizontal":"vertical"}return"horizontal"}return"vertical"}return"horizontal"}if(GQ(o))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}const XK="boxplot",JK=new MK(XK,KK);function QK(e){return ls(e)?"tukey":e}function KK(e,t){let{config:n}=t;e={...e,encoding:BK(e.encoding,n)};const{mark:r,encoding:i,params:o,projection:a,...s}=e,l=KJ(r)?r:{type:r};o&&wX(VY("boxplot"));const u=l.extent??n.boxplot.extent,c=CY("size",l,n),f=l.invalid,d=QK(u),{bins:h,timeUnits:p,transform:m,continuousAxisChannelDef:g,continuousAxis:y,groupby:v,aggregate:b,encodingWithoutContinuousAxis:x,ticksOrient:w,boxOrient:k,customTooltipWithoutAggregatedField:_}=function(e,t,n){const r=YK(e,XK),{continuousAxisChannelDef:i,continuousAxis:o}=GK(e,r,XK),a=i.field,s=QK(t),l=[...e0(a),{op:"median",field:a,as:`mid_box_${a}`},{op:"min",field:a,as:("min-max"===s?"lower_whisker_":"min_")+a},{op:"max",field:a,as:("min-max"===s?"upper_whisker_":"max_")+a}],u="min-max"===s||"tukey"===s?[]:[{calculate:`datum["upper_box_${a}"] - datum["lower_box_${a}"]`,as:`iqr_${a}`},{calculate:`min(datum["upper_box_${a}"] + datum["iqr_${a}"] * ${t}, datum["max_${a}"])`,as:`upper_whisker_${a}`},{calculate:`max(datum["lower_box_${a}"] - datum["iqr_${a}"] * ${t}, datum["min_${a}"])`,as:`lower_whisker_${a}`}],{[o]:c,...f}=e.encoding,{customTooltipWithoutAggregatedField:d,filteredEncoding:h}=function(e){const{tooltip:t,...n}=e;if(!t)return{filteredEncoding:n};let r,i;if(ha(t)){for(const e of t)e.aggregate?(r||(r=[]),r.push(e)):(i||(i=[]),i.push(e));r&&(n.tooltip=r)}else t.aggregate?n.tooltip=t:i=t;return ha(i)&&1===i.length&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}(f),{bins:p,timeUnits:m,aggregate:g,groupby:y,encoding:v}=RK(h,n),b="vertical"===r?"horizontal":"vertical",x=r,w=[...p,...m,{aggregate:[...g,...l],groupby:y},...u];return{bins:p,timeUnits:m,transform:w,groupby:y,aggregate:g,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:v,ticksOrient:b,boxOrient:x,customTooltipWithoutAggregatedField:d}}(e,u,n),{color:O,size:E,...D}=x,j=e=>ZK(l,y,g,e,n.boxplot),N=j(D),S=j(x),A=j({...D,...E?{size:E}:{}}),$=qK([{fieldPrefix:"min-max"===d?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===d?"lower_whisker_":"min_",titlePrefix:"Min"}],g,x),C={type:"tick",color:"black",opacity:1,orient:w,invalid:f,aria:!1},M="min-max"===d?$:qK([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],g,x),P=[...N({partName:"rule",mark:{type:"rule",invalid:f,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:M}),...N({partName:"rule",mark:{type:"rule",invalid:f,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:M}),...N({partName:"ticks",mark:C,positionPrefix:"lower_whisker",extraEncoding:M}),...N({partName:"ticks",mark:C,positionPrefix:"upper_whisker",extraEncoding:M})],F=[..."tukey"!==d?P:[],...S({partName:"box",mark:{type:"bar",...c?{size:c}:{},orient:k,invalid:f,ariaRoleDescription:"box"},positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:$}),...A({partName:"median",mark:{type:"tick",invalid:f,...pa(n.boxplot.median)&&n.boxplot.median.color?{color:n.boxplot.median.color}:{},...c?{size:c}:{},orient:w,aria:!1},positionPrefix:"mid_box",extraEncoding:$})];if("min-max"===d)return{...s,transform:(s.transform??[]).concat(m),layer:F};const T=`datum["lower_box_${g.field}"]`,z=`datum["upper_box_${g.field}"]`,R=`(${z} - ${T})`,L=`${T} - ${u} * ${R}`,B=`${z} + ${u} * ${R}`,I=`datum["${g.field}"]`,U={joinaggregate:e0(g.field),groupby:v},q={transform:[{filter:`(${L} <= ${I}) && (${I} <= ${B})`},{aggregate:[{op:"min",field:g.field,as:`lower_whisker_${g.field}`},{op:"max",field:g.field,as:`upper_whisker_${g.field}`},{op:"min",field:`lower_box_${g.field}`,as:`lower_box_${g.field}`},{op:"max",field:`upper_box_${g.field}`,as:`upper_box_${g.field}`},...b],groupby:v}],layer:P},{tooltip:W,...Z}=D,{scale:H,axis:G}=g,V=WK(g),Y=pH(G,["title"]),X=HK(l,"outliers",n.boxplot,{transform:[{filter:`(${I} < ${L}) || (${I} > ${B})`}],mark:"point",encoding:{[y]:{field:g.field,type:g.type,...void 0!==V?{title:V}:{},...void 0!==H?{scale:H}:{},...NH(Y)?{}:{axis:Y}},...Z,...O?{color:O}:{},..._?{tooltip:_}:{}}})[0];let J;const Q=[...h,...p,U];return X?J={transform:Q,layer:[X,q]}:(J=q,J.transform.unshift(...Q)),{...s,layer:[J,{transform:m,layer:F}]}}function e0(e){return[{op:"q1",field:e,as:`lower_box_${e}`},{op:"q3",field:e,as:`upper_box_${e}`}]}const t0="errorbar",n0=new MK(t0,r0);function r0(e,t){let{config:n}=t;e={...e,encoding:BK(e.encoding,n)};const{transform:r,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:a,ticksOrient:s,markDef:l,outerSpec:u,tooltipEncoding:c}=o0(e,t0,n);delete a.size;const f=ZK(l,o,i,a,n.errorbar),d=l.thickness,h=l.size,p={type:"tick",orient:s,aria:!1,...void 0!==d?{thickness:d}:{},...void 0!==h?{size:h}:{}},m=[...f({partName:"ticks",mark:p,positionPrefix:"lower",extraEncoding:c}),...f({partName:"ticks",mark:p,positionPrefix:"upper",extraEncoding:c}),...f({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar",...void 0!==d?{size:d}:{}},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:c})];return{...u,transform:r,...m.length>1?{layer:m}:{...m[0]}}}function i0(e,t){const{encoding:n}=e;if(function(e){return(XQ(e.x)||XQ(e.y))&&!XQ(e.x2)&&!XQ(e.y2)&&!XQ(e.xError)&&!XQ(e.xError2)&&!XQ(e.yError)&&!XQ(e.yError2)}(n))return{orient:YK(e,t),inputType:"raw"};const r=function(e){return XQ(e.x2)||XQ(e.y2)}(n),i=function(e){return XQ(e.xError)||XQ(e.xError2)||XQ(e.yError)||XQ(e.yError2)}(n),o=n.x,a=n.y;if(r){if(i)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const e=n.x2,r=n.y2;if(XQ(e)&&XQ(r))throw new Error(`${t} cannot have both x2 and y2`);if(XQ(e)){if(GQ(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}if(XQ(r)){if(GQ(a))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}{const e=n.xError,r=n.xError2,i=n.yError,s=n.yError2;if(XQ(r)&&!XQ(e))throw new Error(`${t} cannot have xError2 without xError`);if(XQ(s)&&!XQ(i))throw new Error(`${t} cannot have yError2 without yError`);if(XQ(e)&&XQ(i))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(XQ(e)){if(GQ(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(XQ(i)){if(GQ(a))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function o0(e,t,n){const{mark:r,encoding:i,params:o,projection:a,...s}=e,l=KJ(r)?r:{type:r};o&&wX(VY(t));const{orient:u,inputType:c}=i0(e,t),{continuousAxisChannelDef:f,continuousAxisChannelDef2:d,continuousAxisChannelDefError:h,continuousAxisChannelDefError2:p,continuousAxis:m}=GK(e,u,t),{errorBarSpecificAggregate:g,postAggregateCalculates:y,tooltipSummary:v,tooltipTitleWithFieldName:b}=function(e,t,n,r,i,o,a,s){let l=[],u=[];const c=t.field;let f,d=!1;if("raw"===o){const t=e.center?e.center:e.extent?"iqr"===e.extent?"median":"mean":s.errorbar.center,n=e.extent?e.extent:"mean"===t?"stderr":"iqr";if("median"===t!=("iqr"===n)&&wX(function(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}(t,n,a)),"stderr"===n||"stdev"===n)l=[{op:n,field:c,as:`extent_${c}`},{op:t,field:c,as:`center_${c}`}],u=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:`upper_${c}`},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:`lower_${c}`}],f=[{fieldPrefix:"center_",titlePrefix:TH(t)},{fieldPrefix:"upper_",titlePrefix:a0(t,n,"+")},{fieldPrefix:"lower_",titlePrefix:a0(t,n,"-")}],d=!0;else{let e,t,r;"ci"===n?(e="mean",t="ci0",r="ci1"):(e="median",t="q1",r="q3"),l=[{op:t,field:c,as:`lower_${c}`},{op:r,field:c,as:`upper_${c}`},{op:e,field:c,as:`center_${c}`}],f=[{fieldPrefix:"upper_",titlePrefix:uK({field:c,aggregate:r,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:uK({field:c,aggregate:t,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:uK({field:c,aggregate:e,type:"quantitative"},s,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&wX(function(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}(e.center,e.extent)),"aggregated-upper-lower"===o?(f=[],u=[{calculate:`datum["${n.field}"]`,as:`upper_${c}`},{calculate:`datum["${c}"]`,as:`lower_${c}`}]):"aggregated-error"===o&&(f=[{fieldPrefix:"",titlePrefix:c}],u=[{calculate:`datum["${c}"] + datum["${r.field}"]`,as:`upper_${c}`}],i?u.push({calculate:`datum["${c}"] + datum["${i.field}"]`,as:`lower_${c}`}):u.push({calculate:`datum["${c}"] - datum["${r.field}"]`,as:`lower_${c}`}));for(const e of u)f.push({fieldPrefix:e.as.substring(0,6),titlePrefix:IH(IH(e.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:u,errorBarSpecificAggregate:l,tooltipSummary:f,tooltipTitleWithFieldName:d}}(l,f,d,h,p,c,t,n),{[m]:x,["x"===m?"x2":"y2"]:w,["x"===m?"xError":"yError"]:k,["x"===m?"xError2":"yError2"]:_,...O}=i,{bins:E,timeUnits:D,aggregate:j,groupby:N,encoding:S}=RK(O,n),A=[...j,...g],$="raw"!==c?[]:N,C=qK(v,f,S,b);return{transform:[...s.transform??[],...E,...D,...0===A.length?[]:[{aggregate:A,groupby:$}],...y],groupby:$,continuousAxisChannelDef:f,continuousAxis:m,encodingWithoutContinuousAxis:S,ticksOrient:"vertical"===u?"horizontal":"vertical",markDef:l,outerSpec:s,tooltipEncoding:C}}function a0(e,t,n){return`${TH(e)} ${n} ${t}`}const s0="errorband",l0=new MK(s0,u0);function u0(e,t){let{config:n}=t;e={...e,encoding:BK(e.encoding,n)};const{transform:r,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:a,markDef:s,outerSpec:l,tooltipEncoding:u}=o0(e,s0,n),c=s,f=ZK(c,o,i,a,n.errorband),d=void 0!==e.encoding.x&&void 0!==e.encoding.y;let h={type:d?"area":"rect"},p={type:d?"line":"rule"};const m={...c.interpolate?{interpolate:c.interpolate}:{},...c.tension&&c.interpolate?{tension:c.tension}:{}};return d?(h={...h,...m,ariaRoleDescription:"errorband"},p={...p,...m,aria:!1}):c.interpolate?wX(yX("interpolate")):c.tension&&wX(yX("tension")),{...l,transform:r,layer:[...f({partName:"band",mark:h,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...f({partName:"borders",mark:p,positionPrefix:"lower",extraEncoding:u}),...f({partName:"borders",mark:p,positionPrefix:"upper",extraEncoding:u})]}}const c0={};function f0(e,t,n){const r=new MK(e,t);c0[e]={normalizer:r,parts:n}}f0(XK,KK,["box","median","outliers","rule","ticks"]),f0(t0,r0,["ticks","rule"]),f0(s0,u0,["band","borders"]);const d0=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],h0={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},p0={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},m0=SH(h0),g0=SH(p0),y0=SH({header:1,headerRow:1,headerColumn:1,headerFacet:1}),v0=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],b0="_vgsid_",x0={point:{on:"click",fields:[b0],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function w0(e){return"legend"===e||!!e?.legend}function k0(e){return w0(e)&&pa(e)}function _0(e){return!!e?.select}function O0(e){const t=[];for(const n of e||[]){if(_0(n))continue;const{expr:e,bind:r,...i}=n;if(r&&e){const n={...i,bind:r,init:e};t.push(n)}else{const n={...i,...e?{update:e}:{},...r?{bind:r}:{}};t.push(n)}}return t}function E0(e){return"concat"in e}function D0(e){return"vconcat"in e}function j0(e){return"hconcat"in e}function N0(e){let{step:t,offsetIsDiscrete:n}=e;return n?t.for??"offset":"position"}function S0(e){return pa(e)&&void 0!==e.step}function A0(e){return e.view||e.width||e.height}const $0=SH({align:1,bounds:1,center:1,columns:1,spacing:1});function C0(e,t){return e[t]??e["width"===t?"continuousWidth":"continuousHeight"]}function M0(e,t){const n=P0(e,t);return S0(n)?n.step:F0}function P0(e,t){return WH(e[t]??e["width"===t?"discreteWidth":"discreteHeight"],{step:e.step})}const F0=20,T0={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:F0},mark:{color:"#4c78a8",invalid:"filter",timeUnitBandSize:1},arc:{},area:{},bar:oQ,circle:{},geoshape:{},image:{},line:{},point:{},rect:aQ,rule:{color:"black"},square:{},text:{color:"black"},tick:{thickness:1},trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:{pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4,zero:!0},projection:{},legend:{gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:x0,style:{},title:{},facet:{spacing:20},concat:{spacing:20},normalizedNumberFormat:".0%"},z0=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],R0={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},L0={blue:z0[0],orange:z0[1],red:z0[2],teal:z0[3],green:z0[4],yellow:z0[5],purple:z0[6],pink:z0[7],brown:z0[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function B0(e){const t=SH(e||{}),n={};for(const r of t){const t=e[r];n[r]=EK(t)?_Y(t):OY(t)}return n}const I0=[...nQ,...$K,...y0,"background","padding","legend","lineBreak","scale","style","title","view"];function U0(e){void 0===e&&(e={});const{color:t,font:n,fontSize:r,selection:i,...o}=e,a=ga({},fH(T0),n?function(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}(n):{},t?function(e){return void 0===e&&(e={}),{signals:[{name:"color",value:pa(e)?{...L0,...e}:L0}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}(t):{},r?function(e){return{signals:[{name:"fontSize",value:pa(e)?{...R0,...e}:R0}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}(r):{},o||{});i&&ya(a,"selection",i,!0);const s=pH(a,I0);for(const l of["background","lineBreak","padding"])a[l]&&(s[l]=OY(a[l]));for(const l of nQ)a[l]&&(s[l]=pY(a[l]));for(const l of $K)a[l]&&(s[l]=B0(a[l]));for(const l of y0)a[l]&&(s[l]=pY(a[l]));return a.legend&&(s.legend=pY(a.legend)),a.scale&&(s.scale=pY(a.scale)),a.style&&(s.style=function(e){const t=SH(e),n={};for(const r of t)n[r]=B0(e[r]);return n}(a.style)),a.title&&(s.title=pY(a.title)),a.view&&(s.view=pY(a.view)),s}const q0=new Set(["view",...QJ]),W0=["color","fontSize","background","padding","facet","concat","numberFormat","numberFormatType","normalizedNumberFormat","normalizedNumberFormatType","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],Z0={view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"],area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],line:["point"],tick:["bandSize","thickness"]};function H0(e){e=fH(e);for(const t of W0)delete e[t];if(e.axis)for(const t in e.axis)EK(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of d0)delete e.legend[t];if(e.mark){for(const t of tQ)delete e.mark[t];e.mark.tooltip&&pa(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(O0(e.params)),delete e.params);for(const t of q0){for(const r of tQ)delete e[t][r];const n=Z0[t];if(n)for(const r of n)delete e[t][r];G0(e,t)}for(const t of SH(c0))delete e[t];!function(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:r}=mY(e.title);NH(t)||(e.style["group-title"]={...e.style["group-title"],...t});NH(n)||(e.style["group-subtitle"]={...e.style["group-subtitle"],...n});NH(r)?delete e.title:e.title=r}(e);for(const t in e)pa(e[t])&&NH(e[t])&&delete e[t];return NH(e)?void 0:e}function G0(e,t,n,r){"view"===t&&(n="cell");const i={...r?e[t][r]:e[t],...e.style[n??t]};NH(i)||(e.style[n??t]=i),r||delete e[t]}function V0(e){return"layer"in e}class Y0{map(e,t){return PQ(e)?this.mapFacet(e,t):function(e){return"repeat"in e}(e)?this.mapRepeat(e,t):j0(e)?this.mapHConcat(e,t):D0(e)?this.mapVConcat(e,t):E0(e)?this.mapConcat(e,t):this.mapLayerOrUnit(e,t)}mapLayerOrUnit(e,t){if(V0(e))return this.mapLayer(e,t);if(CK(e))return this.mapUnit(e,t);throw new Error(BY(e))}mapLayer(e,t){return{...e,layer:e.layer.map((e=>this.mapLayerOrUnit(e,t)))}}mapHConcat(e,t){return{...e,hconcat:e.hconcat.map((e=>this.map(e,t)))}}mapVConcat(e,t){return{...e,vconcat:e.vconcat.map((e=>this.map(e,t)))}}mapConcat(e,t){const{concat:n,...r}=e;return{...r,concat:n.map((e=>this.map(e,t)))}}mapFacet(e,t){return{...e,spec:this.map(e.spec,t)}}mapRepeat(e,t){return{...e,spec:this.map(e.spec,t)}}}const X0={zero:1,center:1,normalize:1};const J0=new Set([TJ,RJ,zJ,qJ,IJ,GJ,VJ,BJ,WJ,ZJ]),Q0=new Set([RJ,zJ,TJ]);function K0(e){return WQ(e)&&"quantitative"===ZQ(e)&&!e.bin}function e1(e,t,n){let{orient:r,type:i}=n;const o="x"===t?"y":"radius",a="x"===t,s=e[t],l=e[o];if(WQ(s)&&WQ(l))if(K0(s)&&K0(l)){if(s.stack)return t;if(l.stack)return o;const e=WQ(s)&&!!s.aggregate;if(e!==(WQ(l)&&!!l.aggregate))return e?t:o;if(a&&["bar","area"].includes(i)){if("vertical"===r)return o;if("horizontal"===r)return t}}else{if(K0(s))return t;if(K0(l))return o}else{if(K0(s))return t;if(K0(l))return o}}function t1(e,t){const n=KJ(e)?e:{type:e},r=n.type;if(!J0.has(r))return null;const i=e1(t,"x",n)||e1(t,"theta",n);if(!i)return null;const o=t[i],a=WQ(o)?iK(o,{}):void 0,s=function(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}(i),l=[],u=new Set;if(t[s]){const e=t[s],n=WQ(e)?iK(e,{}):void 0;n&&n!==a&&(l.push(s),u.add(n));const r="x"===s?"xOffset":"yOffset",i=t[r],o=WQ(i)?iK(i,{}):void 0;o&&o!==a&&(l.push(r),u.add(o))}const c=EV.reduce(((e,n)=>{if("tooltip"!==n&&PK(t,n)){const r=t[n];for(const t of Ra(r)){const r=hK(t);if(r.aggregate)continue;const i=iK(r,{});i&&u.has(i)||e.push({channel:n,fieldDef:r})}}return e}),[]);let f;return void 0!==o.stack?f=os(o.stack)?o.stack?"zero":null:o.stack:Q0.has(r)&&(f="zero"),f&&f in X0?zK(t)&&0===c.length?null:o?.scale?.type&&o?.scale?.type!==uJ.LINEAR?(o?.stack&&wX(function(e){return`Cannot stack non-linear scale (${e}).`}(o.scale.type)),null):XQ(t[iV(i)])?(void 0!==o.stack&&wX(`Cannot stack "${d=i}" if there is already "${d}2".`),null):(WQ(o)&&o.aggregate&&!oY.has(o.aggregate)&&wX(`Stacking is applied even though the aggregate function is non-summative ("${o.aggregate}").`),{groupbyChannels:l,groupbyFields:u,fieldChannel:i,impute:null!==o.impute&&XJ(r),stackBy:c,offset:f}):null;var d}function n1(e,t,n){const r=pY(e),i=CY("orient",r,n);if(r.orient=function(e,t,n){switch(e){case IJ:case GJ:case VJ:case WJ:case UJ:case LJ:return}const{x:r,y:i,x2:o,y2:a}=t;switch(e){case RJ:if(WQ(r)&&(uY(r.bin)||WQ(i)&&i.aggregate&&!r.aggregate))return"vertical";if(WQ(i)&&(uY(i.bin)||WQ(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(a||o){if(n)return n;if(!o)return(WQ(r)&&r.type===iJ&&!lY(r.bin)||YQ(r))&&WQ(i)&&uY(i.bin)?"horizontal":"vertical";if(!a)return(WQ(i)&&i.type===iJ&&!lY(i.bin)||YQ(i))&&WQ(r)&&uY(r.bin)?"vertical":"horizontal"}case qJ:if(o&&(!WQ(r)||!uY(r.bin))&&a&&(!WQ(i)||!uY(i.bin)))return;case zJ:if(a)return WQ(i)&&uY(i.bin)?"horizontal":"vertical";if(o)return WQ(r)&&uY(r.bin)?"vertical":"horizontal";if(e===qJ){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case BJ:case ZJ:{const t=VQ(r),o=VQ(i);if(n)return n;if(t&&!o)return"tick"!==e?"horizontal":"vertical";if(!t&&o)return"tick"!==e?"vertical":"horizontal";if(t&&o)return"vertical";{const e=JQ(r)&&r.type===aJ,t=JQ(i)&&i.type===aJ;if(e&&!t)return"vertical";if(!e&&t)return"horizontal"}return}}return"vertical"}(r.type,t,i),void 0!==i&&i!==r.orient&&wX(`Specified orient "${r.orient}" overridden with "${i}".`),"bar"===r.type&&r.orient){const e=CY("cornerRadiusEnd",r,n);if(void 0!==e){const n="horizontal"===r.orient&&t.x2||"vertical"===r.orient&&t.y2?["cornerRadius"]:iQ[r.orient];for(const t of n)r[t]=e;void 0!==r.cornerRadiusEnd&&delete r.cornerRadiusEnd}}void 0===CY("opacity",r,n)&&(r.opacity=function(e,t){if(vH([IJ,ZJ,GJ,VJ],e)&&!zK(t))return.7;return}(r.type,t));return void 0===CY("cursor",r,n)&&(r.cursor=function(e,t,n){if(t.href||e.href||CY("href",e,n))return"pointer";return e.cursor}(r,t,n)),r}function r1(e){const{point:t,line:n,...r}=e;return SH(r).length>1?r:r.type}function i1(e){for(const t of["line","area","rule","trail"])e[t]&&(e={...e,[t]:pH(e[t],["point","line"])});return e}function o1(e,t,n){return void 0===t&&(t={}),"transparent"===e.point?{opacity:0}:e.point?pa(e.point)?e.point:{}:void 0!==e.point?null:t.point||n.shape?pa(t.point)?t.point:{}:void 0}function a1(e,t){return void 0===t&&(t={}),e.line?!0===e.line?{}:e.line:void 0!==e.line?null:t.line?!0===t.line?{}:t.line:void 0}class s1{constructor(){this.name="path-overlay"}hasMatchingType(e,t){if(CK(e)){const{mark:n,encoding:r}=e,i=KJ(n)?n:{type:n};switch(i.type){case"line":case"rule":case"trail":return!!o1(i,t[i.type],r);case"area":return!!o1(i,t[i.type],r)||!!a1(i,t[i.type])}}return!1}run(e,t,n){const{config:r}=t,{params:i,projection:o,mark:a,name:s,encoding:l,...u}=e,c=BK(l,r),f=KJ(a)?a:{type:a},d=o1(f,r[f.type],c),h="area"===f.type&&a1(f,r[f.type]),p=[{name:s,...i?{params:i}:{},mark:r1({..."area"===f.type&&void 0===f.opacity&&void 0===f.fillOpacity?{opacity:.7}:{},...f}),encoding:pH(c,["shape"])}],m=t1(n1(f,c,r),c);let g=c;if(m){const{fieldChannel:e,offset:t}=m;g={...c,[e]:{...c[e],...t?{stack:t}:{}}}}return g=pH(g,["y2","x2"]),h&&p.push({...o?{projection:o}:{},mark:{type:"line",...hH(f,["clip","interpolate","tension","tooltip"]),...h},encoding:g}),d&&p.push({...o?{projection:o}:{},mark:{type:"point",opacity:1,filled:!0,...hH(f,["clip","tooltip"]),...d},encoding:g}),n({...u,layer:p},{...t,config:i1(r)})}}function l1(e,t){return t?CQ(e)?p1(e,t):f1(e,t):e}function u1(e,t){return t?p1(e,t):e}function c1(e,t,n){const r=t[e];return function(e){return e&&!cs(e)&&"repeat"in e}(r)?r.repeat in n?{...t,[e]:n[r.repeat]}:void wX(function(e){return`Unknown repeated value "${e}".`}(r.repeat)):t}function f1(e,t){if(void 0!==(e=c1("field",e,t))){if(null===e)return null;if(TQ(e)&&AQ(e.sort)){const n=c1("field",e.sort,t);e={...e,...n?{sort:n}:{}}}return e}}function d1(e,t){if(WQ(e))return f1(e,t);{const n=c1("datum",e,t);return n===e||n.type||(n.type="nominal"),n}}function h1(e,t){if(!XQ(e)){if(qQ(e)){const n=d1(e.condition,t);if(n)return{...e,condition:n};{const{condition:t,...n}=e;return n}}return e}{const n=d1(e,t);if(n)return n;if(IQ(e))return{condition:e.condition}}}function p1(e,t){const n={};for(const r in e)if(Ka(e,r)){const i=e[r];if(ha(i))n[r]=i.map((e=>h1(e,t))).filter((e=>e));else{const e=h1(i,t);void 0!==e&&(n[r]=e)}}return n}class m1{constructor(){this.name="RuleForRangedLine"}hasMatchingType(e){if(CK(e)){const{encoding:t,mark:n}=e;if("line"===n||KJ(n)&&"line"===n.type)for(const e of eV){const n=t[nV(e)];if(t[e]&&(WQ(n)&&!uY(n.bin)||HQ(n)))return!0}}return!1}run(e,t,n){const{encoding:r,mark:i}=e;var o,a;return wX((o=!!r.x2,a=!!r.y2,`Line mark is for continuous lines and thus cannot be used with ${o&&a?"x2 and y2":o?"x2":"y2"}. We will use the rule mark (line segments) instead.`)),n({...e,mark:pa(i)?{...i,type:"rule"}:"rule"},t)}}function g1(e){let{parentEncoding:t,encoding:n={},layer:r}=e,i={};if(t){const e=new Set([...SH(t),...SH(n)]);for(const o of e){const e=n[o],a=t[o];if(XQ(e)){const t={...a,...e};i[o]=t}else qQ(e)?i[o]={...e,condition:{...a,...e.condition}}:e||null===e?i[o]=e:(r||QQ(a)||yY(a)||XQ(a)||ha(a))&&(i[o]=a)}}else i=n;return!i||NH(i)?void 0:i}function y1(e){const{parentProjection:t,projection:n}=e;return t&&n&&wX(function(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${mH(t)} is overridden by a child projection ${mH(n)}.`}({parentProjection:t,projection:n})),n??t}function v1(e){return"filter"in e}function b1(e){return void 0!==e?.stop}function x1(e){return"lookup"in e}function w1(e){return"pivot"in e}function k1(e){return"density"in e}function _1(e){return"quantile"in e}function O1(e){return"regression"in e}function E1(e){return"loess"in e}function D1(e){return"sample"in e}function j1(e){return"window"in e}function N1(e){return"joinaggregate"in e}function S1(e){return"flatten"in e}function A1(e){return"calculate"in e}function $1(e){return"bin"in e}function C1(e){return"impute"in e}function M1(e){return"timeUnit"in e}function P1(e){return"aggregate"in e}function F1(e){return"stack"in e}function T1(e){return"fold"in e}function z1(e){return"extent"in e&&!("density"in e)}function R1(e,t){const{transform:n,...r}=e;if(n){const e=n.map((e=>{if(v1(e))return{filter:I1(e,t)};if($1(e)&&cY(e.bin))return{...e,bin:B1(e.bin)};if(x1(e)){const{selection:t,...n}=e.from;return t?{...e,from:{param:t,...n}}:e}return e}));return{...r,transform:e}}return e}function L1(e,t){const n=fH(e);if(WQ(n)&&cY(n.bin)&&(n.bin=B1(n.bin)),KQ(n)&&n.scale?.domain?.selection){const{selection:e,...t}=n.scale.domain;n.scale.domain={...t,...e?{param:e}:{}}}if(IQ(n))if(ha(n.condition))n.condition=n.condition.map((e=>{const{selection:n,param:r,test:i,...o}=e;return r?e:{...o,test:I1(e,t)}}));else{const{selection:e,param:r,test:i,...o}=L1(n.condition,t);n.condition=r?n.condition:{...o,test:I1(n.condition,t)}}return n}function B1(e){const t=e.extent;if(t?.selection){const{selection:n,...r}=t;return{...e,extent:{...r,param:n}}}return e}function I1(e,t){const n=e=>uH(e,(e=>{var n;const r={param:e,empty:t.emptySelections[e]??!0};return(n=t.selectionPredicates)[e]??(n[e]=[]),t.selectionPredicates[e].push(r),r}));return e.selection?n(e.selection):uH(e.test||e.filter,(e=>e.selection?n(e.selection):e))}class U1 extends Y0{map(e,t){const n=t.selections??[];if(e.params&&!CK(e)){const t=[];for(const r of e.params)_0(r)?n.push(r):t.push(r);e.params=t}return t.selections=n,super.map(e,t)}mapUnit(e,t){const n=t.selections;if(!n||!n.length)return e;const r=(t.path??[]).concat(e.name),i=[];for(const o of n)if(o.views&&o.views.length)for(const t of o.views)(cs(t)&&(t===e.name||r.includes(t))||ha(t)&&t.map((e=>r.indexOf(e))).every(((e,t,n)=>-1!==e&&(0===t||e>n[t-1]))))&&i.push(o);else i.push(o);return i.length&&(e.params=i),e}}for(const zee of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const e=U1.prototype[zee];U1.prototype[zee]=function(t,n){return e.call(this,t,q1(t,n))}}function q1(e,t){return e.name?{...t,path:(t.path??[]).concat(e.name)}:t}function W1(e,t){void 0===t&&(t=U0(e.config));const n=function(e,t){void 0===t&&(t={});const n={config:t};return G1.map(Z1.map(H1.map(e,n),n),n)}(e,t),{width:r,height:i}=e,o=function(e,t,n){let{width:r,height:i}=t;const o=CK(e)||V0(e),a={};o?"container"==r&&"container"==i?(a.type="fit",a.contains="padding"):"container"==r?(a.type="fit-x",a.contains="padding"):"container"==i&&(a.type="fit-y",a.contains="padding"):("container"==r&&(wX(UY("width")),r=void 0),"container"==i&&(wX(UY("height")),i=void 0));const s={type:"pad",...a,...n?V1(n.autosize):{},...V1(e.autosize)};"fit"!==s.type||o||(wX(IY),s.type="pad");"container"==r&&"fit"!=s.type&&"fit-x"!=s.type&&wX(qY("width"));"container"==i&&"fit"!=s.type&&"fit-y"!=s.type&&wX(qY("height"));if(cH(s,{type:"pad"}))return;return s}(n,{width:r,height:i,autosize:e.autosize},t);return{...n,...o?{autosize:o}:{}}}const Z1=new class extends Y0{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[JK,n0,l0,new s1,new m1]}map(e,t){if(CK(e)){const n=PK(e.encoding,JH),r=PK(e.encoding,QH),i=PK(e.encoding,KH);if(n||r||i)return this.mapFacetedUnit(e,t)}return super.map(e,t)}mapUnit(e,t){const{parentEncoding:n,parentProjection:r}=t,i=u1(e.encoding,t.repeater),o={...e,...e.name?{name:[t.repeaterPrefix,e.name].filter((e=>e)).join("_")}:{},...i?{encoding:i}:{}};if(n||r)return this.mapUnitWithParentEncodingOrProjection(o,t);const a=this.mapLayerOrUnit.bind(this);for(const s of this.nonFacetUnitNormalizers)if(s.hasMatchingType(o,t.config))return s.run(o,t,a);return o}mapRepeat(e,t){return function(e){return!ha(e.repeat)&&e.repeat.layer}(e)?this.mapLayerRepeat(e,t):this.mapNonLayerRepeat(e,t)}mapLayerRepeat(e,t){const{repeat:n,spec:r,...i}=e,{row:o,column:a,layer:s}=n,{repeater:l={},repeaterPrefix:u=""}=t;return o||a?this.mapRepeat({...e,repeat:{...o?{row:o}:{},...a?{column:a}:{}},spec:{repeat:{layer:s},spec:r}},t):{...i,layer:s.map((e=>{const n={...l,layer:e},i=`${(r.name?`${r.name}_`:"")+u}child__layer_${MH(e)}`,o=this.mapLayerOrUnit(r,{...t,repeater:n,repeaterPrefix:i});return o.name=i,o}))}}mapNonLayerRepeat(e,t){const{repeat:n,spec:r,data:i,...o}=e;!ha(n)&&e.columns&&(e=pH(e,["columns"]),wX(XY("repeat")));const a=[],{repeater:s={},repeaterPrefix:l=""}=t,u=!ha(n)&&n.row||[s?s.row:null],c=!ha(n)&&n.column||[s?s.column:null],f=ha(n)&&n||[s?s.repeat:null];for(const h of f)for(const e of u)for(const i of c){const o={repeat:h,row:e,column:i,layer:s.layer},u=(r.name?`${r.name}_`:"")+l+"child__"+(ha(n)?`${MH(h)}`:(n.row?`row_${MH(e)}`:"")+(n.column?`column_${MH(i)}`:"")),c=this.map(r,{...t,repeater:o,repeaterPrefix:u});c.name=u,a.push(pH(c,["data"]))}const d=ha(n)?e.columns:n.column?n.column.length:1;return{data:r.data??i,align:"all",...o,columns:d,concat:a}}mapFacet(e,t){const{facet:n}=e;return CQ(n)&&e.columns&&(e=pH(e,["columns"]),wX(XY("facet"))),super.mapFacet(e,t)}mapUnitWithParentEncodingOrProjection(e,t){const{encoding:n,projection:r}=e,{parentEncoding:i,parentProjection:o,config:a}=t,s=y1({parentProjection:o,projection:r}),l=g1({parentEncoding:i,encoding:u1(n,t.repeater)});return this.mapUnit({...e,...s?{projection:s}:{},...l?{encoding:l}:{}},{config:a})}mapFacetedUnit(e,t){const{row:n,column:r,facet:i,...o}=e.encoding,{mark:a,width:s,projection:l,height:u,view:c,params:f,encoding:d,...h}=e,{facetMapping:p,layout:m}=this.getFacetMappingAndLayout({row:n,column:r,facet:i},t),g=u1(o,t.repeater);return this.mapFacet({...h,...m,facet:p,spec:{...s?{width:s}:{},...u?{height:u}:{},...c?{view:c}:{},...l?{projection:l}:{},mark:a,encoding:g,...f?{params:f}:{}}},t)}getFacetMappingAndLayout(e,t){const{row:n,column:r,facet:i}=e;if(n||r){i&&wX(`Facet encoding dropped as ${(o=[...n?[JH]:[],...r?[QH]:[]]).join(" and ")} ${o.length>1?"are":"is"} also specified.`);const t={},a={};for(const n of[JH,QH]){const r=e[n];if(r){const{align:e,center:i,spacing:o,columns:s,...l}=r;t[n]=l;for(const t of["align","center","spacing"])void 0!==r[t]&&(a[t]??(a[t]={}),a[t][n]=r[t])}}return{facetMapping:t,layout:a}}{const{align:e,center:n,spacing:r,columns:o,...a}=i;return{facetMapping:l1(a,t.repeater),layout:{...e?{align:e}:{},...n?{center:n}:{},...r?{spacing:r}:{},...o?{columns:o}:{}}}}var o}mapLayer(e,t){let{parentEncoding:n,parentProjection:r,...i}=t;const{encoding:o,projection:a,...s}=e,l={...i,parentEncoding:g1({parentEncoding:n,encoding:o,layer:!0}),parentProjection:y1({parentProjection:r,projection:a})};return super.mapLayer({...s,...e.name?{name:[l.repeaterPrefix,e.name].filter((e=>e)).join("_")}:{}},l)}},H1=new class extends Y0{map(e,t){return t.emptySelections??(t.emptySelections={}),t.selectionPredicates??(t.selectionPredicates={}),e=R1(e,t),super.map(e,t)}mapLayerOrUnit(e,t){if((e=R1(e,t)).encoding){const n={};for(const[r,i]of $H(e.encoding))n[r]=L1(i,t);e={...e,encoding:n}}return super.mapLayerOrUnit(e,t)}mapUnit(e,t){const{selection:n,...r}=e;return n?{...r,params:$H(n).map((e=>{let[n,r]=e;const{init:i,bind:o,empty:a,...s}=r;"single"===s.type?(s.type="point",s.toggle=!1):"multi"===s.type&&(s.type="point"),t.emptySelections[n]="none"!==a;for(const l of AH(t.selectionPredicates[n]??{}))l.empty="none"!==a;return{name:n,value:i,select:s,bind:o}}))}:e}},G1=new U1;function V1(e){return cs(e)?{type:e}:e??{}}const Y1=["background","padding"];function X1(e,t){const n={};for(const r of Y1)e&&void 0!==e[r]&&(n[r]=OY(e[r]));return t&&(n.params=e.params),n}class J1{constructor(e,t){void 0===e&&(e={}),void 0===t&&(t={}),this.explicit=e,this.implicit=t}clone(){return new J1(fH(this.explicit),fH(this.implicit))}combine(){return{...this.explicit,...this.implicit}}get(e){return WH(this.explicit[e],this.implicit[e])}getWithExplicit(e){return void 0!==this.explicit[e]?{explicit:!0,value:this.explicit[e]}:void 0!==this.implicit[e]?{explicit:!1,value:this.implicit[e]}:{explicit:!1,value:void 0}}setWithExplicit(e,t){let{value:n,explicit:r}=t;void 0!==n&&this.set(e,n,r)}set(e,t,n){return delete this[n?"implicit":"explicit"][e],this[n?"explicit":"implicit"][e]=t,this}copyKeyFromSplit(e,t){let{explicit:n,implicit:r}=t;void 0!==n[e]?this.set(e,n[e],!0):void 0!==r[e]&&this.set(e,r[e],!1)}copyKeyFromObject(e,t){void 0!==t[e]&&this.set(e,t[e],!0)}copyAll(e){for(const t of SH(e.combine())){const n=e.getWithExplicit(t);this.setWithExplicit(t,n)}}}function Q1(e){return{explicit:!0,value:e}}function K1(e){return{explicit:!1,value:e}}function e2(e){return(t,n,r,i)=>{const o=e(t.value,n.value);return o>0?t:o<0?n:t2(t,n,r,i)}}function t2(e,t,n,r){return e.explicit&&t.explicit&&wX(function(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${mH(n)} and ${mH(r)}). Using ${mH(n)}.`}(n,r,e.value,t.value)),e}function n2(e,t,n,r,i){return void 0===i&&(i=t2),void 0===e||void 0===e.value?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:cH(e.value,t.value)?e:i(e,t,n,r)}class r2 extends J1{constructor(e,t,n){void 0===e&&(e={}),void 0===t&&(t={}),void 0===n&&(n=!1),super(e,t),this.explicit=e,this.implicit=t,this.parseNothing=n}clone(){const e=super.clone();return e.parseNothing=this.parseNothing,e}}function i2(e){return"url"in e}function o2(e){return"values"in e}function a2(e){return"name"in e&&!i2(e)&&!o2(e)&&!s2(e)}function s2(e){return e&&(l2(e)||u2(e)||c2(e))}function l2(e){return"sequence"in e}function u2(e){return"sphere"in e}function c2(e){return"graticule"in e}var f2;function d2(e){const{signals:t,hasLegend:n,index:r,...i}=e;return i.field=BH(i.field),i}function h2(e,t,n){if(void 0===t&&(t=!0),void 0===n&&(n=ta),ha(e)){const r=e.map((e=>h2(e,t,n)));return t?`[${r.join(", ")}]`:r}return kX(e)?n(t?NX(e):function(e){const t=jX(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}(e)):t?n(mH(e)):e}function p2(e,t){for(const n of AH(e.component.selection??{})){const r=n.name;let i=`${r}${N3}, ${"global"===n.resolve?"true":`{unit: ${C3(e)}}`}`;for(const o of $3)o.defined(n)&&(o.signals&&(t=o.signals(e,n,t)),o.modifyExpr&&(i=o.modifyExpr(e,n,i)));t.push({name:r+S3,on:[{events:{signal:n.name+N3},update:`modify(${vs(n.name+j3)}, ${i})`}]})}return y2(t)}function m2(e,t){if(e.component.selection&&SH(e.component.selection).length){const n=vs(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:wI("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return y2(t)}function g2(e,t){for(const n of AH(e.component.selection??{}))for(const r of $3)r.defined(n)&&r.marks&&(t=r.marks(e,n,t));return t}function y2(e){return e.map((e=>(e.on&&!e.on.length&&delete e.on,e)))}!function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup"}(f2||(f2={}));class v2{constructor(e,t){this.debugName=t,this._children=[],this._parent=null,e&&(this.parent=e)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(e){this._parent=e,e&&e.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(e,t){this._children.includes(e)?wX("Attempt to add the same child twice."):void 0!==t?this._children.splice(t,0,e):this._children.push(e)}removeChild(e){const t=this._children.indexOf(e);return this._children.splice(t,1),t}remove(){let e=this._parent.removeChild(this);for(const t of this._children)t._parent=this._parent,this._parent.addChild(t,e++)}insertAsParentOf(e){const t=e.parent;t.removeChild(this),this.parent=t,e.parent=this}swapWithParent(){const e=this._parent,t=e.parent;for(const r of this._children)r.parent=e;this._children=[],e.removeChild(this);const n=e.parent.removeChild(e);this._parent=t,t.addChild(this,n),e.parent=this}}class b2 extends v2{clone(){const e=new this.constructor;return e.debugName=`clone_${this.debugName}`,e._source=this._source,e._name=`clone_${this._name}`,e.type=this.type,e.refCounts=this.refCounts,e.refCounts[e._name]=0,e}constructor(e,t,n,r){super(e,t),this.type=n,this.refCounts=r,this._source=this._name=t,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}dependentFields(){return new Set}producedFields(){return new Set}hash(){return void 0===this._hash&&(this._hash=`Output ${HH()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(e){this._source=e}}function x2(e){return void 0!==e.as}function w2(e){return`${e}_end`}class k2 extends v2{clone(){return new k2(null,fH(this.formula))}constructor(e,t){super(e),this.formula=t}static makeFromEncoding(e,t){const n=t.reduceFieldDef(((e,n)=>{const{field:r,timeUnit:i}=n;if(i){let o;if($X(i)){if(m4(t)){const{mark:e}=t;(JJ(e)||n.bandPosition)&&(o={timeUnit:BX(i),field:r})}}else o={as:iK(n,{forAs:!0}),field:r,timeUnit:i};o&&(e[gH(o)]=o)}return e}),{});return NH(n)?null:new k2(e,n)}static makeFromTransform(e,t){const{timeUnit:n,...r}={...t},i={...r,timeUnit:BX(n)};return new k2(e,{[gH(i)]:i})}merge(e){this.formula={...this.formula};for(const t in e.formula)this.formula[t]||(this.formula[t]=e.formula[t]);for(const t of e.children)e.removeChild(t),t.parent=this;e.remove()}removeFormulas(e){const t={};for(const[n,r]of $H(this.formula)){const i=x2(r)?r.as:`${r.field}_end`;e.has(i)||(t[n]=r)}this.formula=t}producedFields(){return new Set(AH(this.formula).map((e=>x2(e)?e.as:w2(e.field))))}dependentFields(){return new Set(AH(this.formula).map((e=>e.field)))}hash(){return`TimeUnit ${gH(this.formula)}`}assemble(){const e=[];for(const t of AH(this.formula))if(x2(t)){const{field:n,as:r,timeUnit:i}=t,{unit:o,utc:a,...s}=BX(i);e.push({field:BH(n),type:"timeunit",...o?{units:FX(o)}:{},...a?{timezone:"utc"}:{},...s,as:[r,`${r}_end`]})}else if(t){const{field:n,timeUnit:r}=t,i=TX(r?.unit),{part:o,step:a}=qX(i,r.step);e.push({type:"formula",expr:`timeOffset('${o}', datum['${n}'], ${a})`,as:w2(n)})}return e}}const _2="_tuple_fields";class O2{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.items=t,this.hasChannel={},this.hasField={},this.hasSelectionId=!1}}const E2={defined:()=>!0,parse:(e,t,n)=>{const r=t.name,i=t.project??(t.project=new O2),o={},a={},s=new Set,l=(e,t)=>{const n="visual"===t?e.channel:e.field;let i=MH(`${r}_${n}`);for(let o=1;s.has(i);o++)i=MH(`${r}_${n}_${o}`);return s.add(i),{[t]:i}},u=t.type,c=e.config.selection[u],f=void 0!==n.value?Ra(n.value):null;let{fields:d,encodings:h}=pa(n.select)?n.select:{};if(!d&&!h&&f)for(const p of f)if(pa(p))for(const e of SH(p))QG[e]?(h||(h=[])).push(e):"interval"===u?(wX('Interval selections should be initialized using "x", "y", "longitude", or "latitude" keys.'),h=c.encodings):(d??(d=[])).push(e);d||h||(h=c.encodings,"fields"in c&&(d=c.fields));for(const p of h??[]){const t=e.fieldDef(p);if(t){let n=t.field;if(t.aggregate){wX(GY(p,t.aggregate));continue}if(!n){wX(HY(p));continue}if(t.timeUnit&&!$X(t.timeUnit)){n=e.vgField(p);const r={timeUnit:t.timeUnit,as:n,field:t.field};a[gH(r)]=r}if(!o[n]){const r={field:n,channel:p,type:"interval"===u&&HV(p)&&wJ(e.getScaleComponent(p).get("type"))?"R":t.bin?"R-RE":"E",index:i.items.length};r.signals={...l(r,"data"),...l(r,"visual")},i.items.push(o[n]=r),i.hasField[n]=o[n],i.hasSelectionId=i.hasSelectionId||n===b0,zG(p)?(r.geoChannel=p,r.channel=TG(p),i.hasChannel[r.channel]=o[n]):i.hasChannel[p]=o[n]}}else wX(HY(p))}for(const p of d??[]){if(i.hasField[p])continue;const e={type:"E",field:p,index:i.items.length};e.signals={...l(e,"data")},i.items.push(e),i.hasField[p]=e,i.hasSelectionId=i.hasSelectionId||p===b0}f&&(t.init=f.map((e=>i.items.map((t=>pa(e)?void 0!==e[t.geoChannel||t.channel]?e[t.geoChannel||t.channel]:e[t.field]:e))))),NH(a)||(i.timeUnit=new k2(null,a))},signals:(e,t,n)=>{const r=t.name+_2;return n.filter((e=>e.name===r)).length>0||t.project.hasSelectionId?n:n.concat({name:r,value:t.project.items.map(d2)})}},D2={defined:e=>"interval"===e.type&&"global"===e.resolve&&e.bind&&"scales"===e.bind,parse:(e,t)=>{const n=t.scales=[];for(const r of t.project.items){const i=r.channel;if(!HV(i))continue;const o=e.getScaleComponent(i),a=o?o.get("type"):void 0;o&&wJ(a)?(o.set("selectionExtent",{param:t.name,field:r.field},!0),n.push(r)):wX("Scale bindings are currently only supported for scales with unbinned, continuous domains.")}},topLevelSignals:(e,t,n)=>{const r=t.scales.filter((e=>0===n.filter((t=>t.name===e.signals.data)).length));if(!e.parent||N2(e)||0===r.length)return n;const i=n.filter((e=>e.name===t.name))[0];let o=i.update;if(o.indexOf(A3)>=0)i.update=`{${r.map((e=>`${vs(BH(e.field))}: ${e.signals.data}`)).join(", ")}}`;else{for(const e of r){const t=`${vs(BH(e.field))}: ${e.signals.data}`;o.includes(t)||(o=`${o.substring(0,o.length-1)}, ${t}}`)}i.update=o}return n.concat(r.map((e=>({name:e.signals.data}))))},signals:(e,t,n)=>{if(e.parent&&!N2(e))for(const r of t.scales){const e=n.filter((e=>e.name===r.signals.data))[0];e.push="outer",delete e.value,delete e.update}return n}};function j2(e,t){return`domain(${vs(e.scaleName(t))})`}function N2(e){return e.parent&&v4(e.parent)&&(!e.parent.parent??N2(e.parent.parent))}const S2="_brush",A2="_scale_trigger",$2="geo_interval_init_tick",C2="_init",M2={defined:e=>"interval"===e.type,parse:(e,t,n)=>{var r;if(e.hasProjection){const e={...pa(n.select)?n.select:{}};e.fields=[b0],e.encodings||(e.encodings=n.value?SH(n.value):[fG,cG]),n.select={type:"interval",...e}}if(t.translate&&!D2.defined(t)){const e=`!event.item || event.item.mark.name !== ${vs(t.name+S2)}`;for(const n of t.events){if(!n.between){wX(`${n} is not an ordered event stream for interval selections.`);continue}const t=Ra((r=n.between[0]).filter??(r.filter=[]));t.indexOf(e)<0&&t.push(e)}}},signals:(e,t,n)=>{const r=t.name,i=r+N3,o=AH(t.project.hasChannel).filter((e=>e.channel===eG||e.channel===tG)),a=t.init?t.init[0]:null;if(n.push(...o.reduce(((n,r)=>n.concat(function(e,t,n,r){const i=!e.hasProjection,o=n.channel,a=n.signals.visual,s=vs(i?e.scaleName(o):e.projectionName()),l=e=>`scale(${s}, ${e})`,u=e.getSizeSignalRef(o===eG?"width":"height").signal,c=`${o}(unit)`,f=t.events.reduce(((e,t)=>[...e,{events:t.between[0],update:`[${c}, ${c}]`},{events:t,update:`[${a}[0], clamp(${c}, 0, ${u})]`}]),[]);if(i){const i=n.signals.data,u=D2.defined(t),c=e.getScaleComponent(o),d=c?c.get("type"):void 0,h=r?{init:h2(r,!0,l)}:{value:[]};return f.push({events:{signal:t.name+A2},update:wJ(d)?`[${l(`${i}[0]`)}, ${l(`${i}[1]`)}]`:"[0, 0]"}),u?[{name:i,on:[]}]:[{name:a,...h,on:f},{name:i,...r?{init:h2(r)}:{},on:[{events:{signal:a},update:`${a}[0] === ${a}[1] ? null : invert(${s}, ${a})`}]}]}{const e=o===eG?0:1,n=t.name+C2;return[{name:a,...r?{init:`[${n}[0][${e}], ${n}[1][${e}]]`}:{value:[]},on:f}]}}(e,t,r,a&&a[r.index]))),[])),e.hasProjection){const s=vs(e.projectionName()),l=e.projectionName()+"_center",{x:u,y:c}=t.project.hasChannel,f=u&&u.signals.visual,d=c&&c.signals.visual,h=u?a&&a[u.index]:`${l}[0]`,p=c?a&&a[c.index]:`${l}[1]`,m=t=>e.getSizeSignalRef(t).signal,g=`[[${f?f+"[0]":"0"}, ${d?d+"[0]":"0"}],[${f?f+"[1]":m("width")}, ${d?d+"[1]":m("height")}]]`;if(a&&(n.unshift({name:r+C2,init:`[scale(${s}, [${u?h[0]:h}, ${c?p[0]:p}]), scale(${s}, [${u?h[1]:h}, ${c?p[1]:p}])]`}),!u||!c)){n.find((e=>e.name===l))||n.unshift({name:l,update:`invert(${s}, [${m("width")}/2, ${m("height")}/2])`})}const y=`vlSelectionTuples(${`intersect(${g}, {markname: ${vs(e.getName("marks"))}}, unit.mark)`}, ${`{unit: ${C3(e)}}`})`,v=o.map((e=>e.signals.visual));return n.concat({name:i,on:[{events:[...v.length?[{signal:v.join(" || ")}]:[],...a?[{signal:$2}]:[]],update:y}]})}{if(!D2.defined(t)){const t=r+A2,i=o.map((t=>{const n=t.channel,{data:r,visual:i}=t.signals,o=vs(e.scaleName(n)),a=wJ(e.getScaleComponent(n).get("type"))?"+":"";return`(!isArray(${r}) || (${a}invert(${o}, ${i})[0] === ${a}${r}[0] && ${a}invert(${o}, ${i})[1] === ${a}${r}[1]))`}));i.length&&n.push({name:t,value:{},on:[{events:o.map((t=>({scale:e.scaleName(t.channel)}))),update:i.join(" && ")+` ? ${t} : {}`}]})}const s=o.map((e=>e.signals.data)),l=`unit: ${C3(e)}, fields: ${r+_2}, values`;return n.concat({name:i,...a?{init:`{${l}: ${h2(a)}}`}:{},...s.length?{on:[{events:[{signal:s.join(" || ")}],update:`${s.join(" && ")} ? {${l}: [${s}]} : null`}]}:{}})}},topLevelSignals:(e,t,n)=>{if(m4(e)&&e.hasProjection&&t.init){n.filter((e=>e.name===$2)).length||n.unshift({name:$2,value:null,on:[{events:"timer{1}",update:`${$2} === null ? {} : ${$2}`}]})}return n},marks:(e,t,n)=>{const r=t.name,{x:i,y:o}=t.project.hasChannel,a=i?.signals.visual,s=o?.signals.visual,l=`data(${vs(t.name+j3)})`;if(D2.defined(t)||!i&&!o)return n;const u={x:void 0!==i?{signal:`${a}[0]`}:{value:0},y:void 0!==o?{signal:`${s}[0]`}:{value:0},x2:void 0!==i?{signal:`${a}[1]`}:{field:{group:"width"}},y2:void 0!==o?{signal:`${s}[1]`}:{field:{group:"height"}}};if("global"===t.resolve)for(const m of SH(u))u[m]=[{test:`${l}.length && ${l}[0].unit === ${C3(e)}`,...u[m]},{value:0}];const{fill:c,fillOpacity:f,cursor:d,...h}=t.mark,p=SH(h).reduce(((e,t)=>(e[t]=[{test:[void 0!==i&&`${a}[0] !== ${a}[1]`,void 0!==o&&`${s}[0] !== ${s}[1]`].filter((e=>e)).join(" && "),value:h[t]},{value:null}],e)),{});return[{name:`${r+S2}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:c},fillOpacity:{value:f}},update:u}},...n,{name:r+S2,type:"rect",clip:!0,encode:{enter:{...d?{cursor:{value:d}}:{},fill:{value:"transparent"}},update:{...u,...p}}}]}};const P2={defined:e=>"point"===e.type,signals:(e,t,n)=>{const r=t.name,i=r+_2,o=t.project,a="(item().isVoronoi ? datum.datum : datum)",s=AH(e.component.selection??{}).reduce(((e,t)=>"interval"===t.type?e.concat(t.name+S2):e),[]).map((e=>`indexof(item().mark.name, '${e}') < 0`)).join(" && "),l="datum && item().mark.marktype !== 'group' && indexof(item().mark.role, 'legend') < 0"+(s?` && ${s}`:"");let u=`unit: ${C3(e)}, `;if(t.project.hasSelectionId)u+=`${b0}: ${a}[${vs(b0)}]`;else{u+=`fields: ${i}, values: [${o.items.map((t=>{const n=e.fieldDef(t.channel);return n?.bin?`[${a}[${vs(e.vgField(t.channel,{}))}], ${a}[${vs(e.vgField(t.channel,{binSuffix:"end"}))}]]`:`${a}[${vs(t.field)}]`})).join(", ")}]`}const c=t.events;return n.concat([{name:r+N3,on:c?[{events:c,update:`${l} ? {${u}} : null`,force:!0}]:[]}])}};function F2(e,t,n,r){const i=IQ(t)&&t.condition,o=r(t);if(i){const t=Ra(i).map((t=>{const n=r(t);if(function(e){return e.param}(t)){const{param:r,empty:i}=t;return{test:L3(e,{param:r,empty:i}),...n}}return{test:I3(e,t.test),...n}}));return{[n]:[...t,...void 0!==o?[o]:[]]}}return void 0!==o?{[n]:o}:{}}function T2(e,t){void 0===t&&(t="text");const n=e.encoding[t];return F2(e,n,t,(t=>z2(t,e.config)))}function z2(e,t,n){if(void 0===n&&(n="datum"),e){if(QQ(e))return DY(e.value);if(XQ(e)){const{format:r,formatType:i}=dK(e);return yQ({fieldOrDatumDef:e,format:r,formatType:i,expr:n,config:t})}}}function R2(e,t){void 0===t&&(t={});const{encoding:n,markDef:r,config:i,stack:o}=e,a=n.tooltip;if(ha(a))return{tooltip:B2({tooltip:a},o,i,t)};{const s=t.reactiveGeom?"datum.datum":"datum";return F2(e,a,"tooltip",(e=>{const a=z2(e,i,s);if(a)return a;if(null===e)return;let l=CY("tooltip",r,i);return!0===l&&(l={content:"encoding"}),cs(l)?{value:l}:pa(l)?yY(l)?l:"encoding"===l.content?B2(n,o,i,t):{signal:s}:void 0}))}}function L2(e,t,n,r){let{reactiveGeom:i}=void 0===r?{}:r;const o={...n,...n.tooltipFormat},a={},s=i?"datum.datum":"datum",l=[];function u(n,r){const i=nV(r),u=JQ(n)?n:{...n,type:e[i].type},c=Ra(u.title||fK(u,o)).join(", ").replaceAll(/"/g,'\\"');let f;if(NV(r)){const t="x"===r?"x2":"y2",n=hK(e[t]);if(uY(u.bin)&&n){const e=iK(u,{expr:s}),r=iK(n,{expr:s}),{format:i,formatType:l}=dK(u);f=EQ(e,r,i,l,o),a[t]=!0}}if((NV(r)||r===lG||r===aG)&&t&&t.fieldChannel===r&&"normalize"===t.offset){const{format:e,formatType:t}=dK(u);f=yQ({fieldOrDatumDef:u,format:e,formatType:t,expr:s,config:o,normalizeStack:!0}).signal}f??(f=z2(u,o,s).signal),l.push({channel:r,key:c,value:f})}IK(e,((e,t)=>{WQ(e)?u(e,t):UQ(e)&&u(e.condition,t)}));const c={};for(const{channel:f,key:d,value:h}of l)a[f]||c[d]||(c[d]=h);return c}function B2(e,t,n,r){let{reactiveGeom:i}=void 0===r?{}:r;const o=L2(e,t,n,{reactiveGeom:i}),a=$H(o).map((e=>{let[t,n]=e;return`"${t}": ${n}`}));return a.length>0?{signal:`{${a.join(", ")}}`}:void 0}function I2(e){const{markDef:t,config:n}=e,r=CY("aria",t,n);return!1===r?{}:{...r?{aria:r}:{},...U2(e),...q2(e)}}function U2(e){const{mark:t,markDef:n,config:r}=e;if(!1===r.aria)return{};const i=CY("ariaRoleDescription",n,r);return null!=i?{ariaRoleDescription:{value:i}}:t in wY?{}:{ariaRoleDescription:{value:t}}}function q2(e){const{encoding:t,markDef:n,config:r,stack:i}=e,o=t.description;if(o)return F2(e,o,"description",(t=>z2(t,e.config)));const a=CY("description",n,r);if(null!=a)return{description:DY(a)};if(!1===r.aria)return{};const s=L2(t,i,r);return NH(s)?void 0:{description:{signal:$H(s).map(((e,t)=>{let[n,r]=e;return`"${t>0?"; ":""}${n}: " + (${r})`})).join(" + ")}}}function W2(e,t,n){void 0===n&&(n={});const{markDef:r,encoding:i,config:o}=t,{vgChannel:a}=n;let{defaultRef:s,defaultValue:l}=n;void 0===s&&(l??(l=CY(e,r,o,{vgChannel:a,ignoreVgConfig:!0})),void 0!==l&&(s=DY(l)));const u=i[e];return F2(t,u,a??e,(n=>dQ({channel:e,channelDef:n,markDef:r,config:o,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:s})))}function Z2(e,t){void 0===t&&(t={filled:void 0});const{markDef:n,encoding:r,config:i}=e,{type:o}=n,a=t.filled??CY("filled",n,i),s=vH(["bar","point","circle","square","geoshape"],o)?"transparent":void 0,l=CY(!0===a?"color":void 0,n,i,{vgChannel:"fill"})??i.mark[!0===a&&"color"]??s,u=CY(!1===a?"color":void 0,n,i,{vgChannel:"stroke"})??i.mark[!1===a&&"color"],c=a?"fill":"stroke",f={...l?{fill:DY(l)}:{},...u?{stroke:DY(u)}:{}};return n.color&&(a?n.fill:n.stroke)&&wX(rX("property",{fill:"fill"in n,stroke:"stroke"in n})),{...f,...W2("color",e,{vgChannel:c,defaultValue:a?l:u}),...W2("fill",e,{defaultValue:r.fill?l:void 0}),...W2("stroke",e,{defaultValue:r.stroke?u:void 0})}}function H2(e){const{encoding:t,mark:n}=e,r=t.order;return!XJ(n)&&QQ(r)?F2(e,r,"zindex",(e=>DY(e.value))):{}}function G2(e){let{channel:t,markDef:n,encoding:r={},model:i,bandPosition:o}=e;const a=`${t}Offset`,s=n[a],l=r[a];if(("xOffset"===a||"yOffset"===a)&&l){return{offsetType:"encoding",offset:dQ({channel:a,channelDef:l,markDef:n,config:i?.config,scaleName:i.scaleName(a),scale:i.getScaleComponent(a),stack:null,defaultRef:DY(s),bandPosition:o})}}const u=n[a];return u?{offsetType:"visual",offset:u}:{}}function V2(e,t,n){let{defaultPos:r,vgChannel:i}=n;const{encoding:o,markDef:a,config:s,stack:l}=t,u=o[e],c=o[iV(e)],f=t.scaleName(e),d=t.getScaleComponent(e),{offset:h,offsetType:p}=G2({channel:e,markDef:a,encoding:o,model:t,bandPosition:.5}),m=Y2({model:t,defaultPos:r,channel:e,scaleName:f,scale:d}),g=!u&&NV(e)&&(o.latitude||o.longitude)?{field:t.getName(e)}:function(e){const{channel:t,channelDef:n,scaleName:r,stack:i,offset:o,markDef:a}=e;if(XQ(n)&&i&&t===i.fieldChannel){if(WQ(n)){let e=n.bandPosition;if(void 0!==e||"text"!==a.type||"radius"!==t&&"theta"!==t||(e=.5),void 0!==e)return fQ({scaleName:r,fieldOrDatumDef:n,startSuffix:"start",bandPosition:e,offset:o})}return cQ(n,r,{suffix:"end"},{offset:o})}return sQ(e)}({channel:e,channelDef:u,channel2Def:c,markDef:a,config:s,scaleName:f,scale:d,stack:l,offset:h,defaultRef:m,bandPosition:"encoding"===p?0:void 0});return g?{[i||e]:g}:void 0}function Y2(e){let{model:t,defaultPos:n,channel:r,scaleName:i,scale:o}=e;const{markDef:a,config:s}=t;return()=>{const e=nV(r),l=rV(r),u=CY(r,a,s,{vgChannel:l});if(void 0!==u)return hQ(r,u);switch(n){case"zeroOrMin":case"zeroOrMax":if(i){const e=o.get("type");if(vH([uJ.LOG,uJ.TIME,uJ.UTC],e));else if(o.domainDefinitelyIncludesZero())return{scale:i,value:0}}if("zeroOrMin"===n)return"y"===e?{field:{group:"height"}}:{value:0};switch(e){case"radius":return{signal:`min(${t.width.signal},${t.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":return{...t[oV(r)],mult:.5}}}}const X2={left:"x",center:"xc",right:"x2"},J2={top:"y",middle:"yc",bottom:"y2"};function Q2(e,t,n,r){if(void 0===r&&(r="middle"),"radius"===e||"theta"===e)return rV(e);const i="x"===e?"align":"baseline",o=CY(i,t,n);let a;return yY(o)?(wX(function(e){return`The ${e} for range marks cannot be an expression`}(i)),a=void 0):a=o,"x"===e?X2[a||("top"===r?"left":"center")]:J2[a||r]}function K2(e,t,n){let{defaultPos:r,defaultPos2:i,range:o}=n;return o?e3(e,t,{defaultPos:r,defaultPos2:i}):V2(e,t,{defaultPos:r})}function e3(e,t,n){let{defaultPos:r,defaultPos2:i}=n;const{markDef:o,config:a}=t,s=iV(e),l=oV(e),u=function(e,t,n){const{encoding:r,mark:i,markDef:o,stack:a,config:s}=e,l=nV(n),u=oV(n),c=rV(n),f=r[l],d=e.scaleName(l),h=e.getScaleComponent(l),{offset:p}=G2(n in r||n in o?{channel:n,markDef:o,encoding:r,model:e}:{channel:l,markDef:o,encoding:r,model:e});if(!f&&("x2"===n||"y2"===n)&&(r.latitude||r.longitude)){const t=oV(n),r=e.markDef[t];return null!=r?{[t]:{value:r}}:{[c]:{field:e.getName(n)}}}const m=function(e){let{channel:t,channelDef:n,channel2Def:r,markDef:i,config:o,scaleName:a,scale:s,stack:l,offset:u,defaultRef:c}=e;if(XQ(n)&&l&&t.charAt(0)===l.fieldChannel.charAt(0))return cQ(n,a,{suffix:"start"},{offset:u});return sQ({channel:t,channelDef:r,scaleName:a,scale:s,stack:l,markDef:i,config:o,offset:u,defaultRef:c})}({channel:n,channelDef:f,channel2Def:r[n],markDef:o,config:s,scaleName:d,scale:h,stack:a,offset:p,defaultRef:void 0});if(void 0!==m)return{[c]:m};return t3(n,o)||t3(n,{[n]:PY(n,o,s.style),[u]:PY(u,o,s.style)})||t3(n,s[i])||t3(n,s.mark)||{[c]:Y2({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}(t,i,s);return{...V2(e,t,{defaultPos:r,vgChannel:u[l]?Q2(e,o,a):rV(e)}),...u}}function t3(e,t){const n=oV(e),r=rV(e);if(void 0!==t[r])return{[r]:hQ(e,t[r])};if(void 0!==t[e])return{[r]:hQ(e,t[e])};if(t[n]){const r=t[n];if(!rQ(r))return{[n]:hQ(e,r)};wX(function(e){return`Position range does not support relative band size for ${e}.`}(n))}}function n3(e,t){const{config:n,encoding:r,markDef:i}=e,o=i.type,a=iV(t),s=oV(t),l=r[t],u=r[a],c=e.getScaleComponent(t),f=c?c.get("type"):void 0,d=i.orient,h=r[s]??r.size??CY("size",i,n,{vgChannel:s}),p=aV(t),m="bar"===o&&("x"===t?"vertical"===d:"horizontal"===d);return!WQ(l)||!(lY(l.bin)||uY(l.bin)||l.timeUnit&&!u)||h&&!rQ(h)||r[p]||xJ(f)?(XQ(l)&&xJ(f)||m)&&!u?function(e,t,n){const{markDef:r,encoding:i,config:o,stack:a}=n,s=r.orient,l=n.scaleName(t),u=n.getScaleComponent(t),c=oV(t),f=iV(t),d=aV(t),h=n.scaleName(d),p=n.getScaleComponent(sV(t)),m="horizontal"===s&&"y"===t||"vertical"===s&&"x"===t;let g;(i.size||r.size)&&(m?g=W2("size",n,{vgChannel:c,defaultRef:DY(r.size)}):wX(function(e){return`Cannot apply size to non-oriented mark "${e}".`}(r.type)));const y=!!g,v=RQ({channel:t,fieldDef:e,markDef:r,config:o,scaleType:u?.get("type"),useVlSizeChannel:m});g=g||{[c]:r3(c,h||l,p||u,o,v,!!e,r.type)};const b="band"===u?.get("type")&&rQ(v)&&!y?"top":"middle",x=Q2(t,r,o,b),w="xc"===x||"yc"===x,{offset:k,offsetType:_}=G2({channel:t,markDef:r,encoding:i,model:n,bandPosition:w?.5:0}),O=sQ({channel:t,channelDef:e,markDef:r,config:o,scaleName:l,scale:u,stack:a,offset:k,defaultRef:Y2({model:n,defaultPos:"mid",channel:t,scaleName:l,scale:u}),bandPosition:w?"encoding"===_?0:.5:yY(v)?{signal:`(1-${v})/2`}:rQ(v)?(1-v.band)/2:0});if(c)return{[x]:O,...g};{const e=rV(f),t=g[c],n=k?{...t,offset:k}:t;return{[x]:O,[e]:ha(O)?[O[0],{...O[1],offset:n}]:{...O,offset:n}}}}(l,t,e):e3(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"}):function(e){let{fieldDef:t,fieldDef2:n,channel:r,model:i}=e;const{config:o,markDef:a,encoding:s}=i,l=i.getScaleComponent(r),u=i.scaleName(r),c=l?l.get("type"):void 0,f=l.get("reverse"),d=RQ({channel:r,fieldDef:t,markDef:a,config:o,scaleType:c}),h=i.component.axes[r]?.[0],p=h?.get("translate")??.5,m=NV(r)?CY("binSpacing",a,o)??0:0,g=iV(r),y=rV(r),v=rV(g),b=MY("minBandSize",a,o),{offset:x}=G2({channel:r,markDef:a,encoding:s,model:i,bandPosition:0}),{offset:w}=G2({channel:g,markDef:a,encoding:s,model:i,bandPosition:0}),k=function(e){let{scaleName:t,fieldDef:n}=e;const r=iK(n,{expr:"datum"});return`abs(scale("${t}", ${iK(n,{expr:"datum",suffix:"end"})}) - scale("${t}", ${r}))`}({fieldDef:t,scaleName:u}),_=i3(r,m,f,p,x,b,k),O=i3(g,m,f,p,w??x,b,k),E=yY(d)?{signal:`(1-${d.signal})/2`}:rQ(d)?(1-d.band)/2:.5;if(lY(t.bin)||t.timeUnit)return{[v]:o3({fieldDef:t,scaleName:u,bandPosition:E,offset:O}),[y]:o3({fieldDef:t,scaleName:u,bandPosition:yY(E)?{signal:`1-${E.signal}`}:1-E,offset:_})};if(uY(t.bin)){const e=cQ(t,u,{},{offset:O});if(WQ(n))return{[v]:e,[y]:cQ(n,u,{},{offset:_})};if(cY(t.bin)&&t.bin.step)return{[v]:e,[y]:{signal:`scale("${u}", ${iK(t,{expr:"datum"})} + ${t.bin.step})`,offset:_}}}return void wX(vX(g))}({fieldDef:l,fieldDef2:u,channel:t,model:e})}function r3(e,t,n,r,i,o,a){if(rQ(i)){if(!n)return{mult:i.band,field:{group:e}};{const e=n.get("type");if("band"===e){let e=`bandwidth('${t}')`;1!==i.band&&(e=`${i.band} * ${e}`);const n=MY("minBandSize",{type:a},r);return{signal:n?`max(${SY(n)}, ${e})`:e}}1!==i.band&&(wX(function(e){return`Cannot use the relative band size with ${e} scale.`}(e)),i=void 0)}}else{if(yY(i))return i;if(i)return{value:i}}if(n){const e=n.get("range");if(vY(e)&&ls(e.step))return{value:e.step-2}}if(!o){const{bandPaddingInner:t,barBandPaddingInner:n,rectBandPaddingInner:i}=r.scale,o=WH(t,"bar"===a?n:i);if(yY(o))return{signal:`(1 - (${o.signal})) * ${e}`};if(ls(o))return{signal:`${1-o} * ${e}`}}return{value:M0(r.view,e)-2}}function i3(e,t,n,r,i,o,a){if(PG(e))return 0;const s="x"===e||"y2"===e,l=s?-t/2:t/2;if(yY(n)||yY(i)||yY(r)||o){const e=SY(n),t=SY(i),u=SY(r),c=SY(o),f=o?`(${a} < ${c} ? ${s?"":"-"}0.5 * (${c} - (${a})) : ${l})`:l;return{signal:(u?`${u} + `:"")+(e?`(${e} ? -1 : 1) * `:"")+(t?`(${t} + ${f})`:f)}}return i=i||0,r+(n?-i-l:+i+l)}function o3(e){let{fieldDef:t,scaleName:n,bandPosition:r,offset:i}=e;return fQ({scaleName:n,fieldOrDatumDef:t,bandPosition:r,offset:i})}const a3=new Set(["aria","width","height"]);function s3(e,t){const{fill:n,stroke:r}="include"===t.color?Z2(e):{};return{...u3(e.markDef,t),...l3(e,"fill",n),...l3(e,"stroke",r),...W2("opacity",e),...W2("fillOpacity",e),...W2("strokeOpacity",e),...W2("strokeWidth",e),...W2("strokeDash",e),...H2(e),...R2(e),...T2(e,"href"),...I2(e)}}function l3(e,t,n){const{config:r,mark:i,markDef:o}=e;if("hide"===CY("invalid",o,r)&&n&&!XJ(i)){const r=function(e,t){let{invalid:n=!1,channels:r}=t;const i=r.reduce(((t,n)=>{const r=e.getScaleComponent(n);if(r){const i=r.get("type"),o=e.vgField(n,{expr:"datum"});o&&wJ(i)&&(t[o]=!0)}return t}),{}),o=SH(i);if(o.length>0){const e=n?"||":"&&";return o.map((e=>uQ(e,n))).join(` ${e} `)}return}(e,{invalid:!0,channels:ZV});if(r)return{[t]:[{test:r,value:null},...Ra(n)]}}return n?{[t]:n}:{}}function u3(e,t){return xY.reduce(((n,r)=>(a3.has(r)||void 0===e[r]||"ignore"===t[r]||(n[r]=DY(e[r])),n)),{})}function c3(e){const{config:t,markDef:n}=e;if(CY("invalid",n,t)){const t=function(e,t){let{invalid:n=!1,channels:r}=t;const i=r.reduce(((t,n)=>{const r=e.getScaleComponent(n);if(r){const i=r.get("type"),o=e.vgField(n,{expr:"datum",binSuffix:e.stack?.impute?"mid":void 0});o&&wJ(i)&&(t[o]=!0)}return t}),{}),o=SH(i);if(o.length>0){const e=n?"||":"&&";return o.map((e=>uQ(e,n))).join(` ${e} `)}return}(e,{channels:jV});if(t)return{defined:{signal:t}}}return{}}function f3(e,t){if(void 0!==t)return{[e]:DY(t)}}const d3="voronoi",h3={defined:e=>"point"===e.type&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(d3)},marks:(e,t,n)=>{const{x:r,y:i}=t.project.hasChannel,o=e.mark;if(XJ(o))return wX(`The "nearest" transform is not supported for ${o} marks.`),n;const a={name:e.getName(d3),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0},...R2(e,{reactiveGeom:!0})}},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let s=0,l=!1;return n.forEach(((t,n)=>{const r=t.name??"";r===e.component.mark[0].name?s=n:r.indexOf(d3)>=0&&(l=!0)})),l||n.splice(s+1,0,a),n}},p3={defined:e=>"point"===e.type&&"global"===e.resolve&&e.bind&&"scales"!==e.bind&&!w0(e.bind),parse:(e,t,n)=>P3(t,n),topLevelSignals:(e,t,n)=>{const r=t.name,i=t.project,o=t.bind,a=t.init&&t.init[0],s=h3.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach(((e,i)=>{const l=MH(`${r}_${e.field}`);n.filter((e=>e.name===l)).length||n.unshift({name:l,...a?{init:h2(a[i])}:{value:null},on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${s}[${vs(e.field)}] : null`}]:[],bind:o[e.field]??o[e.channel]??o})})),n},signals:(e,t,n)=>{const r=t.name,i=t.project,o=n.filter((e=>e.name===r+N3))[0],a=r+_2,s=i.items.map((e=>MH(`${r}_${e.field}`))),l=s.map((e=>`${e} !== null`)).join(" && ");return s.length&&(o.update=`${l} ? {fields: ${a}, values: [${s.join(", ")}]} : null`),delete o.value,delete o.on,n}},m3="_toggle",g3={defined:e=>"point"===e.type&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+m3,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+N3,r=t.name+m3;return`${r} ? null : ${n}, `+("global"===t.resolve?`${r} ? null : true, `:`${r} ? null : {unit: ${C3(e)}}, `)+`${r} ? ${n} : null`}},y3={defined:e=>void 0!==e.clear&&!1!==e.clear,parse:(e,t)=>{t.clear&&(t.clear=cs(t.clear)?wI(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(p3.defined(t))for(const r of t.project.items){const e=n.findIndex((e=>e.name===MH(`${t.name}_${r.field}`)));-1!==e&&n[e].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function r(e,r){-1!==e&&n[e].on&&n[e].on.push({events:t.clear,update:r})}if("interval"===t.type)for(const i of t.project.items){const e=n.findIndex((e=>e.name===i.signals.visual));if(r(e,"[0, 0]"),-1===e){r(n.findIndex((e=>e.name===i.signals.data)),"null")}}else{let e=n.findIndex((e=>e.name===t.name+N3));r(e,"null"),g3.defined(t)&&(e=n.findIndex((e=>e.name===t.name+m3)),r(e,"false"))}return n}},v3={defined:e=>{const t="global"===e.resolve&&e.bind&&w0(e.bind),n=1===e.project.items.length&&e.project.items[0].field!==b0;return t&&!n&&wX("Legend bindings are only supported for selections over an individual field or encoding channel."),t&&n},parse:(e,t,n)=>{const r=fH(n);if(r.select=cs(r.select)?{type:r.select,toggle:t.toggle}:{...r.select,toggle:t.toggle},P3(t,r),pa(n.select)&&(n.select.on||n.select.clear)){const e='event.item && indexof(event.item.mark.role, "legend") < 0';for(const n of t.events)n.filter=Ra(n.filter??[]),n.filter.includes(e)||n.filter.push(e)}const i=k0(t.bind)?t.bind.legend:"click",o=cs(i)?wI(i,"view"):Ra(i);t.bind={legend:{merge:o}}},topLevelSignals:(e,t,n)=>{const r=t.name,i=k0(t.bind)&&t.bind.legend,o=e=>t=>{const n=fH(t);return n.markname=e,n};for(const a of t.project.items){if(!a.hasLegend)continue;const e=`${MH(a.field)}_legend`,s=`${r}_${e}`;if(0===n.filter((e=>e.name===s)).length){const r=i.merge.map(o(`${e}_symbols`)).concat(i.merge.map(o(`${e}_labels`))).concat(i.merge.map(o(`${e}_entries`)));n.unshift({name:s,...t.init?{}:{value:null},on:[{events:r,update:"isDefined(datum.value) ? datum.value : item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:`!event.item || !datum ? null : ${s}`,force:!0}]})}}return n},signals:(e,t,n)=>{const r=t.name,i=t.project,o=n.find((e=>e.name===r+N3)),a=r+_2,s=i.items.filter((e=>e.hasLegend)).map((e=>MH(`${r}_${MH(e.field)}_legend`))),l=`${s.map((e=>`${e} !== null`)).join(" && ")} ? {fields: ${a}, values: [${s.join(", ")}]} : null`;t.events&&s.length>0?o.on.push({events:s.map((e=>({signal:e}))),update:l}):s.length>0&&(o.update=l,delete o.value,delete o.on);const u=n.find((e=>e.name===r+m3)),c=k0(t.bind)&&t.bind.legend;return u&&(t.events?u.on.push({...u.on[0],events:c}):u.on[0].events=c),n}};const b3="_translate_anchor",x3="_translate_delta",w3={defined:e=>"interval"===e.type&&e.translate,signals:(e,t,n)=>{const r=t.name,i=D2.defined(t),o=r+b3,{x:a,y:s}=t.project.hasChannel;let l=wI(t.translate,"scope");return i||(l=l.map((e=>(e.between[0].markname=r+S2,e)))),n.push({name:o,value:{},on:[{events:l.map((e=>e.between[0])),update:"{x: x(unit), y: y(unit)"+(void 0!==a?`, extent_x: ${i?j2(e,eG):`slice(${a.signals.visual})`}`:"")+(void 0!==s?`, extent_y: ${i?j2(e,tG):`slice(${s.signals.visual})`}`:"")+"}"}]},{name:r+x3,value:{},on:[{events:l,update:`{x: ${o}.x - x(unit), y: ${o}.y - y(unit)}`}]}),void 0!==a&&k3(e,t,a,"width",n),void 0!==s&&k3(e,t,s,"height",n),n}};function k3(e,t,n,r,i){const o=t.name,a=o+b3,s=o+x3,l=n.channel,u=D2.defined(t),c=i.filter((e=>e.name===n.signals[u?"data":"visual"]))[0],f=e.getSizeSignalRef(r).signal,d=e.getScaleComponent(l),h=d&&d.get("type"),p=d&&d.get("reverse"),m=`${a}.extent_${l}`,g=`${u&&d?"log"===h?"panLog":"symlog"===h?"panSymlog":"pow"===h?"panPow":"panLinear":"panLinear"}(${m}, ${`${u?l===eG?p?"":"-":p?"-":"":""}${s}.${l} / ${u?`${f}`:`span(${m})`}`}${u?"pow"===h?`, ${d.get("exponent")??1}`:"symlog"===h?`, ${d.get("constant")??1}`:"":""})`;c.on.push({events:{signal:s},update:u?g:`clampRange(${g}, 0, ${f})`})}const _3="_zoom_anchor",O3="_zoom_delta",E3={defined:e=>"interval"===e.type&&e.zoom,signals:(e,t,n)=>{const r=t.name,i=D2.defined(t),o=r+O3,{x:a,y:s}=t.project.hasChannel,l=vs(e.scaleName(eG)),u=vs(e.scaleName(tG));let c=wI(t.zoom,"scope");return i||(c=c.map((e=>(e.markname=r+S2,e)))),n.push({name:r+_3,on:[{events:c,update:i?"{"+[l?`x: invert(${l}, x(unit))`:"",u?`y: invert(${u}, y(unit))`:""].filter((e=>e)).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:o,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==a&&D3(e,t,a,"width",n),void 0!==s&&D3(e,t,s,"height",n),n}};function D3(e,t,n,r,i){const o=t.name,a=n.channel,s=D2.defined(t),l=i.filter((e=>e.name===n.signals[s?"data":"visual"]))[0],u=e.getSizeSignalRef(r).signal,c=e.getScaleComponent(a),f=c&&c.get("type"),d=s?j2(e,a):l.name,h=o+O3,p=`${s&&c?"log"===f?"zoomLog":"symlog"===f?"zoomSymlog":"pow"===f?"zoomPow":"zoomLinear":"zoomLinear"}(${d}, ${`${o}${_3}.${a}`}, ${h}${s?"pow"===f?`, ${c.get("exponent")??1}`:"symlog"===f?`, ${c.get("constant")??1}`:"":""})`;l.on.push({events:{signal:h},update:s?p:`clampRange(${p}, 0, ${u})`})}const j3="_store",N3="_tuple",S3="_modify",A3="vlSelectionResolve",$3=[P2,M2,E2,g3,p3,D2,v3,y3,w3,E3,h3];function C3(e,t){let{escape:n}=void 0===t?{escape:!0}:t,r=n?vs(e.name):e.name;const i=function(e){let t=e.parent;for(;t&&!g4(t);)t=t.parent;return t}(e);if(i){const{facet:e}=i;for(const t of UG)e[t]&&(r+=` + '__facet_${t}_' + (facet[${vs(i.vgField(t))}])`)}return r}function M3(e){return AH(e.component.selection??{}).reduce(((e,t)=>e||t.project.hasSelectionId),!1)}function P3(e,t){!cs(t.select)&&t.select.on||delete e.events,!cs(t.select)&&t.select.clear||delete e.clear,!cs(t.select)&&t.select.toggle||delete e.toggle}function F3(e){const t=[];return"Identifier"===e.type?[e.name]:"Literal"===e.type?[e.value]:("MemberExpression"===e.type&&(t.push(...F3(e.object)),t.push(...F3(e.property))),t)}function T3(e){return"MemberExpression"===e.object.type?T3(e.object):"datum"===e.object.name}function z3(e){const t=WR(e),n=new Set;return t.visit((e=>{"MemberExpression"===e.type&&T3(e)&&n.add(F3(e).slice(1).join("."))})),n}class R3 extends v2{clone(){return new R3(null,this.model,fH(this.filter))}constructor(e,t,n){super(e),this.model=t,this.filter=n,this.expr=I3(this.model,this.filter,this),this._dependentFields=z3(this.expr)}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function L3(e,t,n,r){void 0===r&&(r="datum");const i=cs(t)?t:t.param,o=MH(i),a=vs(o+j3);let s;try{s=e.getSelectionComponent(o,i)}catch(x9){return`!!${o}`}if(s.project.timeUnit){const t=n??e.component.data.raw,r=s.project.timeUnit.clone();t.parent?r.insertAsParentOf(t):t.parent=r}const l=`${s.project.hasSelectionId?"vlSelectionIdTest(":"vlSelectionTest("}${a}, ${r}${"global"===s.resolve?")":`, ${vs(s.resolve)})`}`,u=`length(data(${a}))`;return!1===t.empty?`${u} && ${l}`:`!${u} || ${l}`}function B3(e,t,n){const r=MH(t),i=n.encoding;let o,a=n.field;try{o=e.getSelectionComponent(r,t)}catch(x9){return r}if(i||a){if(i&&!a){const e=o.project.items.filter((e=>e.channel===i));!e.length||e.length>1?(a=o.project.items[0].field,wX((e.length?"Multiple ":"No ")+`matching ${vs(i)} encoding found for selection ${vs(n.param)}. `+`Using "field": ${vs(a)}.`)):a=e[0].field}}else a=o.project.items[0].field,o.project.items.length>1&&wX(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${vs(a)}.`);return`${o.name}[${vs(BH(a))}]`}function I3(e,t,n){return PH(t,(t=>cs(t)?t:function(e){return e?.param}(t)?L3(e,t,n):KX(t)))}function U3(e,t,n,r){var i,o;e.encode??(e.encode={}),(i=e.encode)[t]??(i[t]={}),(o=e.encode[t]).update??(o.update={}),e.encode[t].update[n]=r}function q3(e,t,n,r){void 0===r&&(r={header:!1});const{disable:i,orient:o,scale:a,labelExpr:s,title:l,zindex:u,...c}=e.combine();if(!i){for(const e in c){const n=jK[e],r=c[e];if(n&&n!==t&&"both"!==n)delete c[e];else if(EK(r)){const{condition:t,...n}=r,i=Ra(t),o=OK[e];if(o){const{vgProp:t,part:r}=o,a=[...i.map((e=>{const{test:t,...n}=e;return{test:I3(null,t),...n}})),n];U3(c,r,t,a),delete c[e]}else if(null===o){const t={signal:i.map((e=>{const{test:t,...n}=e;return`${I3(null,t)} ? ${NY(n)} : `})).join("")+NY(n)};c[e]=t}}else if(yY(r)){const t=OK[e];if(t){const{vgProp:n,part:i}=t;U3(c,i,n,r),delete c[e]}}vH(["labelAlign","labelBaseline"],e)&&null===c[e]&&delete c[e]}if("grid"===t){if(!c.grid)return;if(c.encode){const{grid:e}=c.encode;c.encode={...e?{grid:e}:{}},NH(c.encode)&&delete c.encode}return{scale:a,orient:o,...c,domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:WH(u,0)}}{if(!r.header&&e.mainExtracted)return;if(void 0!==s){let e=s;c.encode?.labels?.update&&yY(c.encode.labels.update.text)&&(e=IH(s,"datum.label",c.encode.labels.update.text.signal)),U3(c,"labels","text",{signal:e})}if(null===c.labelAlign&&delete c.labelAlign,c.encode){for(const t of DK)e.hasAxisPart(t)||delete c.encode[t];NH(c.encode)&&delete c.encode}const t=function(e,t){if(e)return ha(e)&&!gY(e)?e.map((e=>fK(e,t))).join(", "):e}(l,n);return{scale:a,orient:o,grid:!1,...t?{title:t}:{},...c,...!1===n.aria?{aria:!1}:{},zindex:WH(u,0)}}}}function W3(e){const{axes:t}=e.component,n=[];for(const r of jV)if(t[r])for(const i of t[r])if(!i.get("disable")&&!i.get("gridScale")){const t="x"===r?"height":"width",i=e.getSizeSignalRef(t).signal;t!==i&&n.push({name:t,update:i})}return n}function Z3(e,t,n,r){return Object.assign.apply(null,[{},...e.map((e=>{if("axisOrient"===e){const e="x"===n?"bottom":"left",i=t["x"===n?"axisBottom":"axisLeft"]||{},o=t["x"===n?"axisTop":"axisRight"]||{},a=new Set([...SH(i),...SH(o)]),s={};for(const t of a.values())s[t]={signal:`${r.signal} === "${e}" ? ${SY(i[t])} : ${SY(o[t])}`};return s}return t[e]}))])}function H3(e,t){const n=[{}];for(const r of e){let e=t[r]?.style;if(e){e=Ra(e);for(const r of e)n.push(t.style[r])}}return Object.assign.apply(null,n)}function G3(e,t,n,r){void 0===r&&(r={});const i=FY(e,n,t);if(void 0!==i)return{configFrom:"style",configValue:i};for(const o of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(void 0!==r[o]?.[e])return{configFrom:o,configValue:r[o][e]};return{}}const V3={scale:e=>{let{model:t,channel:n}=e;return t.scaleName(n)},format:e=>{let{format:t}=e;return t},formatType:e=>{let{formatType:t}=e;return t},grid:e=>{let{fieldOrDatumDef:t,axis:n,scaleType:r}=e;return n.grid??function(e,t){return!xJ(e)&&WQ(t)&&!lY(t?.bin)&&!uY(t?.bin)}(r,t)},gridScale:e=>{let{model:t,channel:n}=e;return function(e,t){const n="x"===t?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n);return}(t,n)},labelAlign:e=>{let{axis:t,labelAngle:n,orient:r,channel:i}=e;return t.labelAlign||J3(n,r,i)},labelAngle:e=>{let{labelAngle:t}=e;return t},labelBaseline:e=>{let{axis:t,labelAngle:n,orient:r,channel:i}=e;return t.labelBaseline||X3(n,r,i)},labelFlush:e=>{let{axis:t,fieldOrDatumDef:n,channel:r}=e;return t.labelFlush??function(e,t){if("x"===t&&vH(["quantitative","temporal"],e))return!0;return}(n.type,r)},labelOverlap:e=>{let{axis:t,fieldOrDatumDef:n,scaleType:r}=e;return t.labelOverlap??function(e,t,n,r){if(n&&!pa(r)||"nominal"!==e&&"ordinal"!==e)return"log"!==t&&"symlog"!==t||"greedy";return}(n.type,r,WQ(n)&&!!n.timeUnit,WQ(n)?n.sort:void 0)},orient:e=>{let{orient:t}=e;return t},tickCount:e=>{let{channel:t,model:n,axis:r,fieldOrDatumDef:i,scaleType:o}=e;const a="x"===t?"width":"y"===t?"height":void 0,s=a?n.getSizeSignalRef(a):void 0;return r.tickCount??function(e){let{fieldOrDatumDef:t,scaleType:n,size:r,values:i}=e;if(!i&&!xJ(n)&&"log"!==n){if(WQ(t)){if(lY(t.bin))return{signal:`ceil(${r.signal}/10)`};if(t.timeUnit&&vH(["month","hours","day","quarter"],BX(t.timeUnit)?.unit))return}return{signal:`ceil(${r.signal}/40)`}}return}({fieldOrDatumDef:i,scaleType:o,size:s,values:r.values})},tickMinStep:function(e){let{format:t,fieldOrDatumDef:n}=e;if("d"===t)return 1;if(WQ(n)){const{timeUnit:e}=n;if(e){const t=IX(e);if(t)return{signal:t}}}return},title:e=>{let{axis:t,model:n,channel:r}=e;if(void 0!==t.title)return t.title;const i=Q3(n,r);if(void 0!==i)return i;const o=n.typedFieldDef(r),a="x"===r?"x2":"y2",s=n.fieldDef(a);return zY(o?[FQ(o)]:[],WQ(s)?[FQ(s)]:[])},values:e=>{let{axis:t,fieldOrDatumDef:n}=e;return function(e,t){const n=e.values;if(ha(n))return kK(t,n);if(yY(n))return n;return}(t,n)},zindex:e=>{let{axis:t,fieldOrDatumDef:n,mark:r}=e;return t.zindex??function(e,t){if("rect"===e&&oK(t))return 1;return 0}(r,n)}};function Y3(e){return`(((${e.signal} % 360) + 360) % 360)`}function X3(e,t,n,r){if(void 0!==e){if("x"===n){if(yY(e)){const n=Y3(e);return{signal:`(45 < ${n} && ${n} < 135) || (225 < ${n} && ${n} < 315) ? "middle" :(${n} <= 45 || 315 <= ${n}) === ${yY(t)?`(${t.signal} === "top")`:"top"===t} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(yY(t)){const n=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${n} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==("top"===t)?"bottom":"top"}if(yY(e)){const n=Y3(e);return{signal:`${n} <= 45 || 315 <= ${n} || (135 <= ${n} && ${n} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${n} && ${n} <= 135) === ${yY(t)?`(${t.signal} === "left")`:"left"===t} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(yY(t)){const n=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${n} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==("left"===t)?"top":"bottom"}}function J3(e,t,n){if(void 0===e)return;const r="x"===n,i=r?0:90,o=r?"bottom":"left";if(yY(e)){const n=Y3(e);return{signal:`(${i?`(${n} + 90)`:n} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${n} && ${n} < ${180+i}) === ${yY(t)?`(${t.signal} === "${o}")`:t===o} ? "left" : "right"`}}if((e+i)%180==0)return r?null:"center";if(yY(t)){const n=i<e&&e<180+i?"===":"!==";return{signal:`${`${t.signal} ${n} "${o}"`} ? "left" : "right"`}}return(i<e&&e<180+i)==(t===o)?"left":"right"}function Q3(e,t){const n="x"===t?"x2":"y2",r=e.fieldDef(t),i=e.fieldDef(n),o=r?r.title:void 0,a=i?i.title:void 0;return o&&a?RY(o,a):o||(a||(void 0!==o?o:void 0!==a?a:void 0))}class K3 extends v2{clone(){return new K3(null,fH(this.transform))}constructor(e,t){super(e),this.transform=t,this._dependentFields=z3(this.transform.calculate)}static parseAllForSortIndex(e,t){return t.forEachFieldDef(((t,n)=>{if(KQ(t)&&$Q(t.sort)){const{field:r,timeUnit:i}=t,o=t.sort,a=o.map(((e,t)=>`${KX({field:r,timeUnit:i,equal:e})} ? ${t} : `)).join("")+o.length;e=new K3(e,{calculate:a,as:e5(t,n,{forAs:!0})})}})),e}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${gH(this.transform)}`}}function e5(e,t,n){return iK(e,{prefix:t,suffix:"sort_index",...n??{}})}function t5(e,t){return vH(["top","bottom"],t)?"column":vH(["left","right"],t)||"row"===e?"row":"column"}function n5(e,t,n,r){const i="row"===r?n.headerRow:"column"===r?n.headerColumn:n.headerFacet;return WH((t||{})[e],i[e],n.header[e])}function r5(e,t,n,r){const i={};for(const o of e){const e=n5(o,t||{},n,r);void 0!==e&&(i[o]=e)}return i}const i5=["row","column"],o5=["header","footer"];function a5(e,t){const n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:o,titleAngle:a,titleOrient:s}=r5(["titleAnchor","titleAngle","titleOrient"],i.header,r,t),l=t5(t,s),u=YH(a);return{name:`${t}-title`,type:"group",role:`${l}-title`,title:{text:n,..."row"===t?{orient:"left"}:{},style:"guide-title",...l5(u,l),...s5(l,u,o),...m5(r,i,t,m0,h0)}}}function s5(e,t,n){switch(void 0===n&&(n="middle"),n){case"start":return{align:"left"};case"end":return{align:"right"}}const r=J3(t,"row"===e?"left":"top","row"===e?"y":"x");return r?{align:r}:{}}function l5(e,t){const n=X3(e,"row"===t?"left":"top","row"===t?"y":"x",!0);return n?{baseline:n}:{}}function u5(e,t){const n=e.component.layoutHeaders[t],r=[];for(const i of o5)if(n[i])for(const o of n[i]){const a=d5(e,t,i,n,o);null!=a&&r.push(a)}return r}function c5(e,t){const{sort:n}=e;return AQ(n)?{field:iK(n,{expr:"datum"}),order:n.order??"ascending"}:ha(n)?{field:e5(e,t,{expr:"datum"}),order:"ascending"}:{field:iK(e,{expr:"datum"}),order:n??"ascending"}}function f5(e,t,n){const{format:r,formatType:i,labelAngle:o,labelAnchor:a,labelOrient:s,labelExpr:l}=r5(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),u=yQ({fieldOrDatumDef:e,format:r,formatType:i,expr:"parent",config:n}).signal,c=t5(t,s);return{text:{signal:l?IH(IH(l,"datum.label",u),"datum.value",iK(e,{expr:"parent"})):u},..."row"===t?{orient:"left"}:{},style:"guide-label",frame:"group",...l5(o,c),...s5(c,o,a),...m5(n,e,t,g0,p0)}}function d5(e,t,n,r,i){if(i){let o=null;const{facetFieldDef:a}=r,s=e.config?e.config:void 0;if(a&&i.labels){const{labelOrient:e}=r5(["labelOrient"],a.header,s,t);("row"===t&&!vH(["top","bottom"],e)||"column"===t&&!vH(["left","right"],e))&&(o=f5(a,t,s))}const l=g4(e)&&!CQ(e.facet),u=i.axes,c=u?.length>0;if(o||c){const s="row"===t?"height":"width";return{name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`,...r.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:c5(a,t)}:{},...c&&l?{from:{data:e.getName(`facet_domain_${t}`)}}:{},...o?{title:o}:{},...i.sizeSignal?{encode:{update:{[s]:i.sizeSignal}}}:{},...c?{axes:u}:{}}}}return null}const h5={column:{start:0,end:1},row:{start:1,end:0}};function p5(e,t){return h5[t][e]}function m5(e,t,n,r,i){const o={};for(const a of r){if(!i[a])continue;const r=n5(a,t?.header,e,n);void 0!==r&&(o[i[a]]=r)}return o}function g5(e){return[...y5(e,"width"),...y5(e,"height"),...y5(e,"childWidth"),...y5(e,"childHeight")]}function y5(e,t){const n="width"===t?"x":"y",r=e.component.layoutSize.get(t);if(!r||"merged"===r)return[];const i=e.getSizeSignalRef(t).signal;if("step"===r){const t=e.getScaleComponent(n);if(t){const r=t.get("type"),o=t.get("range");if(xJ(r)&&vY(o)){const r=e.scaleName(n);if(g4(e.parent)){if("independent"===e.parent.component.resolve.scale[n])return[v5(r,o)]}return[v5(r,o),{name:i,update:b5(r,t,`domain('${r}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}if("container"==r){const t=i.endsWith("width"),n=t?"containerSize()[0]":"containerSize()[1]",r=`isFinite(${n}) ? ${n} : ${C0(e.config.view,t?"width":"height")}`;return[{name:i,init:r,on:[{update:r,events:"window:resize"}]}]}return[{name:i,value:r}]}function v5(e,t){const n=`${e}_step`;return yY(t.step)?{name:n,update:t.step.signal}:{name:n,value:t.step}}function b5(e,t,n){const r=t.get("type"),i=t.get("padding"),o=WH(t.get("paddingOuter"),i);let a=t.get("paddingInner");return a="band"===r?void 0!==a?a:i:1,`bandspace(${n}, ${SY(a)}, ${SY(o)}) * ${e}_step`}function x5(e){return"childWidth"===e?"width":"childHeight"===e?"height":e}function w5(e,t){return SH(e).reduce(((n,r)=>{const i=e[r];return{...n,...F2(t,i,r,(e=>DY(e.value)))}}),{})}function k5(e,t){if(g4(t))return"theta"===e?"independent":"shared";if(v4(t))return"shared";if(y4(t))return NV(e)||"theta"===e||"radius"===e?"independent":"shared";throw new Error("invalid model type for resolve")}function _5(e,t){const n=e.scale[t],r=NV(t)?"axis":"legend";return"independent"===n?("shared"===e[r][t]&&wX(function(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}(t)),"independent"):e[r][t]||"shared"}const O5=SH({aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1,disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1});class E5 extends J1{}const D5={symbols:function(e,t){let{fieldOrDatumDef:n,model:r,channel:i,legendCmpt:o,legendType:a}=t;if("symbol"!==a)return;const{markDef:s,encoding:l,config:u,mark:c}=r,f=s.filled&&"trail"!==c;let d={...AY({},r,eQ),...Z2(r,{filled:f})};const h=o.get("symbolOpacity")??u.legend.symbolOpacity,p=o.get("symbolFillColor")??u.legend.symbolFillColor,m=o.get("symbolStrokeColor")??u.legend.symbolStrokeColor,g=void 0===h?j5(l.opacity)??s.opacity:void 0;if(d.fill)if("fill"===i||f&&i===pG)delete d.fill;else if(d.fill.field)p?delete d.fill:(d.fill=DY(u.legend.symbolBaseFillColor??"black"),d.fillOpacity=DY(g??1));else if(ha(d.fill)){const e=N5(l.fill??l.color)??s.fill??(f&&s.color);e&&(d.fill=DY(e))}if(d.stroke)if("stroke"===i||!f&&i===pG)delete d.stroke;else if(d.stroke.field||m)delete d.stroke;else if(ha(d.stroke)){const e=WH(N5(l.stroke||l.color),s.stroke,f?s.color:void 0);e&&(d.stroke={value:e})}if(i!==xG){const e=WQ(n)&&A5(r,o,n);e?d.opacity=[{test:e,...DY(g??1)},DY(u.legend.unselectedOpacity)]:g&&(d.opacity=DY(g))}return d={...d,...e},NH(d)?void 0:d},gradient:function(e,t){let{model:n,legendType:r,legendCmpt:i}=t;if("gradient"!==r)return;const{config:o,markDef:a,encoding:s}=n;let l={};const u=void 0===(i.get("gradientOpacity")??o.legend.gradientOpacity)?j5(s.opacity)||a.opacity:void 0;u&&(l.opacity=DY(u));return l={...l,...e},NH(l)?void 0:l},labels:function(e,t){let{fieldOrDatumDef:n,model:r,channel:i,legendCmpt:o}=t;const a=r.legend(i)||{},s=r.config,l=WQ(n)?A5(r,o,n):void 0,u=l?[{test:l,value:1},{value:s.legend.unselectedOpacity}]:void 0,{format:c,formatType:f}=a;let d;pQ(f)?d=bQ({fieldOrDatumDef:n,field:"datum.value",format:c,formatType:f,config:s}):void 0===c&&void 0===f&&s.customFormatTypes&&("quantitative"===n.type&&s.numberFormatType?d=bQ({fieldOrDatumDef:n,field:"datum.value",format:s.numberFormat,formatType:s.numberFormatType,config:s}):"temporal"===n.type&&s.timeFormatType&&WQ(n)&&void 0===n.timeUnit&&(d=bQ({fieldOrDatumDef:n,field:"datum.value",format:s.timeFormat,formatType:s.timeFormatType,config:s})));const h={...u?{opacity:u}:{},...d?{text:d}:{},...e};return NH(h)?void 0:h},entries:function(e,t){let{legendCmpt:n}=t;const r=n.get("selections");return r?.length?{...e,fill:{value:"transparent"}}:e}};function j5(e){return S5(e,((e,t)=>Math.max(e,t.value)))}function N5(e){return S5(e,((e,t)=>WH(e,t.value)))}function S5(e,t){return function(e){const t=e?.condition;return!!t&&(ha(t)||QQ(t))}(e)?Ra(e.condition).reduce(t,e.value):QQ(e)?e.value:void 0}function A5(e,t,n){const r=t.get("selections");if(!r?.length)return;const i=vs(n.field);return r.map((e=>`(!length(data(${vs(MH(e)+j3)})) || (${e}[${i}] && indexof(${e}[${i}], datum.value) >= 0))`)).join(" || ")}const $5={direction:e=>{let{direction:t}=e;return t},format:e=>{let{fieldOrDatumDef:t,legend:n,config:r}=e;const{format:i,formatType:o}=n;return xQ(t,t.type,i,o,r,!1)},formatType:e=>{let{legend:t,fieldOrDatumDef:n,scaleType:r}=e;const{formatType:i}=t;return wQ(i,n,r)},gradientLength:e=>{const{legend:t,legendConfig:n}=e;return t.gradientLength??n.gradientLength??function(e){let{legendConfig:t,model:n,direction:r,orient:i,scaleType:o}=e;const{gradientHorizontalMaxLength:a,gradientHorizontalMinLength:s,gradientVerticalMaxLength:l,gradientVerticalMinLength:u}=t;if(kJ(o))return"horizontal"===r?"top"===i||"bottom"===i?P5(n,"width",s,a):s:P5(n,"height",u,l);return}(e)},labelOverlap:e=>{let{legend:t,legendConfig:n,scaleType:r}=e;return t.labelOverlap??n.labelOverlap??function(e){if(vH(["quantile","threshold","log","symlog"],e))return"greedy";return}(r)},symbolType:e=>{let{legend:t,markDef:n,channel:r,encoding:i}=e;return t.symbolType??function(e,t,n,r){if("shape"!==t){const e=N5(n)??r;if(e)return e}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}(n.type,r,i.shape,n.shape)},title:e=>{let{fieldOrDatumDef:t,config:n}=e;return uK(t,n,{allowDisabling:!0})},type:e=>{let{legendType:t,scaleType:n,channel:r}=e;if(BG(r)&&kJ(n)){if("gradient"===t)return}else if("symbol"===t)return;return t},values:e=>{let{fieldOrDatumDef:t,legend:n}=e;return function(e,t){const n=e.values;if(ha(n))return kK(t,n);if(yY(n))return n;return}(n,t)}};function C5(e){const{legend:t}=e;return WH(t.type,function(e){let{channel:t,timeUnit:n,scaleType:r}=e;if(BG(t)){if(vH(["quarter","month","day"],n))return"symbol";if(kJ(r))return"gradient"}return"symbol"}(e))}function M5(e){let{legendConfig:t,legendType:n,orient:r,legend:i}=e;return i.direction??t[n?"gradientDirection":"symbolDirection"]??function(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===t?"horizontal":void 0}}(r,n)}function P5(e,t,n,r){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${r})`}}function F5(e){const t=m4(e)?function(e){const{encoding:t}=e,n={};for(const r of[pG,...v0]){const i=pK(t[r]);i&&e.getScaleComponent(r)&&(r===yG&&WQ(i)&&i.type===lJ||(n[r]=z5(e,r)))}return n}(e):function(e){const{legends:t,resolve:n}=e.component;for(const r of e.children){F5(r);for(const i of SH(r.component.legends))n.legend[i]=_5(e.component.resolve,i),"shared"===n.legend[i]&&(t[i]=R5(t[i],r.component.legends[i]),t[i]||(n.legend[i]="independent",delete t[i]))}for(const r of SH(t))for(const t of e.children)t.component.legends[r]&&"shared"===n.legend[r]&&delete t.component.legends[r];return t}(e);return e.component.legends=t,t}function T5(e,t,n,r){switch(t){case"disable":return void 0!==n;case"values":return!!n?.values;case"title":if("title"===t&&e===r?.title)return!0}return e===(n||{})[t]}function z5(e,t){let n=e.legend(t);const{markDef:r,encoding:i,config:o}=e,a=o.legend,s=new E5({},function(e,t){const n=e.scaleName(t);if("trail"===e.mark){if("color"===t)return{stroke:n};if("size"===t)return{strokeWidth:n}}return"color"===t?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}(e,t));!function(e,t,n){const r=e.fieldDef(t)?.field;for(const i of AH(e.component.selection??{})){const e=i.project.hasField[r]??i.project.hasChannel[t];if(e&&v3.defined(i)){const t=n.get("selections")??[];t.push(i.name),n.set("selections",t,!1),e.hasLegend=!0}}}(e,t,s);const l=void 0!==n?!n:a.disable;if(s.set("disable",l,void 0!==n),l)return s;n=n||{};const u=e.getScaleComponent(t).get("type"),c=pK(i[t]),f=WQ(c)?BX(c.timeUnit)?.unit:void 0,d=n.orient||o.legend.orient||"right",h=C5({legend:n,channel:t,timeUnit:f,scaleType:u}),p={legend:n,channel:t,model:e,markDef:r,encoding:i,fieldOrDatumDef:c,legendConfig:a,config:o,scaleType:u,orient:d,legendType:h,direction:M5({legend:n,legendType:h,orient:d,legendConfig:a})};for(const b of O5){if("gradient"===h&&b.startsWith("symbol")||"symbol"===h&&b.startsWith("gradient"))continue;const r=b in $5?$5[b](p):n[b];if(void 0!==r){const i=T5(r,b,n,e.fieldDef(t));(i||void 0===o.legend[b])&&s.set(b,r,i)}}const m=n?.encoding??{},g=s.get("selections"),y={},v={fieldOrDatumDef:c,model:e,channel:t,legendCmpt:s,legendType:h};for(const b of["labels","legend","title","symbols","gradient","entries"]){const t=w5(m[b]??{},e),n=b in D5?D5[b](t,v):t;void 0===n||NH(n)||(y[b]={...g?.length&&WQ(c)?{name:`${MH(c.field)}_legend_${b}`}:{},...g?.length?{interactive:!!g}:{},update:n})}return NH(y)||s.set("encode",y,!!n?.encoding),s}function R5(e,t){if(!e)return t.clone();const n=e.getWithExplicit("orient"),r=t.getWithExplicit("orient");if(n.explicit&&r.explicit&&n.value!==r.value)return;let i=!1;for(const o of O5){const n=n2(e.getWithExplicit(o),t.getWithExplicit(o),o,"legend",((e,t)=>{switch(o){case"symbolType":return L5(e,t);case"title":return LY(e,t);case"type":return i=!0,K1("symbol")}return t2(e,t,o,"legend")}));e.setWithExplicit(o,n)}return i&&(e.implicit?.encode?.gradient&&FH(e.implicit,["encode","gradient"]),e.explicit?.encode?.gradient&&FH(e.explicit,["encode","gradient"])),e}function L5(e,t){return"circle"===t.value?t:e}function B5(e){const t=e.component.legends,n={};for(const i of SH(t)){const r=e.getScaleComponent(i),o=mH(r.get("domains"));if(n[o])for(const e of n[o]){R5(e,t[i])||n[o].push(t[i])}else n[o]=[t[i].clone()]}const r=AH(n).flat().map((t=>function(e,t){const{disable:n,labelExpr:r,selections:i,...o}=e.combine();if(n)return;!1===t.aria&&null==o.aria&&(o.aria=!1);if(o.encode?.symbols){const e=o.encode.symbols.update;!e.fill||"transparent"===e.fill.value||e.stroke||o.stroke||(e.stroke={value:"transparent"});for(const t of v0)o[t]&&delete e[t]}o.title||delete o.title;if(void 0!==r){let e=r;o.encode?.labels?.update&&yY(o.encode.labels.update.text)&&(e=IH(r,"datum.label",o.encode.labels.update.text.signal)),function(e,t,n,r){var i,o;e.encode??(e.encode={}),(i=e.encode)[t]??(i[t]={}),(o=e.encode[t]).update??(o.update={}),e.encode[t].update[n]=r}(o,"labels","text",{signal:e})}return o}(t,e.config))).filter((e=>void 0!==e));return r}function I5(e){return v4(e)||y4(e)?function(e){return e.children.reduce(((e,t)=>e.concat(t.assembleProjections())),U5(e))}(e):U5(e)}function U5(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:r}=n;if(t.data){const i={signal:`[${t.size.map((e=>e.signal)).join(", ")}]`},o=t.data.reduce(((t,n)=>{const r=yY(n)?n.signal:`data('${e.lookupDataSource(n)}')`;return vH(t,r)||t.push(r),t}),[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[{name:r,size:i,fit:{signal:o.length>1?`[${o.join(", ")}]`:o[0]},...n}]}return[{name:r,translate:{signal:"[width / 2, height / 2]"},...n}]}const q5=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class W5 extends J1{constructor(e,t,n,r){super({...t},{name:e}),this.specifiedProjection=t,this.size=n,this.data=r,this.merged=!1}get isFit(){return!!this.data}}function Z5(e){e.component.projection=m4(e)?function(e){if(e.hasProjection){const t=pY(e.specifiedProjection),n=!(t&&(null!=t.scale||null!=t.translate)),r=n?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,i=n?function(e){const t=[],{encoding:n}=e;for(const r of[[fG,cG],[hG,dG]])(pK(n[r[0]])||pK(n[r[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});e.channelHasField(yG)&&e.typedFieldDef(yG).type===lJ&&t.push({signal:e.getName(`geojson_${t.length}`)});0===t.length&&t.push(e.requestDataName(f2.Main));return t}(e):void 0,o=new W5(e.projectionName(!0),{...pY(e.config.projection)??{},...t??{}},r,i);return o.get("type")||o.set("type","equalEarth",!1),o}return}(e):function(e){if(0===e.children.length)return;let t;for(const r of e.children)Z5(r);const n=xH(e.children,(e=>{const n=e.component.projection;if(n){if(t){const e=function(e,t){const n=xH(q5,(n=>!Ka(e.explicit,n)&&!Ka(t.explicit,n)||!!(Ka(e.explicit,n)&&Ka(t.explicit,n)&&cH(e.get(n),t.get(n))))),r=cH(e.size,t.size);if(r){if(n)return e;if(cH(e.explicit,{}))return t;if(cH(t.explicit,{}))return e}return null}(t,n);return e&&(t=e),!!e}return t=n,!0}return!0}));if(t&&n){const n=e.projectionName(!0),r=new W5(n,t.specifiedProjection,t.size,fH(t.data));for(const t of e.children){const e=t.component.projection;e&&(e.isFit&&r.data.push(...t.component.projection.data),t.renameProjection(e.get("name"),n),e.merged=!0)}return r}return}(e)}function H5(e,t,n,r){if(_K(t,n)){const i=m4(e)?e.axis(n)??e.legend(n)??{}:{},o=iK(t,{expr:"datum"}),a=iK(t,{expr:"datum",binSuffix:"end"});return{formulaAs:iK(t,{binSuffix:"range",forAs:!0}),formula:EQ(o,a,i.format,i.formatType,r)}}return{}}function G5(e,t){return`${sY(e)}_${t}`}function V5(e,t,n){const r=G5(vK(n,void 0)??{},t);return e.getName(`${r}_bins`)}function Y5(e,t,n){let r,i;r=function(e){return"as"in e}(e)?cs(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:[iK(e,{forAs:!0}),iK(e,{binSuffix:"end",forAs:!0})];const o={...vK(t,void 0)},a=G5(o,e.field),{signal:s,extentSignal:l}=function(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}(n,a);if(fY(o.extent)){const e=o.extent;i=B3(n,e.param,e),delete o.extent}return{key:a,binComponent:{bin:o,field:e.field,as:[r],...s?{signal:s}:{},...l?{extentSignal:l}:{},...i?{span:i}:{}}}}class X5 extends v2{clone(){return new X5(null,fH(this.bins))}constructor(e,t){super(e),this.bins=t}static makeFromEncoding(e,t){const n=t.reduceFieldDef(((e,n,r)=>{if(JQ(n)&&lY(n.bin)){const{key:i,binComponent:o}=Y5(n,n.bin,t);e[i]={...o,...e[i],...H5(t,n,r,t.config)}}return e}),{});return NH(n)?null:new X5(e,n)}static makeFromTransform(e,t,n){const{key:r,binComponent:i}=Y5(t,t.bin,n);return new X5(e,{[r]:i})}merge(e,t){for(const n of SH(e.bins))n in this.bins?(t(e.bins[n].signal,this.bins[n].signal),this.bins[n].as=_H([...this.bins[n].as,...e.bins[n].as],gH)):this.bins[n]=e.bins[n];for(const n of e.children)e.removeChild(n),n.parent=this;e.remove()}producedFields(){return new Set(AH(this.bins).map((e=>e.as)).flat(2))}dependentFields(){return new Set(AH(this.bins).map((e=>e.field)))}hash(){return`Bin ${gH(this.bins)}`}assemble(){return AH(this.bins).flatMap((e=>{const t=[],[n,...r]=e.as,{extent:i,...o}=e.bin,a={type:"bin",field:BH(e.field),as:n,signal:e.signal,...fY(i)?{extent:null}:{extent:i},...e.span?{span:{signal:`span(${e.span})`}}:{},...o};!i&&e.extentSignal&&(t.push({type:"extent",field:BH(e.field),signal:e.extentSignal}),a.extent={signal:e.extentSignal}),t.push(a);for(const s of r)for(let e=0;e<2;e++)t.push({type:"formula",expr:iK({field:n[e]},{expr:"datum"}),as:s[e]});return e.formula&&t.push({type:"formula",expr:e.formula,as:e.formulaAs}),t}))}}function J5(e,t,n,r){const i=m4(r)?r.encoding[iV(t)]:void 0;if(JQ(n)&&m4(r)&&LQ(n,i,r.markDef,r.config))e.add(iK(n,{})),e.add(iK(n,{suffix:"end"})),n.bin&&_K(n,t)&&e.add(iK(n,{binSuffix:"range"}));else if(zG(t)){const n=TG(t);e.add(r.getName(n))}else e.add(iK(n));return KQ(n)&&function(e){return pa(e)&&"field"in e}(n.scale?.range)&&e.add(n.scale.range.field),e}class Q5 extends v2{clone(){return new Q5(null,new Set(this.dimensions),fH(this.measures))}constructor(e,t,n){super(e),this.dimensions=t,this.measures=n}get groupBy(){return this.dimensions}static makeFromEncoding(e,t){let n=!1;t.forEachFieldDef((e=>{e.aggregate&&(n=!0)}));const r={},i=new Set;return n?(t.forEachFieldDef(((e,n)=>{const{aggregate:o,field:a}=e;if(o)if("count"===o)r["*"]??(r["*"]={}),r["*"].count=new Set([iK(e,{forAs:!0})]);else{if(eY(o)||tY(o)){const e=eY(o)?"argmin":"argmax",t=o[e];r[t]??(r[t]={}),r[t][e]=new Set([iK({op:e,field:t},{forAs:!0})])}else r[a]??(r[a]={}),r[a][o]=new Set([iK(e,{forAs:!0})]);HV(n)&&"unaggregated"===t.scaleDomain(n)&&(r[a]??(r[a]={}),r[a].min=new Set([iK({field:a,aggregate:"min"},{forAs:!0})]),r[a].max=new Set([iK({field:a,aggregate:"max"},{forAs:!0})]))}else J5(i,n,e,t)})),i.size+SH(r).length===0?null:new Q5(e,i,r)):null}static makeFromTransform(e,t){const n=new Set,r={};for(const i of t.aggregate){const{op:e,field:t,as:n}=i;e&&("count"===e?(r["*"]??(r["*"]={}),r["*"].count=new Set([n||iK(i,{forAs:!0})])):(r[t]??(r[t]={}),r[t][e]=new Set([n||iK(i,{forAs:!0})])))}for(const i of t.groupby??[])n.add(i);return n.size+SH(r).length===0?null:new Q5(e,n,r)}merge(e){return OH(this.dimensions,e.dimensions)?(function(e,t){for(const n of SH(t)){const r=t[n];for(const t of SH(r))n in e?e[n][t]=new Set([...e[n][t]??[],...r[t]]):e[n]={[t]:r[t]}}}(this.measures,e.measures),!0):(function(){xX.debug(...arguments)}("different dimensions, cannot merge"),!1)}addDimensions(e){e.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...SH(this.measures)])}producedFields(){const e=new Set;for(const t of SH(this.measures))for(const n of SH(this.measures[t])){const r=this.measures[t][n];0===r.size?e.add(`${n}_${t}`):r.forEach(e.add,e)}return e}hash(){return`Aggregate ${gH({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const e=[],t=[],n=[];for(const r of SH(this.measures))for(const i of SH(this.measures[r]))for(const o of this.measures[r][i])n.push(o),e.push(i),t.push("*"===r?null:BH(r));return{type:"aggregate",groupby:[...this.dimensions].map(BH),ops:e,fields:t,as:n}}}class K5 extends v2{constructor(e,t,n,r){super(e),this.model=t,this.name=n,this.data=r;for(const i of UG){const e=t.facet[i];if(e){const{bin:n,sort:r}=e;this[i]={name:t.getName(`${i}_domain`),fields:[iK(e),...lY(n)?[iK(e,{binSuffix:"end"})]:[]],...AQ(r)?{sortField:r}:ha(r)?{sortIndexField:e5(e,i)}:{}}}}this.childModel=t.child}hash(){let e="Facet";for(const t of UG)this[t]&&(e+=` ${t.charAt(0)}:${gH(this[t])}`);return e}get fields(){const e=[];for(const t of UG)this[t]?.fields&&e.push(...this[t].fields);return e}dependentFields(){const e=new Set(this.fields);for(const t of UG)this[t]&&(this[t].sortField&&e.add(this[t].sortField.field),this[t].sortIndexField&&e.add(this[t].sortIndexField));return e}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const e={};for(const t of jV){const n=this.childModel.component.scales[t];if(n&&!n.merged){const r=n.get("type"),i=n.get("range");if(xJ(r)&&vY(i)){const n=H6(G6(this.childModel,t));n?e[t]=n:wX(ZY(t))}}}return e}assembleRowColumnHeaderData(e,t,n){const r={row:"y",column:"x",facet:void 0}[e],i=[],o=[],a=[];r&&n&&n[r]&&(t?(i.push(`distinct_${n[r]}`),o.push("max")):(i.push(n[r]),o.push("distinct")),a.push(`distinct_${n[r]}`));const{sortField:s,sortIndexField:l}=this[e];if(s){const{op:e=DQ,field:t}=s;i.push(t),o.push(e),a.push(iK(s,{forAs:!0}))}else l&&(i.push(l),o.push("max"),a.push(l));return{name:this[e].name,source:t??this.data,transform:[{type:"aggregate",groupby:this[e].fields,...i.length?{fields:i,ops:o,as:a}:{}}]}}assembleFacetHeaderData(e){const{columns:t}=this.model.layout,{layoutHeaders:n}=this.model.component,r=[],i={};for(const s of i5){for(const e of o5){const t=(n[s]&&n[s][e])??[];for(const e of t)if(e.axes?.length>0){i[s]=!0;break}}if(i[s]){const e=`length(data("${this.facet.name}"))`,n="row"===s?t?{signal:`ceil(${e} / ${t})`}:1:t?{signal:`min(${e}, ${t})`}:{signal:e};r.push({name:`${this.facet.name}_${s}`,transform:[{type:"sequence",start:0,stop:n}]})}}const{row:o,column:a}=i;return(o||a)&&r.unshift(this.assembleRowColumnHeaderData("facet",null,e)),r}assemble(){const e=[];let t=null;const n=this.getChildIndependentFieldsWithStep(),{column:r,row:i,facet:o}=this;if(r&&i&&(n.x||n.y)){t=`cross_${this.column.name}_${this.row.name}`;const r=[].concat(n.x??[],n.y??[]),i=r.map((()=>"distinct"));e.push({name:t,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:r,ops:i}]})}for(const a of[QH,JH])this[a]&&e.push(this.assembleRowColumnHeaderData(a,t,n));if(o){const t=this.assembleFacetHeaderData(n);t&&e.push(...t)}return e}}function e6(e){return e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e}function t6(e){const t={};return lH(e.filter,(e=>{if(JX(e)){let n=null;WX(e)?n=OY(e.equal):HX(e)?n=OY(e.lte):ZX(e)?n=OY(e.lt):GX(e)?n=OY(e.gt):VX(e)?n=OY(e.gte):YX(e)?n=e.range[0]:XX(e)&&(n=(e.oneOf??e.in)[0]),n&&(kX(n)?t[e.field]="date":ls(n)?t[e.field]="number":cs(n)&&(t[e.field]="string")),e.timeUnit&&(t[e.field]="date")}})),t}function n6(e){const t={};function n(e){var n;xK(e)?t[e.field]="date":"quantitative"===e.type&&(cs(n=e.aggregate)&&vH(["min","max"],n))?t[e.field]="number":qH(e.field)>1?e.field in t||(t[e.field]="flatten"):KQ(e)&&AQ(e.sort)&&qH(e.sort.field)>1&&(e.sort.field in t||(t[e.sort.field]="flatten"))}if((m4(e)||g4(e))&&e.forEachFieldDef(((t,r)=>{if(JQ(t))n(t);else{const i=nV(r),o=e.fieldDef(i);n({...t,type:o.type})}})),m4(e)){const{mark:n,markDef:r,encoding:i}=e;if(XJ(n)&&!e.encoding.order){const e=i["horizontal"===r.orient?"y":"x"];WQ(e)&&"quantitative"===e.type&&!(e.field in t)&&(t[e.field]="number")}}return t}class r6 extends v2{clone(){return new r6(null,fH(this._parse))}constructor(e,t){super(e),this._parse=t}hash(){return`Parse ${gH(this._parse)}`}static makeExplicit(e,t,n){let r={};const i=t.data;return!s2(i)&&i?.format?.parse&&(r=i.format.parse),this.makeWithAncestors(e,r,{},n)}static makeWithAncestors(e,t,n,r){for(const a of SH(n)){const e=r.getWithExplicit(a);void 0!==e.value&&(e.explicit||e.value===n[a]||"derived"===e.value||"flatten"===n[a]?delete n[a]:wX(JY(a,n[a],e.value)))}for(const a of SH(t)){const e=r.get(a);void 0!==e&&(e===t[a]?delete t[a]:wX(JY(a,t[a],e)))}const i=new J1(t,n);r.copyAll(i);const o={};for(const a of SH(i.combine())){const e=i.get(a);null!==e&&(o[a]=e)}return 0===SH(o).length||r.parseNothing?null:new r6(e,o)}get parse(){return this._parse}merge(e){this._parse={...this._parse,...e.parse},e.remove()}assembleFormatParse(){const e={};for(const t of SH(this._parse)){const n=this._parse[t];1===qH(t)&&(e[t]=n)}return e}producedFields(){return new Set(SH(this._parse))}dependentFields(){return new Set(SH(this._parse))}assembleTransforms(e){return void 0===e&&(e=!1),SH(this._parse).filter((t=>!e||qH(t)>1)).map((e=>{const t=function(e,t){const n=zH(e);if("number"===t)return`toNumber(${n})`;if("boolean"===t)return`toBoolean(${n})`;if("string"===t)return`toString(${n})`;if("date"===t)return`toDate(${n})`;if("flatten"===t)return n;if(t.startsWith("date:"))return`timeParse(${n},'${e6(t.slice(5,t.length))}')`;if(t.startsWith("utc:"))return`utcParse(${n},'${e6(t.slice(4,t.length))}')`;return wX(`Unrecognized parse "${t}".`),null}(e,this._parse[e]);if(!t)return null;return{type:"formula",expr:t,as:UH(e)}})).filter((e=>null!==e))}}class i6 extends v2{clone(){return new i6(null)}constructor(e){super(e)}dependentFields(){return new Set}producedFields(){return new Set([b0])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:b0}}}class o6 extends v2{clone(){return new o6(null,this.params)}constructor(e,t){super(e),this.params=t}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${gH(this.params)}`}assemble(){return{type:"graticule",...!0===this.params?{}:this.params}}}class a6 extends v2{clone(){return new a6(null,this.params)}constructor(e,t){super(e),this.params=t}dependentFields(){return new Set}producedFields(){return new Set([this.params.as??"data"])}hash(){return`Hash ${gH(this.params)}`}assemble(){return{type:"sequence",...this.params}}}class s6 extends v2{constructor(e){let t;if(super(null),e??(e={name:"source"}),s2(e)||(t=e.format?{...pH(e.format,["parse"])}:{}),o2(e))this._data={values:e.values};else if(i2(e)){if(this._data={url:e.url},!t.type){let n=/(?:\.([^.]+))?$/.exec(e.url)[1];vH(["json","csv","tsv","dsv","topojson"],n)||(n="json"),t.type=n}}else u2(e)?this._data={values:[{type:"Sphere"}]}:(a2(e)||s2(e))&&(this._data={});this._generator=s2(e),e.name&&(this._name=e.name),t&&!NH(t)&&(this._data.format=t)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(e){this._name=e}set parent(e){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return{name:this._name,...this._data,transform:[]}}}var l6,u6=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},c6=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};function f6(e){return e instanceof s6||e instanceof o6||e instanceof a6}class d6{constructor(){l6.set(this,void 0),u6(this,l6,!1,"f")}setModified(){u6(this,l6,!0,"f")}get modifiedFlag(){return c6(this,l6,"f")}}l6=new WeakMap;class h6 extends d6{getNodeDepths(e,t,n){n.set(e,t);for(const r of e.children)this.getNodeDepths(r,t+1,n);return n}optimize(e){const t=[...this.getNodeDepths(e,0,new Map).entries()].sort(((e,t)=>t[1]-e[1]));for(const n of t)this.run(n[0]);return this.modifiedFlag}}class p6 extends d6{optimize(e){this.run(e);for(const t of e.children)this.optimize(t);return this.modifiedFlag}}class m6 extends p6{mergeNodes(e,t){const n=t.shift();for(const r of t)e.removeChild(r),r.parent=n,r.remove()}run(e){const t=e.children.map((e=>e.hash())),n={};for(let r=0;r<t.length;r++)void 0===n[t[r]]?n[t[r]]=[e.children[r]]:n[t[r]].push(e.children[r]);for(const r of SH(n))n[r].length>1&&(this.setModified(),this.mergeNodes(e,n[r]))}}class g6 extends p6{constructor(e){super(),this.requiresSelectionId=e&&M3(e)}run(e){e instanceof i6&&(this.requiresSelectionId&&(f6(e.parent)||e.parent instanceof Q5||e.parent instanceof r6)||(this.setModified(),e.remove()))}}class y6 extends d6{optimize(e){return this.run(e,new Set),this.modifiedFlag}run(e,t){let n=new Set;e instanceof k2&&(n=e.producedFields(),EH(n,t)&&(this.setModified(),e.removeFormulas(t),0===e.producedFields.length&&e.remove()));for(const r of e.children)this.run(r,new Set([...t,...n]))}}class v6 extends p6{constructor(){super()}run(e){e instanceof b2&&!e.isRequired()&&(this.setModified(),e.remove())}}class b6 extends h6{run(e){if(!(f6(e)||e.numChildren()>1))for(const t of e.children)if(t instanceof r6)if(e instanceof r6)this.setModified(),e.merge(t);else{if(jH(e.producedFields(),t.dependentFields()))continue;this.setModified(),t.swapWithParent()}}}class x6 extends h6{run(e){const t=[...e.children],n=e.children.filter((e=>e instanceof r6));if(e.numChildren()>1&&n.length>=1){const r={},i=new Set;for(const e of n){const t=e.parse;for(const e of SH(t))e in r?r[e]!==t[e]&&i.add(e):r[e]=t[e]}for(const e of i)delete r[e];if(!NH(r)){this.setModified();const n=new r6(e,r);for(const i of t){if(i instanceof r6)for(const e of SH(r))delete i.parse[e];e.removeChild(i),i.parent=n,i instanceof r6&&0===SH(i.parse).length&&i.remove()}}}}}class w6 extends h6{run(e){e instanceof b2||e.numChildren()>0||e instanceof K5||e instanceof s6||(this.setModified(),e.remove())}}class k6 extends h6{run(e){const t=e.children.filter((e=>e instanceof k2)),n=t.pop();for(const r of t)this.setModified(),n.merge(r)}}class _6 extends h6{run(e){const t=e.children.filter((e=>e instanceof Q5)),n={};for(const r of t){const e=gH(r.groupBy);e in n||(n[e]=[]),n[e].push(r)}for(const r of SH(n)){const t=n[r];if(t.length>1){const n=t.pop();for(const r of t)n.merge(r)&&(e.removeChild(r),r.parent=n,r.remove(),this.setModified())}}}}class O6 extends h6{constructor(e){super(),this.model=e}run(e){const t=!(f6(e)||e instanceof R3||e instanceof r6||e instanceof i6),n=[],r=[];for(const i of e.children)i instanceof X5&&(t&&!jH(e.producedFields(),i.dependentFields())?n.push(i):r.push(i));if(n.length>0){const t=n.pop();for(const e of n)t.merge(e,this.model.renameSignal.bind(this.model));this.setModified(),e instanceof X5?e.merge(t,this.model.renameSignal.bind(this.model)):t.swapWithParent()}if(r.length>1){const e=r.pop();for(const t of r)e.merge(t,this.model.renameSignal.bind(this.model));this.setModified()}}}class E6 extends h6{run(e){const t=[...e.children];if(!bH(t,(e=>e instanceof b2))||e.numChildren()<=1)return;const n=[];let r;for(const i of t)if(i instanceof b2){let t=i;for(;1===t.numChildren();){const[e]=t.children;if(!(e instanceof b2))break;t=e}n.push(...t.children),r?(e.removeChild(i),i.parent=r.parent,r.parent.removeChild(r),r.parent=t,this.setModified()):r=t}else n.push(i);if(n.length){this.setModified();for(const e of n)e.parent.removeChild(e),e.parent=r}}}class D6 extends v2{clone(){return new D6(null,fH(this.transform))}constructor(e,t){super(e),this.transform=t}addDimensions(e){this.transform.groupby=_H(this.transform.groupby.concat(e),(e=>e))}dependentFields(){const e=new Set;return this.transform.groupby&&this.transform.groupby.forEach(e.add,e),this.transform.joinaggregate.map((e=>e.field)).filter((e=>void 0!==e)).forEach(e.add,e),e}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(e){return e.as??iK(e)}hash(){return`JoinAggregateTransform ${gH(this.transform)}`}assemble(){const e=[],t=[],n=[];for(const i of this.transform.joinaggregate)t.push(i.op),n.push(this.getDefaultName(i)),e.push(void 0===i.field?null:i.field);const r=this.transform.groupby;return{type:"joinaggregate",as:n,ops:t,fields:e,...void 0!==r?{groupby:r}:{}}}}class j6 extends v2{clone(){return new j6(null,fH(this._stack))}constructor(e,t){super(e),this._stack=t}static makeFromTransform(e,t){const{stack:n,groupby:r,as:i,offset:o="zero"}=t,a=[],s=[];if(void 0!==t.sort)for(const c of t.sort)a.push(c.field),s.push(WH(c.order,"ascending"));const l={field:a,order:s};let u;return u=function(e){return ha(e)&&e.every((e=>cs(e)))&&e.length>1}(i)?i:cs(i)?[i,`${i}_end`]:[`${t.stack}_start`,`${t.stack}_end`],new j6(e,{dimensionFieldDefs:[],stackField:n,groupby:r,offset:o,sort:l,facetby:[],as:u})}static makeFromEncoding(e,t){const n=t.stack,{encoding:r}=t;if(!n)return null;const{groupbyChannels:i,fieldChannel:o,offset:a,impute:s}=n,l=i.map((e=>hK(r[e]))).filter((e=>!!e)),u=function(e){return e.stack.stackBy.reduce(((e,t)=>{const n=iK(t.fieldDef);return n&&e.push(n),e}),[])}(t),c=t.encoding.order;let f;if(ha(c)||WQ(c))f=TY(c);else{const e=BQ(c)?c.sort:"y"===o?"descending":"ascending";f=u.reduce(((t,n)=>(t.field.push(n),t.order.push(e),t)),{field:[],order:[]})}return new j6(e,{dimensionFieldDefs:l,stackField:t.vgField(o),facetby:[],stackby:u,sort:f,offset:a,impute:s,as:[t.vgField(o,{suffix:"start",forAs:!0}),t.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(e){this._stack.facetby.push(...e)}dependentFields(){const e=new Set;return e.add(this._stack.stackField),this.getGroupbyFields().forEach(e.add,e),this._stack.facetby.forEach(e.add,e),this._stack.sort.field.forEach(e.add,e),e}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${gH(this._stack)}`}getGroupbyFields(){const{dimensionFieldDefs:e,impute:t,groupby:n}=this._stack;return e.length>0?e.map((e=>e.bin?t?[iK(e,{binSuffix:"mid"})]:[iK(e,{}),iK(e,{binSuffix:"end"})]:[iK(e)])).flat():n??[]}assemble(){const e=[],{facetby:t,dimensionFieldDefs:n,stackField:r,stackby:i,sort:o,offset:a,impute:s,as:l}=this._stack;if(s)for(const u of n){const{bandPosition:n=.5,bin:o}=u;if(o){const t=iK(u,{expr:"datum"}),r=iK(u,{expr:"datum",binSuffix:"end"});e.push({type:"formula",expr:`${n}*${t}+${1-n}*${r}`,as:iK(u,{binSuffix:"mid",forAs:!0})})}e.push({type:"impute",field:r,groupby:[...i,...t],key:iK(u,{binSuffix:"mid"}),method:"value",value:0})}return e.push({type:"stack",groupby:[...this.getGroupbyFields(),...t],field:r,sort:o,as:l,offset:a}),e}}class N6 extends v2{clone(){return new N6(null,fH(this.transform))}constructor(e,t){super(e),this.transform=t}addDimensions(e){this.transform.groupby=_H(this.transform.groupby.concat(e),(e=>e))}dependentFields(){const e=new Set;return(this.transform.groupby??[]).forEach(e.add,e),(this.transform.sort??[]).forEach((t=>e.add(t.field))),this.transform.window.map((e=>e.field)).filter((e=>void 0!==e)).forEach(e.add,e),e}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(e){return e.as??iK(e)}hash(){return`WindowTransform ${gH(this.transform)}`}assemble(){const e=[],t=[],n=[],r=[];for(const c of this.transform.window)t.push(c.op),n.push(this.getDefaultName(c)),r.push(void 0===c.param?null:c.param),e.push(void 0===c.field?null:c.field);const i=this.transform.frame,o=this.transform.groupby;if(i&&null===i[0]&&null===i[1]&&t.every((e=>nY(e))))return{type:"joinaggregate",as:n,ops:t,fields:e,...void 0!==o?{groupby:o}:{}};const a=[],s=[];if(void 0!==this.transform.sort)for(const c of this.transform.sort)a.push(c.field),s.push(c.order??"ascending");const l={field:a,order:s},u=this.transform.ignorePeers;return{type:"window",params:r,as:n,ops:t,fields:e,sort:l,...void 0!==u?{ignorePeers:u}:{},...void 0!==o?{groupby:o}:{},...void 0!==i?{frame:i}:{}}}}function S6(e){if(e instanceof K5)if(1!==e.numChildren()||e.children[0]instanceof b2){const n=e.model.component.data.main;A6(n);const r=(t=e,function e(n){if(!(n instanceof K5)){const r=n.clone();if(r instanceof b2){const e=$6+r.getSource();r.setSource(e),t.model.component.data.outputNodes[e]=r}else(r instanceof Q5||r instanceof j6||r instanceof N6||r instanceof D6)&&r.addDimensions(t.fields);for(const t of n.children.flatMap(e))t.parent=r;return[r]}return n.children.flatMap(e)}),i=e.children.map(r).flat();for(const e of i)e.parent=n}else{const t=e.children[0];(t instanceof Q5||t instanceof j6||t instanceof N6||t instanceof D6)&&t.addDimensions(e.fields),t.swapWithParent(),S6(e)}else e.children.map(S6);var t}function A6(e){if(e instanceof b2&&e.type===f2.Main&&1===e.numChildren()){const t=e.children[0];t instanceof K5||(t.swapWithParent(),A6(e))}}const $6="scale_",C6=5;function M6(e){for(const t of e){for(const e of t.children)if(e.parent!==t)return!1;if(!M6(t.children))return!1}return!0}function P6(e,t){let n=!1;for(const r of t)n=e.optimize(r)||n;return n}function F6(e,t,n){let r=e.sources,i=!1;return i=P6(new v6,r)||i,i=P6(new g6(t),r)||i,r=r.filter((e=>e.numChildren()>0)),i=P6(new w6,r)||i,r=r.filter((e=>e.numChildren()>0)),n||(i=P6(new b6,r)||i,i=P6(new O6(t),r)||i,i=P6(new y6,r)||i,i=P6(new x6,r)||i,i=P6(new _6,r)||i,i=P6(new k6,r)||i,i=P6(new m6,r)||i,i=P6(new E6,r)||i),e.sources=r,i}class T6{constructor(e){Object.defineProperty(this,"signal",{enumerable:!0,get:e})}static fromName(e,t){return new T6((()=>e(t)))}}function z6(e){m4(e)?function(e){const t=e.component.scales;for(const n of SH(t)){const r=R6(e,n);if(t[n].setWithExplicit("domains",r),U6(e,n),e.component.data.isFaceted){let t=e;for(;!g4(t)&&t.parent;)t=t.parent;if("shared"===t.component.resolve.scale[n])for(const e of r.value)bY(e)&&(e.data=$6+e.data.replace($6,""))}}}(e):function(e){for(const n of e.children)z6(n);const t=e.component.scales;for(const n of SH(t)){let r,i=null;for(const t of e.children){const e=t.component.scales[n];if(e){r=void 0===r?e.getWithExplicit("domains"):n2(r,e.getWithExplicit("domains"),"domains","scale",W6);const t=e.get("selectionExtent");i&&t&&i.param!==t.param&&wX(YY),i=t}}t[n].setWithExplicit("domains",r),i&&t[n].set("selectionExtent",i,!0)}}(e)}function R6(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:r}=e,i=function(e,t,n,r){if("unaggregated"===e){const{valid:e,reason:r}=q6(t,n);if(!e)return void wX(r)}else if(void 0===e&&r.useUnaggregatedDomain){const{valid:e}=q6(t,n);if(e)return"unaggregated"}return e}(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return i!==e.scaleDomain(t)&&(e.specifiedScales[t]={...e.specifiedScales[t],domain:i}),"x"===t&&pK(r.x2)?pK(r.x)?n2(B6(n,i,e,"x"),B6(n,i,e,"x2"),"domain","scale",W6):B6(n,i,e,"x2"):"y"===t&&pK(r.y2)?pK(r.y)?n2(B6(n,i,e,"y"),B6(n,i,e,"y2"),"domain","scale",W6):B6(n,i,e,"y2"):B6(n,i,e,t)}function L6(e,t,n){const r=BX(n)?.unit;return"temporal"===t||r?function(e,t,n){return e.map((e=>({signal:`{data: ${wK(e,{timeUnit:n,type:t})}}`})))}(e,t,r):[e]}function B6(e,t,n,r){const{encoding:i}=n,o=pK(i[r]),{type:a}=o,s=o.timeUnit;if(function(e){return e?.unionWith}(t)){const i=B6(e,void 0,n,r);return Q1([...L6(t.unionWith,a,s),...i.value])}if(yY(t))return Q1([t]);if(t&&"unaggregated"!==t&&!OJ(t))return Q1(L6(t,a,s));const l=n.stack;if(l&&r===l.fieldChannel){if("normalize"===l.offset)return K1([[0,1]]);const e=n.requestDataName(f2.Main);return K1([{data:e,field:n.vgField(r,{suffix:"start"})},{data:e,field:n.vgField(r,{suffix:"end"})}])}const u=HV(r)&&WQ(o)?function(e,t,n){if(!xJ(n))return;const r=e.fieldDef(t),i=r.sort;if($Q(i))return{op:"min",field:e5(r,t),order:"ascending"};const{stack:o}=e,a=o?new Set([...o.groupbyFields,...o.stackBy.map((e=>e.fieldDef.field))]):void 0;if(AQ(i)){return I6(i,o&&!a.has(i.field))}if(SQ(i)){const{encoding:t,order:n}=i,r=e.fieldDef(t),{aggregate:s,field:l}=r,u=o&&!a.has(l);if(eY(s)||tY(s))return I6({field:iK(r),order:n},u);if(nY(s)||!s)return I6({op:s,field:l,order:n},u)}else{if("descending"===i)return{op:"min",field:e.vgField(t),order:"descending"};if(vH(["ascending",void 0],i))return!0}return}(n,r,e):void 0;if(HQ(o)){return K1(L6([o.datum],a,s))}const c=o;if("unaggregated"===t){const e=n.requestDataName(f2.Main),{field:t}=o;return K1([{data:e,field:iK({field:t,aggregate:"min"})},{data:e,field:iK({field:t,aggregate:"max"})}])}if(lY(c.bin)){if(xJ(e))return K1("bin-ordinal"===e?[]:[{data:CH(u)?n.requestDataName(f2.Main):n.requestDataName(f2.Raw),field:n.vgField(r,_K(c,r)?{binSuffix:"range"}:{}),sort:!0!==u&&pa(u)?u:{field:n.vgField(r,{}),op:"min"}}]);{const{bin:e}=c;if(lY(e)){const t=V5(n,c.field,e);return K1([new T6((()=>{const e=n.getSignalName(t);return`[${e}.start, ${e}.stop]`}))])}return K1([{data:n.requestDataName(f2.Main),field:n.vgField(r,{})}])}}if(c.timeUnit&&vH(["time","utc"],e)&&LQ(c,m4(n)?n.encoding[iV(r)]:void 0,n.markDef,n.config)){const e=n.requestDataName(f2.Main);return K1([{data:e,field:n.vgField(r)},{data:e,field:n.vgField(r,{suffix:"end"})}])}return K1(u?[{data:CH(u)?n.requestDataName(f2.Main):n.requestDataName(f2.Raw),field:n.vgField(r),sort:u}]:[{data:n.requestDataName(f2.Main),field:n.vgField(r)}])}function I6(e,t){const{op:n,field:r,order:i}=e;return{op:n??(t?"sum":DQ),...r?{field:BH(r)}:{},...i?{order:i}:{}}}function U6(e,t){const n=e.component.scales[t],r=e.specifiedScales[t].domain,i=e.fieldDef(t)?.bin,o=OJ(r)&&r,a=cY(i)&&fY(i.extent)&&i.extent;(o||a)&&n.set("selectionExtent",o??a,!0)}function q6(e,t){const{aggregate:n,type:r}=e;return n?cs(n)&&!aY.has(n)?{valid:!1,reason:fX(n)}:"quantitative"===r&&"log"===t?{valid:!1,reason:dX(e)}:{valid:!0}:{valid:!1,reason:cX(e)}}function W6(e,t,n,r){return e.explicit&&t.explicit&&wX(function(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${mH(n)} and ${mH(r)}). Using the union of the two domains.`}(n,r,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function Z6(e){const t=_H(e.map((e=>{if(bY(e)){const{sort:t,...n}=e;return n}return e})),gH),n=_H(e.map((e=>{if(bY(e)){const t=e.sort;return void 0===t||CH(t)||("op"in t&&"count"===t.op&&delete t.field,"ascending"===t.order&&delete t.order),t}})).filter((e=>void 0!==e)),gH);if(0===t.length)return;if(1===t.length){const t=e[0];if(bY(t)&&n.length>0){let e=n[0];if(n.length>1){wX(mX);const t=n.filter((e=>pa(e)&&"op"in e&&"min"!==e.op));e=!n.every((e=>pa(e)&&"op"in e))||1!==t.length||t[0]}else if(pa(e)&&"field"in e){const n=e.field;t.field===n&&(e=!e.order||{order:e.order})}return{...t,sort:e}}return t}const r=_H(n.map((e=>CH(e)||!("op"in e)||cs(e.op)&&e.op in KV?e:(wX(function(e){return`Dropping sort property ${mH(e)} as unioned domains only support boolean or op "count", "min", and "max".`}(e)),!0))),gH);let i;1===r.length?i=r[0]:r.length>1&&(wX(mX),i=!0);const o=_H(e.map((e=>bY(e)?e.data:null)),(e=>e));if(1===o.length&&null!==o[0]){return{data:o[0],fields:t.map((e=>e.field)),...i?{sort:i}:{}}}return{fields:t,...i?{sort:i}:{}}}function H6(e){if(bY(e)&&cs(e.field))return e.field;if(function(e){return!ha(e)&&"fields"in e&&!("data"in e)}(e)){let t;for(const n of e.fields)if(bY(n)&&cs(n.field))if(t){if(t!==n.field)return wX("Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect."),t}else t=n.field;return wX("Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect."),t}if(function(e){return!ha(e)&&"fields"in e&&"data"in e}(e)){wX("Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.");const t=e.fields[0];return cs(t)?t:void 0}}function G6(e,t){const n=e.component.scales[t].get("domains").map((t=>(bY(t)&&(t.data=e.lookupDataSource(t.data)),t)));return Z6(n)}function V6(e){return v4(e)||y4(e)?e.children.reduce(((e,t)=>e.concat(V6(t))),Y6(e)):Y6(e)}function Y6(e){return SH(e.component.scales).reduce(((t,n)=>{const r=e.component.scales[n];if(r.merged)return t;const i=r.combine(),{name:o,type:a,selectionExtent:s,domains:l,range:u,reverse:c,...f}=i,d=function(e,t,n,r){if(NV(n)){if(vY(e))return{step:{signal:`${t}_step`}}}else if(pa(e)&&bY(e))return{...e,data:r.lookupDataSource(e.data)};return e}(i.range,o,n,e),h=G6(e,n),p=s?function(e,t,n,r){const i=B3(e,t.param,t);return{signal:wJ(n.get("type"))&&ha(r)&&r[0]>r[1]?`isValid(${i}) && reverse(${i})`:i}}(e,s,r,h):null;return t.push({name:o,type:a,...h?{domain:h}:{},...p?{domainRaw:p}:{},range:d,...void 0!==c?{reverse:c}:{},...f}),t}),[])}class X6 extends J1{constructor(e,t){super({},{name:e}),this.merged=!1,this.setWithExplicit("type",t)}domainDefinitelyIncludesZero(){return!1!==this.get("zero")||bH(this.get("domains"),(e=>ha(e)&&2===e.length&&e[0]<=0&&e[1]>=0))}}const J6=["range","scheme"];function Q6(e,t){const n=e.fieldDef(t);if(n?.bin){const{bin:r,field:i}=n,o=oV(t),a=e.getName(o);if(pa(r)&&r.binned&&void 0!==r.step)return new T6((()=>{const n=e.scaleName(t),i=`(domain("${n}")[1] - domain("${n}")[0]) / ${r.step}`;return`${e.getSignalName(a)} / (${i})`}));if(lY(r)){const t=V5(e,i,r);return new T6((()=>{const n=e.getSignalName(t),r=`(${n}.stop - ${n}.start) / ${n}.step`;return`${e.getSignalName(a)} / (${r})`}))}}}function K6(e,t){const n=t.specifiedScales[e],{size:r}=t,i=t.getScaleComponent(e).get("type");for(const c of J6)if(void 0!==n[c]){const r=MJ(i,c),o=PJ(e,c);if(r)if(o)wX(o);else switch(c){case"range":{const r=n.range;if(ha(r)){if(NV(e))return Q1(r.map((e=>{if("width"===e||"height"===e){const n=t.getName(e),r=t.getSignalName.bind(t);return T6.fromName(r,n)}return e})))}else if(pa(r))return Q1({data:t.requestDataName(f2.Main),field:r.field,sort:{op:"min",field:t.vgField(e)}});return Q1(r)}case"scheme":return Q1(e4(n[c]))}else wX(hX(i,c,e))}const o=e===eG||"xOffset"===e?"width":"height",a=r[o];if(S0(a))if(NV(e))if(xJ(i)){const n=t4(a,t,e);if(n)return Q1({step:n})}else wX(pX(o));else if(MV(e)){const n=e===iG?"x":"y";if("band"===t.getScaleComponent(n).get("type")){const e=n4(a,i);if(e)return Q1(e)}}const{rangeMin:s,rangeMax:l}=n,u=function(e,t){const{size:n,config:r,mark:i,encoding:o}=t,a=t.getSignalName.bind(t),{type:s}=pK(o[e]),l=t.getScaleComponent(e),u=l.get("type"),{domain:c,domainMid:f}=t.specifiedScales[e];switch(e){case eG:case tG:{if(vH(["point","band"],u)){const i=r4(e,n,r.view);if(S0(i)){return{step:t4(i,t,e)}}}const i=oV(e),o=t.getName(i);return e===tG&&wJ(u)?[T6.fromName(a,o),0]:[0,T6.fromName(a,o)]}case iG:case oG:return function(e,t,n){const r=e===iG?"x":"y",i=t.getScaleComponent(r),o=i.get("type"),a=t.scaleName(r);if("band"===o){const e=r4(r,t.size,t.config.view);if(S0(e)){const t=n4(e,n);if(t)return t}return[0,{signal:`bandwidth('${a}')`}]}{const n=t.encoding[r];if(WQ(n)&&n.timeUnit){const e=IX(n.timeUnit,(e=>`scale('${a}', ${e})`)),r=t.config.scale.bandWithNestedOffsetPaddingInner;if(r){return[{signal:`${yY(r)?`${r.signal}/2`:""+r/2} * (${e})`},{signal:`${yY(r)?`(1 - ${r.signal}/2)`:""+(1-r/2)} * (${e})`}]}return[0,{signal:e}]}return dH(`Cannot use ${e} scale if ${r} scale is not discrete.`)}}(e,t,u);case vG:{const o=i4(i,t.component.scales[e].get("zero"),r),a=function(e,t,n,r){const i={x:Q6(n,"x"),y:Q6(n,"y")};switch(e){case"bar":case"tick":{if(void 0!==r.scale.maxBandSize)return r.scale.maxBandSize;const e=a4(t,i,r.view);return ls(e)?e-1:new T6((()=>`${e.signal} - 1`))}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const e=a4(t,i,r.view);return ls(e)?Math.pow(o4*e,2):new T6((()=>`pow(${o4} * ${e.signal}, 2)`))}}throw new Error(oX("size",e))}(i,n,t,r);return _J(u)?function(e,t,n){const r=()=>{const r=SY(t),i=SY(e),o=`(${r} - ${i}) / (${n} - 1)`;return`sequence(${i}, ${r} + ${o}, ${o})`};return yY(t)?new T6(r):{signal:r()}}(o,a,function(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return void 0!==n&&ha(n)?n.length+1:(wX(function(e){return`Domain for ${e} is required for threshold scale.`}(r)),3)}}(u,r,c,e)):[o,a]}case lG:return[0,2*Math.PI];case bG:return[0,360];case aG:return[0,new T6((()=>`min(${t.getSignalName("width")},${t.getSignalName("height")})/2`))];case _G:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case OG:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case yG:return"symbol";case pG:case mG:case gG:return"ordinal"===u?"nominal"===s?"category":"ordinal":void 0!==f?"diverging":"rect"===i||"geoshape"===i?"heatmap":"ramp";case xG:case wG:case kG:return[r.scale.minOpacity,r.scale.maxOpacity]}}(e,t);return(void 0!==s||void 0!==l)&&MJ(i,"rangeMin")&&ha(u)&&2===u.length?Q1([s??u[0],l??u[1]]):K1(u)}function e4(e){return function(e){return!cs(e)&&!!e.name}(e)?{scheme:e.name,...pH(e,["name"])}:{scheme:e}}function t4(e,t,n){const{encoding:r}=t,i=t.getScaleComponent(n),o=sV(n),a=r[o];if("offset"===N0({step:e,offsetIsDiscrete:XQ(a)&&rJ(a.type)})&&FK(r,o)){const n=t.getScaleComponent(o);let r=`domain('${t.scaleName(o)}').length`;if("band"===n.get("type")){r=`bandspace(${r}, ${n.get("paddingInner")??n.get("padding")??0}, ${n.get("paddingOuter")??n.get("padding")??0})`}const a=i.get("paddingInner")??i.get("padding");return{signal:`${e.step} * ${r} / (1-${jY(a)})`}}return e.step}function n4(e,t){if("offset"===N0({step:e,offsetIsDiscrete:xJ(t)}))return{step:e.step}}function r4(e,t,n){const r=e===eG?"width":"height",i=t[r];return i||P0(n,r)}function i4(e,t,n){if(t)return yY(t)?{signal:`${t.signal} ? 0 : ${i4(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(oX("size",e))}const o4=.95;function a4(e,t,n){const r=S0(e.width)?e.width.step:M0(n,"width"),i=S0(e.height)?e.height.step:M0(n,"height");return t.x||t.y?new T6((()=>`min(${[t.x?t.x.signal:r,t.y?t.y.signal:i].join(", ")})`)):Math.min(r,i)}function s4(e,t){m4(e)?function(e,t){const n=e.component.scales,{config:r,encoding:i,markDef:o,specifiedScales:a}=e;for(const s of SH(n)){const l=a[s],u=n[s],c=e.getScaleComponent(s),f=pK(i[s]),d=l[t],h=c.get("type"),p=c.get("padding"),m=c.get("paddingInner"),g=MJ(h,t),y=PJ(s,t);if(void 0!==d&&(g?y&&wX(y):wX(hX(h,t,s))),g&&void 0===y)if(void 0!==d){const e=f.timeUnit,n=f.type;switch(t){case"domainMax":case"domainMin":kX(l[t])||"temporal"===n||e?u.set(t,{signal:wK(l[t],{type:n,timeUnit:e})},!0):u.set(t,l[t],!0);break;default:u.copyKeyFromObject(t,l)}}else{const n=t in l4?l4[t]({model:e,channel:s,fieldOrDatumDef:f,scaleType:h,scalePadding:p,scalePaddingInner:m,domain:l.domain,domainMin:l.domainMin,domainMax:l.domainMax,markDef:o,config:r,hasNestedOffsetScale:TK(i,s),hasSecondaryRangeChannel:!!i[iV(s)]}):r.scale[t];void 0!==n&&u.set(t,n,!1)}}}(e,t):c4(e,t)}const l4={bins:e=>{let{model:t,fieldOrDatumDef:n}=e;return WQ(n)?function(e,t){const n=t.bin;if(lY(n)){const r=V5(e,t.field,n);return new T6((()=>e.getSignalName(r)))}if(uY(n)&&cY(n)&&void 0!==n.step)return{step:n.step};return}(t,n):void 0},interpolate:e=>{let{channel:t,fieldOrDatumDef:n}=e;return function(e,t){if(vH([pG,mG,gG],e)&&"nominal"!==t)return"hcl";return}(t,n.type)},nice:e=>{let{scaleType:t,channel:n,domain:r,domainMin:i,domainMax:o,fieldOrDatumDef:a}=e;return function(e,t,n,r,i,o){if(hK(o)?.bin||ha(n)||null!=i||null!=r||vH([uJ.TIME,uJ.UTC],e))return;return!!NV(t)||void 0}(t,n,r,i,o,a)},padding:e=>{let{channel:t,scaleType:n,fieldOrDatumDef:r,markDef:i,config:o}=e;return function(e,t,n,r,i,o){if(NV(e)){if(kJ(t)){if(void 0!==n.continuousPadding)return n.continuousPadding;const{type:t,orient:a}=i;if("bar"===t&&(!WQ(r)||!r.bin&&!r.timeUnit)&&("vertical"===a&&"x"===e||"horizontal"===a&&"y"===e))return o.continuousBandSize}if(t===uJ.POINT)return n.pointPadding}return}(t,n,o.scale,r,i,o.bar)},paddingInner:e=>{let{scalePadding:t,channel:n,markDef:r,scaleType:i,config:o,hasNestedOffsetScale:a}=e;return function(e,t,n,r,i,o){void 0===o&&(o=!1);if(void 0!==e)return;if(NV(t)){const{bandPaddingInner:e,barBandPaddingInner:t,rectBandPaddingInner:r,bandWithNestedOffsetPaddingInner:a}=i;return o?a:WH(e,"bar"===n?t:r)}if(MV(t)&&r===uJ.BAND)return i.offsetBandPaddingInner;return}(t,n,r.type,i,o.scale,a)},paddingOuter:e=>{let{scalePadding:t,channel:n,scaleType:r,scalePaddingInner:i,config:o,hasNestedOffsetScale:a}=e;return function(e,t,n,r,i,o){void 0===o&&(o=!1);if(void 0!==e)return;if(NV(t)){const{bandPaddingOuter:e,bandWithNestedOffsetPaddingOuter:t}=i;if(o)return t;if(n===uJ.BAND)return WH(e,yY(r)?{signal:`${r.signal}/2`}:r/2)}else if(MV(t)){if(n===uJ.POINT)return.5;if(n===uJ.BAND)return i.offsetBandPaddingOuter}return}(t,n,r,i,o.scale,a)},reverse:e=>{let{fieldOrDatumDef:t,scaleType:n,channel:r,config:i}=e;return function(e,t,n,r){if("x"===n&&void 0!==r.xReverse)return wJ(e)&&"descending"===t?yY(r.xReverse)?{signal:`!${r.xReverse.signal}`}:!r.xReverse:r.xReverse;if(wJ(e)&&"descending"===t)return!0;return}(n,WQ(t)?t.sort:void 0,r,i.scale)},zero:e=>{let{channel:t,fieldOrDatumDef:n,domain:r,markDef:i,scaleType:o,config:a,hasSecondaryRangeChannel:s}=e;return function(e,t,n,r,i,o,a){if(n&&"unaggregated"!==n&&wJ(i)){if(ha(n)){const e=n[0],t=n[n.length-1];if(e<=0&&t>=0)return!0}return!1}if("size"===e&&"quantitative"===t.type&&!_J(i))return!0;if((!WQ(t)||!t.bin)&&vH([...jV,...AV],e)){const{orient:t,type:n}=r;return(!vH(["bar","area","line","trail"],n)||!("horizontal"===t&&"y"===e||"vertical"===t&&"x"===e))&&(!(!vH(["bar","area"],n)||a)||o?.zero)}return!1}(t,n,r,i,o,a.scale,s)}};function u4(e){m4(e)?function(e){const t=e.component.scales;for(const n of ZV){const r=t[n];if(!r)continue;const i=K6(n,e);r.setWithExplicit("range",i)}}(e):c4(e,"range")}function c4(e,t){const n=e.component.scales;for(const r of e.children)"range"===t?u4(r):s4(r,t);for(const r of SH(n)){let i;for(const n of e.children){const e=n.component.scales[r];if(e){i=n2(i,e.getWithExplicit(t),t,"scale",e2(((e,n)=>"range"===t&&e.step&&n.step?e.step-n.step:0)))}}n[r].setWithExplicit(t,i)}}function f4(e,t,n,r,i){void 0===i&&(i=!1);const o=function(e,t,n,r){switch(t.type){case"nominal":case"ordinal":if(BG(e)||"discrete"===JV(e))return"shape"===e&&"ordinal"===t.type&&wX(uX(e,"ordinal")),"ordinal";if(NV(e)||MV(e)){if(vH(["rect","bar","image","rule"],n.type))return"band";if(r)return"band"}else if("arc"===n.type&&e in SV)return"band";return rQ(n[oV(e)])||eK(t)&&t.axis?.tickBand?"band":"point";case"temporal":return BG(e)?"time":"discrete"===JV(e)?(wX(uX(e,"temporal")),"ordinal"):WQ(t)&&t.timeUnit&&BX(t.timeUnit).utc?"utc":"time";case"quantitative":return BG(e)?WQ(t)&&lY(t.bin)?"bin-ordinal":"linear":"discrete"===JV(e)?(wX(uX(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(nX(t.type))}(t,n,r,i),{type:a}=e;return HV(t)?void 0!==a?function(e,t,n){if(void 0===n&&(n=!1),!HV(e))return!1;switch(e){case eG:case tG:case iG:case oG:case lG:case aG:return!!kJ(t)||"band"===t||"point"===t&&!n;case vG:case _G:case xG:case wG:case kG:case bG:return kJ(t)||_J(t)||vH(["band","point","ordinal"],t);case pG:case mG:case gG:return"band"!==t;case OG:case yG:return"ordinal"===t||_J(t)}}(t,a)?WQ(n)&&(s=a,l=n.type,!(vH([oJ,sJ],l)?void 0===s||xJ(s):l===aJ?vH([uJ.TIME,uJ.UTC,void 0],s):l!==iJ||gJ(s)||_J(s)||void 0===s))?(wX(function(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}(a,o)),o):a:(wX(function(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}(t,a,o)),o):o:null;var s,l}function d4(e){m4(e)?e.component.scales=function(e){const{encoding:t,mark:n,markDef:r}=e,i={};for(const o of ZV){const a=pK(t[o]);if(a&&n===YJ&&o===yG&&a.type===lJ)continue;let s=a&&a.scale;if(MV(o)){if(!TK(t,lV(o))){s&&wX(aX(o));continue}}if(a&&null!==s&&!1!==s){s??(s={});const n=f4(s,o,a,r,TK(t,o));i[o]=new X6(e.scaleName(`${o}`,!0),{value:n,explicit:s.type===n})}}return i}(e):e.component.scales=function(e){var t;const n=e.component.scales={},r={},i=e.component.resolve;for(const o of e.children){d4(o);for(const n of SH(o.component.scales))if((t=i.scale)[n]??(t[n]=k5(n,e)),"shared"===i.scale[n]){const e=r[n],t=o.component.scales[n].getWithExplicit("type");e?fJ(e.value,t.value)?r[n]=n2(e,t,"type","scale",h4):(i.scale[n]="independent",delete r[n]):r[n]=t}}for(const o of SH(r)){const t=e.scaleName(o,!0),i=r[o];n[o]=new X6(t,i);for(const n of e.children){const e=n.component.scales[o];e&&(n.renameScale(e.get("name"),t),e.merged=!0)}}return n}(e)}const h4=e2(((e,t)=>hJ(e)-hJ(t)));class p4{constructor(){this.nameMap={}}rename(e,t){this.nameMap[e]=t}has(e){return void 0!==this.nameMap[e]}get(e){for(;this.nameMap[e]&&e!==this.nameMap[e];)e=this.nameMap[e];return e}}function m4(e){return"unit"===e?.type}function g4(e){return"facet"===e?.type}function y4(e){return"concat"===e?.type}function v4(e){return"layer"===e?.type}class b4{constructor(e,t,n,r,i,o,a){this.type=t,this.parent=n,this.config=i,this.correctDataNames=e=>(e.from?.data&&(e.from.data=this.lookupDataSource(e.from.data)),e.from?.facet?.data&&(e.from.facet.data=this.lookupDataSource(e.from.facet.data)),e),this.parent=n,this.config=i,this.view=pY(a),this.name=e.name??r,this.title=gY(e.title)?{text:e.title}:e.title?pY(e.title):void 0,this.scaleNameMap=n?n.scaleNameMap:new p4,this.projectionNameMap=n?n.projectionNameMap:new p4,this.signalNameMap=n?n.signalNameMap:new p4,this.data=e.data,this.description=e.description,this.transforms=function(e){return e.map((e=>v1(e)?{filter:uH(e.filter,tJ)}:e))}(e.transform??[]),this.layout="layer"===t||"unit"===t?{}:function(e,t,n){const r=n[t],i={},{spacing:o,columns:a}=r;void 0!==o&&(i.spacing=o),void 0!==a&&(PQ(e)&&!CQ(e.facet)||E0(e))&&(i.columns=a),D0(e)&&(i.columns=1);for(const s of $0)if(void 0!==e[s])if("spacing"===s){const t=e[s];i[s]=ls(t)?t:{row:t.row??o,column:t.column??o}}else i[s]=e[s];return i}(e,t,i),this.component={data:{sources:n?n.component.data.sources:[],outputNodes:n?n.component.data.outputNodes:{},outputNodeRefCounts:n?n.component.data.outputNodeRefCounts:{},isFaceted:PQ(e)||n?.component.data.isFaceted&&void 0===e.data},layoutSize:new J1,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:{scale:{},axis:{},legend:{},...o?fH(o):{}},selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){!function(e,t){let{ignoreRange:n}=void 0===t?{}:t;d4(e),z6(e);for(const r of CJ)s4(e,r);n||u4(e)}(this)}parseProjection(){Z5(this)}renameTopLevelLayoutSizeSignal(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height")}parseLegends(){F5(this)}assembleEncodeFromView(e){const{style:t,...n}=e,r={};for(const i of SH(n)){const e=n[i];void 0!==e&&(r[i]=DY(e))}return r}assembleGroupEncodeEntry(e){let t={};return this.view&&(t=this.assembleEncodeFromView(this.view)),e||(this.description&&(t.description=DY(this.description)),"unit"!==this.type&&"layer"!==this.type)?NH(t)?void 0:t:{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height"),...t??{}}}assembleLayout(){if(!this.layout)return;const{spacing:e,...t}=this.layout,{component:n,config:r}=this,i=function(e,t){const n={};for(const r of UG){const i=e[r];if(i?.facetFieldDef){const{titleAnchor:e,titleOrient:o}=r5(["titleAnchor","titleOrient"],i.facetFieldDef.header,t,r),a=t5(r,o),s=p5(e,a);void 0!==s&&(n[a]=s)}}return NH(n)?void 0:n}(n.layoutHeaders,r);return{padding:e,...this.assembleDefaultLayout(),...t,...i?{titleBand:i}:{}}}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:e}=this.component;let t=[];for(const n of UG)e[n].title&&t.push(a5(this,n));for(const n of i5)t=t.concat(u5(this,n));return t}assembleAxes(){return function(e,t){const{x:n=[],y:r=[]}=e;return[...n.map((e=>q3(e,"grid",t))),...r.map((e=>q3(e,"grid",t))),...n.map((e=>q3(e,"main",t))),...r.map((e=>q3(e,"main",t)))].filter((e=>e))}(this.component.axes,this.config)}assembleLegends(){return B5(this)}assembleProjections(){return I5(this)}assembleTitle(){const{encoding:e,...t}=this.title??{},n={...mY(this.config.title).nonMarkTitleProperties,...t,...e?{encode:{update:e}}:{}};if(n.text)return vH(["unit","layer"],this.type)?vH(["middle",void 0],n.anchor)&&(n.frame??(n.frame="group")):n.anchor??(n.anchor="start"),NH(n)?void 0:n}assembleGroup(e){void 0===e&&(e=[]);const t={};(e=e.concat(this.assembleSignals())).length>0&&(t.signals=e);const n=this.assembleLayout();n&&(t.layout=n),t.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||g4(this.parent)?V6(this):[];r.length>0&&(t.scales=r);const i=this.assembleAxes();i.length>0&&(t.axes=i);const o=this.assembleLegends();return o.length>0&&(t.legends=o),t}getName(e){return MH((this.name?`${this.name}_`:"")+e)}getDataName(e){return this.getName(f2[e].toLowerCase())}requestDataName(e){const t=this.getDataName(e),n=this.component.data.outputNodeRefCounts;return n[t]=(n[t]||0)+1,t}getSizeSignalRef(e){if(g4(this.parent)){const t=$V(x5(e)),n=this.component.scales[t];if(n&&!n.merged){const e=n.get("type"),r=n.get("range");if(xJ(e)&&vY(r)){const e=n.get("name"),r=H6(G6(this,t));if(r){return{signal:b5(e,n,iK({aggregate:"distinct",field:r},{expr:"datum"}))}}return wX(ZY(t)),null}}}return{signal:this.signalNameMap.get(this.getName(e))}}lookupDataSource(e){const t=this.component.data.outputNodes[e];return t?t.getSource():e}getSignalName(e){return this.signalNameMap.get(e)}renameSignal(e,t){this.signalNameMap.rename(e,t)}renameScale(e,t){this.scaleNameMap.rename(e,t)}renameProjection(e,t){this.projectionNameMap.rename(e,t)}scaleName(e,t){return t?this.getName(e):KG(e)&&HV(e)&&this.component.scales[e]||this.scaleNameMap.has(this.getName(e))?this.scaleNameMap.get(this.getName(e)):void 0}projectionName(e){return e?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}getScaleComponent(e){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const t=this.component.scales[e];return t&&!t.merged?t:this.parent?this.parent.getScaleComponent(e):void 0}getSelectionComponent(e,t){let n=this.component.selection[e];if(!n&&this.parent&&(n=this.parent.getSelectionComponent(e,t)),!n)throw new Error(function(e){return`Cannot find a selection named "${e}".`}(t));return n}hasAxisOrientSignalRef(){return this.component.axes.x?.some((e=>e.hasOrientSignalRef()))||this.component.axes.y?.some((e=>e.hasOrientSignalRef()))}}class x4 extends b4{vgField(e,t){void 0===t&&(t={});const n=this.fieldDef(e);if(n)return iK(n,t)}reduceFieldDef(e,t){return function(e,t,n,r){return e?SH(e).reduce(((n,i)=>{const o=e[i];return ha(o)?o.reduce(((e,n)=>t.call(r,e,n,i)),n):t.call(r,n,o,i)}),n):n}(this.getMapping(),((t,n,r)=>{const i=hK(n);return i?e(t,i,r):t}),t)}forEachFieldDef(e,t){IK(this.getMapping(),((t,n)=>{const r=hK(t);r&&e(r,n)}),t)}}class w4 extends v2{clone(){return new w4(null,fH(this.transform))}constructor(e,t){super(e),this.transform=t,this.transform=fH(t);const n=this.transform.as??[void 0,void 0];this.transform.as=[n[0]??"value",n[1]??"density"],t.groupby&&null==t.minsteps&&null==t.maxsteps&&null==t.steps&&(this.transform.steps=200)}dependentFields(){return new Set([this.transform.density,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${gH(this.transform)}`}assemble(){const{density:e,...t}=this.transform;return{type:"kde",field:e,...t}}}class k4 extends v2{clone(){return new k4(null,fH(this.transform))}constructor(e,t){super(e),this.transform=t,this.transform=fH(t)}dependentFields(){return new Set([this.transform.extent])}producedFields(){return new Set([])}hash(){return`ExtentTransform ${gH(this.transform)}`}assemble(){const{extent:e,param:t}=this.transform;return{type:"extent",field:e,signal:t}}}class _4 extends v2{clone(){return new _4(null,{...this.filter})}constructor(e,t){super(e),this.filter=t}static make(e,t){const{config:n,mark:r,markDef:i}=t;if("filter"!==CY("invalid",i,n))return null;const o=t.reduceFieldDef(((e,n,i)=>{const o=HV(i)&&t.getScaleComponent(i);if(o){wJ(o.get("type"))&&"count"!==n.aggregate&&!XJ(r)&&(e[n.field]=n)}return e}),{});return SH(o).length?new _4(e,o):null}dependentFields(){return new Set(SH(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${gH(this.filter)}`}assemble(){const e=SH(this.filter).reduce(((e,t)=>{const n=this.filter[t],r=iK(n,{expr:"datum"});return null!==n&&("temporal"===n.type?e.push(`(isDate(${r}) || (isValid(${r}) && isFinite(+${r})))`):"quantitative"===n.type&&(e.push(`isValid(${r})`),e.push(`isFinite(+${r})`))),e}),[]);return e.length>0?{type:"filter",expr:e.join(" && ")}:null}}class O4 extends v2{clone(){return new O4(this.parent,fH(this.transform))}constructor(e,t){super(e),this.transform=t,this.transform=fH(t);const{flatten:n,as:r=[]}=this.transform;this.transform.as=n.map(((e,t)=>r[t]??e))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${gH(this.transform)}`}assemble(){const{flatten:e,as:t}=this.transform;return{type:"flatten",fields:e,as:t}}}class E4 extends v2{clone(){return new E4(null,fH(this.transform))}constructor(e,t){super(e),this.transform=t,this.transform=fH(t);const n=this.transform.as??[void 0,void 0];this.transform.as=[n[0]??"key",n[1]??"value"]}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${gH(this.transform)}`}assemble(){const{fold:e,as:t}=this.transform;return{type:"fold",fields:e,as:t}}}class D4 extends v2{clone(){return new D4(null,fH(this.fields),this.geojson,this.signal)}static parseAll(e,t){if(t.component.projection&&!t.component.projection.isFit)return e;let n=0;for(const r of[[fG,cG],[hG,dG]]){const i=r.map((e=>{const n=pK(t.encoding[e]);return WQ(n)?n.field:HQ(n)?{expr:`${n.datum}`}:QQ(n)?{expr:`${n.value}`}:void 0}));(i[0]||i[1])&&(e=new D4(e,i,null,t.getName("geojson_"+n++)))}if(t.channelHasField(yG)){const r=t.typedFieldDef(yG);r.type===lJ&&(e=new D4(e,null,r.field,t.getName("geojson_"+n++)))}return e}constructor(e,t,n,r){super(e),this.fields=t,this.geojson=n,this.signal=r}dependentFields(){const e=(this.fields??[]).filter(cs);return new Set([...this.geojson?[this.geojson]:[],...e])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${gH(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],{type:"geojson",...this.fields?{fields:this.fields}:{},...this.geojson?{geojson:this.geojson}:{},signal:this.signal}]}}class j4 extends v2{clone(){return new j4(null,this.projection,fH(this.fields),fH(this.as))}constructor(e,t,n,r){super(e),this.projection=t,this.fields=n,this.as=r}static parseAll(e,t){if(!t.projectionName())return e;for(const n of[[fG,cG],[hG,dG]]){const r=n.map((e=>{const n=pK(t.encoding[e]);return WQ(n)?n.field:HQ(n)?{expr:`${n.datum}`}:QQ(n)?{expr:`${n.value}`}:void 0})),i=n[0]===hG?"2":"";(r[0]||r[1])&&(e=new j4(e,t.projectionName(),r,[t.getName(`x${i}`),t.getName(`y${i}`)]))}return e}dependentFields(){return new Set(this.fields.filter(cs))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${gH(this.fields)} ${gH(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class N4 extends v2{clone(){return new N4(null,fH(this.transform))}constructor(e,t){super(e),this.transform=t}dependentFields(){return new Set([this.transform.impute,this.transform.key,...this.transform.groupby??[]])}producedFields(){return new Set([this.transform.impute])}processSequence(e){const{start:t=0,stop:n,step:r}=e;return{signal:`sequence(${[t,n,...r?[r]:[]].join(",")})`}}static makeFromTransform(e,t){return new N4(e,t)}static makeFromEncoding(e,t){const n=t.encoding,r=n.x,i=n.y;if(WQ(r)&&WQ(i)){const o=r.impute?r:i.impute?i:void 0;if(void 0===o)return;const a=r.impute?i:i.impute?r:void 0,{method:s,value:l,frame:u,keyvals:c}=o.impute,f=UK(t.mark,n);return new N4(e,{impute:o.field,key:a.field,...s?{method:s}:{},...void 0!==l?{value:l}:{},...u?{frame:u}:{},...void 0!==c?{keyvals:c}:{},...f.length?{groupby:f}:{}})}return null}hash(){return`Impute ${gH(this.transform)}`}assemble(){const{impute:e,key:t,keyvals:n,method:r,groupby:i,value:o,frame:a=[null,null]}=this.transform,s={type:"impute",field:e,key:t,...n?{keyvals:b1(n)?this.processSequence(n):n}:{},method:"value",...i?{groupby:i}:{},value:r&&"value"!==r?null:o};if(r&&"value"!==r){return[s,{type:"window",as:[`imputed_${e}_value`],ops:[r],fields:[e],frame:a,ignorePeers:!1,...i?{groupby:i}:{}},{type:"formula",expr:`datum.${e} === null ? datum.imputed_${e}_value : datum.${e}`,as:e}]}return[s]}}class S4 extends v2{clone(){return new S4(null,fH(this.transform))}constructor(e,t){super(e),this.transform=t,this.transform=fH(t);const n=this.transform.as??[void 0,void 0];this.transform.as=[n[0]??t.on,n[1]??t.loess]}dependentFields(){return new Set([this.transform.loess,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${gH(this.transform)}`}assemble(){const{loess:e,on:t,...n}=this.transform;return{type:"loess",x:t,y:e,...n}}}class A4 extends v2{clone(){return new A4(null,fH(this.transform),this.secondary)}constructor(e,t,n){super(e),this.transform=t,this.secondary=n}static make(e,t,n,r){const i=t.component.data.sources,{from:o}=n;let a=null;if(function(e){return"data"in e}(o)){let e=Z4(o.data,i);e||(e=new s6(o.data),i.push(e));const n=t.getName(`lookup_${r}`);a=new b2(e,n,f2.Lookup,t.component.data.outputNodeRefCounts),t.component.data.outputNodes[n]=a}else if(function(e){return"param"in e}(o)){const e=o.param;let r;n={as:e,...n};try{r=t.getSelectionComponent(MH(e),e)}catch(x9){throw new Error(function(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}(e))}if(a=r.materialized,!a)throw new Error(function(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}(e))}return new A4(e,n,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?Ra(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${gH({transform:this.transform,secondary:this.secondary})}`}assemble(){let e;if(this.transform.from.fields)e={values:this.transform.from.fields,...this.transform.as?{as:Ra(this.transform.as)}:{}};else{let t=this.transform.as;cs(t)||(wX('If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.'),t="_lookup"),e={as:[t]}}return{type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup],...e,...this.transform.default?{default:this.transform.default}:{}}}}class $4 extends v2{clone(){return new $4(null,fH(this.transform))}constructor(e,t){super(e),this.transform=t,this.transform=fH(t);const n=this.transform.as??[void 0,void 0];this.transform.as=[n[0]??"prob",n[1]??"value"]}dependentFields(){return new Set([this.transform.quantile,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${gH(this.transform)}`}assemble(){const{quantile:e,...t}=this.transform;return{type:"quantile",field:e,...t}}}class C4 extends v2{clone(){return new C4(null,fH(this.transform))}constructor(e,t){super(e),this.transform=t,this.transform=fH(t);const n=this.transform.as??[void 0,void 0];this.transform.as=[n[0]??t.on,n[1]??t.regression]}dependentFields(){return new Set([this.transform.regression,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${gH(this.transform)}`}assemble(){const{regression:e,on:t,...n}=this.transform;return{type:"regression",x:t,y:e,...n}}}class M4 extends v2{clone(){return new M4(null,fH(this.transform))}constructor(e,t){super(e),this.transform=t}addDimensions(e){this.transform.groupby=_H((this.transform.groupby??[]).concat(e),(e=>e))}producedFields(){}dependentFields(){return new Set([this.transform.pivot,this.transform.value,...this.transform.groupby??[]])}hash(){return`PivotTransform ${gH(this.transform)}`}assemble(){const{pivot:e,value:t,groupby:n,limit:r,op:i}=this.transform;return{type:"pivot",field:e,value:t,...void 0!==r?{limit:r}:{},...void 0!==i?{op:i}:{},...void 0!==n?{groupby:n}:{}}}}class P4 extends v2{clone(){return new P4(null,fH(this.transform))}constructor(e,t){super(e),this.transform=t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${gH(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function F4(e){let t=0;return function n(r,i){if(r instanceof s6&&!r.isGenerator&&!i2(r.data)){e.push(i);i={name:null,source:i.name,transform:[]}}if(r instanceof r6&&(r.parent instanceof s6&&!i.source?(i.format={...i.format??{},parse:r.assembleFormatParse()},i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof K5)return i.name||(i.name="data_"+t++),!i.source||i.transform.length>0?(e.push(i),r.data=i.name):r.data=i.source,void e.push(...r.assemble());if((r instanceof o6||r instanceof a6||r instanceof _4||r instanceof R3||r instanceof K3||r instanceof j4||r instanceof Q5||r instanceof A4||r instanceof N6||r instanceof D6||r instanceof E4||r instanceof O4||r instanceof w4||r instanceof S4||r instanceof $4||r instanceof C4||r instanceof i6||r instanceof P4||r instanceof M4||r instanceof k4)&&i.transform.push(r.assemble()),(r instanceof X5||r instanceof k2||r instanceof N4||r instanceof j6||r instanceof D4)&&i.transform.push(...r.assemble()),r instanceof b2)if(i.source&&0===i.transform.length)r.setSource(i.source);else if(r.parent instanceof b2)r.setSource(i.name);else if(i.name||(i.name="data_"+t++),r.setSource(i.name),1===r.numChildren()){e.push(i);i={name:null,source:i.name,transform:[]}}switch(r.numChildren()){case 0:r instanceof b2&&(!i.source||i.transform.length>0)&&e.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name="data_"+t++);let o=i.name;!i.source||i.transform.length>0?e.push(i):o=i.source;for(const e of r.children){n(e,{name:null,source:o,transform:[]})}break}}}}function T4(e){return"top"===e||"left"===e||yY(e)?"header":"footer"}function z4(e,t){const{facet:n,config:r,child:i,component:o}=e;if(e.channelHasField(t)){const a=n[t],s=n5("title",null,r,t);let l=uK(a,r,{allowDisabling:!0,includeDefault:void 0===s||!!s});i.component.layoutHeaders[t].title&&(l=ha(l)?l.join(", "):l,l+=` / ${i.component.layoutHeaders[t].title}`,i.component.layoutHeaders[t].title=null);const u=n5("labelOrient",a.header,r,t),c=null!==a.header&&WH(a.header?.labels,r.header.labels,!0),f=vH(["bottom","right"],u)?"footer":"header";o.layoutHeaders[t]={title:null!==a.header?l:null,facetFieldDef:a,[f]:"facet"===t?[]:[R4(e,t,c)]}}}function R4(e,t,n){const r="row"===t?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function L4(e,t){const{child:n}=e;if(n.component.axes[t]){const{layoutHeaders:r,resolve:i}=e.component;if(i.axis[t]=_5(i,t),"shared"===i.axis[t]){const i="x"===t?"column":"row",o=r[i];for(const r of n.component.axes[t]){const t=T4(r.get("orient"));o[t]??(o[t]=[R4(e,i,!1)]);const n=q3(r,"main",e.config,{header:!0});n&&o[t][0].axes.push(n),r.mainExtracted=!0}}}}function B4(e){for(const t of e.children)t.parseLayoutSize()}function I4(e,t){const n=x5(t),r=$V(n),i=e.component.resolve,o=e.component.layoutSize;let a;for(const s of e.children){const t=s.component.layoutSize.getWithExplicit(n),o=i.scale[r]??k5(r,e);if("independent"===o&&"step"===t.value){a=void 0;break}if(a){if("independent"===o&&a.value!==t.value){a=void 0;break}a=n2(a,t,n,"")}else a=t}if(a){for(const r of e.children)e.renameSignal(r.getName(n),e.getName(t)),r.component.layoutSize.set(n,"merged",!1);o.setWithExplicit(t,a)}else o.setWithExplicit(t,{explicit:!1,value:void 0})}function U4(e,t){const n="width"===t?"x":"y",r=e.config,i=e.getScaleComponent(n);if(i){const e=i.get("type"),n=i.get("range");if(xJ(e)){const e=P0(r.view,t);return vY(n)||S0(e)?"step":e}return C0(r.view,t)}if(e.hasProjection||"arc"===e.mark)return C0(r.view,t);{const e=P0(r.view,t);return S0(e)?e.step:e}}function q4(e,t,n){return iK(t,{suffix:`by_${iK(e)}`,...n??{}})}class W4 extends x4{constructor(e,t,n,r){super(e,"facet",t,n,r,e.resolve),this.child=y9(e.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(e.facet)}initFacet(e){if(!CQ(e))return{facet:this.initFacetFieldDef(e,"facet")};const t=SH(e),n={};for(const r of t){if(![JH,QH].includes(r)){wX(oX(r,"facet"));break}const t=e[r];if(void 0===t.field){wX(iX(t,r));break}n[r]=this.initFacetFieldDef(t,r)}return n}initFacetFieldDef(e,t){const n=yK(e,t);return n.header?n.header=pY(n.header):null===n.header&&(n.header=null),n}channelHasField(e){return!!this.facet[e]}fieldDef(e){return this.facet[e]}parseData(){this.component.data=H4(this),this.child.parseData()}parseLayoutSize(){B4(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),function(e){for(const t of UG)z4(e,t);L4(e,"x"),L4(e,"y")}(this)}assembleSelectionTopLevelSignals(e){return this.child.assembleSelectionTopLevelSignals(e)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(e){return this.child.assembleSelectionData(e)}getHeaderLayoutMixins(){const e={};for(const t of UG)for(const n of o5){const r=this.component.layoutHeaders[t],i=r[n],{facetFieldDef:o}=r;if(o){const n=n5("titleOrient",o.header,this.config,t);if(["right","bottom"].includes(n)){const r=t5(t,n);e.titleAnchor??(e.titleAnchor={}),e.titleAnchor[r]="end"}}if(i?.[0]){const i="row"===t?"height":"width",o="header"===n?"headerBand":"footerBand";"facet"===t||this.child.component.layoutSize.get(i)||(e[o]??(e[o]={}),e[o][t]=.5),r.title&&(e.offset??(e.offset={}),e.offset["row"===t?"rowTitle":"columnTitle"]=10)}}return e}assembleDefaultLayout(){const{column:e,row:t}=this.facet,n=e?this.columnDistinctSignal():t?1:void 0;let r="all";return(t||"independent"!==this.component.resolve.scale.x)&&(e||"independent"!==this.component.resolve.scale.y)||(r="none"),{...this.getHeaderLayoutMixins(),...n?{columns:n}:{},bounds:"full",align:r}}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof W4)){return{signal:`length(data('${this.getName("column_domain")}'))`}}}assembleGroupStyle(){}assembleGroup(e){return this.parent&&this.parent instanceof W4?{...this.channelHasField("column")?{encode:{update:{columns:{field:iK(this.facet.column,{prefix:"distinct"})}}}}:{},...super.assembleGroup(e)}:super.assembleGroup(e)}getCardinalityAggregateForChild(){const e=[],t=[],n=[];if(this.child instanceof W4){if(this.child.channelHasField("column")){const r=iK(this.child.facet.column);e.push(r),t.push("distinct"),n.push(`distinct_${r}`)}}else for(const r of jV){const i=this.child.component.scales[r];if(i&&!i.merged){const o=i.get("type"),a=i.get("range");if(xJ(o)&&vY(a)){const i=H6(G6(this.child,r));i?(e.push(i),t.push("distinct"),n.push(`distinct_${i}`)):wX(ZY(r))}}}return{fields:e,ops:t,as:n}}assembleFacet(){const{name:e,data:t}=this.component.data.facetRoot,{row:n,column:r}=this.facet,{fields:i,ops:o,as:a}=this.getCardinalityAggregateForChild(),s=[];for(const u of UG){const e=this.facet[u];if(e){s.push(iK(e));const{bin:t,sort:l}=e;if(lY(t)&&s.push(iK(e,{binSuffix:"end"})),AQ(l)){const{field:t,op:s=DQ}=l,u=q4(e,l);n&&r?(i.push(u),o.push("max"),a.push(u)):(i.push(t),o.push(s),a.push(u))}else if(ha(l)){const t=e5(e,u);i.push(t),o.push("max"),a.push(t)}}}const l=!!n&&!!r;return{name:e,data:t,groupby:s,...l||i.length>0?{aggregate:{...l?{cross:l}:{},...i.length?{fields:i,ops:o,as:a}:{}}}:{}}}facetSortFields(e){const{facet:t}=this,n=t[e];return n?AQ(n.sort)?[q4(n,n.sort,{expr:"datum"})]:ha(n.sort)?[e5(n,e,{expr:"datum"})]:[iK(n,{expr:"datum"})]:[]}facetSortOrder(e){const{facet:t}=this,n=t[e];if(n){const{sort:e}=n;return[(AQ(e)?e.order:!ha(e)&&e)||"ascending"]}return[]}assembleLabelTitle(){const{facet:e,config:t}=this;if(e.facet)return f5(e.facet,"facet",t);const n={row:["top","bottom"],column:["left","right"]};for(const r of i5)if(e[r]){const i=n5("labelOrient",e[r]?.header,t,r);if(n[r].includes(i))return f5(e[r],r,t)}}assembleMarks(){const{child:e}=this,t=function(e){const t=[],n=F4(t);for(const r of e.children)n(r,{source:e.name,name:null,transform:[]});return t}(this.component.data.facetRoot),n=e.assembleGroupEncodeEntry(!1),r=this.assembleLabelTitle()||e.assembleTitle(),i=e.assembleGroupStyle(),o={name:this.getName("cell"),type:"group",...r?{title:r}:{},...i?{style:i}:{},from:{facet:this.assembleFacet()},sort:{field:UG.map((e=>this.facetSortFields(e))).flat(),order:UG.map((e=>this.facetSortOrder(e))).flat()},...t.length>0?{data:t}:{},...n?{encode:{update:n}}:{},...e.assembleGroup(m2(this,[]))};return[o]}getMapping(){return this.facet}}function Z4(e,t){for(const n of t){const t=n.data;if(e.name&&n.hasName()&&e.name!==n.dataName)continue;const r=e.format?.mesh,i=t.format?.feature;if(r&&i)continue;const o=e.format?.feature;if((o||i)&&o!==i)continue;const a=t.format?.mesh;if(!r&&!a||r===a)if(o2(e)&&o2(t)){if(cH(e.values,t.values))return n}else if(i2(e)&&i2(t)){if(e.url===t.url)return n}else if(a2(e)&&e.name===n.dataName)return n}return null}function H4(e){let t=function(e,t){if(e.data||!e.parent){if(null===e.data){const e=new s6({values:[]});return t.push(e),e}const n=Z4(e.data,t);if(n)return s2(e.data)||(n.data.format=wH({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const n=new s6(e.data);return t.push(n),n}}return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}(e,e.component.data.sources);const{outputNodes:n,outputNodeRefCounts:r}=e.component.data,i=e.data,o=!(i&&(s2(i)||i2(i)||o2(i)))&&e.parent?e.parent.component.data.ancestorParse.clone():new r2;s2(i)?(l2(i)?t=new a6(t,i.sequence):c2(i)&&(t=new o6(t,i.graticule)),o.parseNothing=!0):null===i?.format?.parse&&(o.parseNothing=!0),t=r6.makeExplicit(t,e,o)??t,t=new i6(t);const a=e.parent&&v4(e.parent);(m4(e)||g4(e))&&a&&(t=X5.makeFromEncoding(t,e)??t),e.transforms.length>0&&(t=function(e,t,n){let r=0;for(const i of t.transforms){let o,a;if(A1(i))a=e=new K3(e,i),o="derived";else if(v1(i)){const r=t6(i);a=e=r6.makeWithAncestors(e,{},r,n)??e,e=new R3(e,t,i.filter)}else if($1(i))a=e=X5.makeFromTransform(e,i,t),o="number";else if(M1(i))o="date",void 0===n.getWithExplicit(i.field).value&&(e=new r6(e,{[i.field]:o}),n.set(i.field,o,!1)),a=e=k2.makeFromTransform(e,i);else if(P1(i))a=e=Q5.makeFromTransform(e,i),o="number",M3(t)&&(e=new i6(e));else if(x1(i))a=e=A4.make(e,t,i,r++),o="derived";else if(j1(i))a=e=new N6(e,i),o="number";else if(N1(i))a=e=new D6(e,i),o="number";else if(F1(i))a=e=j6.makeFromTransform(e,i),o="derived";else if(T1(i))a=e=new E4(e,i),o="derived";else if(z1(i))a=e=new k4(e,i),o="derived";else if(S1(i))a=e=new O4(e,i),o="derived";else if(w1(i))a=e=new M4(e,i),o="derived";else if(D1(i))e=new P4(e,i);else if(C1(i))a=e=N4.makeFromTransform(e,i),o="derived";else if(k1(i))a=e=new w4(e,i),o="derived";else if(_1(i))a=e=new $4(e,i),o="derived";else if(O1(i))a=e=new C4(e,i),o="derived";else{if(!E1(i)){wX(QY(i));continue}a=e=new S4(e,i),o="derived"}if(a&&void 0!==o)for(const e of a.producedFields()??[])n.set(e,o,!1)}return e}(t,e,o));const s=function(e){const t={};if(m4(e)&&e.component.selection)for(const n of SH(e.component.selection)){const r=e.component.selection[n];for(const e of r.project.items)!e.channel&&qH(e.field)>1&&(t[e.field]="flatten")}return t}(e),l=n6(e);t=r6.makeWithAncestors(t,{},{...s,...l},o)??t,m4(e)&&(t=D4.parseAll(t,e),t=j4.parseAll(t,e)),(m4(e)||g4(e))&&(a||(t=X5.makeFromEncoding(t,e)??t),t=k2.makeFromEncoding(t,e)??t,t=K3.parseAllForSortIndex(t,e));const u=e.getDataName(f2.Raw),c=new b2(t,u,f2.Raw,r);if(n[u]=c,t=c,m4(e)){const n=Q5.makeFromEncoding(t,e);n&&(t=n,M3(e)&&(t=new i6(t))),t=N4.makeFromEncoding(t,e)??t,t=j6.makeFromEncoding(t,e)??t}m4(e)&&(t=_4.make(t,e)??t);const f=e.getDataName(f2.Main),d=new b2(t,f,f2.Main,r);n[f]=d,t=d,m4(e)&&function(e,t){for(const[n,r]of $H(e.component.selection??{})){const i=e.getName(`lookup_${n}`);e.component.data.outputNodes[i]=r.materialized=new b2(new R3(t,e,{param:n}),i,f2.Lookup,e.component.data.outputNodeRefCounts)}}(e,d);let h=null;if(g4(e)){const r=e.getName("facet");t=function(e,t){const{row:n,column:r}=t;if(n&&r){let t=null;for(const i of[n,r])if(AQ(i.sort)){const{field:n,op:r=DQ}=i.sort;e=t=new D6(e,{joinaggregate:[{op:r,field:n,as:q4(i,i.sort,{forAs:!0})}],groupby:[iK(i)]})}return t}return null}(t,e.facet)??t,h=new K5(t,e,r,d.getSource()),n[r]=h}return{...e.component.data,outputNodes:n,outputNodeRefCounts:r,raw:c,main:d,facetRoot:h,ancestorParse:o}}class G4 extends b4{constructor(e,t,n,r){super(e,"concat",t,n,r,e.resolve),"shared"!==e.resolve?.axis?.x&&"shared"!==e.resolve?.axis?.y||wX("Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415)."),this.children=this.getChildren(e).map(((e,t)=>y9(e,this,this.getName(`concat_${t}`),void 0,r)))}parseData(){this.component.data=H4(this);for(const e of this.children)e.parseData()}parseSelections(){this.component.selection={};for(const e of this.children){e.parseSelections();for(const t of SH(e.component.selection))this.component.selection[t]=e.component.selection[t]}}parseMarkGroup(){for(const e of this.children)e.parseMarkGroup()}parseAxesAndHeaders(){for(const e of this.children)e.parseAxesAndHeaders()}getChildren(e){return D0(e)?e.vconcat:j0(e)?e.hconcat:e.concat}parseLayoutSize(){!function(e){B4(e);const t=1===e.layout.columns?"width":"childWidth",n=void 0===e.layout.columns?"height":"childHeight";I4(e,t),I4(e,n)}(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(e){return this.children.reduce(((e,t)=>t.assembleSelectionTopLevelSignals(e)),e)}assembleSignals(){return this.children.forEach((e=>e.assembleSignals())),[]}assembleLayoutSignals(){const e=g5(this);for(const t of this.children)e.push(...t.assembleLayoutSignals());return e}assembleSelectionData(e){return this.children.reduce(((e,t)=>t.assembleSelectionData(e)),e)}assembleMarks(){return this.children.map((e=>{const t=e.assembleTitle(),n=e.assembleGroupStyle(),r=e.assembleGroupEncodeEntry(!1);return{type:"group",name:e.getName("group"),...t?{title:t}:{},...n?{style:n}:{},...r?{encode:{update:r}}:{},...e.assembleGroup()}}))}assembleGroupStyle(){}assembleDefaultLayout(){const e=this.layout.columns;return{...null!=e?{columns:e}:{},bounds:"full",align:"each"}}}const V4={disable:1,gridScale:1,scale:1,...NK,labelExpr:1,encode:1},Y4=SH(V4);class X4 extends J1{constructor(e,t,n){void 0===e&&(e={}),void 0===t&&(t={}),void 0===n&&(n=!1),super(),this.explicit=e,this.implicit=t,this.mainExtracted=n}clone(){return new X4(fH(this.explicit),fH(this.implicit),this.mainExtracted)}hasAxisPart(e){return"axis"===e||("grid"===e||"title"===e?!!this.get(e):!(!1===(t=this.get(e))||null===t));var t}hasOrientSignalRef(){return yY(this.explicit.orient)}}const J4={bottom:"top",top:"bottom",left:"right",right:"left"};function Q4(e,t){if(!e)return t.map((e=>e.clone()));{if(e.length!==t.length)return;const n=e.length;for(let r=0;r<n;r++){const n=e[r],i=t[r];if(!!n!=!!i)return;if(n&&i){const t=n.getWithExplicit("orient"),o=i.getWithExplicit("orient");if(t.explicit&&o.explicit&&t.value!==o.value)return;e[r]=K4(n,i)}}}return e}function K4(e,t){for(const n of Y4){const r=n2(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",((e,t)=>{switch(n){case"title":return LY(e,t);case"gridScale":return{explicit:e.explicit,value:WH(e.value,t.value)}}return t2(e,t,n,"axis")}));e.setWithExplicit(n,r)}return e}function e9(e,t,n,r,i){if("disable"===t)return void 0!==n;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(yY(n.labelAngle)?n.labelAngle:YH(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===Q3(r,i))return!0}return e===n[t]}const t9=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function n9(e,t){let n=t.axis(e);const r=new X4,i=pK(t.encoding[e]),{mark:o,config:a}=t,s=n?.orient||a["x"===e?"axisX":"axisY"]?.orient||a.axis?.orient||function(e){return"x"===e?"bottom":"left"}(e),l=t.getScaleComponent(e).get("type"),u=function(e,t,n,r){const i="band"===t?["axisDiscrete","axisBand"]:"point"===t?["axisDiscrete","axisPoint"]:gJ(t)?["axisQuantitative"]:"time"===t||"utc"===t?["axisTemporal"]:[],o="x"===e?"axisX":"axisY",a=yY(n)?"axisOrient":`axis${TH(n)}`,s=[...i,...i.map((e=>o+e.substr(4)))],l=["axis",a,o];return{vlOnlyAxisConfig:Z3(s,r,e,n),vgAxisConfig:Z3(l,r,e,n),axisConfigStyle:H3([...l,...s],r)}}(e,l,s,t.config),c=void 0!==n?!n:G3("disable",a.style,n?.style,u).configValue;if(r.set("disable",c,void 0!==n),c)return r;n=n||{};const f=function(e,t,n,r,i){const o=t?.labelAngle;if(void 0!==o)return yY(o)?o:YH(o);{const{configValue:o}=G3("labelAngle",r,t?.style,i);return void 0!==o?YH(o):n!==eG||!vH([sJ,oJ],e.type)||WQ(e)&&e.timeUnit?void 0:270}}(i,n,e,a.style,u),d=wQ(n.formatType,i,l),h=xQ(i,i.type,n.format,n.formatType,a,!0),p={fieldOrDatumDef:i,axis:n,channel:e,model:t,scaleType:l,orient:s,labelAngle:f,format:h,formatType:d,mark:o,config:a};for(const y of Y4){const i=y in V3?V3[y](p):AK(y)?n[y]:void 0,o=void 0!==i,s=e9(i,y,n,t,e);if(o&&s)r.set(y,i,s);else{const{configValue:e,configFrom:t}=AK(y)&&"values"!==y?G3(y,a.style,n.style,u):{},l=void 0!==e;o&&!l?r.set(y,i,s):("vgAxisConfig"!==t||t9.has(y)&&l||EK(e)||yY(e))&&r.set(y,e,!1)}}const m=n.encoding??{},g=DK.reduce(((n,i)=>{if(!r.hasAxisPart(i))return n;const o=w5(m[i]??{},t),a="labels"===i?function(e,t,n){const{encoding:r,config:i}=e,o=pK(r[t])??pK(r[iV(t)]),a=e.axis(t)||{},{format:s,formatType:l}=a;if(pQ(l))return{text:bQ({fieldOrDatumDef:o,field:"datum.value",format:s,formatType:l,config:i}),...n};if(void 0===s&&void 0===l&&i.customFormatTypes){if("quantitative"===ZQ(o)){if(eK(o)&&"normalize"===o.stack&&i.normalizedNumberFormatType)return{text:bQ({fieldOrDatumDef:o,field:"datum.value",format:i.normalizedNumberFormat,formatType:i.normalizedNumberFormatType,config:i}),...n};if(i.numberFormatType)return{text:bQ({fieldOrDatumDef:o,field:"datum.value",format:i.numberFormat,formatType:i.numberFormatType,config:i}),...n}}if("temporal"===ZQ(o)&&i.timeFormatType&&WQ(o)&&!o.timeUnit)return{text:bQ({fieldOrDatumDef:o,field:"datum.value",format:i.timeFormat,formatType:i.timeFormatType,config:i}),...n}}return n}(t,e,o):o;return void 0===a||NH(a)||(n[i]={update:a}),n}),{});return NH(g)||r.set("encode",g,!!n.encoding||void 0!==n.labelAngle),r}function r9(e,t){const{config:n}=e;return{...s3(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...V2("x",e,{defaultPos:"mid"}),...V2("y",e,{defaultPos:"mid"}),...W2("size",e),...W2("angle",e),...i9(e,n,t)}}function i9(e,t,n){return n?{shape:{value:n}}:W2("shape",e)}const o9={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return e.encoding.x||e.encoding.y||e.encoding.latitude||e.encoding.longitude?{...s3(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...K2("x",e,{defaultPos:"horizontal"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"vertical"!==n}),...K2("y",e,{defaultPos:"vertical"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"horizontal"!==n}),...W2("size",e,{vgChannel:"strokeWidth"})}:{}}};function a9(e,t,n){if(void 0===CY("align",e,n))return"center"}function s9(e,t,n){if(void 0===CY("baseline",e,n))return"middle"}const l9={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,r=n.orient,i="horizontal"===r?"width":"height",o="horizontal"===r?"height":"width";return{...s3(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...V2("x",e,{defaultPos:"mid",vgChannel:"xc"}),...V2("y",e,{defaultPos:"mid",vgChannel:"yc"}),...W2("size",e,{defaultValue:u9(e),vgChannel:i}),[o]:DY(CY("thickness",n,t))}}};function u9(e){const{config:t,markDef:n}=e,{orient:r}=n,i="horizontal"===r?"width":"height",o=e.getScaleComponent("horizontal"===r?"x":"y"),a=CY("size",n,t,{vgChannel:i})??t.tick.bandSize;if(void 0!==a)return a;{const e=o?o.get("range"):void 0;if(e&&vY(e)&&ls(e.step))return 3*e.step/4;return 3*M0(t.view,i)/4}}const c9={arc:{vgMark:"arc",encodeEntry:e=>({...s3(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...V2("x",e,{defaultPos:"mid"}),...V2("y",e,{defaultPos:"mid"}),...n3(e,"radius"),...n3(e,"theta")})},area:{vgMark:"area",encodeEntry:e=>({...s3(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"}),...K2("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"horizontal"===e.markDef.orient}),...K2("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"vertical"===e.markDef.orient}),...c3(e)})},bar:{vgMark:"rect",encodeEntry:e=>({...s3(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...n3(e,"x"),...n3(e,"y")})},circle:{vgMark:"symbol",encodeEntry:e=>r9(e,"circle")},geoshape:{vgMark:"shape",encodeEntry:e=>({...s3(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})}),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[{type:"geoshape",projection:e.projectionName(),...n&&WQ(n)&&n.type===lJ?{field:iK(n,{expr:"datum"})}:{}}]}},image:{vgMark:"image",encodeEntry:e=>({...s3(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"}),...n3(e,"x"),...n3(e,"y"),...T2(e,"url")})},line:{vgMark:"line",encodeEntry:e=>({...s3(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...V2("x",e,{defaultPos:"mid"}),...V2("y",e,{defaultPos:"mid"}),...W2("size",e,{vgChannel:"strokeWidth"}),...c3(e)})},point:{vgMark:"symbol",encodeEntry:e=>r9(e)},rect:{vgMark:"rect",encodeEntry:e=>({...s3(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...n3(e,"x"),...n3(e,"y")})},rule:o9,square:{vgMark:"symbol",encodeEntry:e=>r9(e,"square")},text:{vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return{...s3(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"}),...V2("x",e,{defaultPos:"mid"}),...V2("y",e,{defaultPos:"mid"}),...T2(e),...W2("size",e,{vgChannel:"fontSize"}),...W2("angle",e),...f3("align",a9(e.markDef,n,t)),...f3("baseline",s9(e.markDef,n,t)),...V2("radius",e,{defaultPos:null}),...V2("theta",e,{defaultPos:null})}}},tick:l9,trail:{vgMark:"trail",encodeEntry:e=>({...s3(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...V2("x",e,{defaultPos:"mid"}),...V2("y",e,{defaultPos:"mid"}),...W2("size",e),...c3(e)})}};function f9(e){if(vH([BJ,zJ,HJ],e.mark)){const t=UK(e.mark,e.encoding);if(t.length>0)return function(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:d9+e.requestDataName(f2.Main),data:e.requestDataName(f2.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:p9(e,{fromPrefix:d9})}]}(e,t)}else if(e.mark===RJ){const t=kY.some((t=>CY(t,e.markDef,e.config)));if(e.stack&&!e.fieldDef("size")&&t)return function(e){const[t]=p9(e,{fromPrefix:h9}),n=e.scaleName(e.stack.fieldChannel),r=function(t){return void 0===t&&(t={}),e.vgField(e.stack.fieldChannel,t)},i=(e,t)=>`${e}(${[r({prefix:"min",suffix:"start",expr:t}),r({prefix:"max",suffix:"start",expr:t}),r({prefix:"min",suffix:"end",expr:t}),r({prefix:"max",suffix:"end",expr:t})].map((e=>`scale('${n}',${e})`)).join(",")})`;let o,a;"x"===e.stack.fieldChannel?(o={...hH(t.encode.update,["y","yc","y2","height",...kY]),x:{signal:i("min","datum")},x2:{signal:i("max","datum")},clip:{value:!0}},a={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},t.encode.update={...pH(t.encode.update,["y","yc","y2"]),height:{field:{group:"height"}}}):(o={...hH(t.encode.update,["x","xc","x2","width"]),y:{signal:i("min","datum")},y2:{signal:i("max","datum")},clip:{value:!0}},a={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},t.encode.update={...pH(t.encode.update,["x","xc","x2"]),width:{field:{group:"width"}}});for(const l of kY){const n=MY(l,e.markDef,e.config);t.encode.update[l]?(o[l]=t.encode.update[l],delete t.encode.update[l]):n&&(o[l]=DY(n)),n&&(t.encode.update[l]={value:0})}const s=[];if(e.stack.groupbyChannels?.length>0)for(const l of e.stack.groupbyChannels){const t=e.fieldDef(l),n=iK(t);n&&s.push(n),(t?.bin||t?.timeUnit)&&s.push(iK(t,{binSuffix:"end"}))}o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce(((n,r)=>{if(t.encode.update[r])return{...n,[r]:t.encode.update[r]};{const t=MY(r,e.markDef,e.config);return void 0!==t?{...n,[r]:DY(t)}:n}}),o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0});return[{type:"group",from:{facet:{data:e.requestDataName(f2.Main),name:h9+e.requestDataName(f2.Main),groupby:s,aggregate:{fields:[r({suffix:"start"}),r({suffix:"start"}),r({suffix:"end"}),r({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:a},marks:[t]}]}]}(e)}return p9(e)}const d9="faceted_path_";const h9="stack_group_";function p9(e,t){void 0===t&&(t={fromPrefix:""});const{mark:n,markDef:r,encoding:i,config:o}=e,a=WH(r.clip,function(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return!(!t?.get("selectionExtent")&&!n?.get("selectionExtent"))||void 0}(e),function(e){const t=e.component.projection;return!(!t||t.isFit)||void 0}(e)),s=$Y(r),l=i.key,u=function(e){const{encoding:t,stack:n,mark:r,markDef:i,config:o}=e,a=t.order;if(!(!ha(a)&&QQ(a)&&yH(a.value)||!a&&yH(CY("order",i,o)))){if((ha(a)||WQ(a))&&!n)return TY(a,{expr:"datum"});if(XJ(r)){const n="horizontal"===i.orient?"y":"x",r=t[n];if(WQ(r)){const t=r.sort;return ha(t)?{field:iK(r,{prefix:n,suffix:"sort_index",expr:"datum"})}:AQ(t)?{field:iK({aggregate:zK(e.encoding)?t.op:void 0,field:t.field},{expr:"datum"})}:SQ(t)?{field:iK(e.fieldDef(t.encoding),{expr:"datum"}),order:t.order}:null===t?void 0:{field:iK(r,{binSuffix:e.stack?.impute?"mid":void 0,expr:"datum"})}}}}}(e),c=function(e){if(!e.component.selection)return null;const t=SH(e.component.selection).length;let n=t,r=e.parent;for(;r&&0===n;)n=SH(r.component.selection).length,r=r.parent;return n?{interactive:t>0||"geoshape"===e.mark||!!e.encoding.tooltip}:null}(e),f=CY("aria",r,o),d=c9[n].postEncodingTransform?c9[n].postEncodingTransform(e):null;return[{name:e.getName("marks"),type:c9[n].vgMark,...a?{clip:!0}:{},...s?{style:s}:{},...l?{key:l.field}:{},...u?{sort:u}:{},...c||{},...!1===f?{aria:f}:{},from:{data:t.fromPrefix+e.requestDataName(f2.Main)},encode:{update:c9[n].encodeEntry(e)},...d?{transform:d}:{}}]}class m9 extends x4{constructor(e,t,n,r,i){void 0===r&&(r={}),super(e,"unit",t,n,i,void 0,A0(e)?e.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const o=KJ(e.mark)?{...e.mark}:{type:e.mark},a=o.type;void 0===o.filled&&(o.filled=function(e,t,n){let{graticule:r}=n;if(r)return!1;const i=MY("filled",e,t),o=e.type;return WH(i,o!==IJ&&o!==BJ&&o!==qJ)}(o,i,{graticule:e.data&&c2(e.data)}));const s=this.encoding=function(e,t,n,r){const i={};for(const a of SH(e))KG(a)||wX(`${o=a}-encoding is dropped as ${o} is not a valid encoding channel.`);var o;for(let a of uV){if(!e[a])continue;const o=e[a];if(MV(a)){const e=lV(a),t=i[e];if(WQ(t)){if(nJ(t.type)&&WQ(o)&&!t.timeUnit){wX(eX(e));continue}}else a=e,wX(tX(e))}if("angle"!==a||"arc"!==t||e.theta||(wX("Arc marks uses theta channel rather than angle, replacing angle with theta."),a=lG),LK(e,a,t)){if(a===vG&&"line"===t){const t=hK(e[a]);if(t?.aggregate){wX("Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.");continue}}if(a===pG&&(n?"fill"in e:"stroke"in e))wX(rX("encoding",{fill:"fill"in e,stroke:"stroke"in e}));else if(a===jG||a===DG&&!ha(o)&&!QQ(o)||a===SG&&ha(o)){if(o){if(a===DG){const t=e[a];if(BQ(t)){i[a]=t;continue}}i[a]=Ra(o).reduce(((e,t)=>(WQ(t)?e.push(yK(t,a)):wX(iX(t,a)),e)),[])}}else{if(a===SG&&null===o)i[a]=null;else if(!(WQ(o)||HQ(o)||QQ(o)||IQ(o)||yY(o))){wX(iX(o,a));continue}i[a]=mK(o,a,r)}}else wX(oX(a,t))}return i}(e.encoding||{},a,o.filled,i);this.markDef=n1(o,s,i),this.size=function(e){let{encoding:t,size:n}=e;for(const r of jV){const e=oV(r);S0(n[e])&&GQ(t[r])&&(delete n[e],wX(pX(e)))}return n}({encoding:s,size:A0(e)?{...r,...e.width?{width:e.width}:{},...e.height?{height:e.height}:{}}:r}),this.stack=t1(this.markDef,s),this.specifiedScales=this.initScales(a,s),this.specifiedAxes=this.initAxes(s),this.specifiedLegends=this.initLegends(s),this.specifiedProjection=e.projection,this.selection=(e.params??[]).filter((e=>_0(e)))}get hasProjection(){const{encoding:e}=this,t=this.mark===YJ,n=e&&RG.some((t=>XQ(e[t])));return t||n}scaleDomain(e){const t=this.specifiedScales[e];return t?t.domain:void 0}axis(e){return this.specifiedAxes[e]}legend(e){return this.specifiedLegends[e]}initScales(e,t){return ZV.reduce(((e,n)=>{const r=pK(t[n]);return r&&(e[n]=this.initScale(r.scale??{})),e}),{})}initScale(e){const{domain:t,range:n}=e,r=pY(e);return ha(t)&&(r.domain=t.map(OY)),ha(n)&&(r.range=n.map(OY)),r}initAxes(e){return jV.reduce(((t,n)=>{const r=e[n];if(XQ(r)||n===eG&&XQ(e.x2)||n===tG&&XQ(e.y2)){const e=XQ(r)?r.axis:void 0;t[n]=e?this.initAxis({...e}):e}return t}),{})}initAxis(e){const t=SH(e),n={};for(const r of t){const t=e[r];n[r]=EK(t)?_Y(t):OY(t)}return n}initLegends(e){return qV.reduce(((t,n)=>{const r=pK(e[n]);if(r&&function(e){switch(e){case pG:case mG:case gG:case vG:case yG:case xG:case _G:case OG:return!0;case wG:case kG:case bG:return!1}}(n)){const e=r.legend;t[n]=e?pY(e):e}return t}),{})}parseData(){this.component.data=H4(this)}parseLayoutSize(){!function(e){const{size:t,component:n}=e;for(const r of jV){const i=oV(r);if(t[i]){const e=t[i];n.layoutSize.set(i,S0(e)?"step":e,!0)}else{const t=U4(e,i);n.layoutSize.set(i,t,!1)}}}(this)}parseSelections(){this.component.selection=function(e,t){const n={},r=e.config.selection;if(!t||!t.length)return n;for(const i of t){const t=MH(i.name),o=i.select,a=cs(o)?o:o.type,s=pa(o)?fH(o):{type:a},l=r[a];for(const e in l)"fields"!==e&&"encodings"!==e&&("mark"===e&&(s[e]={...l[e],...s[e]}),void 0!==s[e]&&!0!==s[e]||(s[e]=fH(l[e]??s[e])));const u=n[t]={...s,name:t,type:a,init:i.value,bind:i.bind,events:cs(s.on)?wI(s.on,"scope"):Ra(fH(s.on))},c=fH(i);for(const n of $3)n.defined(u)&&n.parse&&n.parse(e,u,c)}return n}(this,this.selection)}parseMarkGroup(){this.component.mark=f9(this)}parseAxesAndHeaders(){var e;this.component.axes=(e=this,jV.reduce(((t,n)=>(e.component.scales[n]&&(t[n]=[n9(n,e)]),t)),{}))}assembleSelectionTopLevelSignals(e){return function(e,t){let n=!1;for(const r of AH(e.component.selection??{})){const i=r.name,o=vs(i+j3);if(0===t.filter((e=>e.name===i)).length){const e="global"===r.resolve?"union":r.resolve,n="point"===r.type?", true, true)":")";t.push({name:r.name,update:`${A3}(${o}, ${vs(e)}${n}`})}n=!0;for(const n of $3)n.defined(r)&&n.topLevelSignals&&(t=n.topLevelSignals(e,r,t))}n&&0===t.filter((e=>"unit"===e.name)).length&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]});return y2(t)}(this,e)}assembleSignals(){return[...W3(this),...p2(this,[])]}assembleSelectionData(e){return function(e,t){const n=[...t],r=C3(e,{escape:!1});for(const i of AH(e.component.selection??{})){const e={name:i.name+j3};if(i.project.hasSelectionId&&(e.transform=[{type:"collect",sort:{field:b0}}]),i.init){const t=i.project.items.map(d2);e.values=i.project.hasSelectionId?i.init.map((e=>({unit:r,[b0]:h2(e,!1)[0]}))):i.init.map((e=>({unit:r,fields:t,values:h2(e,!1)})))}n.filter((e=>e.name===i.name+j3)).length||n.push(e)}return n}(this,e)}assembleLayout(){return null}assembleLayoutSignals(){return g5(this)}assembleMarks(){let e=this.component.mark??[];return this.parent&&v4(this.parent)||(e=g2(this,e)),e.map(this.correctDataNames)}assembleGroupStyle(){const{style:e}=this.view||{};return void 0!==e?e:this.encoding.x||this.encoding.y?"cell":"view"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(e){return PK(this.encoding,e)}fieldDef(e){return hK(this.encoding[e])}typedFieldDef(e){const t=this.fieldDef(e);return JQ(t)?t:null}}class g9 extends b4{constructor(e,t,n,r,i){super(e,"layer",t,n,i,e.resolve,e.view);const o={...r,...e.width?{width:e.width}:{},...e.height?{height:e.height}:{}};this.children=e.layer.map(((e,t)=>{if(V0(e))return new g9(e,this,this.getName(`layer_${t}`),o,i);if(CK(e))return new m9(e,this,this.getName(`layer_${t}`),o,i);throw new Error(BY(e))}))}parseData(){this.component.data=H4(this);for(const e of this.children)e.parseData()}parseLayoutSize(){var e;B4(e=this),I4(e,"width"),I4(e,"height")}parseSelections(){this.component.selection={};for(const e of this.children){e.parseSelections();for(const t of SH(e.component.selection))this.component.selection[t]=e.component.selection[t]}}parseMarkGroup(){for(const e of this.children)e.parseMarkGroup()}parseAxesAndHeaders(){!function(e){const{axes:t,resolve:n}=e.component,r={top:0,bottom:0,right:0,left:0};for(const i of e.children){i.parseAxesAndHeaders();for(const r of SH(i.component.axes))n.axis[r]=_5(e.component.resolve,r),"shared"===n.axis[r]&&(t[r]=Q4(t[r],i.component.axes[r]),t[r]||(n.axis[r]="independent",delete t[r]))}for(const i of jV){for(const o of e.children)if(o.component.axes[i]){if("independent"===n.axis[i]){t[i]=(t[i]??[]).concat(o.component.axes[i]);for(const e of o.component.axes[i]){const{value:t,explicit:n}=e.getWithExplicit("orient");if(!yY(t)){if(r[t]>0&&!n){const n=J4[t];r[t]>r[n]&&e.set("orient",n,!1)}r[t]++}}}delete o.component.axes[i]}if("independent"===n.axis[i]&&t[i]&&t[i].length>1)for(const[e,n]of(t[i]||[]).entries())e>0&&n.get("grid")&&!n.explicit.grid&&(n.implicit.grid=!1)}}(this)}assembleSelectionTopLevelSignals(e){return this.children.reduce(((e,t)=>t.assembleSelectionTopLevelSignals(e)),e)}assembleSignals(){return this.children.reduce(((e,t)=>e.concat(t.assembleSignals())),W3(this))}assembleLayoutSignals(){return this.children.reduce(((e,t)=>e.concat(t.assembleLayoutSignals())),g5(this))}assembleSelectionData(e){return this.children.reduce(((e,t)=>t.assembleSelectionData(e)),e)}assembleGroupStyle(){const e=new Set;for(const n of this.children)for(const t of Ra(n.assembleGroupStyle()))e.add(t);const t=Array.from(e);return t.length>1?t:1===t.length?t[0]:void 0}assembleTitle(){let e=super.assembleTitle();if(e)return e;for(const t of this.children)if(e=t.assembleTitle(),e)return e}assembleLayout(){return null}assembleMarks(){return function(e,t){for(const n of e.children)m4(n)&&(t=g2(n,t));return t}(this,this.children.flatMap((e=>e.assembleMarks())))}assembleLegends(){return this.children.reduce(((e,t)=>e.concat(t.assembleLegends())),B5(this))}}function y9(e,t,n,r,i){if(PQ(e))return new W4(e,t,n,i);if(V0(e))return new g9(e,t,n,r,i);if(CK(e))return new m9(e,t,n,r,i);if(function(e){return D0(e)||j0(e)||E0(e)}(e))return new G4(e,t,n,i);throw new Error(BY(e))}const v9=QZ;var b9=Object.freeze({__proto__:null,accessPathDepth:qH,accessPathWithDatum:zH,compile:function(e,t){var n;void 0===t&&(t={}),t.logger&&(n=t.logger,xX=n),t.fieldTitle&&lK(t.fieldTitle);try{const n=U0(ga(t.config,e.config)),r=W1(e,n),i=y9(r,null,"",void 0,n);i.parse(),function(e,t){M6(e.sources);let n=0,r=0;for(let i=0;i<C6&&F6(e,t,!0);i++)n++;e.sources.map(S6);for(let i=0;i<C6&&F6(e,t,!1);i++)r++;M6(e.sources),Math.max(n,r)===C6&&wX(`Maximum optimization runs(${C6}) reached.`)}(i.component.data,i);const o=function(e,t,n,r){void 0===n&&(n={});const i=e.config?H0(e.config):void 0,o=[].concat(e.assembleSelectionData([]),function(e,t){const n=[],r=F4(n);let i=0;for(const a of e.sources){a.hasName()||(a.dataName="source_"+i++);const e=a.assemble();r(a,e)}for(const a of n)0===a.transform.length&&delete a.transform;let o=0;for(const[a,s]of n.entries())0!==(s.transform??[]).length||s.source||n.splice(o++,0,n.splice(a,1)[0]);for(const a of n)for(const t of a.transform??[])"lookup"===t.type&&(t.from=e.outputNodes[t.from].getSource());for(const a of n)a.name in t&&(a.values=t[a.name]);return n}(e.component.data,n)),a=e.assembleProjections(),s=e.assembleTitle(),l=e.assembleGroupStyle(),u=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();c=c.filter((e=>"width"!==e.name&&"height"!==e.name||void 0===e.value||(t[e.name]=+e.value,!1)));const{params:f,...d}=t;return{$schema:"https://vega.github.io/schema/vega/v5.json",...e.description?{description:e.description}:{},...d,...s?{title:s}:{},...l?{style:l}:{},...u?{encode:{update:u}}:{},data:o,...a.length>0?{projections:a}:{},...e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([]),...O0(f)]),...i?{config:i}:{},...r?{usermeta:r}:{}}}(i,function(e,t,n,r){const i=r.component.layoutSize.get("width"),o=r.component.layoutSize.get("height");void 0===t?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):cs(t)&&(t={type:t});if(i&&o&&(a=t.type,"fit"===a||"fit-x"===a||"fit-y"===a))if("step"===i&&"step"===o)wX(WY()),t.type="pad";else if("step"===i||"step"===o){const e="step"===i?"width":"height";wX(WY($V(e)));const n="width"===e?"height":"width";t.type=function(e){return e?`fit-${$V(e)}`:"fit"}(n)}var a;return{...1===SH(t).length&&t.type?"pad"===t.type?{}:{autosize:t.type}:{autosize:t},...X1(n,!1),...X1(e,!0)}}(e,r.autosize,n,i),e.datasets,e.usermeta);return{spec:o,normalized:r}}finally{t.logger&&(xX=bX),t.fieldTitle&&lK(aK)}},contains:vH,deepEqual:cH,deleteNestedProperty:FH,duplicate:fH,entries:$H,every:xH,fieldIntersection:jH,flatAccessWithDatum:RH,getFirstDefined:WH,hasIntersection:EH,hash:gH,internalField:GH,isBoolean:CH,isEmpty:NH,isEqual:function(e,t){const n=SH(e),r=SH(t);if(n.length!==r.length)return!1;for(const i of n)if(e[i]!==t[i])return!1;return!0},isInternalField:VH,isNullOrFalse:yH,isNumeric:XH,keys:SH,logicalExpr:PH,mergeDeep:wH,never:dH,normalize:W1,normalizeAngle:YH,omit:pH,pick:hH,prefixGenerator:DH,removePathFromField:UH,replaceAll:IH,replacePathInField:BH,resetIdCounter:function(){ZH=42},setEqual:OH,some:bH,stringify:mH,titleCase:TH,unique:_H,uniqueId:HH,vals:AH,varName:MH,version:v9});function x9(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var w9="2.14.0";const k9="#fff",_9="#888",O9={background:"#333",view:{stroke:_9},title:{color:k9,subtitleColor:k9},style:{"guide-label":{fill:k9},"guide-title":{fill:k9}},axis:{domainColor:k9,gridColor:_9,tickColor:k9}},E9="#4572a7",D9={background:"#fff",arc:{fill:E9},area:{fill:E9},line:{stroke:E9,strokeWidth:2},path:{stroke:E9},rect:{fill:E9},shape:{stroke:E9},symbol:{fill:E9,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},j9="#30a2da",N9="#cbcbcb",S9="#f0f0f0",A9="#333",$9={arc:{fill:j9},area:{fill:j9},axis:{domainColor:N9,grid:!0,gridColor:N9,gridWidth:1,labelColor:"#999",labelFontSize:10,titleColor:"#333",tickColor:N9,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:S9,group:{fill:S9},legend:{labelColor:A9,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:A9,titleFontSize:14,titlePadding:10},line:{stroke:j9,strokeWidth:2},path:{stroke:j9,strokeWidth:.5},rect:{fill:j9},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:j9},bar:{binSpacing:2,fill:j9,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},C9="#000",M9={group:{fill:"#e5e5e5"},arc:{fill:C9},area:{fill:C9},line:{stroke:C9},path:{stroke:C9},rect:{fill:C9},shape:{stroke:C9},symbol:{fill:C9,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},P9="Benton Gothic, sans-serif",F9="#82c6df",T9="Benton Gothic Bold, sans-serif",z9="normal",R9={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},L9={background:"#ffffff",title:{anchor:"start",color:"#000000",font:T9,fontSize:22,fontWeight:"normal"},arc:{fill:F9},area:{fill:F9},line:{stroke:F9,strokeWidth:2},path:{stroke:F9},rect:{fill:F9},shape:{stroke:F9},symbol:{fill:F9,size:30},axis:{labelFont:P9,labelFontSize:11.5,labelFontWeight:"normal",titleFont:T9,titleFontSize:13,titleFontWeight:z9},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:P9,labelFontSize:11.5,symbolType:"square",titleFont:T9,titleFontSize:13,titleFontWeight:z9},range:{category:R9["category-6"],diverging:R9["fireandice-6"],heatmap:R9["fire-7"],ordinal:R9["fire-7"],ramp:R9["fire-7"]}},B9="#ab5787",I9="#979797",U9={background:"#f9f9f9",arc:{fill:B9},area:{fill:B9},line:{stroke:B9},path:{stroke:B9},rect:{fill:B9},shape:{stroke:B9},symbol:{fill:B9,size:30},axis:{domainColor:I9,domainWidth:.5,gridWidth:.2,labelColor:I9,tickColor:I9,tickWidth:.2,titleColor:I9},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},q9="#3e5c69",W9={background:"#fff",arc:{fill:q9},area:{fill:q9},line:{stroke:q9},path:{stroke:q9},rect:{fill:q9},shape:{stroke:q9},symbol:{fill:q9},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},Z9="#1696d2",H9="#000000",G9="Lato",V9="Lato",Y9={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},X9={background:"#FFFFFF",title:{anchor:"start",fontSize:18,font:G9},axisX:{domain:!0,domainColor:H9,domainWidth:1,grid:!1,labelFontSize:12,labelFont:V9,labelAngle:0,tickColor:H9,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:G9},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:"#DEDDDD",gridWidth:1,labelFontSize:12,labelFont:V9,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:G9,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:V9,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:G9,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:Y9["six-groups-cat-1"],diverging:Y9["diverging-colors"],heatmap:Y9["diverging-colors"],ordinal:Y9["six-groups-seq"],ramp:Y9["shades-blue"]},area:{fill:Z9},rect:{fill:Z9},line:{color:Z9,stroke:Z9,strokeWidth:5},trail:{color:Z9,stroke:Z9,strokeWidth:0,size:1},path:{stroke:Z9,strokeWidth:.5},point:{filled:!0},text:{font:"Lato",color:Z9,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:Z9,stroke:null}},arc:{fill:Z9},shape:{stroke:Z9},symbol:{fill:Z9,size:30}},J9="#3366CC",Q9="#ccc",K9="Arial, sans-serif",e8={arc:{fill:J9},area:{fill:J9},path:{stroke:J9},rect:{fill:J9},shape:{stroke:J9},symbol:{stroke:J9},circle:{fill:J9},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:K9,fontSize:12},"guide-title":{font:K9,fontSize:12},"group-title":{font:K9,fontSize:12}},title:{font:K9,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:Q9,tickColor:Q9,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},t8=e=>e*(1/3+1),n8=t8(9),r8=t8(10),i8=t8(12),o8="Segoe UI",a8="wf_standard-font, helvetica, arial, sans-serif",s8="#252423",l8="#605E5C",u8="transparent",c8="#118DFF",f8="#DEEFFF",d8=[f8,c8],h8={view:{stroke:u8},background:u8,font:o8,header:{titleFont:a8,titleFontSize:i8,titleColor:s8,labelFont:o8,labelFontSize:r8,labelColor:l8},axis:{ticks:!1,grid:!1,domain:!1,labelColor:l8,labelFontSize:n8,titleFont:a8,titleColor:s8,titleFontSize:i8,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:"#C8C6C4",gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:c8},line:{stroke:c8,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:o8,fontSize:n8,fill:l8},arc:{fill:c8},area:{fill:c8,line:!0,opacity:.6},path:{stroke:c8},rect:{fill:c8},point:{fill:c8,filled:!0,size:75},shape:{stroke:c8},symbol:{fill:c8,strokeWidth:1.5,size:50},legend:{titleFont:o8,titleFontWeight:"bold",titleColor:l8,labelFont:o8,labelFontSize:r8,labelColor:l8,symbolType:"circle",symbolSize:75},range:{category:[c8,"#12239E","#E66C37","#6B007B","#E044A7","#744EC2","#D9B300","#D64550"],diverging:d8,heatmap:d8,ordinal:[f8,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",c8]}},p8='IBM Plex Sans,system-ui,-apple-system,BlinkMacSystemFont,".sfnstext-regular",sans-serif',m8=["#8a3ffc","#33b1ff","#007d79","#ff7eb6","#fa4d56","#fff1f1","#6fdc8c","#4589ff","#d12771","#d2a106","#08bdba","#bae6ff","#ba4e00","#d4bbff"],g8=["#6929c4","#1192e8","#005d5d","#9f1853","#fa4d56","#570408","#198038","#002d9c","#ee538b","#b28600","#009d9a","#012749","#8a3800","#a56eff"];function y8(e){let{type:t,background:n}=e;const r="dark"===t?"#161616":"#ffffff",i="dark"===t?"#f4f4f4":"#161616",o="dark"===t?"#d4bbff":"#6929c4";return{background:n,arc:{fill:o},area:{fill:o},path:{stroke:o},rect:{fill:o},shape:{stroke:o},symbol:{stroke:o},circle:{fill:o},view:{fill:r,stroke:r},group:{fill:r},title:{color:i,anchor:"start",dy:-15,fontSize:16,font:p8,fontWeight:600},axis:{labelColor:i,labelFontSize:12,grid:!0,gridColor:"#525252",titleColor:i,labelAngle:0},style:{"guide-label":{font:p8,fill:i,fontWeight:400},"guide-title":{font:p8,fill:i,fontWeight:400}},range:{category:"dark"===t?m8:g8,diverging:["#750e13","#a2191f","#da1e28","#fa4d56","#ff8389","#ffb3b8","#ffd7d9","#fff1f1","#e5f6ff","#bae6ff","#82cfff","#33b1ff","#1192e8","#0072c3","#00539a","#003a6d"],heatmap:["#f6f2ff","#e8daff","#d4bbff","#be95ff","#a56eff","#8a3ffc","#6929c4","#491d8b","#31135e","#1c0f30"]}}}const v8=y8({type:"light",background:"#ffffff"}),b8=y8({type:"light",background:"#f4f4f4"}),x8=y8({type:"dark",background:"#262626"}),w8=y8({type:"dark",background:"#161616"}),k8=w9;var _8=Object.freeze({__proto__:null,carbong10:b8,carbong100:w8,carbong90:x8,carbonwhite:v8,dark:O9,excel:D9,fivethirtyeight:$9,ggplot2:M9,googlecharts:e8,latimes:L9,powerbi:h8,quartz:U9,urbaninstitute:X9,version:k8,vox:W9});function O8(e){return O8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O8(e)}function E8(e){var t=function(e,t){if("object"!==O8(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==O8(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===O8(t)?t:String(t)}function D8(e,t,n){return(t=E8(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j8(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const N8=["title","image"];function S8(e,t){return JSON.stringify(e,function(e){const t=[];return function(n,r){if("object"!=typeof r||null===r)return r;const i=t.indexOf(this)+1;return t.length=i,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}(t))}var A8="#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black;\n}\n#vg-tooltip-element.visible {\n  visibility: visible;\n}\n#vg-tooltip-element h2 {\n  margin-top: 0;\n  margin-bottom: 10px;\n  font-size: 13px;\n}\n#vg-tooltip-element table {\n  border-spacing: 0;\n}\n#vg-tooltip-element table tr {\n  border: none;\n}\n#vg-tooltip-element table tr td {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-top: 2px;\n  padding-bottom: 2px;\n}\n#vg-tooltip-element table tr td.key {\n  color: #808080;\n  max-width: 150px;\n  text-align: right;\n  padding-right: 4px;\n}\n#vg-tooltip-element table tr td.value {\n  display: block;\n  max-width: 300px;\n  max-height: 7em;\n  text-align: left;\n}\n#vg-tooltip-element.dark-theme {\n  background-color: rgba(32, 32, 32, 0.9);\n  border: 1px solid #f5f5f5;\n  color: white;\n}\n#vg-tooltip-element.dark-theme td.key {\n  color: #bfbfbf;\n}\n";const $8="vg-tooltip-element",C8={offsetX:10,offsetY:10,id:$8,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")},maxDepth:2,formatTooltip:function(e,t,n){if(ha(e))return`[${e.map((e=>t(cs(e)?e:S8(e,n)))).join(", ")}]`;if(pa(e)){let r="";const i=e,{title:o,image:a}=i,s=j8(i,N8);o&&(r+=`<h2>${t(o)}</h2>`),a&&(r+=`<img src="${t(a)}">`);const l=Object.keys(s);if(l.length>0){r+="<table>";for(const e of l){let i=s[e];void 0!==i&&(pa(i)&&(i=S8(i,n)),r+=`<tr><td class="key">${t(e)}:</td><td class="value">${t(i)}</td></tr>`)}r+="</table>"}return r||"{}"}return t(e)}};function M8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P8(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M8(Object(n),!0).forEach((function(t){D8(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M8(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class F8{constructor(e){this.options=P8(P8({},C8),e);const t=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const e=document.createElement("style");e.setAttribute("id",this.options.styleId),e.innerHTML=function(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return A8.toString().replace($8,e)}(t);const n=document.head;n.childNodes.length>0?n.insertBefore(e,n.childNodes[0]):n.appendChild(e)}}tooltipHandler(e,t,n,r){if(this.el=document.getElementById(this.options.id),!this.el){this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip");(document.fullscreenElement??document.body).appendChild(this.el)}if(null==r||""===r)return void this.el.classList.remove("visible",`${this.options.theme}-theme`);this.el.innerHTML=this.options.formatTooltip(r,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:i,y:o}=function(e,t,n,r){let i=e.clientX+n;i+t.width>window.innerWidth&&(i=+e.clientX-n-t.width);let o=e.clientY+r;return o+t.height>window.innerHeight&&(o=+e.clientY-r-t.height),{x:i,y:o}}(t,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.style.top=`${o}px`,this.el.style.left=`${i}px`}}function T8(e){return T8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T8(e)}function z8(e){var t=function(e,t){if("object"!==T8(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==T8(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===T8(t)?t:String(t)}function R8(e,t,n){return(t=z8(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function L8(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var B8,I8;var U8=q8;function q8(e){var t=this;if(t instanceof q8||(t=new q8),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var n=0,r=arguments.length;n<r;n++)t.push(arguments[n]);return t}function W8(e,t,n){var r=t===e.head?new G8(n,null,t,e):new G8(n,t,t.next,e);return null===r.next&&(e.tail=r),null===r.prev&&(e.head=r),e.length++,r}function Z8(e,t){e.tail=new G8(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function H8(e,t){e.head=new G8(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function G8(e,t,n,r){if(!(this instanceof G8))return new G8(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}q8.Node=G8,q8.create=q8,q8.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},q8.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},q8.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},q8.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)Z8(this,arguments[e]);return this.length},q8.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)H8(this,arguments[e]);return this.length},q8.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},q8.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},q8.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;null!==n;r++)e.call(t,n.value,r,this),n=n.next},q8.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;null!==n;r--)e.call(t,n.value,r,this),n=n.prev},q8.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},q8.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},q8.prototype.map=function(e,t){t=t||this;for(var n=new q8,r=this.head;null!==r;)n.push(e.call(t,r.value,this)),r=r.next;return n},q8.prototype.mapReverse=function(e,t){t=t||this;for(var n=new q8,r=this.tail;null!==r;)n.push(e.call(t,r.value,this)),r=r.prev;return n},q8.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var i=0;null!==r;i++)n=e(n,r.value,i),r=r.next;return n},q8.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var i=this.length-1;null!==r;i--)n=e(n,r.value,i),r=r.prev;return n},q8.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},q8.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},q8.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new q8;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=0,i=this.head;null!==i&&r<e;r++)i=i.next;for(;null!==i&&r<t;r++,i=i.next)n.push(i.value);return n},q8.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new q8;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=this.length,i=this.tail;null!==i&&r>t;r--)i=i.prev;for(;null!==i&&r>e;r--,i=i.prev)n.push(i.value);return n},q8.prototype.splice=function(e,t){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,r=this.head;null!==r&&n<e;n++)r=r.next;var i=[];for(n=0;r&&n<t;n++)i.push(r.value),r=this.removeNode(r);null===r&&(r=this.tail),r!==this.head&&r!==this.tail&&(r=r.prev);for(n=0;n<(arguments.length<=2?0:arguments.length-2);n++)r=W8(this,r,n+2<2||arguments.length<=n+2?void 0:arguments[n+2]);return i},q8.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};try{(I8||(I8=1,B8=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}),B8)(q8)}catch(Tee){}const V8=U8,Y8=Symbol("max"),X8=Symbol("length"),J8=Symbol("lengthCalculator"),Q8=Symbol("allowStale"),K8=Symbol("maxAge"),e7=Symbol("dispose"),t7=Symbol("noDisposeOnSet"),n7=Symbol("lruList"),r7=Symbol("cache"),i7=Symbol("updateAgeOnGet"),o7=()=>1;const a7=(e,t,n)=>{const r=e[r7].get(t);if(r){const t=r.value;if(s7(e,t)){if(u7(e,r),!e[Q8])return}else n&&(e[i7]&&(r.value.now=Date.now()),e[n7].unshiftNode(r));return t.value}},s7=(e,t)=>{if(!t||!t.maxAge&&!e[K8])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[K8]&&n>e[K8]},l7=e=>{if(e[X8]>e[Y8])for(let t=e[n7].tail;e[X8]>e[Y8]&&null!==t;){const n=t.prev;u7(e,t),t=n}},u7=(e,t)=>{if(t){const n=t.value;e[e7]&&e[e7](n.key,n.value),e[X8]-=n.length,e[r7].delete(n.key),e[n7].removeNode(t)}};class c7{constructor(e,t,n,r,i){this.key=e,this.value=t,this.length=n,this.now=r,this.maxAge=i||0}}const f7=(e,t,n,r)=>{let i=n.value;s7(e,i)&&(u7(e,n),e[Q8]||(i=void 0)),i&&t.call(r,i.value,i.key,e)};var d7=class{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[Y8]=e.max||1/0;const t=e.length||o7;if(this[J8]="function"!=typeof t?o7:t,this[Q8]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[K8]=e.maxAge||0,this[e7]=e.dispose,this[t7]=e.noDisposeOnSet||!1,this[i7]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[Y8]=e||1/0,l7(this)}get max(){return this[Y8]}set allowStale(e){this[Q8]=!!e}get allowStale(){return this[Q8]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[K8]=e,l7(this)}get maxAge(){return this[K8]}set lengthCalculator(e){"function"!=typeof e&&(e=o7),e!==this[J8]&&(this[J8]=e,this[X8]=0,this[n7].forEach((e=>{e.length=this[J8](e.value,e.key),this[X8]+=e.length}))),l7(this)}get lengthCalculator(){return this[J8]}get length(){return this[X8]}get itemCount(){return this[n7].length}rforEach(e,t){t=t||this;for(let n=this[n7].tail;null!==n;){const r=n.prev;f7(this,e,n,t),n=r}}forEach(e,t){t=t||this;for(let n=this[n7].head;null!==n;){const r=n.next;f7(this,e,n,t),n=r}}keys(){return this[n7].toArray().map((e=>e.key))}values(){return this[n7].toArray().map((e=>e.value))}reset(){this[e7]&&this[n7]&&this[n7].length&&this[n7].forEach((e=>this[e7](e.key,e.value))),this[r7]=new Map,this[n7]=new V8,this[X8]=0}dump(){return this[n7].map((e=>!s7(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)})).toArray().filter((e=>e))}dumpLru(){return this[n7]}set(e,t,n){if((n=n||this[K8])&&"number"!=typeof n)throw new TypeError("maxAge must be a number");const r=n?Date.now():0,i=this[J8](t,e);if(this[r7].has(e)){if(i>this[Y8])return u7(this,this[r7].get(e)),!1;const o=this[r7].get(e).value;return this[e7]&&(this[t7]||this[e7](e,o.value)),o.now=r,o.maxAge=n,o.value=t,this[X8]+=i-o.length,o.length=i,this.get(e),l7(this),!0}const o=new c7(e,t,i,r,n);return o.length>this[Y8]?(this[e7]&&this[e7](e,t),!1):(this[X8]+=o.length,this[n7].unshift(o),this[r7].set(e,this[n7].head),l7(this),!0)}has(e){if(!this[r7].has(e))return!1;const t=this[r7].get(e).value;return!s7(this,t)}get(e){return a7(this,e,!0)}peek(e){return a7(this,e,!1)}pop(){const e=this[n7].tail;return e?(u7(this,e),e.value):null}del(e){u7(this,this[r7].get(e))}load(e){this.reset();const t=Date.now();for(let n=e.length-1;n>=0;n--){const r=e[n],i=r.e||0;if(0===i)this.set(r.k,r.v);else{const e=i-t;e>0&&this.set(r.k,r.v,e)}}}prune(){this[r7].forEach(((e,t)=>a7(this,t,!1)))}};const h7=Object.freeze({loose:!0}),p7=Object.freeze({});var m7=e=>e?"object"!=typeof e?h7:e:p7,g7={exports:{}};var y7={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2};var v7="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return console.error("SEMVER",...t)}:()=>{};!function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:i}=y7,o=v7,a=(t=e.exports={}).re=[],s=t.safeRe=[],l=t.src=[],u=t.t={};let c=0;const f="[a-zA-Z0-9-]",d=[["\\s",1],["\\d",i],[f,r]],h=(e,t,n)=>{const r=(e=>{for(const[t,n]of d)e=e.split(`${t}*`).join(`${t}{0,${n}}`).split(`${t}+`).join(`${t}{1,${n}}`);return e})(t),i=c++;o(e,i,t),u[e]=i,l[i]=t,a[i]=new RegExp(t,n?"g":void 0),s[i]=new RegExp(r,n?"g":void 0)};h("NUMERICIDENTIFIER","0|[1-9]\\d*"),h("NUMERICIDENTIFIERLOOSE","\\d+"),h("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${f}*`),h("MAINVERSION",`(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})`),h("MAINVERSIONLOOSE",`(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})`),h("PRERELEASEIDENTIFIER",`(?:${l[u.NUMERICIDENTIFIER]}|${l[u.NONNUMERICIDENTIFIER]})`),h("PRERELEASEIDENTIFIERLOOSE",`(?:${l[u.NUMERICIDENTIFIERLOOSE]}|${l[u.NONNUMERICIDENTIFIER]})`),h("PRERELEASE",`(?:-(${l[u.PRERELEASEIDENTIFIER]}(?:\\.${l[u.PRERELEASEIDENTIFIER]})*))`),h("PRERELEASELOOSE",`(?:-?(${l[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[u.PRERELEASEIDENTIFIERLOOSE]})*))`),h("BUILDIDENTIFIER",`${f}+`),h("BUILD",`(?:\\+(${l[u.BUILDIDENTIFIER]}(?:\\.${l[u.BUILDIDENTIFIER]})*))`),h("FULLPLAIN",`v?${l[u.MAINVERSION]}${l[u.PRERELEASE]}?${l[u.BUILD]}?`),h("FULL",`^${l[u.FULLPLAIN]}$`),h("LOOSEPLAIN",`[v=\\s]*${l[u.MAINVERSIONLOOSE]}${l[u.PRERELEASELOOSE]}?${l[u.BUILD]}?`),h("LOOSE",`^${l[u.LOOSEPLAIN]}$`),h("GTLT","((?:<|>)?=?)"),h("XRANGEIDENTIFIERLOOSE",`${l[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),h("XRANGEIDENTIFIER",`${l[u.NUMERICIDENTIFIER]}|x|X|\\*`),h("XRANGEPLAIN",`[v=\\s]*(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:${l[u.PRERELEASE]})?${l[u.BUILD]}?)?)?`),h("XRANGEPLAINLOOSE",`[v=\\s]*(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:${l[u.PRERELEASELOOSE]})?${l[u.BUILD]}?)?)?`),h("XRANGE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAIN]}$`),h("XRANGELOOSE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAINLOOSE]}$`),h("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),h("COERCERTL",l[u.COERCE],!0),h("LONETILDE","(?:~>?)"),h("TILDETRIM",`(\\s*)${l[u.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",h("TILDE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAIN]}$`),h("TILDELOOSE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAINLOOSE]}$`),h("LONECARET","(?:\\^)"),h("CARETTRIM",`(\\s*)${l[u.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",h("CARET",`^${l[u.LONECARET]}${l[u.XRANGEPLAIN]}$`),h("CARETLOOSE",`^${l[u.LONECARET]}${l[u.XRANGEPLAINLOOSE]}$`),h("COMPARATORLOOSE",`^${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]})$|^$`),h("COMPARATOR",`^${l[u.GTLT]}\\s*(${l[u.FULLPLAIN]})$|^$`),h("COMPARATORTRIM",`(\\s*)${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]}|${l[u.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",h("HYPHENRANGE",`^\\s*(${l[u.XRANGEPLAIN]})\\s+-\\s+(${l[u.XRANGEPLAIN]})\\s*$`),h("HYPHENRANGELOOSE",`^\\s*(${l[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[u.XRANGEPLAINLOOSE]})\\s*$`),h("STAR","(<|>)?=?\\s*\\*"),h("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),h("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(g7,g7.exports);var b7=g7.exports;const x7=/^[0-9]+$/,w7=(e,t)=>{const n=x7.test(e),r=x7.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1};var k7={compareIdentifiers:w7,rcompareIdentifiers:(e,t)=>w7(t,e)};const _7=v7,{MAX_LENGTH:O7,MAX_SAFE_INTEGER:E7}=y7,{safeRe:D7,t:j7}=b7,N7=m7,{compareIdentifiers:S7}=k7;var A7=class e{constructor(t,n){if(n=N7(n),t instanceof e){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if("string"!=typeof t)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>O7)throw new TypeError(`version is longer than ${O7} characters`);_7("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const r=t.trim().match(n.loose?D7[j7.LOOSE]:D7[j7.FULL]);if(!r)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>E7||this.major<0)throw new TypeError("Invalid major version");if(this.minor>E7||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>E7||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<E7)return t}return e})):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(_7("SemVer.compare",this.version,this.options,t),!(t instanceof e)){if("string"==typeof t&&t===this.version)return 0;t=new e(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof e||(t=new e(t,this.options)),S7(this.major,t.major)||S7(this.minor,t.minor)||S7(this.patch,t.patch)}comparePre(t){if(t instanceof e||(t=new e(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{const e=this.prerelease[n],r=t.prerelease[n];if(_7("prerelease compare",n,e,r),void 0===e&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===e)return-1;if(e!==r)return S7(e,r)}while(++n)}compareBuild(t){t instanceof e||(t=new e(t,this.options));let n=0;do{const e=this.build[n],r=t.build[n];if(_7("prerelease compare",n,e,r),void 0===e&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===e)return-1;if(e!==r)return S7(e,r)}while(++n)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(n)?1:0;if(!t&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let r=this.prerelease.length;for(;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);if(-1===r){if(t===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let r=[t,e];!1===n&&(r=[t]),0===S7(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=r):this.prerelease=r}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};const $7=A7;var C7=(e,t,n)=>new $7(e,n).compare(new $7(t,n));const M7=C7;var P7=(e,t,n)=>0===M7(e,t,n);const F7=C7;var T7=(e,t,n)=>0!==F7(e,t,n);const z7=C7;var R7=(e,t,n)=>z7(e,t,n)>0;const L7=C7;var B7=(e,t,n)=>L7(e,t,n)>=0;const I7=C7;var U7=(e,t,n)=>I7(e,t,n)<0;const q7=C7;var W7=(e,t,n)=>q7(e,t,n)<=0;const Z7=P7,H7=T7,G7=R7,V7=B7,Y7=U7,X7=W7;var J7,Q7,K7,eee,tee=(e,t,n,r)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e===n;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return Z7(e,n,r);case"!=":return H7(e,n,r);case">":return G7(e,n,r);case">=":return V7(e,n,r);case"<":return Y7(e,n,r);case"<=":return X7(e,n,r);default:throw new TypeError(`Invalid operator: ${t}`)}};function nee(){if(eee)return K7;eee=1;class e{constructor(t,i){if(i=n(i),t instanceof e)return t.loose===!!i.loose&&t.includePrerelease===!!i.includePrerelease?t:new e(t.raw,i);if(t instanceof r)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=i,this.loose=!!i.loose,this.includePrerelease=!!i.includePrerelease,this.raw=t.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!h(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const t of this.set)if(1===t.length&&p(t[0])){this.set=[t];break}}this.format()}format(){return this.range=this.set.map((e=>e.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(e){const n=((this.options.includePrerelease&&f)|(this.options.loose&&d))+":"+e,o=t.get(n);if(o)return o;const p=this.options.loose,m=p?a[s.HYPHENRANGELOOSE]:a[s.HYPHENRANGE];e=e.replace(m,D(this.options.includePrerelease)),i("hyphen replace",e),e=e.replace(a[s.COMPARATORTRIM],l),i("comparator trim",e),e=e.replace(a[s.TILDETRIM],u),i("tilde trim",e),e=e.replace(a[s.CARETTRIM],c),i("caret trim",e);let y=e.split(" ").map((e=>g(e,this.options))).join(" ").split(/\s+/).map((e=>E(e,this.options)));p&&(y=y.filter((e=>(i("loose invalid filter",e,this.options),!!e.match(a[s.COMPARATORLOOSE]))))),i("range list",y);const v=new Map,b=y.map((e=>new r(e,this.options)));for(const t of b){if(h(t))return[t];v.set(t.value,t)}v.size>1&&v.has("")&&v.delete("");const x=[...v.values()];return t.set(n,x),x}intersects(t,n){if(!(t instanceof e))throw new TypeError("a Range is required");return this.set.some((e=>m(e,n)&&t.set.some((t=>m(t,n)&&e.every((e=>t.every((t=>e.intersects(t,n)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new o(e,this.options)}catch(Tee){return!1}for(let t=0;t<this.set.length;t++)if(j(this.set[t],e,this.options))return!0;return!1}}K7=e;const t=new d7({max:1e3}),n=m7,r=function(){if(Q7)return J7;Q7=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(r,i){if(i=n(i),r instanceof t){if(r.loose===!!i.loose)return r;r=r.value}r=r.trim().split(/\s+/).join(" "),a("comparator",r,i),this.options=i,this.loose=!!i.loose,this.parse(r),this.semver===e?this.value="":this.value=this.operator+this.semver.version,a("comp",this)}parse(t){const n=this.options.loose?r[i.COMPARATORLOOSE]:r[i.COMPARATOR],o=t.match(n);if(!o)throw new TypeError(`Invalid comparator: ${t}`);this.operator=void 0!==o[1]?o[1]:"","="===this.operator&&(this.operator=""),o[2]?this.semver=new s(o[2],this.options.loose):this.semver=e}toString(){return this.value}test(t){if(a("Comparator.test",t,this.options.loose),this.semver===e||t===e)return!0;if("string"==typeof t)try{t=new s(t,this.options)}catch(Tee){return!1}return o(t,this.operator,this.semver,this.options)}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new l(e.value,r).test(this.value):""===e.operator?""===e.value||new l(this.value,r).test(e.semver):!((r=n(r)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===e.value)||!r.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))||(!this.operator.startsWith(">")||!e.operator.startsWith(">"))&&(!this.operator.startsWith("<")||!e.operator.startsWith("<"))&&(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))&&!(o(this.semver,"<",e.semver,r)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))&&!(o(this.semver,">",e.semver,r)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}}J7=t;const n=m7,{safeRe:r,t:i}=b7,o=tee,a=v7,s=A7,l=nee();return J7}(),i=v7,o=A7,{safeRe:a,t:s,comparatorTrimReplace:l,tildeTrimReplace:u,caretTrimReplace:c}=b7,{FLAG_INCLUDE_PRERELEASE:f,FLAG_LOOSE:d}=y7,h=e=>"<0.0.0-0"===e.value,p=e=>""===e.value,m=(e,t)=>{let n=!0;const r=e.slice();let i=r.pop();for(;n&&r.length;)n=r.every((e=>i.intersects(e,t))),i=r.pop();return n},g=(e,t)=>(i("comp",e,t),e=x(e,t),i("caret",e),e=v(e,t),i("tildes",e),e=k(e,t),i("xrange",e),e=O(e,t),i("stars",e),e),y=e=>!e||"x"===e.toLowerCase()||"*"===e,v=(e,t)=>e.trim().split(/\s+/).map((e=>b(e,t))).join(" "),b=(e,t)=>{const n=t.loose?a[s.TILDELOOSE]:a[s.TILDE];return e.replace(n,((t,n,r,o,a)=>{let s;return i("tilde",e,t,n,r,o,a),y(n)?s="":y(r)?s=`>=${n}.0.0 <${+n+1}.0.0-0`:y(o)?s=`>=${n}.${r}.0 <${n}.${+r+1}.0-0`:a?(i("replaceTilde pr",a),s=`>=${n}.${r}.${o}-${a} <${n}.${+r+1}.0-0`):s=`>=${n}.${r}.${o} <${n}.${+r+1}.0-0`,i("tilde return",s),s}))},x=(e,t)=>e.trim().split(/\s+/).map((e=>w(e,t))).join(" "),w=(e,t)=>{i("caret",e,t);const n=t.loose?a[s.CARETLOOSE]:a[s.CARET],r=t.includePrerelease?"-0":"";return e.replace(n,((t,n,o,a,s)=>{let l;return i("caret",e,t,n,o,a,s),y(n)?l="":y(o)?l=`>=${n}.0.0${r} <${+n+1}.0.0-0`:y(a)?l="0"===n?`>=${n}.${o}.0${r} <${n}.${+o+1}.0-0`:`>=${n}.${o}.0${r} <${+n+1}.0.0-0`:s?(i("replaceCaret pr",s),l="0"===n?"0"===o?`>=${n}.${o}.${a}-${s} <${n}.${o}.${+a+1}-0`:`>=${n}.${o}.${a}-${s} <${n}.${+o+1}.0-0`:`>=${n}.${o}.${a}-${s} <${+n+1}.0.0-0`):(i("no pr"),l="0"===n?"0"===o?`>=${n}.${o}.${a}${r} <${n}.${o}.${+a+1}-0`:`>=${n}.${o}.${a}${r} <${n}.${+o+1}.0-0`:`>=${n}.${o}.${a} <${+n+1}.0.0-0`),i("caret return",l),l}))},k=(e,t)=>(i("replaceXRanges",e,t),e.split(/\s+/).map((e=>_(e,t))).join(" ")),_=(e,t)=>{e=e.trim();const n=t.loose?a[s.XRANGELOOSE]:a[s.XRANGE];return e.replace(n,((n,r,o,a,s,l)=>{i("xRange",e,n,r,o,a,s,l);const u=y(o),c=u||y(a),f=c||y(s),d=f;return"="===r&&d&&(r=""),l=t.includePrerelease?"-0":"",u?n=">"===r||"<"===r?"<0.0.0-0":"*":r&&d?(c&&(a=0),s=0,">"===r?(r=">=",c?(o=+o+1,a=0,s=0):(a=+a+1,s=0)):"<="===r&&(r="<",c?o=+o+1:a=+a+1),"<"===r&&(l="-0"),n=`${r+o}.${a}.${s}${l}`):c?n=`>=${o}.0.0${l} <${+o+1}.0.0-0`:f&&(n=`>=${o}.${a}.0${l} <${o}.${+a+1}.0-0`),i("xRange return",n),n}))},O=(e,t)=>(i("replaceStars",e,t),e.trim().replace(a[s.STAR],"")),E=(e,t)=>(i("replaceGTE0",e,t),e.trim().replace(a[t.includePrerelease?s.GTE0PRE:s.GTE0],"")),D=e=>(t,n,r,i,o,a,s,l,u,c,f,d,h)=>`${n=y(r)?"":y(i)?`>=${r}.0.0${e?"-0":""}`:y(o)?`>=${r}.${i}.0${e?"-0":""}`:a?`>=${n}`:`>=${n}${e?"-0":""}`} ${l=y(u)?"":y(c)?`<${+u+1}.0.0-0`:y(f)?`<${u}.${+c+1}.0-0`:d?`<=${u}.${c}.${f}-${d}`:e?`<${u}.${c}.${+f+1}-0`:`<=${l}`}`.trim(),j=(e,t,n)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let n=0;n<e.length;n++)if(i(e[n].semver),e[n].semver!==r.ANY&&e[n].semver.prerelease.length>0){const r=e[n].semver;if(r.major===t.major&&r.minor===t.minor&&r.patch===t.patch)return!0}return!1}return!0};return K7}const ree=nee();var iee=(e,t,n)=>{try{t=new ree(t,n)}catch(Tee){return!1}return t.test(e)},oee=L8(iee);var aee='.vega-embed {\n  position: relative;\n  display: inline-block;\n  box-sizing: border-box;\n}\n.vega-embed.has-actions {\n  padding-right: 38px;\n}\n.vega-embed details:not([open]) > :not(summary) {\n  display: none !important;\n}\n.vega-embed summary {\n  list-style: none;\n  position: absolute;\n  top: 0;\n  right: 0;\n  padding: 6px;\n  z-index: 1000;\n  background: white;\n  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n  color: #1b1e23;\n  border: 1px solid #aaa;\n  border-radius: 999px;\n  opacity: 0.2;\n  transition: opacity 0.4s ease-in;\n  cursor: pointer;\n  line-height: 0px;\n}\n.vega-embed summary::-webkit-details-marker {\n  display: none;\n}\n.vega-embed summary:active {\n  box-shadow: #aaa 0px 0px 0px 1px inset;\n}\n.vega-embed summary svg {\n  width: 14px;\n  height: 14px;\n}\n.vega-embed details[open] summary {\n  opacity: 0.7;\n}\n.vega-embed:hover summary, .vega-embed:focus-within summary {\n  opacity: 1 !important;\n  transition: opacity 0.2s ease;\n}\n.vega-embed .vega-actions {\n  position: absolute;\n  z-index: 1001;\n  top: 35px;\n  right: -9px;\n  display: flex;\n  flex-direction: column;\n  padding-bottom: 8px;\n  padding-top: 8px;\n  border-radius: 4px;\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n  border: 1px solid #d9d9d9;\n  background: white;\n  animation-duration: 0.15s;\n  animation-name: scale-in;\n  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n  text-align: left;\n}\n.vega-embed .vega-actions a {\n  padding: 8px 16px;\n  font-family: sans-serif;\n  font-size: 14px;\n  font-weight: 600;\n  white-space: nowrap;\n  color: #434a56;\n  text-decoration: none;\n}\n.vega-embed .vega-actions a:hover, .vega-embed .vega-actions a:focus {\n  background-color: #f7f7f9;\n  color: black;\n}\n.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n  content: "";\n  display: inline-block;\n  position: absolute;\n}\n.vega-embed .vega-actions::before {\n  left: auto;\n  right: 14px;\n  top: -16px;\n  border: 8px solid rgba(0, 0, 0, 0);\n  border-bottom-color: #d9d9d9;\n}\n.vega-embed .vega-actions::after {\n  left: auto;\n  right: 15px;\n  top: -14px;\n  border: 7px solid rgba(0, 0, 0, 0);\n  border-bottom-color: #fff;\n}\n.vega-embed .chart-wrapper.fit-x {\n  width: 100%;\n}\n.vega-embed .chart-wrapper.fit-y {\n  height: 100%;\n}\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: auto;\n  padding-right: 14px;\n}\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6);\n  }\n  to {\n    opacity: 1;\n    transform: scale(1);\n  }\n}\n';function see(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(const i of n)lee(e,i);return e}function lee(e,t){for(const n of Object.keys(t))ya(e,n,t[n],!0)}function uee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function cee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?uee(Object(n),!0).forEach((function(t){R8(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const fee=BZ;let dee=b9;const hee="undefined"!=typeof window?window:void 0;void 0===dee&&hee?.vl?.compile&&(dee=hee.vl);const pee={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},mee={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},gee={vega:"Vega","vega-lite":"Vega-Lite"},yee={vega:fee.version,"vega-lite":dee?dee.version:"not available"},vee={vega:e=>e,"vega-lite":(e,t)=>dee.compile(e,{config:t}).spec},bee='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>',xee="chart-wrapper";function wee(e,t,n,r){const i=`<html><head>${t}</head><body><pre><code class="json">`,o=`</code></pre>${n}</body></html>`,a=window.open("");a.document.write(i+e+o),a.document.title=`${gee[r]} JSON Source`}function kee(e){return(t=e)&&"load"in t?e:fee.loader(e);var t}async function _ee(e,t,n){let r,i;void 0===n&&(n={}),cs(t)?(i=kee(n.loader),r=JSON.parse(await i.load(t))):r=t;const o=function(e){const t=e.usermeta?.embedOptions??{};return cs(t.defaultStyle)&&(t.defaultStyle=!1),t}(r),a=o.loader;i&&!a||(i=kee(n.loader??a));const s=await Oee(o,i),l=await Oee(n,i),u=cee(cee({},see(l,s)),{},{config:ga(l.config??{},s.config??{})});return await async function(e,t,n,r){void 0===n&&(n={});const i=n.theme?ga(_8[n.theme],n.config??{}):n.config,o=os(n.actions)?n.actions:see({},pee,n.actions??{}),a=cee(cee({},mee),n.i18n),s=n.renderer??"canvas",l=n.logLevel??fee.Warn,u=n.downloadFileName??"visualization",c="string"==typeof e?document.querySelector(e):e;if(!c)throw new Error(`${e} does not exist`);if(!1!==n.defaultStyle){const e="vega-embed-style",{root:t,rootContainer:r}=function(e){const t=e.getRootNode?e.getRootNode():document;return t instanceof ShadowRoot?{root:t,rootContainer:t}:{root:document,rootContainer:document.head??document.body}}(c);if(!t.getElementById(e)){const t=document.createElement("style");t.id=e,t.innerHTML=void 0===n.defaultStyle||!0===n.defaultStyle?aee.toString():n.defaultStyle,r.appendChild(t)}}const f=function(e,t){if(e.$schema){const n=x9(e.$schema);t&&t!==n.library&&console.warn(`The given visualization spec is written in ${gee[n.library]}, but mode argument sets ${gee[t]??t}.`);const r=n.library;return oee(yee[r],`^${n.version.slice(1)}`)||console.warn(`The input spec uses ${gee[r]} ${n.version}, but the current version of ${gee[r]} is v${yee[r]}.`),r}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t??"vega"}(t,n.mode);let d=vee[f](t,i);if("vega-lite"===f&&d.$schema){const e=x9(d.$schema);oee(yee.vega,`^${e.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${e.version}, but current version is v${yee.vega}.`)}c.classList.add("vega-embed"),o&&c.classList.add("has-actions");c.innerHTML="";let h=c;if(o){const e=document.createElement("div");e.classList.add(xee),c.appendChild(e),h=e}const p=n.patch;p&&(d=p instanceof Function?p(d):$o(d,p,!0,!1).newDocument);n.formatLocale&&fee.formatLocale(n.formatLocale);n.timeFormatLocale&&fee.timeFormatLocale(n.timeFormatLocale);if(n.expressionFunctions)for(const w in n.expressionFunctions){const e=n.expressionFunctions[w];"fn"in e?fee.expressionFunction(w,e.fn,e.visitor):e instanceof Function&&fee.expressionFunction(w,e)}const{ast:m}=n,g=fee.parse(d,"vega-lite"===f?{}:i,{ast:m}),y=new(n.viewClass||fee.View)(g,cee({loader:r,logLevel:l,renderer:s},m?{expr:fee.expressionInterpreter??n.expr??JZ}:{}));if(y.addSignalListener("autosize",((e,t)=>{const{type:n}=t;"fit-x"==n?(h.classList.add("fit-x"),h.classList.remove("fit-y")):"fit-y"==n?(h.classList.remove("fit-x"),h.classList.add("fit-y")):"fit"==n?h.classList.add("fit-x","fit-y"):h.classList.remove("fit-x","fit-y")})),!1!==n.tooltip){const e=function(e){return"function"==typeof e}(n.tooltip)?n.tooltip:new F8(!0===n.tooltip?{}:n.tooltip).call;y.tooltip(e)}let v,{hover:b}=n;void 0===b&&(b="vega"===f);if(b){const{hoverSet:e,updateSet:t}="boolean"==typeof b?{}:b;y.hover(e,t)}n&&(null!=n.width&&y.width(n.width),null!=n.height&&y.height(n.height),null!=n.padding&&y.padding(n.padding));if(await y.initialize(h,n.bind).runAsync(),!1!==o){let e=c;if(!1!==n.defaultStyle){const t=document.createElement("details");t.title=a.CLICK_TO_VIEW_ACTIONS,c.append(t),e=t;const n=document.createElement("summary");n.innerHTML=bee,t.append(n),v=e=>{t.contains(e.target)||t.removeAttribute("open")},document.addEventListener("click",v)}const r=document.createElement("div");if(e.append(r),r.classList.add("vega-actions"),!0===o||!1!==o.export)for(const t of["svg","png"])if(!0===o||!0===o.export||o.export[t]){const e=a[`${t.toUpperCase()}_ACTION`],i=document.createElement("a"),o=pa(n.scaleFactor)?n.scaleFactor[t]:n.scaleFactor;i.text=e,i.href="#",i.target="_blank",i.download=`${u}.${t}`,i.addEventListener("mousedown",(async function(e){e.preventDefault();const n=await y.toImageURL(t,o);this.href=n})),r.append(i)}if(!0===o||!1!==o.source){const e=document.createElement("a");e.text=a.SOURCE_ACTION,e.href="#",e.addEventListener("click",(function(e){wee(Wo(t),n.sourceHeader??"",n.sourceFooter??"",f),e.preventDefault()})),r.append(e)}if("vega-lite"===f&&(!0===o||!1!==o.compiled)){const e=document.createElement("a");e.text=a.COMPILED_ACTION,e.href="#",e.addEventListener("click",(function(e){wee(Wo(d),n.sourceHeader??"",n.sourceFooter??"","vega"),e.preventDefault()})),r.append(e)}if(!0===o||!1!==o.editor){const e=n.editorUrl??"https://vega.github.io/editor/",o=document.createElement("a");o.text=a.EDITOR_ACTION,o.href="#",o.addEventListener("click",(function(n){!function(e,t,n){const r=e.open(t),i=250,{origin:o}=new URL(t);let a=~~(1e4/i);e.addEventListener("message",(function t(n){n.source===r&&(a=0,e.removeEventListener("message",t,!1))}),!1),setTimeout((function e(){a<=0||(r.postMessage(n,o),setTimeout(e,i),a-=1)}),i)}(window,e,{config:i,mode:f,renderer:s,spec:Wo(t)}),n.preventDefault()})),r.append(o)}}function x(){v&&document.removeEventListener("click",v),y.finalize()}return{view:y,spec:t,vgSpec:d,finalize:x,embedOptions:n}}(e,r,u,i)}async function Oee(e,t){const n=cs(e.config)?JSON.parse(await t.load(e.config)):e.config??{},r=cs(e.patch)?JSON.parse(await t.load(e.patch)):e.patch;return cee(cee(cee({},e),r?{patch:r}:{}),n?{config:n}:{})}function Eee(e,t){Object.keys(t).forEach((n=>{!function(e,t,n){var r;n&&((r=n)&&"[object Function]"==={}.toString.call(r)?n(e.data(t)):e.change(t,fee.changeset().remove((()=>!0)).insert(n)))}(e,n,t[n])}))}function Dee(e){const t=new Set;return e.forEach((e=>{Object.keys(e).forEach((e=>{t.add(e)}))})),t}const jee=()=>{};function Nee(e,t){const n=Object.keys(t);return n.forEach((n=>{try{e.addSignalListener(n,t[n])}catch(Jo){console.warn("Cannot add invalid signal listener.",Jo)}})),n.length>0}function See(e,t){const n=Object.keys(t);return n.forEach((n=>{try{e.removeSignalListener(n,t[n])}catch(Jo){console.warn("Cannot remove invalid signal listener.",Jo)}})),n.length>0}function Aee(e){const{spec:t,width:n,height:r}=e;return void 0!==n&&void 0!==r?{...t,width:n,height:r}:void 0!==n?{...t,width:n}:void 0!==r?{...t,height:r}:t}function $ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Cee extends a.PureComponent{constructor(){super(...arguments),$ee(this,"containerRef",a.createRef()),$ee(this,"resultPromise",void 0),$ee(this,"handleError",(e=>{const{onError:t=jee}=this.props;t(e,this.containerRef.current),console.warn(e)})),$ee(this,"modifyView",(e=>{this.resultPromise&&this.resultPromise.then((t=>(t&&e(t.view),!0))).catch(this.handleError)}))}componentDidMount(){this.createView()}componentDidUpdate(e){const t=Dee([this.props,e]);if(t.delete("className"),t.delete("signalListeners"),t.delete("spec"),t.delete("style"),t.delete("width"),t.delete("height"),Array.from(t).some((t=>this.props[t]!==e[t])))this.clearView(),this.createView();else{const t=function(e,t){if(e===t)return!1;const n={width:!1,height:!1,isExpensive:!1},r=Dee([e,t]);return!r.has("width")||"width"in e&&"width"in t&&e.width===t.width||("width"in e&&"number"==typeof e.width?n.width=e.width:n.isExpensive=!0),!r.has("height")||"height"in e&&"height"in t&&e.height===t.height||("height"in e&&"number"==typeof e.height?n.height=e.height:n.isExpensive=!0),r.delete("width"),r.delete("height"),[...r].some((n=>!(n in e)||!(n in t)||!nH(e[n],t[n])))&&(n.isExpensive=!0),!(!1===n.width&&!1===n.height&&!n.isExpensive)&&n}(Aee(this.props),Aee(e)),{signalListeners:n}=this.props,{signalListeners:r}=e;if(t)if(t.isExpensive)this.clearView(),this.createView();else{const e=!fo(n,r);this.modifyView((i=>{!1!==t.width&&i.width(t.width),!1!==t.height&&i.height(t.height),e&&(r&&See(i,r),n&&Nee(i,n)),i.run()}))}else fo(n,r)||this.modifyView((e=>{r&&See(e,r),n&&Nee(e,n),e.run()}))}}componentWillUnmount(){this.clearView()}createView(){const{spec:e,onNewView:t,signalListeners:n={},width:r,height:i,...o}=this.props;if(this.containerRef.current){const e=Aee(this.props);this.resultPromise=_ee(this.containerRef.current,e,o).then((e=>{if(e){const{view:t}=e;Nee(t,n)&&t.run()}return e})).catch(this.handleError),t&&this.modifyView(t)}}clearView(){return this.resultPromise&&this.resultPromise.then((e=>{e&&e.finalize()})).catch(this.handleError),this.resultPromise=void 0,this}render(){const{className:e,style:t}=this.props;return a.createElement("div",{ref:this.containerRef,className:e,style:t})}}function Mee(){return Mee=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Mee.apply(this,arguments)}function Pee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}$ee(Cee,"propTypes",{className:uo.string,onError:uo.func});class Fee extends a.PureComponent{constructor(){super(...arguments),Pee(this,"vegaEmbed",a.createRef()),Pee(this,"handleNewView",(e=>{this.update();const{onNewView:t=jee}=this.props;t(e)}))}componentDidMount(){this.update()}componentDidUpdate(e){fo(this.props.data,e.data)||this.update()}update(){const{data:e}=this.props;this.vegaEmbed.current&&e&&Object.keys(e).length>0&&this.vegaEmbed.current.modifyView((t=>{Eee(t,e),t.resize().run()}))}render(){const{data:e,...t}=this.props;return a.createElement(Cee,Mee({ref:this.vegaEmbed},t,{onNewView:this.handleNewView}))}}Pee(Fee,"defaultProps",{data:{}})},4882:(e,t,n)=>{n.d(t,{U:()=>f});var r=n(4749),i=n(4993),o=n(4733),a=n(2983);const s=(e,t)=>{const n=new URL(t,new URL(e,"resolve://pathname/"));if("resolve:"===n.protocol){const{pathname:n,search:r,hash:i}=new URL(t,new URL(e,"http://example.com/"));return n+r+i}return n.toString()},l={1:{},2:{h1:o.XJ,h2:o.aC,h3:o.k8,h4:o.by,h5:o.Cd},3:{h1:o.aC,h2:o.k8,h3:o.by,h4:o.Cd,h5:o.Cd},4:{h1:o.k8,h2:o.by,h3:o.Cd,h4:o.Cd,h5:o.Cd},5:{h1:o.by,h2:o.Cd,h3:o.Cd,h4:o.Cd,h5:o.Cd},6:{h1:o.Cd,h2:o.Cd,h3:o.Cd,h4:o.Cd,h5:o.Cd}},u=e=>({img:t=>{let{src:n,...i}=t;return a.createElement("img",(0,r.Z)({},i,{src:s(e,n),className:"utrecht-img utrecht-img--fit"}))}}),c=(e,t)=>{if(e){const e={...l[t-1]};return e.h1=()=>null,e}return l[t]},f=e=>{let{children:t,omitH1:n=!1,headingLevel:r=1,baseUrl:o=""}=e;return a.createElement(i.Zo,{components:{...c(n,r),...u(o)}},t)}},7289:(e,t,n)=>{n.d(t,{U:()=>c});var r=n(7090),i=n(1478),o=n(2959),a=n(8856),s=n(2983);const l="story-tabs__tab_Ets0",u="story-tabs__link_j5UT",c=e=>{let{tabs:t}=e;return s.createElement(o.Z,null,t.map((e=>{let{id:t,label:n,story:o}=e;const{siteConfig:c}=(0,r.Z)(),f=c.customFields.storybookUrl,d=`${f}?path=/docs/${o}`,h=`${f}iframe.html?id=${o}&viewMode=docs#singleStory=true&shortcuts=false`;return s.createElement(i.Z,{value:t,label:n,key:t},s.createElement("div",{className:l},s.createElement(a.Z,{src:h,style:{width:"1px",minWidth:"100%"},heightCalculationMethod:"lowestElement"}),s.createElement("a",{className:u,href:d,target:"_blank",rel:"noreferrer"},"Storybook: ",o)))})))}},6280:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>g,contentTitle:()=>p,default:()=>x,frontMatter:()=>h,metadata:()=>m,toc:()=>y});var r=n(4749),i=(n(2983),n(4993)),o=n(4882),a=n(7289);const s={toc:[{value:"Activeren met <em>touch</em>",id:"activeren-met-touch",level:2},{value:"Activeren met toetsenbord",id:"activeren-met-toetsenbord",level:2},{value:"Activeren met een muis",id:"activeren-met-een-muis",level:2},{value:"Activeren met een <em>screen reader</em>",id:"activeren-met-een-screen-reader",level:2},{value:"Terug met de <em>Back button</em>",id:"terug-met-de-back-button",level:2},{value:"Er zijn veel soorten links",id:"er-zijn-veel-soorten-links",level:2},{value:"Link versus button",id:"link-versus-button",level:2},{value:"Design",id:"design",level:2},{value:"Onderstreep de link",id:"onderstreep-de-link",level:3},{value:"Geen icoon voor externe links",id:"geen-icoon-voor-externe-links",level:3},{value:"<code>hover</code> en <code>focus</code>",id:"hover-en-focus",level:3},{value:"Contrast met elke achtergrondkleur",id:"contrast-met-elke-achtergrondkleur",level:3},{value:"Content",id:"content",level:2},{value:"Gebruik van links in tekst",id:"gebruik-van-links-in-tekst",level:3},{value:"Links in een zin",id:"links-in-een-zin",level:3},{value:"Do&#39;s",id:"dos",level:3},{value:"Don&#39;ts",id:"donts",level:3},{value:"States",id:"states",level:2},{value:"Link in plaats van <code>&lt;a&gt;</code>",id:"link-in-plaats-van-a",level:2},{value:"HTML",id:"html",level:2},{value:"<code>tabindex=&quot;-1&quot;</code>",id:"tabindex-1",level:3},{value:"Privacy",id:"privacy",level:2},{value:"Hoe het niet moet",id:"hoe-het-niet-moet",level:2},{value:"Geen zichtbaar verschil tussen hover en focus state",id:"geen-zichtbaar-verschil-tussen-hover-en-focus-state",level:3},{value:"Link-tekst betekent verschillende dingen",id:"link-tekst-betekent-verschillende-dingen",level:3},{value:"Verkeerde taal",id:"verkeerde-taal",level:3},{value:"Link naar huidige pagina niet opmaken",id:"link-naar-huidige-pagina-niet-opmaken",level:3},{value:"Onnodige link naar huidige pagina",id:"onnodige-link-naar-huidige-pagina",level:3},{value:"Link zonder <code>href</code> attribuut",id:"link-zonder-href-attribuut",level:3},{value:"Referenties",id:"referenties",level:2},{value:"Relevante WCAG regels",id:"relevante-wcag-regels",level:3}]},l="wrapper";function u(e){let{components:t,...n}=e;return(0,i.kt)(l,(0,r.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"link"},"Link"),(0,i.kt)("p",null,"Met de link maak je navigatie mogelijk naar een gerelateerde pagina."),(0,i.kt)("h2",{id:"activeren-met-touch"},"Activeren met ",(0,i.kt)("em",{parentName:"h2"},"touch")),(0,i.kt)("p",null,"Veel gebruikers activeren de link door te klikken op een ",(0,i.kt)("em",{parentName:"p"},"touch screen"),". Deze gebruikers zien niet de ",(0,i.kt)("em",{parentName:"p"},"hover")," state van een link, dus een link moet ook duidelijk herkenbaar zijn zonder ooit het design van de ",(0,i.kt)("em",{parentName:"p"},"hover")," state te zien."),(0,i.kt)("h2",{id:"activeren-met-toetsenbord"},"Activeren met toetsenbord"),(0,i.kt)("p",null,"Sommige gebruikers gebruiken het toetsenbord om telkens met \xe9\xe9n druk op de knop naar de volgende link te gaan. De ",(0,i.kt)("inlineCode",{parentName:"p"},"focus-visible")," variant moet daarom opvallend zijn, zodat je weet welke link je kunt activeren met ",(0,i.kt)("inlineCode",{parentName:"p"},"Enter"),". Links moet je kunnen activeren met ",(0,i.kt)("inlineCode",{parentName:"p"},"Enter"),", maar niet met ",(0,i.kt)("inlineCode",{parentName:"p"},"Space"),"."),(0,i.kt)("h2",{id:"activeren-met-een-muis"},"Activeren met een muis"),(0,i.kt)("p",null,"Gebuikers met een muis kunnen de ",(0,i.kt)("em",{parentName:"p"},"hover")," state zien wanneer de muisaanwezer over de link heen beweegt. Links met een ",(0,i.kt)("inlineCode",{parentName:"p"},"title")," attribuut kunnen dan een tooltip tonen die in de weg zit (gebruik daarom geen ",(0,i.kt)("inlineCode",{parentName:"p"},"title")," attribuut)."),(0,i.kt)("p",null,"Gebruikers die zowel toetsenbord als muis gebruiken moeten kunnen onderscheiden welke link focus heeft, en welke de ",(0,i.kt)("em",{parentName:"p"},"hover")," state heeft."),(0,i.kt)("h2",{id:"activeren-met-een-screen-reader"},"Activeren met een ",(0,i.kt)("em",{parentName:"h2"},"screen reader")),(0,i.kt)("p",null,'Sommige gebruikers gebruiken een lijst van alle links op een pagina, en kiezen een link uit op basis van de link-tekst. Deze gebruikers bekijken niet de hele pagina, en zien niet altijd de link in de context van de omliggende tekst. Daarom is het belangrijk dat de link-tekst op zichzelf duidelijk maakt welke pagina je opent. Om de juiste link te kunnen kiezen, is het ook belangrijk dat niet dezelfde link-tekst wordt gebruikt voor verschillende links. Gebruik dus niet "Lees meer" als link-tekst, die tekst is meestal niet uniek op een pagina en is onduidelijk zonder context.'),(0,i.kt)("h2",{id:"terug-met-de-back-button"},"Terug met de ",(0,i.kt)("em",{parentName:"h2"},"Back button")),(0,i.kt)("p",null,"Na het activeren van een link, moet een gebruiker weer terug kunnen naar de vorige pagina. Gebruikers doen dat met bijvoorbeeld de ",(0,i.kt)("em",{parentName:"p"},"back button")," van de browser, of met een ",(0,i.kt)("em",{parentName:"p"},"swipe gesture")," op een ",(0,i.kt)("em",{parentName:"p"},"touch screen"),"."),(0,i.kt)("p",null,"Als je gewoon ",(0,i.kt)("inlineCode",{parentName:"p"},'<a href="...">')," in HTML gebruikt dan werkt de back button zoals het hoort. Met extra code kun je de back button onbedoeld kapot maken. Als je het ",(0,i.kt)("inlineCode",{parentName:"p"},"target")," attribuut gebruikt, dan werkt de ",(0,i.kt)("em",{parentName:"p"},"back button")," niet (bijvoorbeeld: ",(0,i.kt)("inlineCode",{parentName:"p"},'target="_blank"'),")."),(0,i.kt)("p",null,"Als je een ",(0,i.kt)("em",{parentName:"p"},"single page app")," maakt moet je goed testen dat de back button nog goed werkt. Wanneer je de ",(0,i.kt)("inlineCode",{parentName:"p"},"click")," event van de link stopt met ",(0,i.kt)("inlineCode",{parentName:"p"},"event.preventDefault()")," en met script een eigen navigatie maakt, dan moet je de ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/API/History"},"History API")," gebruiken om een even goede ervaring te bieden als gewone links in HTML."),(0,i.kt)("h2",{id:"er-zijn-veel-soorten-links"},"Er zijn veel soorten links"),(0,i.kt)("p",null,"Je kunt links groeperen in de navigatie-regio van de pagina, zodat gebruikers snel vinden welke informatie er nog meer is. Je kunt links plaatsen in de lopende tekst. Je kunt overzichtelijke lijstjes met links plaatsen in de tekst. Je kunt links plaatsen naar dezelfde informatie in een ander formaat of in een andere taal. Je kunt van hele blokken een link maken, om die informatie in detail te openen."),(0,i.kt)("h2",{id:"link-versus-button"},"Link versus button"),(0,i.kt)("p",null,"Links worden vooral gebruikt om te navigeren en verschijnen dan ook in of direct na een zin."),(0,i.kt)("p",null,"Buttons worden gebruikt voor acties, zoals 'toevoegen', 'sluiten' of 'opslaan'."),(0,i.kt)("h2",{id:"design"},"Design"),(0,i.kt)("h3",{id:"onderstreep-de-link"},"Onderstreep de link"),(0,i.kt)("p",null,"Links zijn het meest herkenbaar als je de tekst van de link onderstreept, want dat is gebruikelijk sinds het begin van het web. Gebruik een kleur met voldoende contrast voor de streep, zodat iedereen die de tekst kan zien ook de streep kan zien. De kleur van de streep kan minder contrast hebben als de streep dikker is."),(0,i.kt)("p",null,"Een streep die door de letters gaat maakt de tekst minder leesbaar. Gebruikers met dyslexie kunnen woorden beter herkennen als het woordbeeld niet wordt aangetast. Maak het woordbeeld van links rustiger met de volgende twee CSS properties. Je kunt met ",(0,i.kt)("inlineCode",{parentName:"p"},"text-decoration-skip-ink")," in CSS de streep automatisch laten onderbreken, zodat je voorkomt dat woorden een beetje doorstreept worden. Met ",(0,i.kt)("inlineCode",{parentName:"p"},"text-underline-offset")," kun je de afstand tussen de streep en de letters iets groter maken, zodat een onderbroken streep minder vaak nodig is."),(0,i.kt)("p",null,"Links die staan op een herkenbare plek zoals de hoofdnavigatie, zijn vaak al herkenbaar als link wanneer ze niet onderstreept zijn. Je kunt extra duidelijk maken dat het een link is door de tekst alsnog onderstrepen als ",(0,i.kt)("inlineCode",{parentName:"p"},"hover")," of ",(0,i.kt)("inlineCode",{parentName:"p"},"focus"),' effect, zodat een gebruiker zeker weet dat de browser mogelijkheden heeft zoals "Openen deze link in een nieuwe tab" of "Deel deze link".'),(0,i.kt)("p",null,"Heeft de link een icoon \xe9n tekst, onderstreep dan alleen de tekst."),(0,i.kt)("h3",{id:"geen-icoon-voor-externe-links"},"Geen icoon voor externe links"),(0,i.kt)("p",null,"Gebruik geen speciaal icoon bij links naar een externe website. Door ",(0,i.kt)("a",{parentName:"p",href:"https://designnotes.blog.gov.uk/2016/11/28/removing-the-external-link-icon-from-gov-uk/"},"onderzoek naar externe links van GOV.UK")," weten we dat gebruikers hier weinig voordeel van hebben."),(0,i.kt)("h3",{id:"hover-en-focus"},(0,i.kt)("inlineCode",{parentName:"h3"},"hover")," en ",(0,i.kt)("inlineCode",{parentName:"h3"},"focus")),(0,i.kt)("p",null,"Wanneer een gebruiker met de muis over een link gaat (",(0,i.kt)("inlineCode",{parentName:"p"},"hover"),"), of met het toetsenbord een link selecteert (",(0,i.kt)("inlineCode",{parentName:"p"},"focus"),"), dan is het belangrijk dat er geen onvoorspelbare wijzigingen in de layout zijn."),(0,i.kt)("p",null,"Gebruik voor ",(0,i.kt)("inlineCode",{parentName:"p"},"hover")," en ",(0,i.kt)("inlineCode",{parentName:"p"},"focus")," geen effecten waardoor de tekst van de link over meer regels wordt verdeeld, of waardoor de tekst na de link verschuift. Gebruik daarom geen andere ",(0,i.kt)("inlineCode",{parentName:"p"},"font-size")," of ",(0,i.kt)("inlineCode",{parentName:"p"},"font-weight")," als effect."),(0,i.kt)("p",null,"Gebruik voor ",(0,i.kt)("inlineCode",{parentName:"p"},"hover")," en ",(0,i.kt)("inlineCode",{parentName:"p"},"focus")," geen effect waardoor de positie van de link verschuift, waardoor het moeilijk wordt de link aan te klikken."),(0,i.kt)("h3",{id:"contrast-met-elke-achtergrondkleur"},"Contrast met elke achtergrondkleur"),(0,i.kt)("p",null,"Links kunnen staan in componenten die een speciale achtergrondkleur hebben, zoals componenten met een signaalkleur als achtergrond. De linkkleur moet voldoende contrast hebben met die achtergrondkleuren. Controleer alle mogelijke varianten, want misschien moet je in die situaties een bijpassende link-kleur kiezen."),(0,i.kt)("h2",{id:"content"},"Content"),(0,i.kt)("h3",{id:"gebruik-van-links-in-tekst"},"Gebruik van links in tekst"),(0,i.kt)("p",null,"Links moeten duidelijk zijn: gebruikers begrijpen dat je de link gebruikt om naar een andere pagina te gaan, en het is voorspelbaar naar welke pagina je toe gaat."),(0,i.kt)("p",null,"Gebruikers met ondersteunende technologie, zoals een schermlezer of braillebalk, horen/voelen vaak als eerste alle links in de content om hen te helpen snel te kunnen navigeren door de content. Er kan ook behoefte zijn om de de content vergroot te willen bekijken, zodat de gebruikers alleen de linktekst en een paar woorden eromheen tegelijkertijd kan zien."),(0,i.kt)("p",null,'Maak geen links met een onduidelijke tekst, zoals "hier" of "lees meer".'),(0,i.kt)("h3",{id:"links-in-een-zin"},"Links in een zin"),(0,i.kt)("p",null,"Links moeten nooit een hele zin in beslag nemen, maar alleen de tekst die beschrijft waar de gebruikers naar toe gaan als ze op de link klikken."),(0,i.kt)("h3",{id:"dos"},"Do's"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Plaats links aan het einde van een zin als dat mogelijk is."),(0,i.kt)("li",{parentName:"ul"},"Maak duidelijk waar de link je naar toe brengt."),(0,i.kt)("li",{parentName:"ul"},"Gebruik het meest relevante woord van de link aan het begin van de link tekst. Bezoekers lezen niet verder dan de eerste twee woorden van een link."),(0,i.kt)("li",{parentName:"ul"},"Zorg dat de link ook begrijpelijk is zonder dat je de zinnen er omheen gelezen hebt.")),(0,i.kt)("h3",{id:"donts"},"Don'ts"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Gebruik geen buttons waar je een link kan gebruiken."),(0,i.kt)("li",{parentName:"ul"},"Gebruik geen vage of te algemene termen voor de link tekst. Help de gebruiker met voorspellen waar hij naar toe gaat."),(0,i.kt)("li",{parentName:"ul"},"Open interne links niet in een nieuwe tab. Hiermee schakel je \xe9\xe9n navigatiemanier uit om terug te gaan naar eerdere pagina's, de terug knop van de brower.")),(0,i.kt)("h2",{id:"states"},"States"),(0,i.kt)("p",null,"We beschrijven de volgende states van een link:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"normal"),": geen van de onderstaande states is van toepassing op de link. Deze state is gewoon de ",(0,i.kt)("inlineCode",{parentName:"li"},"utrecht-link")," class in de code, maar we beschrijven hem hier om aan te geven dat de link 'normaal' is zonder een andere state."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"active"),": de gebruiker activeert de link op dit moment. Bijvoorbeeld door er op te klikken. De ",(0,i.kt)("inlineCode",{parentName:"li"},"active")," state duurt maar heel kort."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"hover"),": de gebruiker heeft de aanwijzer boven de link. Bijvoorbeeld door met de muiscursor er over te 'zweven'."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"focus"),": de link heeft de focus doordat er op geklikt of getapt is. Denk ook aan voice of eye-tracking."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"focus-visible"),": de link heeft de focus door de 'tab' knop van het keyboard."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"visited"),": de link is eerder gebruikt door de gebruiker."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"busy"),": de button is geactiveerd en de actie wordt nu nog uitgevoerd.")),(0,i.kt)("h2",{id:"link-in-plaats-van-a"},"Link in plaats van ",(0,i.kt)("inlineCode",{parentName:"h2"},"<a>")),(0,i.kt)("p",null,'Voor de component naam hebben we voor "',(0,i.kt)("inlineCode",{parentName:"p"},"link"),'" gekozen, en niet voor "',(0,i.kt)("inlineCode",{parentName:"p"},"a"),'" zoals de ',(0,i.kt)("a",{parentName:"p",href:"https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element"},(0,i.kt)("inlineCode",{parentName:"a"},"<a>"))," in HTML. Buiten de context van HTML-code (bijvoorbeeld in Figma) is ",(0,i.kt)("inlineCode",{parentName:"p"},"a"),"niet duidelijk genoeg, en we verwachten niet dat er grote verwarring ontstaat met het ",(0,i.kt)("a",{parentName:"p",href:"https://html.spec.whatwg.org/multipage/semantics.html#the-link-element"},(0,i.kt)("inlineCode",{parentName:"a"},"<link>"))," element van HTML."),(0,i.kt)("h2",{id:"html"},"HTML"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Gebruik het ",(0,i.kt)("inlineCode",{parentName:"li"},"<a>")," element om links aan te maken."),(0,i.kt)("li",{parentName:"ul"},"Gebuik niet het ",(0,i.kt)("inlineCode",{parentName:"li"},"title")," attribuut. Sommige browsers gebruiken een tooltip om de tekst uit het ",(0,i.kt)("inlineCode",{parentName:"li"},"title")," attribuut te tonen, die tooltip kan over de tekst heenstaan waardoor het niet leesbaar is."),(0,i.kt)("li",{parentName:"ul"},"Gebruik nooit een ",(0,i.kt)("inlineCode",{parentName:"li"},"<button>")," of een ander element met een ",(0,i.kt)("inlineCode",{parentName:"li"},"click")," event om zelf een link na te maken."),(0,i.kt)("li",{parentName:"ul"},"Gebruik ",(0,i.kt)("inlineCode",{parentName:"li"},'aria-current="page"')," wanneer de link verwijst naar de huidige pagina. Voor consistente navigatie (",(0,i.kt)("a",{parentName:"li",href:"https://www.w3.org/TR/WCAG21/#consistent-navigation"},"WCAG eis 3.2.3"),") is het beter om links in de navigatie te laten staan dan om geen ",(0,i.kt)("inlineCode",{parentName:"li"},"<a>")," te gebruiken voor de huidige pagina."),(0,i.kt)("li",{parentName:"ul"},"Vermijd het gebruik van ",(0,i.kt)("inlineCode",{parentName:"li"},'href="#"'),". Dit brengt de focus naar het begin van de pagina en dat is nooit wensbaar."),(0,i.kt)("li",{parentName:"ul"},"Gebruik nooit ",(0,i.kt)("inlineCode",{parentName:"li"},'tabindex="0"')," bij het ",(0,i.kt)("inlineCode",{parentName:"li"},"<a>")," element. Links kunnen al standaard focus ontvangen."),(0,i.kt)("li",{parentName:"ul"},"Vermijd onnodig gebruik van ",(0,i.kt)("inlineCode",{parentName:"li"},'tabindex="-1"'),", er zijn weinig situaties waar het nodig is."),(0,i.kt)("li",{parentName:"ul"},"Gebruik ",(0,i.kt)("inlineCode",{parentName:"li"},"aria-label")," en niet ",(0,i.kt)("inlineCode",{parentName:"li"},"title")," voor het volledige label van de link. Soms is de inhoud van het ",(0,i.kt)("inlineCode",{parentName:"li"},"a"),' element niet een goed label, bijvoorbeeld wanneer er een icoon in staat of het zichtbare label een algemene tekst is zoals "Lees meer". Zie ook ',(0,i.kt)("a",{parentName:"li",href:"https://www.w3.org/WAI/WCAG21/Techniques/aria/ARIA8"},"WCAG Technique ARIA8"))),(0,i.kt)("h3",{id:"tabindex-1"},(0,i.kt)("inlineCode",{parentName:"h3"},'tabindex="-1"')),(0,i.kt)("p",null,"Gebruik ",(0,i.kt)("inlineCode",{parentName:"p"},'tabindex="-1"')," in zeldzame gevallen dat het gebruiksvriendelijker is om een link weg te halen uit tabvolgorde. Toetsenbordgebruikers moeten toegang hebben tot dezelfde links als gebruikers van een muis."),(0,i.kt)("p",null,"Als het nodig is twee identieke links kort na elkaar te plaatsen, dan is het onnodig en onhandig dat dezelfde link twee keer na elkaar focus krijgt. In dat geval is het beter om \xe9\xe9n van de links uit de tabvolgorde te verwijderen."),(0,i.kt)("p",null,"Bijvoorbeeld:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<article>\n  <h2 id="heading-puppy-geboren"><a href="/nieuws/monster-puppy">Puppy met zes poten</a></h2>\n  <p>\n    In de gemeente Monster is een puppy geboren met zes poten.\n    <a href="/nieuws/monster-puppy" tabindex="-1" aria-labelledby="heading-puppy-geboren">Lees verder...</a>\n  </p>\n</article>\n')),(0,i.kt)("h2",{id:"privacy"},"Privacy"),(0,i.kt)("p",null,"Als de ",(0,i.kt)("inlineCode",{parentName:"p"},"visited")," een ander visueel ontwerp heeft dan een normale link, dan kunnen anderen zien welke pagina's zijn bekeken. Gebruik daarom liever geen ",(0,i.kt)("inlineCode",{parentName:"p"},"visited")," design tokens voor websites waar de privacy van de gebruiker in gevaar komt."),(0,i.kt)("p",null,'Als je een linkt maakt naar een externe website, dan kan die website zien op welke pagina de bezoeker op dat moment was. Dit is slecht voor de privacy, gebruik daarom altijd gebruik van de "externe link" code om deze informatie af te schermen.'),(0,i.kt)("h2",{id:"hoe-het-niet-moet"},"Hoe het niet moet"),(0,i.kt)("h3",{id:"geen-zichtbaar-verschil-tussen-hover-en-focus-state"},"Geen zichtbaar verschil tussen hover en focus state"),(0,i.kt)("p",null,"Als toetsenbordgebruiker is het belangrijk dat je weet welke link je activeert als je op ",(0,i.kt)("inlineCode",{parentName:"p"},"Enter")," drukt. Als de hover-variant van de link (bijna) hetzelfde is als de focus-variant, dan weet je niet zeker welke link je zult activeren."),(0,i.kt)("h3",{id:"link-tekst-betekent-verschillende-dingen"},"Link-tekst betekent verschillende dingen"),(0,i.kt)("p",null,'Niet goed: "contact" linkt eerst naar de contact-pagina, verder op linkt "contact" naar een telefoonnummer.'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<nav>\n  <a href="/contact/">contact</a>\n</nav>\n\x3c!-- ...op een andere plek in dezelfde pagina --\x3e\n<p>Neem <a href="tel:555-1234">contact</a> op met de klantenservice, vandaag tot 6 uur bereikbaar.</p>\n')),(0,i.kt)("p",null,"Beter:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<nav>\n  <a href="/contact/">contact</a>\n</nav>\n\x3c!-- ...op een andere plek in dezelfde pagina --\x3e\n<p><a href="tel:555-1234">Bel de klantenservice</a>, vandaag tot 6 uur bereikbaar.</p>\n')),(0,i.kt)("h3",{id:"verkeerde-taal"},"Verkeerde taal"),(0,i.kt)("p",null,"Als je linkt naar een pagina waarvan de beschrijving in een andere taal is dan de context waarin de link staat, dan moet je de taal instellen op de link zelf (WCAG 3.1.2)."),(0,i.kt)("p",null,"Niet:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<a href="/nl/">Nederlands</a>\n<a href="/en/">English</a>\n<a href="/fr/">Fran\xe7ois</a>\n')),(0,i.kt)("p",null,"Wel:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<a href="/nl/">Nederlands</a>\n<a href="/en/" lang="en">English</a>\n<a href="/fr/" lang="fr">Fran\xe7ois</a>\n')),(0,i.kt)("p",null,"Niet:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<p>\n  In de presentatie\n  <a href="https://www.slideshare.net/stubbornella/object-oriented-css"\n    >Object Oriented CSS for high performance web applications and sites</a\n  >\n  vertelt Nicole Sullivan over een aanpak om CSS te schrijven.\n</p>\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<p>\n  In de presentatie\n  <a href="https://www.slideshare.net/stubbornella/object-oriented-css" lang="en"\n    >Object Oriented CSS for high performance web applications and sites</a\n  >\n  vertelt Nicole Sullivan over een aanpak om CSS te schrijven.\n</p>\n')),(0,i.kt)("h3",{id:"link-naar-huidige-pagina-niet-opmaken"},"Link naar huidige pagina niet opmaken"),(0,i.kt)("p",null,"Gebruik niet ",(0,i.kt)("em",{parentName:"p"},"alleen")," een class name om duidelijk te maken dat de link verwijst naar de huidige pagina."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<a href="/">Home</a> \u203a <a href="/nieuws/">Nieuws</a> \u203a\n<a href="/nieuws/burgemeester" class="current">Nieuwe burgemeester</a>\n')),(0,i.kt)("p",null,"Gebruik altijd ",(0,i.kt)("inlineCode",{parentName:"p"},"aria-current")," om de informatie beschikbaar te maken aan de browser en tools:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<a href="/">Home</a> \u203a <a href="/nieuws/">Nieuws</a> \u203a\n<a href="/nieuws/burgemeester" class="current" aria-current="page">Nieuwe burgemeester</a>\n')),(0,i.kt)("h3",{id:"onnodige-link-naar-huidige-pagina"},"Onnodige link naar huidige pagina"),(0,i.kt)("p",null,"Niet goed: een link naar de homepage plaatsen op de homepage zelf. Op andere pagina's is het natuurlijk wel handig om het logo een link te maken."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<header>\n  <a href="/">\n    <img class="utrecht-logo" src="/logo.svg" alt="Keuringsdienst van waarde" />\n  </a>\n</header>\n<h1>Home</h1>\n')),(0,i.kt)("p",null,"Wel goed: logo zonder link op de homepage."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<header>\n  <img class="utrecht-logo" src="/logo.svg" alt="Keuringsdienst van waarde" />\n</header>\n<h1>Home</h1>\n')),(0,i.kt)("h3",{id:"link-zonder-href-attribuut"},"Link zonder ",(0,i.kt)("inlineCode",{parentName:"h3"},"href")," attribuut"),(0,i.kt)("p",null,"Niet goed: een link zonder ",(0,i.kt)("inlineCode",{parentName:"p"},"href")," attribuut is niet ",(0,i.kt)("em",{parentName:"p"},"focusable"),", waardoor je de link niet kan activeren."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},"<a onclick=\"navigate('/step-1')\">Vorige</a>\n")),(0,i.kt)("h2",{id:"referenties"},"Referenties"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.interaction-design.org/literature/article/tips-for-better-hyperlink-ux"},(0,i.kt)("em",{parentName:"a"},"Tips for Better Hyperlink UX"),", door de Interaction Design Foundation"),": waarom 'klik hier' niet werkt."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://blog.prototypr.io/a-guide-to-designing-perfect-links-in-ux-414558f35730"},(0,i.kt)("em",{parentName:"a"},"A comprehensive guide to designing perfect links in UX"),", op Prototypr"),": best practices rondom links."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://uxplanet.org/dos-and-don-ts-of-web-design-8c9d6a5de7c6"},(0,i.kt)("em",{parentName:"a"},"Do\u2019s and Don\u2019ts of Web Design")," van UX Planet"),": interessante do's en don'ts over Web Design, onder andere over links."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.nngroup.com/articles/writing-links/"},(0,i.kt)("em",{parentName:"a"},"Writing Hyperlinks: Salient, Descriptive, Start with Keyword")," door Norman Nielsen Group"),": hoe schrijf je goede links? Een uitgebreid artikel over links."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://wunder.io/wunderpedia/accessibility/accessible-uis/hover-focus-active/"},(0,i.kt)("em",{parentName:"a"},"Hover, focus, active"),", door Wunder"),": goede uitleg over de states die elementen zoals de link en button hebben in browsers."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.nngroup.com/articles/guidelines-for-visualizing-links/"},(0,i.kt)("em",{parentName:"a"},"Guidelines for Visualizing Links"),", door Nielsen Normal Group"),": richtlijnen voor het design van links."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/a"},"MDN: ",(0,i.kt)("inlineCode",{parentName:"a"},"<a>"),": The Anchor element"),": uitgebreid overzicht van alle mogelijkheden van links in HTML.")),(0,i.kt)("h3",{id:"relevante-wcag-regels"},"Relevante WCAG regels"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.w3.org/TR/WCAG21/#use-of-color"},"WCAG 1.4.1"),": een link is niet voor iedereen duidelijk herkenbaar wanneer je alleen kleur gebruikt. Gebruik ook onderstreping om de link duidelijk te maken."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.w3.org/TR/WCAG21/#contrast-minimum"},"WCAG 1.4.3")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.w3.org/TR/WCAG21/#link-purpose-in-context"},"WCAG 2.4.4")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.w3.org/TR/WCAG21/#label-in-name"},"WCAG 2.5.3")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.w3.org/TR/WCAG21/#language-of-parts"},"WCAG 3.1.2"))))}u.isMDXComponent=!0;const c={toc:[{value:"Design beslissingen",id:"design-beslissingen",level:2},{value:"Tekstlink",id:"tekstlink",level:2},{value:"Ankerlinks",id:"ankerlinks",level:2},{value:"Link met pijl",id:"link-met-pijl",level:3},{value:"Linklijst",id:"linklijst",level:2},{value:"Top navigatie link",id:"top-navigatie-link",level:2},{value:"Side navigatie link",id:"side-navigatie-link",level:2},{value:"Call-to-action button",id:"call-to-action-button",level:2},{value:"Top taak button",id:"top-taak-button",level:2},{value:"Headings als link",id:"headings-als-link",level:2},{value:"Telefoonnummer link",id:"telefoonnummer-link",level:2},{value:"Accordion link",id:"accordion-link",level:2},{value:"Link Card",id:"link-card",level:2}]},f="wrapper";function d(e){let{components:t,...n}=e;return(0,i.kt)(f,(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"soorten-links"},"Soorten links"),(0,i.kt)("p",null,"Er is een aantal verschillende soorten links in het Design System te vinden:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Tekstlinks"),(0,i.kt)("li",{parentName:"ul"},"Ankerlinks"),(0,i.kt)("li",{parentName:"ul"},"Links met pijl"),(0,i.kt)("li",{parentName:"ul"},"Linklijst"),(0,i.kt)("li",{parentName:"ul"},"Top navigatie link"),(0,i.kt)("li",{parentName:"ul"},"Side navigatie link"),(0,i.kt)("li",{parentName:"ul"},"CTA Button"),(0,i.kt)("li",{parentName:"ul"},"Top taak button"),(0,i.kt)("li",{parentName:"ul"},"Heading als link"),(0,i.kt)("li",{parentName:"ul"},"Telefoonnummer link"),(0,i.kt)("li",{parentName:"ul"},"Accordion link"),(0,i.kt)("li",{parentName:"ul"},"Link cards (wordt ingevuld als component gebouwd wordt)")),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null}),(0,i.kt)("th",{parentName:"tr",align:null},"Tekst link"),(0,i.kt)("th",{parentName:"tr",align:null},"Link met pijl"),(0,i.kt)("th",{parentName:"tr",align:null},"Ankerlinks"),(0,i.kt)("th",{parentName:"tr",align:null},"Linklijst"),(0,i.kt)("th",{parentName:"tr",align:null},"Top navigatie link"),(0,i.kt)("th",{parentName:"tr",align:null},"Side bar navigatie link"),(0,i.kt)("th",{parentName:"tr",align:null},"CTA Button link"),(0,i.kt)("th",{parentName:"tr",align:null},"Top taak button"),(0,i.kt)("th",{parentName:"tr",align:null},"Headings that are links"),(0,i.kt)("th",{parentName:"tr",align:null},"Tel nummer link"),(0,i.kt)("th",{parentName:"tr",align:null},"Accordion link"),(0,i.kt)("th",{parentName:"tr",align:null},"Link cards"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},":active"),(0,i.kt)("td",{parentName:"tr",align:null},"onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null},"niet onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null},"onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null},"niet onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null},"niet onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null},"niet onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null},"niet onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null},"niet onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null},"onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null},"onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null},"niet onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},":hover kleur"),(0,i.kt)("td",{parentName:"tr",align:null},"kleur veranderd"),(0,i.kt)("td",{parentName:"tr",align:null},"kleur veranderd"),(0,i.kt)("td",{parentName:"tr",align:null},"kleur veranderd"),(0,i.kt)("td",{parentName:"tr",align:null},"kleur veranderd"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"kleur lichter"),(0,i.kt)("td",{parentName:"tr",align:null},"kleur veranderd"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},":hover achtergrondkleur"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"achtergrond kleur lichter"),(0,i.kt)("td",{parentName:"tr",align:null},"achtergrond kleur lichter"),(0,i.kt)("td",{parentName:"tr",align:null},"achtergrond kleur lichter"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"achtergrond kleur lichter"),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},":hover onderstreping"),(0,i.kt)("td",{parentName:"tr",align:null},"dikkere onderstreping"),(0,i.kt)("td",{parentName:"tr",align:null},"dikke onderstreping"),(0,i.kt)("td",{parentName:"tr",align:null},"dikkere onderstreping"),(0,i.kt)("td",{parentName:"tr",align:null},"dikkere onderstreping"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"dikkere onderstreping"),(0,i.kt)("td",{parentName:"tr",align:null},"onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},":hover grootte"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"formaat 1.2 keer groter"),(0,i.kt)("td",{parentName:"tr",align:null},"formaat 1.2 keer groter"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},":focus outline"),(0,i.kt)("td",{parentName:"tr",align:null},"dotted outline"),(0,i.kt)("td",{parentName:"tr",align:null},"dotted outline"),(0,i.kt)("td",{parentName:"tr",align:null},"dotted outline"),(0,i.kt)("td",{parentName:"tr",align:null},"dotted outline"),(0,i.kt)("td",{parentName:"tr",align:null},"dotted outline"),(0,i.kt)("td",{parentName:"tr",align:null},"dotted outline"),(0,i.kt)("td",{parentName:"tr",align:null},"dotted outline"),(0,i.kt)("td",{parentName:"tr",align:null},"dotted outline"),(0,i.kt)("td",{parentName:"tr",align:null},"dotted outline"),(0,i.kt)("td",{parentName:"tr",align:null},"dotted outline"),(0,i.kt)("td",{parentName:"tr",align:null},"dotted outline"),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},":focus onderstreping"),(0,i.kt)("td",{parentName:"tr",align:null},"onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"niet onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null},"niet onderstreept"),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null})))),(0,i.kt)("h2",{id:"design-beslissingen"},"Design beslissingen"),(0,i.kt)("p",null,"We maken de volgende design beslissingen over links:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Links zijn onderstreept om een gebruiker snel en duidelijk te laten zien dat het een link is."),(0,i.kt)("li",{parentName:"ul"},"Bij een hover krijgt een link in de tekst een dikkere onderstreping om duidelijk aan te geven dat de link onder de muisknop zit."),(0,i.kt)("li",{parentName:"ul"},"Bij een hover maken we het component groter als het component een border of een achtergrondkleur heeft zodat je visuele feedback hebt van je hover zonder dat je een onderstreping ziet. De accordion en de hoofdnavigatie zijn de uitzondering op deze regel, maar deze krijgen wel weer een onderstreping."),(0,i.kt)("li",{parentName:"ul"},"Bij een focus krijgt een component een gestippelde outline. Er is geen visuele feedback van de muis met een hover, dus op deze manier geven we aan dat dit component is geselecteerd."),(0,i.kt)("li",{parentName:"ul"},"De gestippelde outline van de focus bestaat uit zwarte en witte puntjes zodat er altijd genoeg contrast is en dus niet afhankelijk is van de achtergrond kleur."),(0,i.kt)("li",{parentName:"ul"},"We houden de visuele weergave van de focus state en de hover state strict van elkaar gescheiden zodat beide states een eigen unieke ervaring hebben, ook al is de bezoeker hier niet actief mee bezig."),(0,i.kt)("li",{parentName:"ul"},"Een link die nog niet onderstreept is krijgt bij een hover state juist wel een onderstreping om aan te geven dat je er op kan klikken.")),(0,i.kt)("h2",{id:"tekstlink"},"Tekstlink"),(0,i.kt)("p",null,"Tekstlinks zijn standaard donkerblauw en onderstreept. In sommige gevallen zijn tekstlinks zwart of wit. Dit geldt bij teksten op een gekleurde achtergrond, waar blauw niet voldoende contrast biedt. De link tekst is andere kleur blauw in hover state De link tekst is onderstreept in hover state maar niet in focus state, een eventueel icon is niet onderstreept"),(0,i.kt)("h2",{id:"ankerlinks"},"Ankerlinks"),(0,i.kt)("p",null,"Ankerlinks worden gebruikt om te navigeren naar specifieke content op de pagina. Ankerlinks staan boven de content waar ze naar verwijzen, komen alleen voor op contentpagina\u2019s en worden gebruikt als opsomming. Ankerlinks zijn worden veel gebruikt als een soort inhoudsopgave van de pagina.\nAnkerlinks zijn blauw, onderstreept en hebben een rood bolletje als voorloopteken."),(0,i.kt)("h3",{id:"link-met-pijl"},"Link met pijl"),(0,i.kt)("p",null,"Links met een pijl als voorloopteken worden gebruikt aan het einde van een tekst. Ze verwijzen naar gerelateerde informatie over het onderwerp wat er in de voorafgaande tekst is besproken. De links zijn dik gedrukt en niet onderstreept."),(0,i.kt)("h2",{id:"linklijst"},"Linklijst"),(0,i.kt)("p",null,"Lijklijsten hebben een pijl als voorloopteken worden gebruikt aan het einde van een tekst. Ze verwijzen naar gerelateerde informatie over het onderwerp wat er in de voorafgaande tekst is besproken. De links zijn donkerblauw, bold en hebben een pijl (>) als voorloopteken. Dit type link wordt ook gebruikt in de linklijst en de subnavigatie."),(0,i.kt)("p",null,"Bij een variant van de linklijsten is de pijl zwart (#000) in plaats van donkerblauw. Deze link wordt gebruikt in de linklijsten \u2018related\u2019 die verwijzen naar gerelateerde content onderaan een contentpagina."),(0,i.kt)("h2",{id:"top-navigatie-link"},"Top navigatie link"),(0,i.kt)("p",null,"De top navigatie link is onderdeel van de top navigatiebalk die wordt gebruikt als hoofdnavigatie en die de gebruiker moet helpen te navigeren door de site."),(0,i.kt)("h2",{id:"side-navigatie-link"},"Side navigatie link"),(0,i.kt)("p",null,"De side navigatie link is onderdeel van het metromenu die wordt gebruikt om te kunnen navigeren door een onderdeel van de site."),(0,i.kt)("h2",{id:"call-to-action-button"},"Call-to-action button"),(0,i.kt)("p",null,"De Call-to-action button vertelt de gebruiker een actie uit te voeren."),(0,i.kt)("h2",{id:"top-taak-button"},"Top taak button"),(0,i.kt)("p",null,"De Top taak button is onderdeel van een set aan top taken die de gebruiker helpt bij navigeren door de meest gebruikte taken van de site duidelijk aan te bieden."),(0,i.kt)("h2",{id:"headings-als-link"},"Headings als link"),(0,i.kt)("p",null,"Soms zijn headers een link."),(0,i.kt)("h2",{id:"telefoonnummer-link"},"Telefoonnummer link"),(0,i.kt)("p",null,"De telefoonnummer link stelt gebruikers in staat vanaf de website direct met de gemeente te bellen."),(0,i.kt)("h2",{id:"accordion-link"},"Accordion link"),(0,i.kt)("p",null,"Accordions geven overzicht door content achter een klik zichtbaar te maken."),(0,i.kt)("h2",{id:"link-card"},"Link Card"),(0,i.kt)("p",null,"Wordt ingevuld als component gebouwd wordt."))}d.isMDXComponent=!0;const h={title:"Link",hide_title:!0,hide_table_of_contents:!1,sidebar_label:"Link",sidebar_position:1,pagination_label:"Link",description:"Utrecht Link component.",keywords:["link","links","hyperlink","interactie","anker","ankerlink","navigatie","sitenavigatie","tekstlink"]},p=void 0,m={unversionedId:"componenten/typografie/link",id:"componenten/typografie/link",title:"Link",description:"Utrecht Link component.",source:"@site/docs/componenten/typografie/link.mdx",sourceDirName:"componenten/typografie",slug:"/componenten/typografie/link",permalink:"/utrecht/docs/componenten/typografie/link",draft:!1,editUrl:"https://github.com/nl-design-system/utrecht/tree/main/documentation/docs/componenten/typografie/link.mdx",tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"Link",hide_title:!0,hide_table_of_contents:!1,sidebar_label:"Link",sidebar_position:1,pagination_label:"Link",description:"Utrecht Link component.",keywords:["link","links","hyperlink","interactie","anker","ankerlink","navigatie","sitenavigatie","tekstlink"]},sidebar:"components",previous:{title:"Heading",permalink:"/utrecht/docs/componenten/typografie/heading"},next:{title:"Paragraaf",permalink:"/utrecht/docs/componenten/typografie/paragraaf"}},g={},y=[{value:"UX Richtlijnen",id:"ux-richtlijnen",level:2},{value:"Soorten links",id:"soorten-links",level:2},{value:"Link Component",id:"link-component",level:2},{value:"Standaard",id:"standaard",level:3},{value:"Email",id:"email",level:3},{value:"Telefoon",id:"telefoon",level:3},{value:"Externe link",id:"externe-link",level:3},{value:"Met icoon links",id:"met-icoon-links",level:3},{value:"Voor wisselen taal link",id:"voor-wisselen-taal-link",level:3}],v={toc:y},b="wrapper";function x(e){let{components:t,...n}=e;return(0,i.kt)(b,(0,r.Z)({},v,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"{/",(0,i.kt)("em",{parentName:"p"}," @license CC0-1.0 "),"/}"),(0,i.kt)("h1",{id:"link"},"Link"),(0,i.kt)("h2",{id:"ux-richtlijnen"},"UX Richtlijnen"),(0,i.kt)("p",null,"Links helpen je gebruiker te navigeren door je app of pagina."),(0,i.kt)(o.U,{headingLevel:2,omitH1:!0,mdxType:"Markdown"},(0,i.kt)(u,{mdxType:"UXGuidelines"})),(0,i.kt)("h2",{id:"soorten-links"},"Soorten links"),(0,i.kt)(o.U,{headingLevel:3,omitH1:!0,mdxType:"Markdown"},(0,i.kt)(d,{mdxType:"SoortenLinks"})),(0,i.kt)("h2",{id:"link-component"},"Link Component"),(0,i.kt)("h3",{id:"standaard"},"Standaard"),(0,i.kt)(a.U,{tabs:[{id:"html",label:"HTML",story:"html-link--default-story"},{id:"css",label:"CSS",story:"css-link--default-story"}],mdxType:"StoryTabs"}),(0,i.kt)("h3",{id:"email"},"Email"),(0,i.kt)(a.U,{tabs:[{id:"html",label:"HTML",story:"html-link--email"},{id:"css",label:"CSS",story:"css-link--email"}],mdxType:"StoryTabs"}),(0,i.kt)("h3",{id:"telefoon"},"Telefoon"),(0,i.kt)(a.U,{tabs:[{id:"html",label:"HTML",story:"html-link--telephone"},{id:"css",label:"CSS",story:"css-link--telephone"}],mdxType:"StoryTabs"}),(0,i.kt)("h3",{id:"externe-link"},"Externe link"),(0,i.kt)(a.U,{tabs:[{id:"html",label:"HTML",story:"html-link--external"},{id:"css",label:"CSS",story:"css-link--external"}],mdxType:"StoryTabs"}),(0,i.kt)("h3",{id:"met-icoon-links"},"Met icoon links"),(0,i.kt)(a.U,{tabs:[{id:"css",label:"CSS",story:"css-link--icon-left"}],mdxType:"StoryTabs"}),(0,i.kt)("h3",{id:"voor-wisselen-taal-link"},"Voor wisselen taal link"),(0,i.kt)("p",null,"Als de taal een andere is dan het huidige document"),(0,i.kt)(a.U,{tabs:[{id:"html",label:"HTML",story:"html-link--alternate-lang"},{id:"css",label:"CSS",story:"css-link--alternate-lang"}],mdxType:"StoryTabs"}),(0,i.kt)("p",null,"Als de taal dezelfde taal is als het huidige document"),(0,i.kt)(a.U,{tabs:[{id:"html",label:"HTML",story:"html-link--current-lang"},{id:"css",label:"CSS",story:"css-link--current-lang"}],mdxType:"StoryTabs"}))}x.isMDXComponent=!0}}]);