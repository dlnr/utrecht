{"version":3,"file":"preview-3f5cd387.js","sources":["../../../../node_modules/.pnpm/storybook-addon-pseudo-states@2.0.0-next.0_4brwzt33xfky4dscp5z6acwexa/node_modules/storybook-addon-pseudo-states/dist/chunk-A7FPDXSC.mjs","../../../../node_modules/.pnpm/storybook-addon-pseudo-states@2.0.0-next.0_4brwzt33xfky4dscp5z6acwexa/node_modules/storybook-addon-pseudo-states/dist/preview.mjs"],"sourcesContent":["// src/constants.ts\nvar ADDON_ID = \"storybook/pseudo-states\";\nvar TOOL_ID = `${ADDON_ID}/tool`;\nvar EXCLUDED_PSEUDO_ELEMENTS = [\"::-webkit-scrollbar-thumb\"];\nvar PSEUDO_STATES = {\n  hover: \"hover\",\n  active: \"active\",\n  focusVisible: \"focus-visible\",\n  focusWithin: \"focus-within\",\n  focus: \"focus\",\n  visited: \"visited\",\n  link: \"link\",\n  target: \"target\"\n};\n\nexport {\n  ADDON_ID,\n  TOOL_ID,\n  EXCLUDED_PSEUDO_ELEMENTS,\n  PSEUDO_STATES\n};\n","import {\n  EXCLUDED_PSEUDO_ELEMENTS,\n  PSEUDO_STATES\n} from \"./chunk-A7FPDXSC.mjs\";\n\n// src/preview/withPseudoState.ts\nimport {\n  DOCS_RENDERED,\n  STORY_CHANGED,\n  STORY_RENDERED,\n  UPDATE_GLOBALS\n} from \"@storybook/core-events\";\nimport { addons, useEffect, useMemo } from \"@storybook/preview-api\";\n\n// src/preview/splitSelectors.ts\nvar isAtRule = (selector) => selector.indexOf(\"@\") === 0;\nvar splitSelectors = (selectors) => {\n  if (isAtRule(selectors))\n    return [selectors];\n  let result = [];\n  let parentheses = 0;\n  let brackets = 0;\n  let selector = \"\";\n  for (let i = 0, len = selectors.length; i < len; i++) {\n    const char = selectors[i];\n    if (char === \"(\") {\n      parentheses += 1;\n    } else if (char === \")\") {\n      parentheses -= 1;\n    } else if (char === \"[\") {\n      brackets += 1;\n    } else if (char === \"]\") {\n      brackets -= 1;\n    } else if (char === \",\") {\n      if (!parentheses && !brackets) {\n        result.push(selector.trim());\n        selector = \"\";\n        continue;\n      }\n    }\n    selector += char;\n  }\n  result.push(selector.trim());\n  return result;\n};\n\n// src/preview/rewriteStyleSheet.ts\nvar pseudoStates = Object.values(PSEUDO_STATES);\nvar matchOne = new RegExp(`:(${pseudoStates.join(\"|\")})`);\nvar matchAll = new RegExp(`:(${pseudoStates.join(\"|\")})`, \"g\");\nvar warnings = /* @__PURE__ */ new Set();\nvar warnOnce = (message) => {\n  if (warnings.has(message))\n    return;\n  console.warn(message);\n  warnings.add(message);\n};\nvar isExcludedPseudoElement = (selector, pseudoState) => EXCLUDED_PSEUDO_ELEMENTS.some((element) => selector.endsWith(`${element}:${pseudoState}`));\nvar rewriteRule = ({ cssText, selectorText }, shadowRoot) => {\n  return cssText.replace(\n    selectorText,\n    splitSelectors(selectorText).flatMap((selector) => {\n      if (selector.includes(\".pseudo-\")) {\n        return [];\n      }\n      if (!matchOne.test(selector)) {\n        return [selector];\n      }\n      const states = [];\n      const plainSelector = selector.replace(matchAll, (_, state) => {\n        states.push(state);\n        return \"\";\n      });\n      const classSelector = states.reduce((acc, state) => {\n        if (isExcludedPseudoElement(selector, state))\n          return \"\";\n        return acc.replace(new RegExp(`(?<!Y):${state}`, \"g\"), `.pseudo-${state}`);\n      }, selector);\n      if (selector.startsWith(\":host(\") || selector.startsWith(\"::slotted(\")) {\n        return [selector, classSelector].filter(Boolean);\n      }\n      const ancestorSelector = shadowRoot ? `:host(${states.map((s) => `.pseudo-${s}`).join(\"\")}) ${plainSelector}` : `${states.map((s) => `.pseudo-${s}`).join(\"\")} ${plainSelector}`;\n      return [selector, classSelector, ancestorSelector].filter(\n        (selector2) => selector2 && !selector2.includes(\":not()\")\n      );\n    }).join(\", \")\n  );\n};\nvar rewriteStyleSheet = (sheet, shadowRoot, shadowHosts2) => {\n  if (sheet.__pseudoStatesRewritten)\n    return;\n  sheet.__pseudoStatesRewritten = true;\n  try {\n    let index = 0;\n    for (const cssRule of sheet.cssRules) {\n      if (!(\"selectorText\" in cssRule))\n        continue;\n      const styleRule = cssRule;\n      if (matchOne.test(styleRule.selectorText)) {\n        const newRule = rewriteRule(styleRule, shadowRoot);\n        sheet.deleteRule(index);\n        sheet.insertRule(newRule, index);\n        if (shadowRoot && shadowHosts2)\n          shadowHosts2.add(shadowRoot.host);\n      }\n      index++;\n      if (index > 1e3) {\n        warnOnce(\"Reached maximum of 1000 pseudo selectors per sheet, skipping the rest.\");\n        break;\n      }\n    }\n  } catch (e) {\n    if (String(e).includes(\"cssRules\")) {\n      warnOnce(`Can't access cssRules, likely due to CORS restrictions: ${sheet.href}`);\n    } else {\n      console.error(e, sheet.href);\n    }\n  }\n};\n\n// src/preview/withPseudoState.ts\nvar channel = addons.getChannel();\nvar shadowHosts = /* @__PURE__ */ new Set();\nvar applyClasses = (element, classnames) => {\n  Object.values(PSEUDO_STATES).forEach((state) => element.classList.remove(`pseudo-${state}`));\n  classnames.forEach((classname) => element.classList.add(classname));\n};\nvar applyParameter = (rootElement, parameter) => {\n  const map = /* @__PURE__ */ new Map([[rootElement, /* @__PURE__ */ new Set()]]);\n  const add = (target, state) => map.set(target, /* @__PURE__ */ new Set([...map.get(target) || [], state]));\n  Object.entries(parameter || {}).forEach(([state, value]) => {\n    if (typeof value === \"boolean\") {\n      if (value)\n        add(rootElement, state);\n    } else if (typeof value === \"string\") {\n      rootElement.querySelectorAll(value).forEach((el) => add(el, state));\n    } else if (Array.isArray(value)) {\n      value.forEach((sel) => rootElement.querySelectorAll(sel).forEach((el) => add(el, state)));\n    }\n  });\n  map.forEach((states, target) => {\n    const classnames = /* @__PURE__ */ new Set();\n    states.forEach((key) => PSEUDO_STATES[key] && classnames.add(`pseudo-${PSEUDO_STATES[key]}`));\n    applyClasses(target, classnames);\n  });\n};\nvar updateShadowHost = (shadowHost) => {\n  const classnames = /* @__PURE__ */ new Set();\n  for (let element = shadowHost.parentElement; element; element = element.parentElement) {\n    if (!element.className)\n      continue;\n    element.className.split(\" \").filter((classname) => classname.indexOf(\"pseudo-\") === 0).forEach((classname) => classnames.add(classname));\n  }\n  applyClasses(shadowHost, classnames);\n};\nvar withPseudoState = (StoryFn, { viewMode, parameters, id, globals: globalsArgs }) => {\n  const { pseudo: parameter } = parameters;\n  const { pseudo: globals } = globalsArgs;\n  const canvasElement = useMemo(() => {\n    if (viewMode === \"docs\") {\n      return document.getElementById(`story--${id}`);\n    }\n    return document.getElementById(\"storybook-root\") || document.getElementById(\"root\");\n  }, [viewMode, id]);\n  useEffect(() => {\n    if (parameter !== globals && viewMode === \"story\") {\n      channel.emit(UPDATE_GLOBALS, {\n        globals: { pseudo: parameter }\n      });\n    }\n  }, [parameter, viewMode]);\n  useEffect(() => {\n    if (!canvasElement)\n      return;\n    const timeout = setTimeout(() => {\n      applyParameter(canvasElement, globals || parameter);\n      shadowHosts.forEach(updateShadowHost);\n    }, 0);\n    return () => clearTimeout(timeout);\n  }, [canvasElement, globals, parameter]);\n  return StoryFn();\n};\nvar rewriteStyleSheets = (shadowRoot) => {\n  let styleSheets = Array.from(shadowRoot ? shadowRoot.styleSheets : document.styleSheets);\n  if (shadowRoot?.adoptedStyleSheets?.length)\n    styleSheets = shadowRoot.adoptedStyleSheets;\n  styleSheets.forEach((sheet) => rewriteStyleSheet(sheet, shadowRoot, shadowHosts));\n};\nchannel.on(STORY_CHANGED, () => shadowHosts.clear());\nchannel.on(STORY_RENDERED, () => rewriteStyleSheets());\nchannel.on(DOCS_RENDERED, () => rewriteStyleSheets());\nif (Element.prototype.attachShadow) {\n  Element.prototype._attachShadow = Element.prototype.attachShadow;\n  Element.prototype.attachShadow = function attachShadow(init) {\n    const shadowRoot = this._attachShadow({ ...init, mode: \"open\" });\n    requestAnimationFrame(() => {\n      rewriteStyleSheets(shadowRoot);\n      updateShadowHost(shadowRoot.host);\n    });\n    return shadowRoot;\n  };\n}\n\n// src/preview.ts\nvar decorators = [withPseudoState];\nexport {\n  decorators\n};\n"],"names":["EXCLUDED_PSEUDO_ELEMENTS","PSEUDO_STATES","isAtRule","selector","splitSelectors","selectors","result","parentheses","brackets","i","len","char","pseudoStates","matchOne","matchAll","warnings","warnOnce","message","isExcludedPseudoElement","pseudoState","element","rewriteRule","cssText","selectorText","shadowRoot","states","plainSelector","_","state","classSelector","acc","ancestorSelector","s","selector2","rewriteStyleSheet","sheet","shadowHosts2","index","cssRule","styleRule","newRule","e","channel","shadowHosts","applyClasses","classnames","classname","applyParameter","rootElement","parameter","map","add","target","value","el","sel","key","updateShadowHost","shadowHost","withPseudoState","StoryFn","viewMode","parameters","id","globalsArgs","globals","canvasElement","timeout","rewriteStyleSheets","_a","styleSheets","init","decorators"],"mappings":"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"}